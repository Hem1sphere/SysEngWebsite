define("MsPortalImpl/Base/BladeWidthHelper",["require","exports","f","o"],(function(n,t,i,r){"use strict";function f(n){return u[n]}r.defineProperty(t,"__esModule",{value:!0});var u={};u[51]={css:"fxs-bladesize-menu",width:265};u[0]={css:"fxs-bladesize-small",width:315};u[1]={css:"fxs-bladesize-medium",width:585};u[2]={css:"fxs-bladesize-large",width:855};u[3]={css:"fxs-bladesize-xlarge",width:1125};t.contextPaneDefaultSizeClass="fxs-bladesize-contextpane-default";t.getBladeWidthInfo=f;t.allWidthClasses=i.map(u,(function(n){return n.css})).join(" ")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-commandBar{position:relative;padding:0 15px;display:-webkit-flex;display:flex}.fxs-commandBar-item{font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}.fxs-commandBar-item .fxs-commandBar-fileUpload-overlay{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;display:block;cursor:pointer}.fxs-commandBar-item-buttoncontainer{display:-webkit-flex;display:flex}.fxs-commandBar-itemList{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-wrap:wrap;flex-wrap:wrap;padding:0;margin:0;list-style-type:none;height:35px;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-commandBar-item[aria-disabled=true],.fxs-commandBar-item[aria-disabled=true] .fxs-commandBar-fileUpload-overlay{cursor:default}.fxs-commandBar-item[aria-disabled=true].fxs-commandBar-itemUnauthorized{cursor:not-allowed}.fxs-commandBar-item[aria-disabled=true].fxs-commandBar-itemDisabledTemporarily{opacity:1}.fxs-commandBar-item-text{font-size:13px;position:relative;background-color:inherit;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:180px}.fxs-commandBar-item-icon{height:16px;width:16px;padding-right:5px}.fxs-commandBar-item-separator{padding:0;margin:0 -3px;outline:0}.fxs-commandBar-item-separator .fxs-commandBar-item-icon{width:21px;height:21px;padding-right:0}.fxs-commandBar-listpopup{top:35px}.fxs-commandBar-item-expandList{height:35px;padding:0;margin-left:auto}.fxs-commandBar-item-expandList>div{height:100%}.fxs-commandBar-item-expandList .fxs-dropmenu-content{width:220px}.fxs-commandBar-item-expandList .fxs-dropmenu-button{padding:0 10px}.fxs-commandBar-overflow-button{display:-webkit-flex;display:flex}.fxs-commandBar-item-focused{outline:#00bcf2 dashed 1px}")}));
define("_generated/Templates/WidgetsCommandBar",["require","exports"],(function(){"use strict";return function(){return'<ul class="fxs-commandBar-itemList" role="menubar"> <!-- ko template: { name: \'fxCommandBarItemTemplate\', foreach: data.topMenuItems(), as: \'command\' } --> <!-- /ko --> <\/ul> <div class="fxs-portal-border fxs-commandBar-item fxs-commandBar-item-expandList fxs-display-none"><\/div> '}}));
define("_generated/Templates/WidgetsCommandBarItem",["require","exports","ko"],(function(){"use strict";return function(){return"<li tabindex=\"-1\" class=\"fxs-commandBar-item fxs-portal-border fxs-command-like-button\" data-bind=\"css: { 'fxs-commandBar-item-opendialog': $data.hasOpenDialog, 'fxs-portal-selected': pressed() || ($data.hasOpenDialog && $data.hasOpenDialog()) || ($data.checked && $data.checked()), 'fxs-commandBar-item-checked': $data.checked, 'fxs-commandBar-item-separator': $data.isSeparator, 'fxs-commandBar-itemDisabled fxs-command-like-button-disabled': $parent.commandDisabled($data), 'fxs-portal-hover': !$parent.commandDisabled($data), 'fxs-commandBar-itemUnauthorized': unauthorized }, attr: { title: tooltip() ? tooltip() : text(), 'aria-disabled': $parent.commandDisabled($data), 'aria-label': ariaLabel, 'aria-haspopup': hasPopup, 'aria-expanded': (hasPopup() ? ($data.hasOpenDialog && $data.hasOpenDialog() ? 'true' : 'false') : false), role: $data.isSeparator && $data.isSeparator() ? 'separator': 'menuitem' }\" > <div class=\"fxs-commandBar-item-buttoncontainer\"> <div class=\"fxs-commandBar-item-icon\" data-bind=\"image: icon\"><\/div> <div class=\"fxs-commandBar-item-text msportalfx-tooltip-overflow\" data-bind=\"text: text\"><\/div> <!-- ko if: ko.unwrap($data.fileInputOptions) --> <input type=\"file\" class=\"fxs-commandBar-fileUpload-overlay\" data-bind=\"attr: { accept: $data.fileInputOptions().accept, multiple: $data.fileInputOptions().maxFiles > 1, disabled: $parent.commandDisabled($data) }\"/> <!-- /ko --> <!-- ko if: hasPopup --> <div class=\"fxs-commandBar-listpopup\"><\/div> <!-- /ko --> <\/div> <\/li>"}}));
define("MsPortalImpl/Widgets/Widgets.CommandBar",["require","exports","f","ko","$","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","_generated/Templates/WidgetsCommandBar","_generated/Templates/WidgetsCommandBarItem","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.DropMenu","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";var nt;return (function(n){function ni(n){for(var i=u(n),e=i.width(),r=i.findByClassName(nt),f=0,t=0;t<r.length;){if(f+=u(r[t]).outerWidth(!0),f>=e-1)break;t++}return t}function ti(n){return(n||[]).filter((function(n){return!(n.isSeparator&&n.isSeparator())}))}function vi(n,t,r,u){var f=n.menuItems().filter((function(n){var t=n.visible();return t&&n.text(),t}));l.requestAnimationFrame((function(){var e,o,s;i.arrayEquals(n.topMenuItems(),f)||n.topMenuItems(f);h.hide(t);e=ni(r);o=ti(n.topMenuItems.splice(e,f.length-e));o.length>0&&(h.unhide(t),s=ni(r),n.remainingMenuItems(s<e?ti(n.topMenuItems.splice(s,e-s)).concat(o):o));u()}))}function yi(){tt={};rt={};rt[5]=v.DialogButton;rt[7]=at;rt[11]=ii;tt[4]=yt;tt[3]=ct;tt[10]=ri;tt[2]=ht;tt[6]=pt;tt[8]=lt;tt[9]=vt}function pi(n,i,r,u,f){var e=i.type,o,s;return e===12?new t(n,new fi.ToolbarButton(12,{type:12,icon:ut.Images.Line(),disabled:!0}),r,f):(tt||yi(),o=tt[e],o)?new o(n,i,r,f):(s=rt[e],s)?new s(n,i,r,u,f):new t(n,i,r,f)}function wi(n){n?u.querySelectorAll(kt).addClass(ot):u.querySelectorAll(hi).removeClass(ot)}var ut=i.Base,ft=ut.Promises,fi=i.ViewModels.Toolbars,t=v.ItemViewModel,ei=window,nt="fxs-commandBar-item",bt="fxs-commandBar-itemList",oi="fxs-commandBar-item-text",et="fxs-commandBar-item-expandList",si="fxs-commandBar-listpopup",kt=".fxs-commandBar-item:not(.fxs-commandBar-itemDisabled)",dt="."+bt+" > ."+nt+":not(.fxs-commandBar-item-separator), ."+et+" .fxs-dropmenu-button",it=".fxs-commandBar-fileUpload-overlay",ot=nt+"DisabledTemporarily",hi="."+ot,gt=i.forEachKey,st=i.require,ci=o.CommandBar,li="<div class=\"fxs-commandBar-overflow-list fxs-portal-border\" role=\"menu\"><!-- ko template: { name: 'fxCommandBarItemTemplate', foreach: $data.data.remainingMenuItems(), as: 'command' } --><!-- /ko --><\/div>",ai='<div class="fxs-commandBar-overflow-button fxs-command-like-button"><div class="fxs-commandBar-item-icon" data-bind="image: $data.data.ellipsisCommandIcon"><\/div><div class="fxs-commandBar-item-text" data-bind="text: $data.data.ellipsisCommandText, attr: { title: $data.data.ellipsisCommandText }"><\/div><\/div>',tt,rt,ht,ii,ct,ri,lt,at,vt,yt,pt,wt,ui;w.registerKoTemplate("fxCommandBarItemTemplate",p());n.createItem=pi;n.toggleTemporarilyDisabledCommands=wi;ht=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.execute=function(t){var u=this._model,i=u&&u.clickableLink,f;i&&r.isObservable(i.uri)&&(f=r.unwrap(i.target)||"_blank",ei.open(i.uri(),f),i.onLinkOpened&&i.onLinkOpened(!1));n.prototype.execute.call(this,t)},t})(t);n.OpenLinkButton=ht;ii=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(v.DialogButton);ct=(function(n){function t(t,i,u,f){var e=n.call(this,t,i,u,f)||this,o=e.model;return o&&o.selectable&&r.isObservable(o.selectable.isSelected)&&r.computed(e._ltm,(function(){e.pressed(e.model.selectable.isSelected())})),e}return __extends(t,n),t.prototype.execute=function(t){var i=this.model.selectable;i&&r.isObservable(i.isCommandSelected)&&i.isSelected(!0);n.prototype.execute.call(this,t)},t})(t);n.OpenBladeButton=ct;ri=(function(n){function t(t,i,r,u){var e=n.call(this,t,i,r,u)||this,o=f.getOrCreate(i.selectable);return e.pressed=o.isSelected,e.execute=function(t){o.onClick();n.prototype.execute.call(e,t)},e}return __extends(t,n),t})(t);lt=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this,e;return f._fileUploaderMap={},e=f.model,f.fileInputOptions(new s.FileInputOptions(e.accept,e.maxFiles)),f.model.cancelAllUploads.subscribe(f._ltm,(function(n){n&&(f._cancelAllUploads(),e.cancelAllUploads(!1))})),f}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);ft.cancelOnDispose(this._executeLifetime,st("MsPortalImpl/Services/Services.FileUpload")).then((function(n){i._execute(n,t)}))},t.prototype._execute=function(n){var f=[],t=this.fileInputOptions().files(),i,e,r,u;if(t&&t.length>0){for(i=this.model,i.cancelAllUploadsOnFileSelection()&&this._cancelAllUploads(),e=Math.min(t.length,i.maxFiles),r=0;r<e;r++)u=this._fileUploaderMap[t[r].name],u&&u.dispose(),u=new n.FileUploader(this._ltm,this._fileUploaderMap,t[r],i),this._fileUploaderMap[t[r].name]=u,f.push(u.uploadTask);i.uploadTasks.push.apply(i.uploadTasks,f)}},t.prototype._cancelAllUploads=function(){var n=this._fileUploaderMap;this._fileUploaderMap={};gt(n,(function(n,t){t.cancel();t.dispose()}))},t})(t);n.FileUploadButton=lt;at=(function(n){function t(t,i,r,u,f){var s=n.call(this,t,i,r,f)||this;return s._diContainer=u,s.visible(!0),e.isSafari&&e.webKitVersion<e.safari_11_webKitVersion&&(s.fxEnabled(!1),s.tooltip(o.FileDownloadCommand.safariDownload)),s}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);this.fxEnabled()&&ft.cancelOnDispose(this._executeLifetime,st("MsPortalImpl/Commands/Commands.FileDownloadCommand")).then((function(n){if(i._instance)i._instance.execute(i.model.context());else return i._currentContext.getFormTarget().then((function(t){var r=t&&t.getForm();i._instance=new n.FileDownloadCommand(i.model.context(),i._diContainer,u(r),i._locator);i._instance.execute(i.model.context())}))}))},t})(t);n.FileDownloadButton=at;vt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);ft.cancelOnDispose(this._executeLifetime,st("MsPortalImpl/Commands/Commands.OAuthCommand")).then((function(n){var t=i.model;i.childWindow=n.executeOAuthCommand(t.value,t.requestUrl(),t.popupWidth(),t.popupHeight())}))},t})(t);n.OAuthButton=vt;yt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.execute=function(t){var i=this._model;i.command&&i.command.execute(r.unwrap(i.commandContext));n.prototype.execute.call(this,t)},t})(t);n.CommandButton=yt;pt=(function(n){function t(t,i,u,f){var e=n.call(this,t,i,u,f)||this;return e.checked=r.observable(!1),e.model&&r.isObservable(e.model.checked)&&r.computed(e._ltm,(function(){e.checked(e.model.checked())})),e}return __extends(t,n),t.prototype.execute=function(t){var i=this.model,r=!i.checked();i.checked(r);i.command&&i.command.execute({checked:r,context:i.commandContext&&i.commandContext()});n.prototype.execute.call(this,t)},t})(t);n.ToggleButton=pt;wt=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.menuItems=r.observableArray(),t.topMenuItems=r.observableArray(),t.remainingMenuItems=r.observableArray(),t.commandForm=r.observable(),t.itemSelected=u.noop,t.commandBarResize=u.noop,t.ellipsisCommandText=r.observable(ci.more),t.ellipsisCommandIcon=ut.Images.Ellipsis({palette:99}),t}return __extends(t,n),t})(a.ViewModel);n.ViewModel=wt;ui=(function(n){function t(t,i){var u=n.call(this,t,i||new wt)||this,e,f,o,c,s,h;return u._groups={},t.html(y()).addClass("fxs-commandBar"),e=u.options,f=u.ltm,u._overflowMenu=t.findByClassName(et),o=new b.ViewModel(ai,li,"."+nt),o.setItemFocusWhenOpen=!0,c=new g.KeyboardNavigation(f,{element:t,tabTriggers:12,itemSelector:dt}),f.registerForDispose([new b.Widget(u._overflowMenu,o),]),u._overflowMenu.findByClassName("fxs-dropmenu-button").addClass("fxs-portal-hover").attr("tabindex","-1"),u._items=u.element.findByClassName(bt),u._bindDescendants({commandDisabled:function(n){return!n.fxEnabled()||!n.enabled()||n.unauthorized()}}),u._attachEventHandlers(),u._setupOptionGroupReactors(e,f),h=function(){e.menuItems().length>0&&s&&s()},h(),r.computed(f,s=function(){vi(e,u._overflowMenu,u._items[0],(function(){u._accessibility()}))}),k.track(u.ltm,t.parent(),h),r.computed(f,e.remainingMenuItems,(function(){c.correctState(!0)})).extend({deferred:!0}),u}return __extends(t,n),t.prototype.dispose=function(){this._removeOptionGroupReactors();this._cleanElement("fxs-commandBar");n.prototype.dispose.call(this)},t.prototype._accessibility=function(){var t,n;for(this.element.find(it).closest("."+nt).removeAttr("tabIndex"),t=this.element.find("."+nt),n=0;n<t.length;n++){var r=u(t[n]),e=r.find("."+oi),f=i.getUniqueId();r.attr("aria-labelledby",f);e.attr("id",f)}},t.prototype.setFocus=function(){var n=this.element.find(dt).filter("[tabindex='0']")[0]||this.element.find(kt)[0];n&&n.focus()},t.prototype._attachEventHandlers=function(){var n=this,t=this.element,i=t.setEvents([[d.default.click,d.default.keydown].join(" "),"."+nt,function(t){(t.type!==d.default.keydown||(t.keyCode===13||t.keyCode===32)&&c.getModifierKeys(t)===0)&&((t.stopPropagation(),u(t.currentTarget).hasClass(et))||u(t.target).attr("aria-disabled")!=="true"&&n._handleItemClick(t))},],[d.default.click,it,function(n){n.stopPropagation();u(n.target).val("")},],[d.default.change,it,function(t){t.stopPropagation();n._handleItemClick(t)},],[d.default.focus,it,function(n){n.stopPropagation();u(n.target).closest("."+nt).addClass("fxs-commandBar-item-focused")},],[d.default.blur,it,function(n){n.stopPropagation();u(n.target).closest("."+nt).removeClass("fxs-commandBar-item-focused")},]);this.ltm.registerForDispose(i)},t.prototype._setupOptionGroupReactors=function(n,t){var i=this;n.menuItems().forEach((function(n){return i._onItemAdded(n)}));n.menuItems.subscribeArrayChanges(t,(function(n){i._onItemAdded(n)}),(function(n){i._onItemRemoved(n)}))},t.prototype._onItemAdded=function(n){var t=n.model;if(t&&t.type===6&&t.optionGroupName){var i=this._groups[t.optionGroupName],u=n._ltm.createChildLifetime(),f={button:t,lifetime:u};i?i.push(f):this._groups[t.optionGroupName]=i=[f];r.computed(u,(function(){var n=t.checked();n&&i.forEach((function(n){var i=n.button;i!==t&&i.checked(!1)}))}))}},t.prototype._onItemRemoved=function(n){var t=n.model,i,r;t&&t.type===6&&t.optionGroupName&&(i=this._groups[t.optionGroupName],r=i.first((function(n){return n.button===t})),i.remove(r),r.lifetime.dispose())},t.prototype._removeOptionGroupReactors=function(){gt(this._groups,(function(n,t){t.forEach((function(n){n.lifetime.dispose()}));t.length=0}))},t.prototype._handleItemClick=function(n){var t=r.dataFor(n.target),o=u(n.target).closest("."+nt),f=o.findByClassName(si),s=t&&t.hasPopup&&t.hasPopup()&&f.length,i=t.fileInputOptions,e;i&&i()&&(e=n.target,i().files(e.files));this.trigger("itemSelected",null,{item:t,popupTarget:s?f[0]:null})},t})(a.Widget);n.Widget=ui})(nt||(nt={})),nt}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-lens{position:relative;padding-bottom:10px}.fxs-blade-locked .fxs-stacklayout-child:last-child.fxs-lens,.fxs-blade-summary-container .fxs-lens{padding-bottom:0}.fxs-lens>.fxs-lens-title-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:30px}.fxs-blade-summary-container .fxs-lens .fxs-lens-title-container,.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part .fxs-part-title,.fxs-lens.fxs-lens-fit>.fxs-lens-title{display:none}.fxs-lens>.fxs-lens-title-container>.fxs-lens-title{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;line-height:30px;height:30px}.fxs-lens.fxs-lens-fit{padding-bottom:0;height:100%}.fxs-lens.fxs-lens-fit>.fxs-lens-layout{height:100%}.fxs-bladestyle-create .fxs-lens.fxs-lens-fit{width:calc(100% + 2*25px);margin-left:-25px}.fxs-bladecontent-unlocked .fxs-lens.fxs-lens-fit{padding-top:15px}.fxs-blade-locked .fxs-blade-stacklayout.fxs-stacklayout-vertical .fxs-lens>.fxs-lens-title-container{height:auto}.fxs-blade-stacklayout.fxs-stacklayout-horizontal .fxs-lens>.fxs-lens-layout{height:calc(100% - 30px)}.fxs-blade-content-container .fxs-bladestyle-hub .fxs-blade-summary-container,.fxs-blade-content-container .fxs-bladestyle-hubsubmenu .fxs-blade-summary-container{border:none}.fxs-blade-summary-container{position:relative;overflow:hidden;border-bottom-width:1px;border-bottom-style:solid}.fxs-blade-summary-container .fxs-lens .fxs-tile{min-height:35px;width:100%!important;height:auto}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-tile-progress{top:35px;height:calc(100% - 35px);overflow:hidden}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part{padding:0;box-shadow:none!important}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part.fxs-part-part-title-visible .fxs-part-content{top:0}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-part .fxs-part-blockui-shield{top:35px}.fxs-blade-summary-container .fxs-lens .fxs-tile .fxs-tile-actionbar-actionlist{visibility:hidden}.fxs-lens-layout-flow .fxs-lens-layout{display:-webkit-flex;display:flex;-webkit-flex-flow:row wrap;flex-flow:row wrap;-webkit-align-items:flex-start;align-items:flex-start;margin:0 -5px -5px 0}.fxs-lens-layout-flow .fxs-tile{-webkit-flex:0 0 auto;flex:0 0 auto;margin:0 5px 5px 0}")}));
define("_generated/Templates/WidgetsLens",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-lens-title-container"> <div class="fxs-lens-title" data-bind=\'text: data.title, visible: data.title\'><\/div> <\/div> <div class="fxs-lens-layout"><\/div> '}}));
define("MsPortalImpl/Widgets/Widgets.Lens",["require","exports","f","o","ko","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsLens","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function tt(n,t){var i=t.findByClassName(a).children().toArray(),r=i.map((function(n){return y($(n),v)}));return r.first((function(t){return t&&t.options&&t.options.id===n}))}var d,g;r.defineProperty(t,"__esModule",{value:!0});var v=h.Widget,nt=c.Widget,y=o.Widget.getWidget,p="fxs-lens",w="fxs-lens-fit",b="fxs-lens-title",a="fxs-lens-layout",k="fxs-lens-layout-flow";d=(function(n){function t(t){var i=n.call(this,t)||this;return i.title=u.observable(),i}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){},t})(c.ViewModel);t.ViewModel=d;g=(function(n){function t(t,r){var f=n.call(this,t,r)||this;return t.addClass(p).html(s()),u.computed(f.ltm,[r.locked,r.title],(function(n,r){if(n||i.isNullOrWhiteSpace(r))t.findByClassName(a).removeAttr("aria-describedby"),t.findByClassName(b).removeAttr("id");else{var u=i.getUniqueId();t.findByClassName(a).attr("aria-describedby",u);t.findByClassName(b).attr("id",u)}})),f._bindDescendants(),f}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(p,w,k);n.prototype.dispose.call(this)},t.prototype.addChild=function(n){var t;if(!n)throw new Error("Can't add null child.");var u=n.element||n,i=y(u,v),r=i.options,f=e.isVariableSize(r.size()),o=r.size()===9;f||this.element.addClass(k);t=this.element;t.findByClassName(a).append(i.element);t.toggleClass(w,o)},t.prototype.removeChild=function(n,t){var r=!1,u=tt(n,this.element),i;return u&&(i=u.element,t?i.detach():i.remove(),r=!0),r},t.prototype.setSize=function(){this.element.findByClassName(a).children().each((function(n,t){var i=y($(t),v);i&&i.element.trigger(l.default.fxsizechanged)}))},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.getTelemetrySource=function(){return f.Source.Lens},t.prototype.discardStateOfUnusedChildren=function(){return{stateDiscarded:!1}},t})(nt);t.Widget=g}));
define("MsPortalImpl/Widgets/Widgets.StackLayout",["require","exports","o","a","ko","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.UIElementBase","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css"],(function(n,t,i,r,u,f,e,o){"use strict";var a,h;i.defineProperty(t,"__esModule",{value:!0});var c="fxs-stacklayout-horizontal",l="fxs-stacklayout-vertical",s="fxs-stacklayout-child",v=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.orientation=u.observable(e.Orientation.Vertical),r.childElements=u.observableArray(),r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{positions:this.positions}},t.prototype.applyViewSettings=function(n){n&&n.positions&&(this.positions=n.positions)},t})(e.ViewModel);t.ViewModel=v;a=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._engine=new h,r._engine.positions=i.positions,t.addClass("fxs-stacklayout"),u.computed(r.ltm,(function(){var n=r.options.orientation();r.element.toggleClass(l,n===undefined||n===e.Orientation.Vertical).toggleClass(c,n===e.Orientation.Horizontal)})),r._bindDescendants(),r}return __extends(t,n),t.prototype.dispose=function(){this.options.childElements().forEach((function(n){u.cleanNode(n[0]);n.remove()}));this._cleanElement(l,c,"fxs-stacklayout");n.prototype.dispose.call(this)},t.prototype.addChild=function(n){this._addInsertChild(n)},t.prototype.insertChild=function(n,t){this._addInsertChild(n,t)},t.prototype.removeChild=function(n){var t=this.options.childElements().first((function(t){return o.Widget.getId(t)===n}));return t?(f.hide(t).removeClass(s),setTimeout((function(){t.remove()}),100),this.options.childElements().splice(this.options.childElements().indexOf(t),1),this._engine.remove(n),this.element.trigger(e.Widget.layoutUpdatedEventName),this._applyPositioning(),!0):!1},t.prototype.saveViewSettings=function(){return this.options.positions=this._engine.positions,this.options.getViewSettings()},t.prototype.discardStateOfUnusedChildren=function(){var t={stateDiscarded:!1},n;return this._engine&&(n=this._engine.discardUnusedPositions(),n&&n.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(n))),t},t.prototype._addInsertChild=function(n,t){var f=this.options,u=this.element,h=f.childElements(),i,r;if(!n)throw new Error("Cannot add a null child.");i=n.element?n.element:n;i.addClass(s);h.push(i);this._engine.insert(o.Widget.getId(i),t);r=u.children("."+s).toArray().filter((function(n){var t=n&&n.style,i=t&&t.display;return i!=="none"}));t>=0||(t=r.length);r.length>t?$(r[t]).before(i):r.length?$(r[r.length-1]).after(i):u.append(i);this._applyPositioning();u.trigger(e.Widget.layoutUpdatedEventName)},t.prototype._applyPositioning=function(){var n=this.options.childElements,t=[];this._engine.positions.forEach((function(i){var r=n().first((function(n){return o.Widget.getId(n)===i.id}));r&&(n().splice(n().indexOf(r),1),t.push(r))}));r.prototype.unshift.apply(n(),t);n.valueHasMutated()},t})(e.Widget);t.Widget=a;h=(function(){function n(){this._items=[];this._filledPositions={}}return n.prototype.append=function(n){var t=this._getExistingItem(n);return this._filledPositions[n]=!0,t||this._insert(n),this._items},n.prototype.insert=function(n,t){var i=this._getExistingItem(n);return this._filledPositions[n]=!0,!i||this._items.splice(this._items.indexOf(i),1),this._insert(n,t),this._items},n.prototype.move=function(n,t){var i=this._getExistingItem(n),r=this._items.indexOf(i);return r>=0&&(this._items.splice(r,1),this._items.splice(t,0,i)),this._items},n.prototype.remove=function(n){var i=this._getExistingItem(n),t;return t=this._items.indexOf(i),t>=0&&(this._items.splice(t,1),this._filledPositions[n]=!1),this._items},i.defineProperty(n.prototype,"positions",{get:function(){return this._items},set:function(n){this._items.length=0;this._items=n},enumerable:!0,configurable:!0}),n.prototype.discardUnusedPositions=function(){var n=this,t=[];return this._items.slice(0).forEach((function(i){n._filledPositions[i.id]||(t.push(i),n.remove(i.id))})),t},n.prototype._insert=function(n,t){var i={id:n,position:{col:0,row:0},rowSpan:1,colSpan:1};t>=0&&t<this._items.length?this._items.splice(t,0,i):this._items.push(i)},n.prototype._getExistingItem=function(n){return this._items.first((function(t){return t.id===n}))},n})();t.StackLayoutPositioningEngine=h}));
define("_generated/Templates/WidgetsBladeContent",["require","exports","$"],(function(){"use strict";return function(){return'<div data-bind="visible: !data.unauthorizedNoticeVm(), stopBindings: true" class="fxs-blade-commandBarContainer"> <div class="fxs-commandBar-target fxs-portal-border fxs-portal-background fxs-portal-svg"><\/div> <\/div> <div class="fxs-blade-dialoghost" data-bind="stopBindings: true"> <div class="fxs-blade-dialog"><\/div> <\/div> <!-- ko if: showDescription --> <div class="fxs-blade-title-description fxs-blade-statusbg fxs-bg-info"> <div class="fxs-blade-title-description-centeringwrapper"> <span data-bind="text: data.description"><\/span> <a class="fxs-blade-title-help-link" data-bind="attr: { href: data.helpUri }, visible: data.helpUri && $.trim(data.helpUri()).length > 0" target="_blank"> <span data-bind="text: data.text.helpText"><\/span> <span class="fxs-blade-title-help-icon" data-bind="image: data.icons.hyperlink"><\/span> <\/a> <\/div> <\/div> <!-- /ko --> <div class="fxs-blade-status-container fxs-blade-statusbg" data-bind="css: data.getStatusBgClass()"> <a class="fxs-blade-status-text-container" data-bind="visible: !data.statusBar.activatable() || data.loaded(), attr: { href: data.statusBar.activatable() ? \'#\' : null }"> <span class="fxs-blade-status-icon" data-bind="image: data.statusIcon, css: data.getStatusFillClass()"><\/span> <span class="fxs-blade-status-text" data-bind="text: data.contentStateDisplayText"><\/span> <span class="fxs-blade-status-arrow" data-bind=\'image: data.icons.arrowRight, css: data.getStatusFillClass(), visible: data.statusBar.activatable\'><\/span> <\/a> <\/div> <div class="fxs-blade-content-wrapper" tabindex="-1" data-bind="attr: { \'aria-label\': data.title }"> <div class="fxs-blade-summary-container fxs-portal-border fxs-display-none"><\/div> <div class="fxs-blade-content"> <div class="fxs-blade-content-focused"><\/div> <!-- ko ifnot: (data.disabled() || data.unauthorizedNoticeVm()) --> <div class="fxs-blade-stacklayout" data-bind="stopBindings: true"><\/div> <!-- /ko --> <!--ko if: data.disabled --> <div class="fxs-blade-disabled-message"> <h2 class="fxs-blade-disabled-message-titleText" data-bind="text: data.disabledMessageTitle"><\/h2> <div class="fxs-blade-disabled-message-subtitleText fxs-portal-title" data-bind="visible: data.disabledMessageSubtitle(), text: data.disabledMessageSubtitle"><\/div> <img data-bind=\'attr: { src: data.icons.sadCloud }\'/> <\/div> <!-- /ko --> <!-- ko if: (data.unauthorizedNoticeVm() && !data.disabled()) --> <div data-bind="pcNotice: data.unauthorizedNoticeVm"><\/div> <!-- /ko --> <button class="fxs-bladecontent-collapser fxs-portal-hover fxs-portal-svg" aria-expanded="true" data-bind="image: data.icons.collapse, attr: { title: ariaCollapse, \'aria-label\': ariaCollapse }"><\/button> <\/div> <\/div> <div class="fxs-blade-actionBar fxs-display-none"><\/div> <button class="fxs-blade-collapse-veil fxs-portal-hover fxs-portal-svg" aria-expanded="false" data-bind="image: data.icons.collapse, attr: { title: ariaExpand, \'aria-label\': ariaExpand }"><\/button> <fxs-progress data-bind="visible: func.showLoadingIndicator, css: func._getShieldClasses"><\/fxs-progress> '}}));
define("MsPortalImpl/Widgets/Widgets.BladeContent",["require","exports","f","i","o","ko","$","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsBladeContent","MsPortalImpl/Widgets/Widgets.CommandBar","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Lens","MsPortalImpl/Widgets/Widgets.StackLayout","MsPortalImpl/Widgets/Widgets.UIElementBase","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/BladeWidthHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Resources/Resources.Images"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft){"use strict";function wr(n){return n.map((function(n){return n.css})).join(" ")}function pi(n){return tr[n||0].toLowerCase()}var et,st,bt,yi,wi;u.defineProperty(t,"__esModule",{value:!0});var kt=i.Base,bi=kt.Diagnostics,at=i.Blades,dt=at.Internal.BladeStyle,ki=at.Internal.BladeWidth,di=at.Internal.DisplayState,ht=kt.Images,gi=ht.Shell,nr=i.ViewModels,vt=ht.StatusBadge.Solid,tr=nr.Internal.InternalContentState,ir=k.Orientation,gt=v.Widget,rr=k.Widget,ur=d.Widget,lt=nt.Widget,ct=s.Blade.StatusBar,ni=bi.createLog(n),fr=i.isNullOrUndefined,ti=lt.viewSettingsChanged,ii="fxs-mode-locked",er="fxs-blade-unauthorized",ri="fxs-blade-locked",yt="fxs-blade-content",ui="fxs-blade-summary-container",or="fxs-blade-status-container",pt=".fxs-blade-status-text-container[href]",sr="fxs-blade-status-visible",fi="fxs-blade-stacklayout",ei="fxs-blade-dialog",hr="fxs-blade-actionBar",cr="fxs-display-none",oi="fxs-bladestyle-default",si="fxs-bladecontent",hi="fxs-bladecontent-unlocked",ci="fxs-bladecontent-progress",lr="fxs-blade-shield-translucent fxs-tile-overlay",ar="fxs-commandBar-target",vr="fxs-blade-disabled-message-titleText",yr="fxs-blade-disabled-message-subtitleText",wt="fxs-blade-collapsed",li="fxs-bladecontent-collapser",ai="fxs-blade-collapse-veil",pr=i.isFeatureEnabled("skipautofocus"),vi=rt.getBladeWidthInfo(1),ot={};ot[2]=ct.warning;ot[3]=ct.error;ot[4]=ct.dirty;ot[5]=ct.info;ot[6]=ct.upsell;ot[7]=ct.complete;et={};st={isLogo:!0};et[2]=vt.Warning(st);et[3]=vt.Error(st);et[4]=et[5]=vt.Info(st);et[6]=ht.StatusUpsell(st);et[7]=ht.Check(st);t.defaultSvg=gi.DefaultBlade();t.combineAllCssClasses=wr;bt=(function(){function n(){this.activatable=f.observable(!1);this.activated=f.observable(!1)}return n})();t.BladeStatusBarViewModel=bt;yi=(function(n){function r(i,r){var u=n.call(this,i)||this,e;return u.loaded=f.observable(!1),u.statusBar=new bt,u.bladeStyle=f.observable(),u.title=f.observable(),u.subtitle=f.observable(),u.titleSuffix=f.observable(),u.subtitleSuffix=f.observable(),u.description=f.observable(""),u.helpUri=f.observable(""),u.contextMenu=new w.ViewModel,u.commandBar=new p.ViewModel,u.renderCmdBarWhenNoCmd=f.observable(!1),u.icon=f.observable(t.defaultSvg),u.contentState=f.observable(0),u.contentStateDisplayText=f.observable(),u.disabledMessageTitle=f.observable(),u.disabledMessageSubtitle=f.observable(),u.unauthorizedNoticeVm=f.observable(),u.statusIcon=f.observable(),u.displayState=f.observable(1),u.shieldType=f.observable(),u.isUiBlocked=f.observable(!1),u.bladeWidth=f.observable(1),u.icons={arrowRight:ht.ArrowRight(st),sadCloud:ft.getPartError().icon,hyperlink:ht.Hyperlink(st),collapse:ht.DoubleChevron()},u.text=s.Blade,u.hasIcon=f.observable(),u.isV2Blade=f.observable(!1),e=new g.ViewModel("fxs-blade-stacklayout-instanceid"),e.orientation(ir.Vertical),u.stackLayoutOptions=e,u.bladeName=r||{name:i,extensionName:null},u}return __extends(r,n),r.prototype.getStatusBgClass=function(){return"fxs-bg-"+pi(this.contentState())},r.prototype.getStatusFillClass=function(){return"fxs-fill-"+pi(this.contentState())},r.prototype.getViewSettings=function(){var t=this.stackLayoutOptions,n;return this._viewSettings||(this._viewSettings=e.extend(this._viewSettings,{})),n=this._viewSettings,n.DisplayState=this.displayState(),n.BladeWidth=this.bladeWidth(),n.BladeStyle=this.bladeStyle(),n.NormalState={layoutSettings:t&&t.getViewSettings()},n},r.prototype.applyViewSettings=function(n){var t,r,u,e,o,s;n&&(t=this._viewSettings=i.extend2(this._viewSettings,f.toJS(n)),r=t.BladeWidth,ki[r]&&this.bladeWidth(r),u=t.BladeStyle,dt[u]&&this.bladeStyle(u),e=t.DisplayState,di[e]&&this.displayState(e),o=t.NormalState,s=o&&o.layoutSettings,s&&this.stackLayoutOptions.applyViewSettings(s))},r})(nt.ViewModel);t.ViewModel=yi;wi=(function(n){function t(t,r,u){var e=n.call(this,t,r)||this,w,s,a,c,l,b,v,k,d;return e.showLoadingIndicator=f.observable(!1),e.timer=i.startTimer(),w=y(),t.html(w).addClass(si),e._accessibility(),s=e.ltm,a=e._$bladeContent=e.element.findByClassName(yt),r.contextMenu.registerForCleanup(s),e._getShieldClasses=f.pureComputed((function(){return r.shieldType()===1?ci+" "+lr:ci+" fxs-portal-background"})),r.contentState.subscribe(s,(function(n){var i=!fr(n)&&n!==0&&n!==1;t.toggleClass(sr,i);r.statusIcon(et[n]||et[5])})),f.computed(s,[r.title,r.contentState,r.contentStateDisplayText,r.statusBar.activatable,],(function(n,t,i,r){if(t!==1&&i){var f=ot[t]?ot[t]:"",u=n+"-"+f+"-"+i;r&&(u+="-"+ct.linkDesc);e._removeLastStatusBarMessage&&e._removeLastStatusBarMessage();e._removeLastStatusBarMessage=h.read(u,2,"blade")}})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),f.reactor(s,(function(){var n=!!r.locked();r.stackLayoutOptions.locked(n);t.toggleClass(ii,n).toggleClass(ri,n).toggleClass(hi,!n)})),l=f.observable(),e._getContentWidth=f.computed(s,(function(){var t=e.options,n,r,u;return t.displayState()===2?(c||(c=s.createChildLifetime(),requestAnimationFrame((function(){c&&tt.track(c,a,(function(n){l(n)}))}))),l||(n=a[0].style.width||"",r=i.endsWith(n,"px")&&+n.substr(0,n.length-2),l(r||a.width())),l()):(c&&(c.dispose(),l(0)),u=rt.getBladeWidthInfo(t.bladeWidth())||vi,u.width)})),b=r.unauthorizedNoticeVm,b.subscribeAndRun(s,(function(n){t.toggleClass(er,!!n);n&&(r.locked(!0),r.loaded(!0),r.isUiBlocked(!1),r.bladeStyle(4));e.trigger(it.default.fxbladerepos)})),r.bladeWidth.subscribe(s,(function(){e.applyBladeWidth(u);t.trigger(ti,e.saveViewSettings());e.trigger(it.default.fxbladerepos)})),s.registerForDispose([t.findByClassName(or).setEvents([it.default.click,pt,function(n){n.preventDefault();t.trigger(it.default.fxbladestatusbarclicked)},],[it.default.keydown,pt,function(n){n.which===13&&(n.preventDefault(),t.trigger(it.default.fxbladestatusbarclicked))},]),t.setEvents([rr.layoutUpdatedEventName,function(n){t.trigger(ti,r.getViewSettings());n.stopPropagation()},],[it.default.keydown,function(n){var i=t.find(pt);if(i.length&&n.which===113)return t.trigger(it.default.fxbladestatusbarclicked),!1},]),]),e._bindDescendants({showDescription:f.computed(s,(function(){return!!(r.description()||"").trim().length})),ariaCollapse:f.computed(e.ltm,r.title,(function(n){return r.text.collapseMenuAria.format(n)})),ariaExpand:f.computed(e.ltm,r.title,(function(n){return r.text.expandMenuAria.format(n)}))}),s.registerForDispose([o.setup(t,r.contextMenu.menuItems),]),r.contextMenu.menuItems.subscribeAndRun(s,(function(n){var i=!!v,u=n.length>0;i&&!u?v.dispose():!i&&u&&(v=s.createChildLifetime()).registerForDispose(o.setup(t,r.contextMenu.menuItems))})),f.computed(s,[r.commandBar.menuItems,r.renderCmdBarWhenNoCmd],(function(n,i){var u=!!e._commandBar,f=n.length>0||i;u&&!f?(k.dispose(),e._commandBar=null):!u&&f&&(k=s.createChildLifetime()).registerForDispose(e._commandBar=new p.Widget(t.findByClassName(ar),r.commandBar))})),e.applyBladeWidth(u),d=e.element.find("."+ai+", ."+li),s.registerForDispose(d.setEvents([it.default.click,function(n){var t=e.element.hasClass(wt);e.element.toggleClass(wt);e.trigger(it.default.fxbladerepos,null,{noExitPeekMode:!0,noScroll:!0});e.element.findByClassName(t?li:ai).focus();n.stopPropagation();i.Base.Diagnostics.Telemetry.trace({source:["Extension",e.options.bladeName.extensionName,ut.Source.Blade,e.options.bladeName.name].join("/"),action:ut.Action.MenuCollapse,actionModifier:t?"Expand":"Collapse",name:"fxs-blade-menu-expandcollapse"})},])),f.computed(e.ltm,[r.isUiBlocked,r.loaded],(function(n,t){e.showLoadingIndicator(!t||n)})),e}return __extends(t,n),t.prototype.dispose=function(){this._removeLastStatusBarMessage&&(this._removeLastStatusBarMessage(),this._removeLastStatusBarMessage=null);this._cleanElement(rt.allWidthClasses,ii,si,this.bladeStyleClass,hi,ri,wt);n.prototype.dispose.call(this)},t.prototype.setContentWidth=function(){var n=this.element.findByClassName(fi),t=rt.getBladeWidthInfo(this.options.bladeWidth())||vi;n.css("width",t.width+50+"px")},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.setSummary=function(n){var t=this.element.findByClassName(ui);l.hide(t);t.empty().append(n);l.unhide(t)},t.prototype.setActionBar=function(n){if(this._actionBar){ni.error("The blade '{0}' already contains an action bar.".format(this.options.id));return}if(this.ltm&&!this.ltm.isDisposed()){var i=this.element.findByClassName(hr).removeClass(cr),t=e(r.createElement("div"));i.append(t);this.ltm.registerForDispose(this._actionBar=n(t))}},t.prototype.getForm=function(){return this.element.findByClassName(ei)[0]},t.prototype.showForm=function(){},t.prototype.hideForm=function(){this.element.findByClassName(ei).empty()},t.prototype.initializeLayout=function(){var t=this.element,i=t.findByClassName(fi),n;if(this._layout)throw new Error("Blade widget's layout can only be initialized once.");n=this.options.stackLayoutOptions;this._layout=new g.Widget(i,n);this.ltm.registerForDispose(this._layout);this.applyBladeWidth()},t.prototype.childRelayout=function(){var n=this;this._layout&&this._layout.options.childElements().forEach((function(t){var i=gt.getWidget(t,ur),r;i&&(r=n._getContentWidth(),i.setSize(r,-1))}))},t.prototype.addChild=function(n){var t;if(!n)throw new Error("Can't add null child.");this._layout&&this._layout.addChild(n);t=n instanceof lt?n:gt.getWidget(n,lt);t.setSize(this._getContentWidth(),-1)},t.prototype.removeChild=function(n){return!!this._layout&&this._layout.removeChild(n)},t.prototype.setFocus=function(){var t=this,r;if(!pr&&this._layout){var i="fxs-lens",u=this.element.findByClassName(ui).findByClassName(i),f=void 0,n;l.isVisible(u)?n=u:(i=yt,n=this._$bladeContent);n.length&&(r=document.activeElement,r&&e.contains(n[0],r)||(f=Q.delay(100).then((function(){return b.waitForBindings(t.element[0])})),f.then((function(){var r=function(){var i=t._actionBar,n=i&&i.contentElement;if(n&&l.isVisible(n))return c.setFocusOnContainer(n[0],null)},u=function(){return c.setFocusOnContainer(n[0],i)};u().then((function(n){if(!n&&!e.contains(t.element[0],document.activeElement))return Q.delay(150).then(u)})).then((function(n){n||e.contains(t.element[0],document.activeElement)||r()})).catch(r)}))))}},t.prototype.setFocusOnCommandBar=function(){this._commandBar&&this._commandBar.setFocus()},t.prototype.discardStateOfUnusedChildren=function(){return ni.assert(!!this._layout,"StackLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},t.prototype.initializeStyleReactor=function(){var n=this,t=this.element,r=this.options;f.reactor(this.ltm,(function(){var e=n.bladeStyleClass,f;t.removeClass(u.keys(i.Blades.Internal.BladeStyle).filter((function(n){return!parseInt(n)})).map((function(n){return"fxs-bladestyle-"+n.toLowerCase()})).concat([oi]).join(" "));f=dt[r.bladeStyle()];e=n.bladeStyleClass=f?"fxs-bladestyle-"+f.toLowerCase():oi;t.addClass(e)}))},t.prototype.applyBladeWidth=function(){var n=rt.getBladeWidthInfo(this.options.bladeWidth()).css;this.element.removeClass(rt.allWidthClasses).addClass(n).findByClassName(yt).removeClass(rt.allWidthClasses).addClass(n)},t.prototype._accessibility=function(){var n=i.getUniqueId();this.element.findByClassName(vr).attr("aria-describedby",n);this.element.findByClassName(yr).attr("id",n)},t})(lt);t.Widget=wi}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-blade-header,.fxs-commandBar-target{border-bottom-width:1px;border-bottom-style:solid}.fxs-blade{position:relative;overflow:hidden;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;max-width:100%}.fxs-blade.fxs-blade-initializing{transition:none!important}.fxs-blade .fxs-blade-dialoghost{display:block;position:relative;z-index:200;width:100%;left:0;overflow:visible;height:0}.fxs-blade .fxs-blade-stacklayout{height:100%;-ms-overflow-style:auto;box-sizing:border-box;padding:10px 25px 25px}.fxs-blade .fxs-blade-disabled-message{text-align:center}.fxs-blade .fxs-blade-disabled-message .fxs-blade-title-subtitleText{font-size:12px;line-height:normal;text-transform:uppercase;margin:0}.fxs-blade-header{position:relative;height:45px;-webkit-flex-shrink:0;flex-shrink:0;box-sizing:border-box}.fxs-blade-title{-webkit-flex:1 1 auto;flex:1 1 auto;min-width:0;width:100%}.fxs-blade-title-subtitleText,.fxs-blade-title-titleText{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-blade-title-titleText{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:18px;line-height:30px;display:inline-block;max-width:100%}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content h1,.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h1,.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h2{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200}.fxs-blade-title-titleText:focus{outline-offset:-1px}.fxs-blade-title-subtitleText{max-width:100%;margin-top:-8px;font-size:10px;line-height:14px}.fxs-blade-header-icon{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;margin-right:10px;position:relative}.fxs-blade-header-icon img,.fxs-blade-header-icon svg{height:28px;width:28px}.fxs-blade-title-image{width:45px;height:45px;display:block;margin-right:10px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-blade-title-content{display:-webkit-flex;display:flex;height:100%;padding-left:25px}.fxs-commandBar-target:empty{border:0}.fxs-blade-disabled .fxs-blade-commandBarContainer{display:none}.fxs-blade-content-container{height:100%;position:relative;display:-webkit-flex;display:flex;-webkit-flex-direction:row;flex-direction:row;-webkit-flex:1 1 auto;flex:1 1 auto;min-height:0}.fxs-blade-content-focused{display:none;position:fixed;border-radius:3px;border:3px inset #00bcf2;margin:1px;height:6px;width:6px;pointer-events:none;opacity:.5}.fxs-blade-content-wrapper{height:100%;overflow:auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-flex:1 1 auto;flex:1 1 auto;box-sizing:border-box;position:relative}.fxs-blade-position-feature2 .fxs-blade-content-wrapper{overflow-x:hidden}.fxs-blade-title-description .fxs-blade-title-help-link{white-space:nowrap}.fxs-blade-title-description .fxs-blade-title-help-link .fxs-blade-title-help-icon>svg{width:10px;height:10px;margin-left:2px;vertical-align:middle}.fxs-blade-status-container.fxs-bg-none,.fxs-blade-status-container.fxs-bg-success{display:none}.fxs-blade-status-text-container,.fxs-blade-title-description{min-height:36px;box-sizing:border-box;padding:5px 25px;font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-blade-status-text-container{height:100%}.fxs-blade-status-icon{height:20px;-webkit-flex:0 0 20px;flex:0 0 20px;margin-right:10px}.fxs-blade-status-icon svg{height:20px;width:20px}.fxs-blade-status-arrow{height:12px;-webkit-flex:0 0 12px;flex:0 0 12px;margin-left:5px}.fxs-blade-status-arrow svg{height:12px;width:12px}.fxs-blade-button:not(.fxs-blade-close),.fxs-blade-title{visibility:hidden}.fxs-blade-loaded .fxs-blade-button,.fxs-blade-loaded .fxs-blade-title{visibility:visible}.fxs-blade-actions{display:-webkit-flex;display:flex;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-blade-button{cursor:pointer;padding:0;border:0;background-color:transparent;margin:0;transition:background-color .2s ease-out;height:30px;width:30px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fxs-blade-button svg{height:12px;width:12px}.fxs-blade-button.fxs-blade-pin[aria-disabled=true]{cursor:default;opacity:.5}.fxs-blade-pin svg{height:14px;width:14px}.fxs-blade-close:hover{background-color:#ba141a;fill:#fff!important}.fxs-bladestyle-context .fxs-blade-content .fxs-tile,.fxs-bladestyle-help .fxs-blade-content .fxs-tile{background:0 0}.fxs-blade.fxs-blade-maximized{width:100%}.fxs-blade-content-container>div{display:none}.fxs-blade-content{height:100%;-webkit-flex:1 1 auto;flex:1 1 auto;position:relative;box-sizing:border-box;min-height:0}.fxs-blade-content-container .fxs-bladecontent{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;position:relative;-webkit-flex:1 1 auto;flex:1 1 auto;min-width:0}.fxs-blade-content-container-details .fxs-part-resourcesummary-bottom,.fxs-blade-content-container-details .fxs-part-resourcesummary-shortcuts,.fxs-blade-hide-translucent .fxs-blade-progress-translucent,.fxs-blade-unauthorized .fxs-blade-status-container,.fxs-blade-unauthorized .fxs-blade-summary-container,.fxs-bladestyle-hub .fx-text-title,.fxs-bladestyle-hub .fxs-blade-actions .fxs-blade-pin,.fxs-bladestyle-hubsubmenu .fx-text-title,.fxs-bladestyle-hubsubmenu .fxs-blade-actions .fxs-blade-pin{display:none}.fxs-blade-content-container .fxs-bladecontent:first-child{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-blade-progress{top:45px;height:calc(100% - 45px);z-index:202}.fxs-bladecontent-progress{z-index:201}.fxs-blade-progress-translucent{height:8px;position:absolute;z-index:202;overflow:hidden}.fxs-blade-progress-translucent>div{margin-left:6px}.fxs-blade-progress-translucent>div::after{height:4px;width:4px}.fxs-blade-content-container-default,.fxs-blade-maximized .fxs-blade-stacklayout{width:100%}.fxs-blade .fxs-blade-summary-container{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-blade-border{border-left-style:solid;border-left-width:1px;box-sizing:border-box}.fxs-blade-content-container-details .fxs-part-resourcesummary .fxs-part-properties{margin-bottom:6px}.fxs-blade-appblade .fxs-blade-content{padding:0}.fxs-bladestyle-app .fxs-blade-stacklayout{padding:0;top:0;bottom:0}.fxs-bladestyle-app .fxs-part{padding:0!important;height:100%!important}.fxs-bladestyle-basic .fxs-blade-content,.fxs-bladestyle-basic .fxs-blade-stacklayout,.fxs-bladestyle-basicwithcommands .fxs-blade-content,.fxs-bladestyle-basicwithcommands .fxs-blade-stacklayout,.fxs-bladestyle-context .fxs-blade-content,.fxs-bladestyle-context .fxs-blade-content .fxs-part-content .fxc-hotspot,.fxs-bladestyle-context .fxs-blade-stacklayout,.fxs-bladestyle-create .fxs-blade-content,.fxs-bladestyle-create .fxs-blade-stacklayout{padding:0}.fxs-bladestyle-app .fxs-lens,.fxs-bladestyle-app .fxs-lens-layout,.fxs-bladestyle-app .fxs-part-content,.fxs-bladestyle-app .fxs-tile{height:100%!important}.fxs-bladestyle-app .fxs-blade-summary-container{border-bottom-width:0}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content h1{font-size:28px;margin:0 0 25px}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content button.fxc-hotspot,.fxs-bladestyle-help .fxs-blade-content .fxs-part-content button.fxc-hotspot{padding:3px 10px 5px}.fxs-bladestyle-context .fxs-blade-content .fxs-part-content .msportalfx-partdivider::after{margin:0}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h1{font-size:34px;margin:14px 0 33px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h2{font-size:22px;margin:0 0 17px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h3{font-size:14px;margin:10px 0 8px}.fxs-bladestyle-help .fxs-blade-content .fxs-part-content h4{text-transform:uppercase;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;margin:0}.fxs-bladestyle-hub .fxs-blade-content,.fxs-bladestyle-hub .fxs-blade-stacklayout,.fxs-bladestyle-hubsubmenu .fxs-blade-content,.fxs-bladestyle-hubsubmenu .fxs-blade-stacklayout{padding:0}.fxs-bladestyle-hub .fxs-blade-statusbar-wrapper,.fxs-bladestyle-hubsubmenu .fxs-blade-statusbar-wrapper{background-color:inherit}.fxs-blade-unauthorized .fxc-notice{position:absolute;width:100%}.fxs-blade-has-activation .azc-collapsed-hidden,.fxs-blade-has-activation .msportalfx-hideonactivated{display:none!important}html[lang^=zh] .fxs-blade .fxs-blade-header .fxs-blade-title h3,html[lang^=zh] .fxs-blade .fxs-blade-statusbar-text,html[lang^=ja] .fxs-blade .fxs-blade-header .fxs-blade-title h3,html[lang^=ja] .fxs-blade .fxs-blade-statusbar-text,html[lang^=ko] .fxs-blade .fxs-blade-header .fxs-blade-title h3,html[lang^=ko] .fxs-blade .fxs-blade-statusbar-text{font-size:11px}.fxs-blade-content-container .fxs-bladestyle-create .fxs-blade-stacklayout{padding-left:25px;padding-right:25px}.fxs-blade-content-container .fxs-bladestyle-create .fxs-blade-stacklayout .fxs-part{padding-left:0;padding-right:0}.fxs-blade-shield-translucent{pointer-events:none}.fxs-blade-shield-translucent .fxs-progress-dots{display:none}.fxs-blade-content-container-details{width:585px}.fxs-bladesize-small.fxs-blade-content-container-details{width:315px}.fxs-bladesize-small.fxs-blade-content{min-width:297px}.fxs-bladesize-medium.fxs-blade-content-container-details{width:585px}.fxs-bladesize-medium.fxs-blade-content{min-width:567px}.fxs-bladesize-expandable.fxs-blade-content-container-details,.fxs-bladesize-large.fxs-blade-content-container-details{width:855px}.fxs-bladesize-expandable.fxs-blade-content,.fxs-bladesize-large.fxs-blade-content{min-width:837px}.fxs-bladesize-xlarge.fxs-blade-content-container-details{width:1125px}.fxs-bladesize-xlarge.fxs-blade-content{min-width:1107px}.fxs-blade-has-activation .fxs-blade-content{min-width:auto}.fxs-menublade .fxs-blade-content-container-default{flex-shrink:0;-webkit-flex-shrink:0;width:265px}.fxs-menublade .fxs-blade-content-container-default .fxs-blade-content{min-width:247px}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-unauthorized{width:100%}.fxs-menublade .fxs-blade-content-container-default.fxs-blade-collapsed{width:25px}.fxs-menublade .fxs-blade-disabled .fxs-blade-content-container-default{width:100%}.fxs-blade-firstblade .fxs-blade-content-container-default.fxs-blade-collapsed{width:24px}.fxs-blade-actions .fxs-blade-collapser>svg,.fxs-bladecontent-collapser svg{height:8px;width:8px}.fxs-blade-firstblade .fxs-blade-content-container-default,.fxs-blade-firstblade .fxs-blade-header,.fxs-blade-firstblade>fxs-progress{border-left-width:0}.fxs-bladecontent-unlocked .fxs-lens-layout-flow{margin-right:-18px}.fxs-blade-position-feature2 .fxs-blade{max-width:none}.fxs-blade-collapser svg,.fxs-bladecontent-collapser svg{transform:rotate(270deg)}.fxs-blade-collapse-veil svg,.fxs-blade-expander svg{transform:rotate(90deg);height:8px;width:8px}.fxs-blade-collapse-veil svg{position:absolute;top:8px;right:8px}.fxs-blade-collapse-veil,.fxs-blade-expander,.fxs-bladecontent-collapser{display:none;position:absolute;cursor:pointer;padding:0;width:100%;border-width:0}.fxs-blade-collapsed .fxs-blade-collapse-veil,.fxs-blade-collapsed .fxs-blade-expander{display:block}.fxs-menublade .fxs-blade-content-container-default .fxs-bladecontent-collapser{display:block;top:0;right:0;width:24px;height:24px}.fxs-blade-collapsed .fxs-blade-content-container-default,.fxs-blade-collapsed .fxs-blade-content-container-details,.fxs-blade-collapsed .fxs-blade-title-content,.fxs-blade-collapsed.fxs-blade-content-container-default>div,.fxs-contextpane .fxs-blade .fxs-blade-actions .fxs-blade-maximizeOrRestore,.fxs-menublade .fxs-blade-content-container-default.fxs-blade-collapsed .fxs-bladecontent-collapser,.fxs-menublade .fxs-blade-content-container-default.fxs-blade-unauthorized .fxs-bladecontent-collapser{display:none}.fxs-blade-collapse-veil,.fxs-blade-expander{height:100%;width:100%}.fxs-blade-collapse-veil.fxs-blade-border{border-left-width:1px}.fxs-blade-collapsed{width:25px}.fxs-blade-collapsed.fxs-blade-firstblade{width:24px}.fxs-blade-collapsed.fxs-blade-firstblade .fxs-blade-collapse-veil{border-left-width:0}.fxs-contextpane .fxs-blade{max-width:100%}.fxs-contextpane .fxs-blade .fxs-blade-header,.fxs-contextpane .fxs-blade .fxs-blade-progress,.fxs-contextpane .fxs-blade .fxs-bladecontent{border:none}.fxs-contextpane .fxs-blade:not(.fxs-bladesize-contextpane-default) .fxs-blade-content-wrapper{overflow:auto}.fxs-contextpane .fxs-blade.fxs-bladesize-small{width:315px}.fxs-contextpane .fxs-blade.fxs-bladesize-medium{width:585px}.fxs-contextpane .fxs-blade.fxs-bladesize-large{width:855px}.fxs-contextpane .fxs-blade.fxs-bladesize-xlarge{width:1125px}.fxs-contextpane .fxs-blade.fxs-bladesize-contextpane-default{max-width:435px}.fxs-blade.fxs-contextpane-content{min-width:315px}.fxs-blade.fxs-bladesize-contextpane-default .fxs-blade-content{min-width:auto}.fxs-journey-layout>.fxs-blade-lastblade .fxs-blade-maximizeOrRestore{display:-webkit-flex;display:flex}.fxs-journey-layout .fxs-blade-maximizeOrRestore{display:none}.fxs-menublade .fxs-blade-content-container-default .fxs-blade-stacklayout{padding:0}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-details{-webkit-flex:1 1 auto;flex:1 1 auto;display:block;position:relative}.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-default .fxs-bladecontent-collapser,.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-content-container-default .fxs-bladecontent-progress,.fxs-blade-known-menu.fxs-blade-initializing .fxs-blade-progress{display:none}')}));
define("_generated/Templates/WidgetsBlade",["require","exports","f"],(function(){"use strict";return function(){return'<header class="fxs-blade-header fxs-header fxs-blade-border fxs-portal-border fxs-portal-svg" data-bind="css: { \'fxs-blade-loading-status\': !data.loaded(), \'fxs-blade-loaded\': data.loaded }"> <div class="fxs-blade-progress-translucent fxs-loading5dots-container" data-bind="visible: data.showTranslucentSpinner"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <div class="fxs-blade-title-content"> <!-- ko if: func._showTitleImage --> <img class="fxs-blade-title-image" data-bind="attr: { src: data.titleImageUri, alt: data.title }"/> <!-- /ko --> <!-- ko if: data.showBladeIcon --> <span class="fxs-blade-header-icon" data-bind="image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon(), {customClass: \'fxs-escapeShadow\'})"><\/span> <!-- /ko --> <div class="fxs-blade-title"> <h2 class="fxs-blade-title-titleText msportalfx-tooltip-overflow" tabindex="-1" data-bind="text: data.title"><\/h2> <div class="fxs-blade-title-subtitleText msportalfx-tooltip-overflow fxs-portal-subtext" data-bind="visible: data.subtitle(), text: data.subtitle"><\/div> <\/div> <div class="fxs-blade-actions"> <button type="button" class="fxs-blade-button fxs-blade-collapser fxs-portal-hover" aria-expanded="true" data-bind="visible: data.collapseVisible, attr: { title: ariaCollapse, \'aria-label\': ariaCollapse }, image: data.icons.collapse"><\/button> <button type="button" class="fxs-blade-button fxs-blade-pin fxs-portal-hover" data-bind="enable: data.pinEnabled, visible: data.pinVisible, attr: { title: data.text.pin, \'aria-label\': ariaPin, \'aria-disabled\': !data.pinEnabled() }, image: data.icons.pin"><\/button> <button type="button" class="fxs-blade-button fxs-blade-maximizeOrRestore fxs-portal-hover" data-bind="enable: data.maximizeOrRestoreEnabled, visible: data.maximizeOrRestoreEnabled, attr: { title: data.maximizeOrRestoreText, \'aria-label\': ariaMaximizeOrRestore }, image: data.icons.maximizeOrRestore"><\/button> <button type="button" class="fxs-blade-button fxs-blade-close" data-bind="attr: { title: data.text.close, \'aria-label\': ariaClose }, image: data.icons.close"><\/button> <\/div> <\/div> <button class="fxs-blade-expander fxs-portal-hover" aria-expanded="false" data-bind="visible: data.collapsed, image: data.icons.collapse, attr: { title: ariaExpand, \'aria-label\': ariaExpand }"><\/button> <\/header> <div class="fxs-blade-content-container" data-bind="css: { \'fxs-blade-disabled\': data.disabled }"> <div class="fxs-blade-content-container-default fxs-blade-border fxs-portal-border" data-bind="stopBindings: true"><\/div> <div class="fxs-blade-content-container-details fxs-blade-border fxs-portal-border fxs-blade-content-container-details-primary" data-bind="stopBindings: true"><\/div> <button class="fxs-blade-collapse-veil fxs-blade-border fxs-portal-border fxs-portal-hover fxs-portal-svg" tabindex="-1" aria-hidden="true" data-bind="attr: { title: ariaExpand }"><\/button> <\/div> <fxs-progress class="fxs-blade-progress fxs-portal-background fxs-blade-border fxs-portal-border" data-bind="visible: !data.loaded()"><\/fxs-progress> '}}));
define("MsPortalImpl/Widgets/Widgets.Blade",["require","exports","f","i","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/BladeWidthHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.BladeContent","_generated/Templates/WidgetsBlade","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Widgets/Widgets.UIElementBase","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/Resources.Images","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";function hi(n){var t=n.find(".fxs-bladecontent");t.each((function(t,i){var r=0,u=e(i),f=u.find("> div");f.each((function(n,t){if(t.offsetParent){var i=e(t);i.hasClass(ot)||(r+=i.outerHeight())}}));u.findByClassName(ot).height(et.height()-n.findByClassName(gt).height()-et.findByClassName(gi).height()-et.findByClassName(ir).height()-r)}))}function rr(n){return o.Blade.untitled.format(n)}function ct(n){n.length&&(f.cleanNode(n[0]),n.html("").removeClass(ui))}function lt(n){var t="";return n.forEach((function(n){n&&(t=t?o.Blade.titleFormat.format(t,n):n)})),t}var ci,li;u.defineProperty(t,"__esModule",{value:!0});var at=i.Base,tt=at.Diagnostics.Telemetry,g=at.Images,ft=g.Shell,ai=i.Blades,vi=ai.Internal.DisplayState,it=c.Action,yi=c.Source.Blade,pi=i.isFeatureEnabled("skipautofocus"),wi=window,et=e(wi.document.body),vt=y.Widget.viewSettingsChanged,yt=s.getBladeWidthInfo(0).width,pt=s.getBladeWidthInfo(1).width,wt=yt,bt=s.getBladeWidthInfo(51).width,bi=wt+bt,kt=o.Controls.Container.preview.toUpperCase(),rt="fxs-blade",nt="fxs-blade-initializing",dt="fxs-portal-bg-txt-br",gt="fxs-blade-header",ni="fxs-blade-close",ti="fxs-blade-pin",ii="fxs-blade-collapser",ri="fxs-blade-maximizeOrRestore",ki="fxs-blade-content-container-default",ut="fxs-menublade",di="fxs-blade-known-menu",ui="fxs-bladecontent fxs-blade-color-locked",ot="fxs-blade-content-wrapper",gi="fxs-topbar",fi="fxs-blade-content-container-details-primary",st="fxs-display-none",nr="fxs-blade-title-titleText",tr="fxs-blade-title-subtitleText",ei="fxs-blade-expander",ht="fxs-blade-collapsed",oi="fxs-blade-hide-translucent",si="fxs-blade-firstblade",ir="fxs-journey-breadcrumb";t.DisplayStateHelper=[];t.DisplayStateHelper[1]={css:""};t.DisplayStateHelper[2]={css:"fxs-blade-maximized"};t.widgetProperties={title:"title",subtitle:"subtitle",titleSuffix:"menuContent.title",subtitleSuffix:"menuContent.subtitle",description:"description",helpUri:"helpUri",helpContentUri:"helpContentUri",icon:"icon",showBladeIcon:"showBladeIcon",titleImageUri:"titleImageUri",contentState:"contentState",contentStateDisplayText:"contentStateDisplayText"};t.getDefaultTitle=rr;t.EventNames={close:"close",closed:"closed"};ci=(function(n){function t(t,i,r){var u=n.call(this,t)||this,s,h;return u.uri=d.getBlade(),u.text=o.Blade,u.close=e.noop,u.closed=e.noop,u.pinblade=e.noop,u.title=f.observable(),u.crumb=f.observable(),u.titleSuffix=f.observable(),u.subtitle=f.observable(""),u.icon=f.observable(),u.titleImageUri=f.observable(),u.displayState=f.observable(1),u.fullWidthExtensionOptOut=!1,u.pinEnabled=f.observable(!1),u.maximizeOrRestoreEnabled=f.observable(!0),u.pinVisible=f.observable(!1),u.collapseVisible=f.observable(!1),u.collapsed=f.observable(!1),u.loaded=f.observable(!1),u.shieldType=f.observable(),u.isUiBlocked=f.observable(!1),u.showBladeIcon=f.observable(!1),u.associatedWithAsset=f.observable(!1),u.showPreviewTag=f.observable(!1),u.isMenuBlade=f.observable(!1),u.useActivationStyle=!1,u.maximizeOrRestoreText=f.pureComputed((function(){var n=u.text;return u.displayState()===1?n.maximize:n.restore})),u.showTranslucentSpinner=f.observable(!1),u.icons={addLens:g.AddTile(),close:ft.Close({isLogo:!0}),hyperlink:g.Hyperlink(),maximizeOrRestore:f.pureComputed((function(){return u.displayState()===1?ft.Maximize({isLogo:!0}):ft.Restore({isLogo:!0})})),pin:g.Pin({isLogo:!0,palette:99}),collapse:g.DoubleChevron({isLogo:!0,palette:99})},u.asSubJourney=!1,u.bladeName=r||{name:t,extensionName:null},s=u.defaultContent=new l.ViewModel(t,u.bladeName),s.loaded=u.loaded,s.disabled=u.disabled,s.displayState=u.displayState,s.shieldType=u.shieldType,s.isUiBlocked=u.isUiBlocked,i&&(h=i.DisplayState,vi[h]&&u.displayState(h)),s.applyViewSettings(i),u}return __extends(t,n),t})(y.ViewModel);t.ViewModel=ci;li=(function(n){function u(t,i){var r=n.call(this,t,i)||this,s,o,u,h,e;return r._showTitleImage=f.observable(!1),r._detailContent=[],s=a(),t.addClass(nt).addClass(rt).addClass(dt).html(s),o=t.findByClassName(ki),u=r._defaultContent=new l.Widget(o,i.defaultContent,t),u.initializeStyleReactor(),p.track(r.ltm,r.element,(function(){b.requestAnimationFrame((function(){r._defaultContent.childRelayout();r._detailContent.forEach((function(n){n.widget&&n.widget.childRelayout()}))}))})),i.displayState.subscribeAndRun(r.ltm,(function(){r.refreshDisplayState()})),i.defaultContent.locked.subscribeAndRun(r.ltm,(function(n){i.locked(n)})),i.crumb.subscribe(r.ltm,(function(){r.trigger(w.default.fxbreadcrumbupdate)})),r._bindDescendants({ariaClose:f.computed(r.ltm,(function(){return i.text.closeAria.format(i.title())})),ariaMaximizeOrRestore:f.computed(r.ltm,(function(){return i.displayState()===1?i.text.maximizeAria.format(i.title()):i.text.restoreAria.format(i.title())})),ariaPin:f.computed(r.ltm,(function(){return i.text.pinAria.format(i.title())})),ariaCollapse:f.computed(r.ltm,(function(){return i.text.collapseAria.format(i.title())})),ariaExpand:f.computed(r.ltm,(function(){return i.text.expandAria.format(i.title())}))}),r.ltm.registerForDispose(u),r._accessibility(),r._attachEventHandlers(),r._setupDefaultReactors(i),o.trigger(vt,u.saveViewSettings()),k.isSafari&&(h=t.findByClassName(ot),p.track(r.ltm,h,(function(){hi(t)}))),r.options.displayState.subscribeAndRun(r.ltm,(function(){r.trigger(w.default.fxbladerepos,null,{noExitPeekMode:!0})})),r._setupLoadingReactor=function(){var n=r.getContentWidget();e&&e.dispose();e=r.ltm.createChildLifetime();f.computed(e,[r.options.loaded,n.showLoadingIndicator,n.options.shieldType,],(function(n,t,i){r.element.toggleClass(oi,(!n||t)&&i!==1)}))},r._setupLoadingReactor(),r}return __extends(u,n),u.prototype.dispose=function(){var i=this._defaultContent;this._cleanElement(rt,dt,ut,nt,s.allWidthClasses,l.combineAllCssClasses(t.DisplayStateHelper),i.bladeStyleClass,st,ht,si,"fxs-blade-lastblade",oi);this.trigger(w.default.fxloadingontopbar,null,{id:this.options.id,cancel:!0});n.prototype.dispose.call(this)},u.prototype.refreshDisplayState=function(){this.element.trigger(vt,this._defaultContent.saveViewSettings());k.isSafari&&hi(this.element)},u.prototype.initializeLayout=function(n){var i=this.element,t,r;i.removeClass(nt);n&&(n.callback&&n.callback(i),t=i.findByClassName(fi),n.setPlaceholderDetailContent&&(t.html("<fxs-progress class='fxs-bladecontent-progress fxs-portal-background'><\/fxs-progress>").addClass(ui),f.applyBindingsToDescendants({},t[0]),r=this._childLifetime.createChildLifetime(),r.registerForDispose((function(){return ct(t)})),this._detailContent.push({container:t,widget:null,lifetime:r,bindingLifetime:null})),n.clearPlaceholderDetailContent&&ct(t))},u.prototype.resetInternalState=function(){this._$lastFocused=null;this._$lastFocusedChain=null},u.prototype._openBladeContent=function(n,t){return n.widget=new l.Widget(n.container,t),n.widget.initializeStyleReactor(),n.lifetime.registerForDispose(n.widget),n.lifetime.registerForDispose((function(){n.widget=null})),n.bindingLifetime=n.lifetime.createChildLifetime(),this._setupDetailReactors(n.bindingLifetime,this.options,t,this._detailContent.length>1),n.widget},u.prototype.focusSearchBox=function(){this.element.find(".fxc-search input").first().focus()},u.prototype.getContentWidget=function(){var n=i.last(this._detailContent);return n&&n.widget||this._defaultContent},u.prototype.setDetailContent=function(n){var t,i,r;return this._detailContent.length?(t=this._detailContent[0],t.lifetime.dispose()):(t={lifetime:undefined,bindingLifetime:undefined,container:this.element.findByClassName(fi),widget:undefined},this._detailContent.push(t)),i=t.lifetime=this._childLifetime.createChildLifetime(),r=this._openBladeContent(t,n),i.registerForDispose((function(){ct(t.container)})),this.trigger(w.default.fxbladerepos),this._setupLoadingReactor(),r},u.prototype.openBladeInPlace=function(n,t){var u=this,o=i.last(this._detailContent),f;o&&(o.container.addClass(st),o.bindingLifetime&&o.bindingLifetime.dispose());var s=n.createChildLifetime(),c=this.element.findByClassName("fxs-blade-content-container"),h=e(r.createElement("div",{"class":"fxs-blade-content-container-details fxs-blade-border fxs-portal-border"}));return c.append(h),f={container:h,lifetime:s,bindingLifetime:null,widget:null},this._detailContent.push(f),s.registerForDispose((function(){f.container.remove();i.remove(u._detailContent,f);var n=i.last(u._detailContent);n&&n.widget&&(n.container.removeClass(st),n.bindingLifetime=n.lifetime.createChildLifetime(),u._setupDetailReactors(n.bindingLifetime,u.options,n.widget.options));u.trigger(w.default.fxbreadcrumbupdate)})),t.title.subscribeAndRun(s,(function(){u.trigger(w.default.fxbreadcrumbupdate)})),this._openBladeContent(f,t)},u.prototype.clearDetailContent=function(n){this._setupDefaultReactors(this.options);var t=this._detailContent[0];t&&t.lifetime&&t.lifetime.dispose();this._detailContent=[];this.initializeLayout(n)},u.prototype.close=function(n){var r=y.Widget.getId(this.element),i={id:r,completed:n},u=this.trigger(t.EventNames.close,null,i);u&&this.trigger(t.EventNames.closed,null,i)},u.prototype.setFocus=function(){var t=this,n;pi||(n=void 0,this._$lastFocused&&e.contains(this.element[0],this._$lastFocused[0])&&h.isVisible(this._$lastFocused)&&(this._$lastFocused.focus(),n=!0),!n&&this._$lastFocusedChain&&(n=this._$lastFocusedChain.some((function(n){return n.length&&e.contains(t.element[0],n[0])&&h.isVisible(n)?(v.setFocusOnContainer(n[0],null),e.contains(t.element[0],document.activeElement)):!1}))),n||this.getContentWidget().setFocus())},u.prototype.discardStateOfUnusedChildren=function(){return this.getContentWidget().discardStateOfUnusedChildren()},u.prototype.idealWidth=function(n){var e=this.element.hasClass(ut),u=this._defaultContent,o=u.element.hasClass(ht),f=this.element.hasClass(si)?24:25,r,t;return n?this.options.collapsed()?f:e?o?f+yt:bi:wt:(r=this.getContentWidget(),t=s.getBladeWidthInfo(r.options.bladeWidth()).width,e?u.options.unauthorizedNoticeVm()||this.options.disabled()?s.getBladeWidthInfo(2).width:(r===u?t=r.element.siblings().hasClass("fxs-bladecontent")||this.element.hasClass(nt)?pt:0:this.options.fullWidthExtensionOptOut||i.isFeatureEnabled("reservehozscroll")||(t=pt),t+(o?f:bt)):t)},u.prototype.setContextPaneWidth=function(n){i.isNullOrUndefined(n)?this.element.addClass(s.contextPaneDefaultSizeClass):(this.getContentWidget().options.bladeWidth(n),this.element.addClass(s.getBladeWidthInfo(n).css))},u.prototype.isMenuBladeLoadingDetailBlade=function(){return this.element.hasClass(ut)&&this.getContentWidget()===this._defaultContent&&!this._defaultContent.options.unauthorizedNoticeVm()&&!this.options.disabled()&&this._defaultContent.element.siblings().hasClass("fxs-bladecontent")},u.prototype._setupDefaultReactors=function(n){var r=this,i=this._resetChildLifetime(),t;i&&(t=n.defaultContent,f.reactor(i,(function(){var i=t.title();n.title(i);n.crumb(i)})),f.reactor(i,(function(){var i=[t.subtitle()];n.showPreviewTag()&&i.push(kt);n.subtitle(lt(i))})),f.reactor(i,(function(){n.icon(t.icon());n.showBladeIcon(t.isV2Blade()?t.hasIcon():n.associatedWithAsset())})),f.reactor(i,(function(){var i=t.bladeStyle();r._showTitleImage(i===2&&!!e.trim(n.titleImageUri()))})))},u.prototype._setupDetailReactors=function(n,t,i,r){var o=this,u;n&&(u=t.defaultContent,f.reactor(n,(function(){var f=r?[u.title(),i.title()]:[u.title(),t.titleSuffix(),i.titleSuffix()],n=lt(f);t.title(n);r||t.crumb(n)})),f.reactor(n,(function(){var n=[u.subtitle(),i.subtitleSuffix()];t.showPreviewTag()&&n.push(kt);t.subtitle(lt(n))})),f.reactor(n,(function(){var n=i.hasIcon()?i:u;t.icon(n.icon());t.showBladeIcon(n.isV2Blade()?n.hasIcon():t.associatedWithAsset())})),f.reactor(n,(function(){o._showTitleImage(i.bladeStyle()===2&&!!e.trim(t.titleImageUri()))})))},u.prototype._resetChildLifetime=function(){if(this.ltm)return i.disposeDisposable(this._childLifetime),this._childLifetime=this.ltm.createChildLifetime()},u.prototype._accessibility=function(){var t=this.element.findByClassName(nr),n=i.getUniqueId();t.attr("aria-describedby",n);this.element.findByClassName(tr).attr("id",n);n=i.getUniqueId();t.attr("id",n);this.element.attr("aria-labelledby",n);this.element.findByClassName(gt).attr("aria-labelledby",n)},u.prototype._getNextVisibleBladeInJourney=function(n){var t=this.element,i=this._journey||(this._journey=t.closest(".fxs-journey"));return i.length?n?t.prev("."+rt+h.getUnhideSelector()).toArray():t.next("."+rt+h.getUnhideSelector()).toArray():[]},u.prototype._attachEventHandlers=function(){var n=this,t=this.element,i=function(){var t=n.options.bladeName;return["Extension",t.extensionName,yi,t.name].join("/")},r,u;t.findByClassName(ni).on(w.default.click,(function(t){tt.trace({source:i(),action:it.CommandExecuted,name:ni});t.preventDefault();n.close(!1)}));t.findByClassName(ti).on(w.default.click,(function(){return tt.trace({source:i(),action:it.CommandExecuted,name:ti}),n.options.pinblade(null),!1}));t.findByClassName(ri).on(w.default.click,(function(){tt.trace({source:i(),action:it.CommandExecuted,name:ri});n.options.maximizeOrRestore&&n.options.maximizeOrRestoreEnabled()&&n.trigger("maximizeOrRestore")}));r=[];u=b.throttle(this.ltm,(function(t){var u,f,i,o;if(r.length?(f=n._getNextVisibleBladeInJourney(),r[0]!==f[0]&&(u=!0)):u=!0,u)for(i=n._$lastFocused=e(t.target),o=n._$lastFocusedChain=[];i.length;)if(i=i.parent().closest(".azc-control, .fxs-tile, .fxs-commandBar, .fxs-commandBar-item-expandList, .fxs-commandBar-item",n.element[0]),i.length)o.push(i);else break}));this.ltm.registerForDispose(t.setEvents([w.default.focusin,function(){r=n._getNextVisibleBladeInJourney()}],[w.default.focusout,u],[w.default.click,"."+ii+", ."+ei+", .fxs-blade-collapse-veil",function(t){var r=n.options.collapsed();n.options.collapsed(!r);n.trigger(w.default.fxbladerepos,null,{noExitPeekMode:!0,noScroll:!0});n.element.findByClassName(r?ii:ei).focus();t.stopPropagation();tt.trace({source:i(),action:it.BladeCollapse,actionModifier:r?"Expand":"Collapse",name:"fxs-blade-expandcollapse"})}]));this.options.collapsed.subscribeAndRun(this.ltm,(function(t){n.element.toggleClass(ht,t)}))},u.prototype.goToFirstDetailContent=function(){var n=this._detailContent[0];n&&n.widget&&this.goToDetailContent(n.widget.options.id)},u.prototype.goToDetailContent=function(n){for(var u,i=this._detailContent.length,r=i,t=0;t<i;++t)if(u=this._detailContent[t],u.widget&&u.widget.options.id===n){r=t;break}for(t=i-1;t>r;--t)this._detailContent[t].lifetime.dispose();return r!==i},u.prototype.getBreadCrumbs=function(){return[{bladeId:this.options.id,bladeTitle:this.options.crumb()}].concat(this._detailContent.filter((function(n,t){return t&&n.widget})).map((function(n){return{bladeId:n.widget.options.id,bladeTitle:n.widget.options.title()}})))},u.prototype.setupAsKnownMenuBlade=function(){if(this.element.hasClass(nt)){this.element.addClass(di+" "+ut);var n=this.element.findByClassName("fxs-blade-content-container-details").empty();n.append(r.createElement("fxs-progress"));f.applyBindingsToDescendants({},n[0])}},u})(y.Widget);t.Widget=li}))