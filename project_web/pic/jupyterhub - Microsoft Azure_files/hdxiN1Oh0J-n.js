define("MsPortalImpl/Base/Base.ImplUtils",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function et(n,t){t=t||{};var i=t.requireHttps||!1,r=i?rt:it;return r.test(n)}function ot(n){var t="data-extensionname",i="["+t+"]["+t+"!='']";return $(n).closest(i).attr(t)||"fx"}function st(n){var t;return typeof n=="string"?t=n:n&&(t=ot(n)),t||"fx"}function a(n,t,r,u,f){f&&(u+=" "+JSON.stringify(f));try{g.client.log(st(t),{level:r,code:0,area:n.normalize(),message:i.getLogFriendlyMessage(u)})}catch(e){tt.error(i.getLogFriendlyMessage(e))}}function ht(n,t,r,u){u=u?i.extend2(n.contextData,u):n.contextData;a(n.localRequire,n.windowContext,t,r,u)}function o(n){n===void 0&&(n="");var t={},i=n.indexOf("?"),r=i>-1?n.substr(i+1):n,u=r.split("&");return u.forEach((function(n){if(n&&!n.match(/^\=+$/)){var i=n.split("="),r=i.shift(),u=i.length>0?i.join("="):"";t[r]=u}})),t}function s(n){var i="",t="";return ut(n,(function(n,r){i+="{0}{1}={2}".format(t,n,r);t||(t="&")})),i}function f(n){var t=n.toString().match(/^([^\:\/]+)\:\/\//);return t?t[1]+":":""}function e(n){var t;if(n=n.toString(),t=f(n),!t)return"";var i=n.substr(t.length+2),u=i.indexOf("/"),r=u>0?i.substr(0,u):i;return!r||r.indexOf("@")>0?"":r.replace(/\:.*/,"")}function y(n){var t=p(n),r=e(t),u=h(t),i=f(t),o=(i?i.length+2:0)+r.length+(u?u.length+1:0);return!r||!i?"":t.substr(o)}function h(n){var i=f(n),r=e(n),u,t;return!i||!r?"":(u=i.length+2+r.length,t=n.toString().substring(u).match(/^\:([0-9]+)/),!t)?"":t[1]}function p(n){var t=n.toString().replace(/\#.*/g,"").replace(/\?.*/,"");return!e(t)||!f(t)?"":t}function w(n){return(n=n.toString().replace(/\#.*/g,""),!n.match(/\?/))?"":n.replace(/.*\?/,"?")}function b(n){return(n=n.toString(),!n.match(/\#/))?"":n.replace(/[^\#]*\#/,"#").replace(/\?.*/,"")}function k(n){var t=n.indexOf("#"),i=t===-1?-1:n.substr(t).indexOf("?");return t===-1?"":i===-1?"":n.substr(t+i)}var v;u.defineProperty(t,"__esModule",{value:!0});var d=i.Base,g=r.Rpc,nt=d.Diagnostics,tt=nt.createLog(n),c="^([Hh][Tt][Tt][Pp][Ss]",l="://(?::)?@?(([dw.-]+)(?::(d+))?)?)([/\\w.()-]*)?(?:([?][^#]*)?(#.*)?).*$",it=new RegExp(c+"?"+l),rt=new RegExp(c+l),ut=i.forEachKey,ft=i.isEmpty;t.validateAbsoluteHttpUri=et;t.logToExtension=a;t.log=ht;v=(function(){function n(n){this._hashQs={};this._qs={};n=n&&n.toString()||"";this._protocol=f(n);this._host=e(n);this._port=h(n);this._pathname=y(n);this._hash=b(n);this._qsPart=w(n);this._qs=o(this._qsPart);this._hashQsPart=k(n);this._hashQs=o(this._hashQsPart)}return n.prototype.getQueryStringValue=function(n){return this._qs[n]||""},n.prototype.setHashQueryStringValue=function(n,t){return this._hashQs[n]=t,this},n.prototype.deleteHashQueryStringValue=function(n){return delete this._hashQs[n],this},n.prototype.clearHashQueryStringIfEmpty=function(){return ft(this._hashQs)&&(this._hashQsPart=""),this},n.prototype.getHashQueryStringValue=function(n){return this._hashQs[n]||""},n.prototype.setHash=function(n){return this._hash=n,this},n.prototype.isHashEmpty=function(){return this.hash===""||this.hash==="#"},n.prototype.toString=function(){return this.href},u.defineProperty(n.prototype,"href",{get:function(){return this.path+this.queryString+this.hash+this.hashQueryString},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"path",{get:function(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"pathname",{get:function(){return this._pathname},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"protocol",{get:function(){return this._protocol},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"queryString",{get:function(){var n=s(this._qs);return n||this._qsPart?"?"+n:""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hash",{get:function(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^\#/,""):""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hashQueryString",{get:function(){var n=s(this._hashQs);return this._hashQsPart||n?"?"+n:""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hashWithHashQueryString",{get:function(){return this.hash+this.hashQueryString},enumerable:!0,configurable:!0}),n.prototype.getHashParts=function(){if(!this._cachedHashParts||this._partsBasedHash!==this.hash){this._partsBasedHash=this.hash;var n=this.hash.match(/^\#([^\/]*)?(\/[^\/]*)?(\/.*)?|$/),t=n[1]||"",i=(n[2]||"").slice(1),r=n[3]||"";this._cachedHashParts=t[0]==="@"?{tenant:t.slice(1),category:i,rest:r.slice(1)}:{tenant:"",category:t,rest:i+r}}return this._cachedHashParts},n})();t.Uri=v;t.queryStringToMap=o;t.mapToQueryString=s;t.getProtocol=f;t.getHost=e;t.getPathnameSegment=y;t.getPort=h;t.getPathSegment=p;t.getQueryStringSegment=w;t.getHashSegment=b;t.getHashQueryStringSegment=k}));
define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports"],(function(){"use strict";var n;return (function(n){function s(){var n=/AppleWebKit\/([\d.]+)/.exec(t);if(n)return parseFloat(n[1])}function h(n){return window.matchMedia(n).matches}function c(){var t="-webkit- -moz- -o- -ms-".split(" "),n;return"ontouchstart"in window?!0:(n="("+t.join("touch-enabled),(")+"touch-enabled)",h(n))}var t=window.navigator.userAgent,e=/Firefox\//i.test(t),r=/Chrome[ /]/i.test(t),i=/Edge\//i.test(t),u=/MSIE /i.test(t),f=/Trident\//i.test(t),o=/Safari/i.test(t);n.safari_11_webKitVersion=604;n.isFirefox=e;n.isChrome=r&&!i;n.isEdge=i;n.isIe=u||f||i;n.isIe11=!u&&f&&!i;n.isSafari=o&&!r&&!i;n.webKitVersion=s()||0;n.isTouch=c()})(n||(n={})),n}));
define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],(function(){"use strict";var n;return (function(n){function f(n){return n=n.replace("::after",":after").replace("::before",":before"),r=function(n,t){return t},l(n||"",!1)}function e(n){var t=n.map((function(n){return n.value}));return t.join("")}var a;n.parseCssSelector=f;n.subselectorToString=e;var i=jQuery.find,u=i.selectors,o=i.selectors.match,r;
/*!
         * -----------------------------------------------------------------------------
         * The portion of this file from here until "End of jQuery code snippet" is code
         * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
         * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
         * Released under the MIT license - http://jquery.org/license
         * Date: 2013-07-03T13:30Z
         */
var t="[\\x20\\t\\r\\n\\f]",s=new RegExp("^"+t+"+|((?:^|[^\\\\])(?:\\\\.)*)"+t+"+$","g"),h=new RegExp("^"+t+"*,"+t+"*"),c=new RegExp("^"+t+"*([>+~]|"+t+")"+t+"*"),l=function(n,t){var l,e,v,f,y,p,w=r[n+" "],a;if(w)return t?0:w.slice(0);for(f=n,y=[],p=u.preFilter;f;){(!l||(e=h.exec(f)))&&(e&&(f=f.slice(e[0].length)||f),y.push(v=[]));l=!1;(e=c.exec(f))&&(l=e.shift(),v.push({value:l,type:e[0].replace(s," ")}),f=f.slice(l.length));for(a in u.filter)(e=o[a].exec(f))&&(!p[a]||(e=p[a](e)))&&(l=e.shift(),v.push({value:l,type:a,matches:e}),f=f.slice(l.length));if(!l)break}return t?f.length:f?i.error(n):r(n,y).slice(0)};
/*!
         * End of jQuery code snippet
         * -----------------------------------------------------------------------------
         */
a=undefined})(n||(n={})),n}));
define("MsPortalImpl/Base/Base.Sanitization",["require","exports","f","o","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u){"use strict";function v(n){var t=f[n.reason]||"Unknown";u.log(n.provenanceContext,2,"Sanitization error found: "+t,{Tag:n.tag,Attribute:n.attr,Binding:n.binding,Value:n.val})}function e(n){return n===""||u.validateAbsoluteHttpUri(n)||c.test(n)}function y(n){return e(n)||o.test(n)}function p(n){return n===""||o.test(n)}function w(n){return n===""||l.test(n)}function b(n){var t=e(n);return t||a.error("Disallowed URI: "+n),t}function k(){return s}var s;r.defineProperty(t,"__esModule",{value:!0});var h=i.Base.Diagnostics,c=/^(vstfs:|ftp:|ftps:|sftp:|storageexplorer:|)\/\/|mailto:/,o=/^#/,l=/^(data:image)\//,a=h.createLog(n),f=[];f[1]="Invalid attribute";f[2]="Invalid CSS class name";f[3]="Invalid CSS property";f[4]="Invalid tag";f[5]="Unknown or prohibited binding";f[6]="Invalid binding value";t.logError=v;t.validateUriOrBlank=e;t.validateLinkUri=y;t.validateLocalUriOnly=p;t.validateDataImage=w;t.sanitizeUri=b;s=["alt","border","colspan","rowspan","span","disabled","height","width","lang","spellcheck","title","cx","cy","d","rx","ry","x","y","x1","x2","y1","y2","fill","fill-rule","opacity","points","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-width","transform","vector-effect","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","role",];t.getWhitelistedAttr=k}));
define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","f","o","a","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s){"use strict";function y(n){return n==="cssFloat"?"float":(n||"").replace(/([A-Z])/g,"-$1").toLowerCase()}function nt(n){var t=n.toLowerCase().match(g).reduce((function(n,t,i){return i>0?(t=t.charAt(0).toUpperCase()+t.slice(1),n+t):n+t}));return t==="float"&&(t="cssFloat"),t}function p(n){return"css-scope-"+n.replace(d,"")}function tt(t){var r="."+p(t.name),i=[];return t.styleSheets=(t.styleSheets||[]).map((function(n){return w(n,r,i)})),i.forEach((function(i){var r="Sanitization error found in style sheet in extension: {0}\nInvalid CSS property - {1}\nCSS rule: {2}".format(t.name,i.errorMessage,i.rule.cssText);s.logToExtension(n,t.name,2,r)})),!i.length}function it(n,t,i){t.insertRule(".ignored1 { {0} }".format(n),0);t.insertRule(".ignored2 {}",1);var r=t.cssRules[0],u=t.cssRules[1];return r.type===CSSRule.STYLE_RULE?(k(r.style,u,i),u.style.cssText):(i.push("Not a style rule: "+n),null)}function w(n,r,u){var f=document.implementation.createHTMLDocument(""),o=f.createElement("style");f.body.appendChild(o);var s=ot(n,f),h=s.filter((function(n){return n.type===CSSRule.STYLE_RULE})),c=h.map((function(n){var t=rt(n,o.sheet,r,u);return t?t.cssText:null})),e=c.join("\n");return[t.extLightClass,t.extDarkClass,t.extHcActiveClass,t.extHcLightClass,t.extHcDarkClass].forEach((function(n){var t=["{0} {1}","{1} {0}"].map((function(t){return t.format(r,"."+n)}));e=i.replaceAll(e,t[0],t[1])})),e}function b(n,t,i){i.push.apply(i,n.map((function(n){return{rule:t,errorMessage:n}})))}function rt(n,t,i,r){var e=[],o=ut(n.selectorText,i,e),u,f;return b(e,n,r),o?(t.insertRule(o+" {}",0),u=t.cssRules[0],f=[],k(n.style,u,f),b(f,n,r),u):null}function k(n,i,r){for(var o,c,l=ht(n),h=0,v=l.length;h<v;h++){var f=l[h],e=n.getPropertyValue(f),y=n.getPropertyPriority(f);if(e!=="initial"){var p=et(y,r),a=null,s=null;t.stylePolicy.hasOwnProperty(f)?(a=f,o=t.stylePolicy[f],o===1?s=e:o instanceof u?(c=o.indexOf(e),c>=0&&(s=o[c])):typeof o=="function"&&o(e)&&(s=e),s?i.style.setProperty(f,e,p):r.push("Disallowed style value. Property name: {0}, value: {1}".format(a,e))):r.push("Disallowed style property. Property name: "+f)}}}function ut(n,t,i){var r,u=[];try{r=e.parseCssSelector(n)}catch(f){return i.push("Malformed selector: "+n+"\nException: "+f.toString()),null}return r.forEach((function(n){ft(n,i)&&u.push(t+" "+e.subselectorToString(n))})),u.join(", ")}function ft(n,t){return!n.some((function(n){if(n.type==="CLASS"){if(n.value&&!i.startsWith(n.value,".ext-")&&!i.startsWith(n.value,".fxt-"))return t.push("Selectors can only refer to extension-specific class names (those starting with .ext- or .fxt-)"),!0}else if(n.type==="ID")return t.push("Selectors cannot refer to elements by ID"),!0}))}function et(n,t){return n?(t.push("Disallowed CSS priority value: "+n),""):n}function ot(n,t){var i=t.createElement("style");t.body.appendChild(i);i.type="text/css";i.textContent=n;var r=i.sheet,f=r&&r.cssRules;return f?u.prototype.slice.call(f,0):[]}function st(n){return n==="none"||n==="uppercase"||n==="lowercase"}function c(n,t){t.forEach((function(t){n[t]=1}))}function ht(n){for(var i,u=[],r=0,f=n.length;r<f;r++)if(i=n[r],!l[i]){if(h[i]&&!(i in t.stylePolicy))return ct(n);u.push(i)}return u}function ct(n){for(var i,r=[],t=v.length-1;t>=0;t--)i=v[t],n[i]&&r.push(y(i));return r}var a,h,l;r.defineProperty(t,"__esModule",{value:!0});t.extLightClass="ext-mode-light";t.extDarkClass="ext-mode-dark";t.extHcActiveClass="ext-mode-highcontrast";t.extHcLightClass="ext-highcontrast-light";t.extHcDarkClass="ext-highcontrast-dark";a=["align-content","align-items","align-self","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","clear","clip-path","color","content","counter-increment","counter-reset","cursor","display","fill","fill-rule","fill-opacity","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-size","font-stretch","font-style","font-variant","font-weight","height","justify-content","left","line-height","list-style-position","list-style-type","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","table-layout","text-align","text-decoration","text-transform","text-overflow","top","transform","transform-origin","transition","transition-delay","transition-duration","transition-property","transition-timing-function","vertical-align","visibility","white-space","width","word-break","word-wrap",];t.stylePolicy={};a.forEach((function(n){t.stylePolicy[n]=1}));t.stylePolicy.position=["relative","absolute","static","inherit"];t.stylePolicy["text-transform"]=st;var d=/\W/g,g=/[a-z|A-Z]+/g,v=r.keys(t.stylePolicy).map(nt);t.domStylePropertyToCssProperty=y;t.getScopeName=p;t.sanitizeDefinition=tt;t.sanitizeStyleDeclarationString=it;t.sanitizeStyleSheetText=w;h={};c(h,["background-position-x","background-position-y",]);o.isChrome||o.isSafari?c(h,["background-repeat-x","background-repeat-y","font-variant-alternate","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","overflow-wrap","text-decoration-color","text-decoration-line","text-decoration-style","-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing",]):o.isFirefox?c(h,["-moz-border-top-colors","-moz-border-right-colors","-moz-border-bottom-colors","-moz-border-left-colors","font-variant-caps","font-variant-ligatures","font-variant-numeric","font-variant-position","overflow-wrap","text-decoration-color","text-decoration-line","text-decoration-style",]):o.isEdge&&c(h,["overflow-wrap",]);l={};o.isIe&&c(l,["enable-background","list-style-image",])}));
define("MsPortalImpl/Base/Base.EventTypes",["require","exports","f","o"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u=undefined,f={doubleclick:"dblclick",mousewheel:"wheel",fxrightclick:"rightclick",animationstart:u,blur:u,change:u,click:u,contextmenu:u,dragover:u,dragstart:u,dragend:u,dragenter:u,dragleave:u,drop:u,focus:u,hashchange:u,input:u,keydown:u,keypress:u,keyup:u,mousedown:u,mouseenter:u,mouseleave:u,mousemove:u,mouseout:u,mouseover:u,mouseup:u,popstate:u,resize:u,scroll:u,selectstart:u,transitionend:u,focusin:u,focusout:u,remove:u,fxactionbarclick:u,fxactionbarvalidationtargetupdated:u,fxactionbarvalidationtargetmutated:u,fxavatartextchange:u,fxautosettings:u,fxbladerepos:u,fxbladestatusbarclicked:u,fxbreadcrumbclick:u,fxbreadcrumbupdate:u,fxcontextmenu:u,fxcontextmenurequest:u,fxcontextpaneclosing:u,fxcopybuttonclick:u,fxcreatepart:u,fxensurebladevisible:u,fxenterorganizemode:u,fxerrorpartclicked:u,fxexitorganizemode:u,fxloadingontopbar:u,fxopeninnewtab:u,fxpaneresize:u,fxpartcreated:u,fxpartgallerypivotinitialized:u,fxpeekmode:u,fxportalcontrolloadfailed:u,fxreadyforfocus:u,fxrearrange:u,fxregistermenu:u,fxrotatetheme:u,fxselectableactivated:u,fxsettingsbuttonclick:u,fxshowhomepage:u,fxshowjourney:u,fxshowstartboard:u,fxsizechange:u,fxsizechanged:u,fxsummarycollapsed:u,fxtoastclick:u,fxtoggleallservices:u,fxtoggleconsole:u,fxunpin:u,touchcancel:u,touchend:u,touchmove:u,touchstart:u,pointerdown:u};i.forEachKey(f,(function(n,t){f[n]=t||n}));t.default=f}));
define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","ko","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function d(n){return k[n]||n}function a(n,r,u,f,e){var s=[],c=i.expressionRewriting.parseObjectLiteral(r),o=!0;return c.forEach((function(i){var c=(i.key||"").trim(),l=d(c),r=b[l],a,y;r||l.substring(0,h.length)!==h||(r=t);r?(a=(i.value||"").trim(),y=r(a,f),y!==null?s.push(v(l)+": "+y):(o=!1,e.push({provenanceContext:n,reason:6,tag:u,binding:c,val:a}))):(o=!1,e.push({provenanceContext:n,reason:5,tag:u,binding:c}))})),o?s.join(", "):null}function nt(n,t,i,r){var f=/^\s*ko\s([\s\S]*)/.exec(t),u;return f?(u=a(n,f[1],"comment",i,r),u===null?" ko ":" ko "+u+" "):/^\s *\/ko/.test(t)?" /ko ":null}function v(n){return n&&!l.exec(n)&&(g.exec(n)||(n="'"+n.replace("'","\\'")+"'")),n}function t(n){var r=e(n),t,i;if(r!==null)return r;for(t=0;t<c.length;t++)if(i=n.split(c[t]),i.length===2&&e(i[0].trim())&&e(i[1].trim()))return n;return null}function tt(n,i,u){var h=r.domStylePropertyToCssProperty(n),f=u.style[h],e=l.exec(i),s=e?i.slice(1,-1):null,o=!1;return f===1?o=!!e||t(i)===i:f instanceof Array?o=!!e&&f.includes(s):typeof f=="function"&&(o=!!e&&f(s)),o}function e(n){return/^\!?([\$_a-z0-9\.'\-"\[\]]|\(\))+$/i.test(n)||/^\{\s*\}$/.test(n)?n:null}function o(n){return y(n,(function(n,i){return!!t(i)}))}function y(n,t){return function(r,u){var o=i.expressionRewriting.parseObjectLiteral(r),f=[],e=!0;return o.forEach((function(i){var r=(i.key||"").trim(),o=(i.value||"").trim();n(r,u)&&t(r,o,u)?f.push(v(r)+": "+o):e=!1})),e?"{ "+f.join(", ")+" }":null}}function p(n){return o((function(t){return n.includes(t)}))}function w(n){return/^"[^"]*"$/.test(n)||/^'[^']*'$/.test(n)?n:null}function it(n){return function(t){var i=!!n.first((function(n){return t==='"'+n+'"'||t==="'"+n+"'"}));return i?t:null}}function s(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,i){for(var u,r=0;r<t.length;r++)if(u=t[r](n,i),u!==null)return u;return null}}var u=s(t,o((function(){return!0}))),b={checked:t,click:t,clickBubble:t,commands:s(t,o((function(){return!0}))),disable:t,enable:t,event:p([f.default.click,"keypress","afterkeypress"]),foreach:s(t,p(["data","as"])),formElement:u,fxclick:t,fxParameterCollector:t,htmlTemplate:u,"if":t,ifnot:t,image:t,options:t,optionsText:w,optionsValue:w,sanitizedAttr:u,sanitizedCss:u,sanitizedHtml:t,selectedOptions:t,style:y((function(n,t){return t.style.hasOwnProperty(r.domStylePropertyToCssProperty(n))}),tt),submit:t,text:t,uniqueName:t,visible:t,value:t,valueUpdate:it(["afterkeyup"]),vtext:t,"with":t},k={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"},h="pc",c=["===","==","!==","!=","<=","<",">=",">","&&","||","-","+","*","/"],l=/^("([^"\\]|\\.)*"|'([^'\\]|\\.)*')$/,g=/^[a-z_$][a-z0-9_$]*$/i;n.sanitizeBindingAttribute=a;n.sanitizeBindingComment=nt})(e||(e={})),e}));
define("MsPortalImpl/Base/Base.LruMap",["require","exports","f","o","a"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u=(function(){function n(n){this._map=r.create(null);this._count=0;this._lastAccessed=0;this._capacity=n}return n.prototype.count=function(){return this._count},n.prototype.contains=function(n){return!!this._map[n]},n.prototype.trim=function(n){var u=this,t,r;(typeof n!="number"&&(n=this._capacity),t=this.count()-n,typeof n!="number"||t<1)||(r=this._lastAccessed-n+1,i.forEachKey(this._map,(function(n,t,i){t.lastAccessed<r&&i.push(t)}),[]).sort((function(n,t){return t.lastAccessed-n.lastAccessed})).some((function(n){return delete u._map[n.key],t--,t<1})),this._count=n)},n.prototype.getOrAdd=function(n,t){var r=this._map[n],i;if(r)r.lastAccessed=++this._lastAccessed,i=r.data;else if(t)i=t(n),this.addOrUpdate(n,i);else throw new Error("Unable to find item with key: '"+n+"'.");return i},n.prototype.addOrUpdate=function(n,t,i){var r=this._map[n];return r?(r.data=t,r.lastAccessed=++this._lastAccessed):(this._map[n]={key:n,data:t,lastAccessed:++this._lastAccessed},this._count++,i||this.trim()),!r},n.prototype.remove=function(n){this._map[n]&&(this._count--,delete this._map[n])},n})();t.LruMap=u}));
define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","f","i","o","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.LruMap"],(function(n,t,i,r,u,f,e,o,s){"use strict";function p(n,t,i,r){var u=i&&i.htmlTemplateInline;u&&a(n,t,u,r,(function(){u.content=null}))}function tt(n,t,i){(t.lenses||[]).forEach((function(r){(r.partInstances||[]).forEach((function(r){p(n,t.name+"/"+r.name,r.inline,i)}))}))}function it(n,t){var r=n.name;i.forEachKey(n.htmlTemplates,(function(i,u){a(r,i,u,t,(function(){delete n.htmlTemplates[i]}))}));(n.partsCatalog||[]).forEach((function(n){var i=n.htmlTemplateInline;i&&a(r,""+n.name,i,t,(function(){i.content=null}))}))}function a(i,r,u,f,e){var o=t.sanitizeHTML({value:u.content,localRequire:n,windowContext:i,contextData:{File:u.file,TemplateKey:r}}),s=!o.errors.length,h=s||f===0;h?u.content=o.sanitizedMarkup:e()}function rt(n,t){function ft(i,r,u,f,e,o){if(!t&&i===h.validateKOBindingString)return null;if(i===1)return r;if(typeof i=="object")return r in i?r:null;if(i instanceof Function){var s=i(r,u,f,e,c,o,n);return typeof s=="boolean"?s===!0?r:null:typeof s=="string"?s:null}return null}function tt(t,i,r){var f,s;if(typeof r=="object")for(f in r)if(s=r[f],t.hasAttribute(f)&&!i.hasAttribute(f)){var h=t.getAttribute(f),e=[],o=ft(s,h,t.nodeName.toUpperCase(),f,i,e);o!==null&&i.setAttribute(f,o);e.length>0?e.forEach((function(n){u.push(n)})):o===null&&u.push({provenanceContext:n,reason:1,tag:t.nodeName.toUpperCase(),attr:f,val:h})}}function it(h,l){var v=h.nodeName.toUpperCase(),a,b,d,et,y,p,ct,w,ft;if(h.nodeType===Node.ELEMENT_NODE&&(g||(g=h!==s.body)))if(k[v]){if(a=r.createElement(v),tt(h,a,k[v]),tt(h,a,ut),b=h.getAttribute("style"),b&&(d=[],et=e.sanitizeStyleDeclarationString(b,nt,d),d.forEach((function(t){u.push({provenanceContext:n,reason:3,tag:v,attr:"style",val:t})})),a.setAttribute("style",et)),v==="A"){var ot=h.getAttribute("href"),st=h.getAttribute("target"),lt=!i.isNullOrWhiteSpace(ot)&&o.validateUriOrBlank(ot);lt&&((i.isNullOrWhiteSpace(st)||st==="_self")&&a.setAttribute("target","_blank"),a.setAttribute("rel","noopener"))}l.appendChild(a);l=a}else u.push({provenanceContext:n,reason:4,tag:v});for(var rt=0,ht=h.childNodes,at=ht.length;rt<at;rt++){y=ht[rt];switch(y.nodeType){case Node.TEXT_NODE:l.appendChild(document.createTextNode(y.textContent));break;case Node.ELEMENT_NODE:it(y,l);break;case Node.COMMENT_NODE:p=c.comments;ct=!t&&p===f.sanitizeBindingComment;!ct&&p&&p instanceof Function&&(w=[],ft=p(n,y.textContent,c,w),ft!==null&&l.appendChild(document.createComment(ft)),w.length>0&&w.forEach((function(n){u.push(n)})))}}return l}var s=document.implementation.createHTMLDocument(""),rt=document.createDocumentFragment(),p=r.createElement("div"),b=c.elements,k=b.tags,ut=b.global,u=[],g=!1,w=n.value,a,nt,v;return rt.appendChild(p),y.forEach((function(n){w=d(w,n,l+n)})),s.body.innerHTML=w||"",a=s.createElement("style"),a.setAttribute("type","text/css"),s.head.appendChild(a),nt=a.sheet,it(s.body,p),u.forEach(o.logError),v=p.innerHTML,y.forEach((function(n){v=d(v,l+n,n)})),{sanitizedMarkup:v,errors:u}}function w(n){var t=new s.LruMap(100);return{cache:t,func:function(i,r,u){var f="";return typeof i=="string"?f=i:i&&(f=i.value||""),t.getOrAdd(f,(function(){return i&&typeof i!="string"||(i={value:f,localRequire:r,windowContext:u}),rt(i,n)}))}}}function d(n,t,i){if(!n)return n;var r=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return n.replace(r,"$1"+i+"$2")}function g(n,t){var i={};return i[l+n]=t,i}var c,b,k;u.defineProperty(t,"__esModule",{value:!0});var nt=/^(msportalfx|ext-|lang-|fxt-)[_\-a-zA-Z0-9]+$/,v=i.getUniqueId().toLowerCase(),h={validateLinkUri:o.validateLinkUri,validateUriOrBlank:o.validateUriOrBlank,validateLocalUriOnly:o.validateLocalUriOnly,validateClassNames:function(n,i,r,u,f,e,o){for(var l=/[_\-a-z0-9]+/ig,h,c=[],s;h=l.exec(n);)s=h[0],t.isAllowedCssClassName(s)?c.push(s):e.push({provenanceContext:o,reason:2,tag:i,val:s});return c.join(" ")||null},validateKOBindingString:function(n,t,i,r,u,e,o){return f.sanitizeBindingAttribute(o,n,t,u,e)},mapName:function(n,t,i,r){return r.setAttribute(i,"TemplateSanitizer"+v+"_"+n),!1}},y=["src",],l="data-sanitizer-"+v+"-";t.sanitizeInlineTemplate=p;t.sanitizeBladeDefinition=tt;t.sanitizeDefinition=it;t.isAllowedCssClassName=function(n){return typeof n=="string"&&nt.test(n)};c=(function(){function i(t){return t.length?n(t):1}function n(n){var t={};return n.forEach((function(n){var u,r;if(typeof n=="string")t[n]=1;else for(u in n)r=n[u],t[u]=r instanceof Function?r:i(r)})),t}var r=["ABBR","ADDRESS","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","H1","H2","H3","H4","H5","H6","HR","I","INS","LABEL","LEGEND","OL","P","PRE","Q","S","SMALL","SPAN","STRONG","SUB","SUP","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL",{A:[{href:h.validateLinkUri},"target",]},{BUTTON:["value"]},{IMG:[g("src",h.validateUriOrBlank)]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},"checked","maxlength","value"]},{LI:["value"]},{OPTION:["label","selected","value"]},{SELECT:["multiple","size"]},{TEXTAREA:["rows","cols"]},{TIME:["datetime"]},{SVG:["viewBox","focusable",{"xmlns:xlink":h.validateUriOrBlank},{"xmlns:svg":h.validateUriOrBlank},{xmlns:h.validateUriOrBlank}]},{CIRCLE:["r"]},"DEFS","DESC",{ELLIPSE:["id"]},{G:["id"]},{LINE:["id"]},"METADATA",{PATH:["id"]},{POLYGON:["id"]},{POLYLINE:["id"]},{RECT:["id"]},{STOP:["offset"]},{TEXT:["id","font-size"]},"TITLE",{USE:["id",{"xlink:href":h.validateLocalUriOnly}]},{VIDEO:["controls","poster"]},{SOURCE:[g("src",h.validateUriOrBlank),"type"]},],u=(t=[{"data-bind":h.validateKOBindingString},{"class":h.validateClassNames},{name:h.mapName},"data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info",]).concat.apply(t,o.getWhitelistedAttr()),t;return{style:e.stylePolicy,elements:{tags:n(r),global:n(u)},comments:f.sanitizeBindingComment}})();b=w(!0);k=w(!1);t.sanitizeHTML=b.func;t.sanitizeHtmlWithoutKOBindings=k.func}));
define("MsPortalImpl.Controls/Controls/Base/WidgetBinding",["require","exports","f","o","ko"],(function(n,t,i,r,u){"use strict";function c(n,t){var i;return f(n)||(i=u.unwrap(n)),f(i)?t:i}function l(n,t){var r=s([n.$disabled,t.$disabled]),i=y([n.$tabIndex,t.$tabIndex],[t.$disabled]),f=u.pureComputed((function(){return i()===null?null:-1}));return{$disabled:r,$tabIndex:i,$focusIndex:f}}function e(n){return u.contextFor($(n)[0])}function o(n){return new u.bindingContext(n)}function p(n,t){return o(n).extend({$disabled:t.$disabled,$tabIndex:t.$tabIndex,$focusIndex:t.$focusIndex})}function a(n,t,i,r){var u=r||e(n);return u=u?u.createChildContext(t):o(t),i&&(u=u.extend(i)),u}function v(n,t){var i=l(n,t);return n.extend(i)}function w(n){var t=e(n);return t||(t=o(null)),f(t.$disabled)&&(t=t.extend({$disabled:u.pureComputed(i.wrap(!1))})),f(t.$tabIndex)&&(t=t.extend({$tabIndex:u.pureComputed(i.wrap(0))})),f(t.$focusIndex)&&(t=t.extend({$focusIndex:u.pureComputed(i.wrap(-1))})),t}function s(n){return u.pureComputed((function(){for(var r,t=!1,i=0;i<n.length;i++)r=c(n[i],!1),t=t||r;return t}))}function y(n,t){var i=s(t);return u.pureComputed((function(){for(var r,f=i(),t=0,u=0;u<n.length;u++)r=c(n[u],0),t===null||r===null?t=null:f||t<0||r<0?r<0?t=r:t<0||(t=-1):t=r;return t}))}var f,h;r.defineProperty(t,"__esModule",{value:!0});f=i.isUndefined;t.getContext=e;t.createIsolatedContext=p;t.createChildContext=a;t.createChainedContext=v;t.contextFor=w;t.chainDisabledProperties=s;t.chainTabindexProperties=y;u.bindingHandlers.context={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t,i,r,f){var e=u.unwrap(t()),o=u.ignoreDependencies((function(){var t=l(f,e);return a(n,r,t,f)}));u.applyBindingsToDescendants(o,n)}};u.virtualElements.allowedBindings.context=!0;h=u.bindingHandlers.template;u.bindingHandlers.template={init:function(n,t,i,r,u){return h.init(n,t,i,r,u)},update:function(n,t,i,r,f){var l=t(),e=u.unwrap(l),o,s,c;return e=typeof e=="string"?{name:l}:u.utils.extend({},e),o=e.context,o&&(f=u.ignoreDependencies((function(){return typeof o=="function"&&(o=o(e.data||r)),v(f,o)})),delete e.context),s=f.$ctl,c=s&&s.templateEngine,c&&e.name&&!e.templateEngine&&(e.templateEngine=c),t=function(){return e},h.update(n,t,i,r,f)}}}));
define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","exports","f","ko","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(n,t,i,r,u){"use strict";var f;return (function(){function f(t){return function(i,u,f,e,s){var c=r.unwrap(u()),l,y,a,v,h;if(c&&(l=c.text,y=c.visible,a=c.disabled,v=c.handler),!c||!l||!y||!a||!v||!c.execute)throw new Error("Command");h=n.text[t];h&&h(i,(function(){return l}),f,e,s);h=n.value[t];h&&h(i,(function(){return l}),f,e,s);h=n.visible[t];h&&h(i,(function(){return y}),f,e,s);h=n.disable[t];h&&h(i,(function(){var u=a()||r.unwrap(s.$disabled||!1),n=v(),f=n?n.canExecute():!1,t=u||!f;return i&&o(i).toggleClass("azc-command-disabled",t),t}),f,e,s);h=n.click[t];h&&h(i,(function(){return function(){var n=v();n&&!a()&&n.canExecute()&&c.execute()}}),f,e,s)}}function e(n){var t=u.createIsolatedContext(n.$data,n);return t.createChildContext=function(t){return u.createIsolatedContext(t,n)},t}var o=jQuery,n=r.bindingHandlers,t;n.azcCommand={init:f("init"),update:f("update")};n.stopBindings={init:function(n,t){var i=r.unwrap(t());return{controlsDescendantBindings:i}}};n.privateTemplate={init:function(t,i,r,u,f){return n.template.init(t,i,r,u,e(f))},update:function(t,i,r,u,f){return n.template.update(t,i,r,u,e(f))}};t={};n.vivaControl={registerCallback:function(n){var r=i.getUniqueId();return t[r]=n,r},unregisterGuid:function(n){delete t[n]},init:function(u,f,e,o,s){var h=r.unwrap(f()),c=t[h];return r.utils.domNodeDisposal.addDisposeCallback(u,(function(){var t=c().ltm;n.vivaControl.unregisterGuid(h);i.disposeDisposable.apply(i,t)})),n.privateTemplate.init(u,c,e,o,s)},update:function(i,u,f,e,o){var s=r.unwrap(u()),h=t[s];return n.privateTemplate.update(i,h,f,e,o)}}})(f||(f={})),f}));
define("Viva.Controls/Util/Viva.Util.Private",["require","exports","o"],(function(n,t,i){"use strict";var r;return (function(n){var t=null,r,u=window,f=(function(){function n(n){this._prefixCode=";;;";this._dataTransfer=n}return i.defineProperty(n.prototype,"dropEffect",{get:function(){return this._dataTransfer.dropEffect},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="link"&&n!=="move")throw new Error("Drop effect must be either none, copy, link, or move.");this._dataTransfer.dropEffect=n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"effectAllowed",{get:function(){return this._dataTransfer.effectAllowed},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="copyLink"&&n!=="copyMove"&&n!=="link"&&n!=="linkMove"&&n!=="move"&&n!=="all"&&n!=="uninitialized")throw new Error("Effect allowed must be either none, copy, copyLink, copyMove, link, linkMove, move, all, or uninitialized.");this._dataTransfer.effectAllowed=n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"types",{get:function(){var n=this._dataTransfer.types,u,f,e,o;if(t===null&&this.getData(""),t)return f=this._getLegacyData(),o=i.keys(f).some((function(n){return f[n]!==""})),i.keys(o?f:r);if(n&&!n.forEach)for(e=n,n=[],u=0;u<e.length;u++)n.push(e[u]);return n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"files",{get:function(){return this._dataTransfer.files},enumerable:!0,configurable:!0}),n.isLegacyDataTransfer=function(){if(t===null){var n=u.DataTransfer||u.Clipboard;return!n.prototype.setDragImage}return t},n.prototype.setDragImage=function(n,t,i){this._dataTransfer.setDragImage&&this._dataTransfer.setDragImage(n,t,i)},n.prototype.addElement=function(n){this._dataTransfer.addElement&&this._dataTransfer.addElement(n)},n.prototype.getData=function(n){if(this._checkFormat(n),t)return this._getLegacyDataTransfer(n);try{return t=!1,this._dataTransfer.getData(n)}catch(i){return t=!0,this.getData(n)}},n.prototype.setData=function(n,i){if(this._checkFormat(n),t)this._setLegacyDataTransfer(n,i);else try{t=!1;this._dataTransfer.setData(n,i)}catch(r){t=!0;this.setData(n,i)}},n.prototype.clearData=function(n){if(this._checkFormat(n),t)this._clearLegacyDataTransfer(n);else try{t=!1;this._dataTransfer.clearData(n)}catch(i){t=!0;this.clearData(n)}},n.prototype._checkFormat=function(n){if(n&&n.toLowerCase()!==n)throw new Error("Format must be in lowercase.");},n.prototype._getLegacyData=function(){var n=this._dataTransfer.getData("Text");return n&&n.substr(0,this._prefixCode.length)===this._prefixCode?JSON.parse(n.substr(this._prefixCode.length)):{Text:n}},n.prototype._stringifyLegacyData=function(n){return this._prefixCode+JSON.stringify(n)},n.prototype._getLegacyDataTransfer=function(n){return this._getLegacyData()[n]||""},n.prototype._setLegacyDataTransfer=function(n,t){var i=this._getLegacyData();i[n]=t;r=i;this._dataTransfer.setData("Text",this._stringifyLegacyData(i))},n.prototype._clearLegacyDataTransfer=function(n){if(r={},n){var t=this._getLegacyData();delete t[n];r=t}this._dataTransfer.setData("Text",this._stringifyLegacyData(r))},n})();n.DataTransfer2=f;document.addEventListener("dragend",(function(){r={}}),!1)})(r||(r={})),r}));
define("Viva.Controls/Util/Viva.Util",["require","exports","f","i","o","ko","$","Viva.Controls/Util/Viva.Util.Private"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){function a(n,t){var e=n.tagName,i,u,f;switch(e){case"TABLE":i="tr";break;case"TR":i="td";break;case"UL":i="li";break;default:i="span"}t&&(f=n.getAttribute("aria-live"),n.setAttribute("aria-live","assertive"));u=r.createElement(i);n.appendChild(u);n.removeChild(u);t&&(f?n.setAttribute("aria-live",f):n.removeAttribute("aria-live"))}function v(n,t){var i=n.parents().filter((function(){var n=e(this),t=n.css("overflow-x"),i=n.css("overflow-y");return(t!=="hidden"||i!=="hidden")&&(t!=="visible"||i!=="visible")}));return t&&(i=i.add(window)),i}function y(n){if(n){var r=e(n),i=void 0;if(r.attr(t.dataControlAttribute))return n;if(i=r.closest("["+t.dataControlAttribute+"='true']"),i.length>0)return i[0]}return null}function c(n){var r=e(n),i;return r.attr(t.dataCanFocusAttribute)&&(i=n[t.dataCanFocusAttribute],i)?i():!1}function s(n,t,i){var f=0,r,e,u;do{if(r=null,u=n.find(t+":eq("+f+")"),u.length>0&&(r=u[0],e=i(r),e&&c(r)))return!0;f++}while(!l(r));return!1}function p(n,t){t===void 0&&(t=!0);var i=u.keys(n);return t?i.sort((function(n,t){return n<t?1:-1})):i}function w(n,t){var i,f,r,u;if(t.length<=n.length){for(i=-1,f=function(r){var u=t[r];return i=n.firstIndex((function(n){return n===u}),i+1),i<0?{value:!1}:void 0},r=0;r<t.length;r++)if(u=f(r),typeof u=="object")return u.value;return!0}return!1}function b(n,i){var f="["+t.dataFocusFirstAttribute+"='true']",e=":not("+f+")",u="["+t.dataCanFocusAttribute+"='true']",o=function(n){return n},r=!1;return i&&(r=s(n,u+f,i),r||(r=s(n,u+e,i))),r||(r=s(n,u+f,o),r||(r=s(n,u+e,o))),r}function k(n,t){var i=t||n.type;return e.Event(n,{type:i,target:n.target,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,currentTarget:n.currentTarget,isImmediatePropagationStopped:n.isImmediatePropagationStopped,isPropagationStopped:n.isPropagationStopped,preventDefault:n.preventDefault,stopImmediatePropagation:n.stopImmediatePropagation,stopPropagation:n.stopPropagation})}function d(n,t,i){for(var s=i?i.length:0,r,e,u,o=0;o<s;o++)r=i[o],e=t[r]||f.observable(),u=n[r],e(f.isObservable(u)?u.peek():u),t[r]||(t[r]=e)}function g(n,t){var i=n.indexOf(t)<0;return i&&n.push(t),!i}function nt(n){var t=n.getAttribute("class");return t?new h(t):new h}function tt(n,t){n.setAttribute("class",t._fields.join(" "))}function it(t){var i=e(t);return i.length?i[0].getBoundingClientRect():n.defaultBox}var l=i.isNullOrUndefined,e=jQuery,t,h;(function(n){n.dataCanFocusAttribute="data-canfocus";n.dataFocusFirstAttribute="data-focus-first";n.dataEditableAttribute="data-editable";n.dataControlAttribute="data-control";n.dataActivatableAttribute="data-activatable";n.dataActivateInfoAttribute="data-activate-info"})(t=n.Constants||(n.Constants={}));n.forceScreenRead=a;n.getScrollableParents=v;n.findContainingControl=y;n.executeSetFocusOn=c;n.getObjectBasicShape=p;n.shapeContains=w;n.setFocusToFirstFocusableChild=b;n.cloneEvent=k;n.fillObserableFields=d;n.existsOrRegisterId=g;h=(function(){function n(n){n===void 0&&(n=null);this._fields=n?n.split(" "):[]}return n.prototype.add=function(n){this._fields.indexOf(n)<0&&this._fields.push(n)},n.prototype.remove=function(n){while(this._fields.indexOf(n)>=0)this._fields.splice(this._fields.indexOf(n),1)},n.prototype.contains=function(n){return this._fields.indexOf(n)>=0},u.defineProperty(n.prototype,"length",{get:function(){return this._fields.length},enumerable:!0,configurable:!0}),n.prototype.toggle=function(n){return this._fields.indexOf(n)>=0?(this.remove(n),!1):(this.add(n),!0)},n.prototype.item=function(n){return this._fields[n]},n.prototype.toString=function(){return this._fields.toString()},n})();n.DOMTokenListShim=h;n.getClassList=nt;n.setClassList=tt;n.DataTransfer=o.DataTransfer2;n.defaultBox={top:0,left:0,width:0,height:0};n.getBox=it})(s||(s={})),s}));
define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px / 2);left:calc(50% - 30px / 2)}")}));
define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","f","i","a","ko","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","Viva.Controls/Controls/Base/Viva.KnockoutExtensions"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function a(n,t){return i.first(c(n,t))||null}function c(n,i){var r=n.data(t.widgetTypesDataKey)||[];return i&&(r=r.filter((function(n){return n instanceof i}))),r}var u,h,l;t.widgetTypesDataKey="fxWidgetTypes";u="remove.fxWidget";h="fxs-display-none";t.getWidget=a;t.getWidgets=c;l=(function(){function c(u,e,c){var b,k,l,y,p,a,d,w,v;if(c===void 0&&(c={}),b=this,this._destroyIds=[],this._currentCssClass="",!u||!u.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");this.element=u;k=this.ltm=new r.TriggerableLifetimeManager;this.vmBasicOption={ltm:k};this.bindingContext=c.bindingContext;l=u.data(t.widgetTypesDataKey);l||u.data(t.widgetTypesDataKey,l=[]);l.push(this);y=e.controlType;y!==0&&y!==94&&(p=void 0,a=u.attr("data-bind")||"",a.length&&a.indexOf("visible")>=0&&(d=f.expressionRewriting.parseObjectLiteral(a)||[],p=d.some((function(n){return n.key==="visible"}))),p||(w=e.visible,w&&w.subscribeAndRun(this.ltm,(function(n){i.isNullOrUndefined(n)||u.toggleClass(h,!n)}))));v=e&&e.cssClass;v&&(v.subscribeAndRun(this.ltm,(function(t){t&&(s.isAllowedCssClassName(t)?(u.addClass(t),b._currentCssClass=t):o.logToExtension(n,u,2,"Invalid control css class name: "+t))})),v.subscribe(this.ltm,(function(n){n&&u.removeClass(n)}),null,"beforeChange"));this._registerDispose()}return c.prototype.isDisposed=function(){return this._destroyIds.length>0},c.prototype.dispose=function(){var i,n;this._checkExistsOrRegisterDestroyId(null)||(this.ltm&&this.ltm.dispose(),i=this.element,i.removeClass(h+" "+this._currentCssClass),n=i.data(t.widgetTypesDataKey),n&&(n.splice(n.indexOf(this),1),n.length||i.removeData(t.widgetTypesDataKey)),this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null))},c.prototype._checkExistsOrRegisterDestroyId=function(n){return e.existsOrRegisterId(this._destroyIds,n)},c.prototype._cleanDescendants=function(){f.utils.cleanDescendantNodes(this.element)},c.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=this.element;this._cleanDescendants();t.length&&i.removeClass(t.join(" "));i.empty()},c.prototype._registerDispose=function(){var n=this,t=this.element;if(this.bindingContext)f.utils.domNodeDisposal.addDisposeCallback(t[0],this._disposeCallback=function(){n.dispose()});else t.on(u,this._disposeCallback=function(i){i.target!==t[0]||n._destroyTriggered||(n._destroyTriggered=!0,n.dispose())})},c.prototype._unregisterDispose=function(){var n=this.element,t=this._disposeCallback;this.bindingContext?f.utils.domNodeDisposal.removeDisposeCallback(n[0],t):n.off(u,t)},c})();t.Widget=l})(h||(h={})),h}));
define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","f","o","ko","$","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){var a=i.Base,y=a.Promises.CancelationToken,p=a.Promises.makeCancelable,w=i.Errors,h=jQuery,v="fxc-base",c="fxc-base-fill-container-width",l="fxc-base-fill-container-height",f=[],b=(function(t){function e(n,i,r){var e=t.call(this,n,i,r)||this,s,h,p;e._addDisposablesToCleanUp=function(n){return e.ltm.registerForDispose(n)};e.vm=i;e._options=i;e._widgets=[];e._waitToken=new y;e._createOptions=u.utils.extend({isTrusted:!1,fillBehavior:0},r);e.isTrusted=e._createOptions.isTrusted;n.addClass(v);switch(e._createOptions.fillBehavior){case 1:n.addClass(c);break;case 2:n.addClass(l);break;case 3:n.addClass(c+" "+l)}s=f.length;s&&(h=f[s-1],h.push(e));var w=e.tabindex=u.observable(0),b=e.disabled=u.observable(!1),a=e.bindingContext||o.getContext(n)||{};return e.$disabled=o.chainDisabledProperties([a.$disabled,b,i.disabled]),p=e.$tabIndex=o.chainTabindexProperties([a.$tabIndex,w],[i.disabled]),e.$focusIndex=u.pureComputed((function(){return p()===null?null:-1})),e}return __extends(e,t),e.prototype.dispose=function(){var n,r;this._checkExistsOrRegisterDestroyId(t.prototype.dispose)||(this._waitToken.cancel(new w.DisposedCanceledError),this._widgets&&(this._widgets.forEach((function(n){n&&n.dispose()})),this._widgets=null),this.element.removeClass(v+" "+c+" "+l).removeAttr("role"),n=f.length,n&&(r=f[n-1],i.remove(r,this)),t.prototype.dispose.call(this))},r.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),e.prototype.widget=function(){return this.element},r.defineProperty(e.prototype,"widgets",{get:function(){return this._widgets},enumerable:!0,configurable:!0}),e.prototype.awaitContentRevealed=function(){return Q(!1)},e.beginTracking=function(n){n===void 0&&(n=[]);f.push(n)},e.endTracking=function(){return f.pop()},e.prototype.trigger=function(n,t,i,r){var f=this.options[n],u=this.element;return i=i||{},t=t||h.Event(n),t.type=n,t.target=r||u[0],u.trigger(t,i),!(h.isFunction(f)&&f.apply(u[0],[t].concat(i))===!1||t.isDefaultPrevented())},e.prototype.waitFor=function(n){return p(n,this._waitToken)},e.prototype.sanitizeTemplate=function(t){return t&&!this.isTrusted?s.sanitizeHTML(t,n).sanitizedMarkup:t},e.prototype._bindDescendants=function(n,t){var i,r,f;n===void 0&&(n={});i=this.options;r=h(t||this.element)[0];u.utils.extend(n,{data:i,func:this});f=o.createChildContext(r,n,{$ctl:this,$vm:i,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);u.applyBindingsToDescendants(f,r)},e.prototype._bindElement=function(n,t){var i=h(t)[0],r=o.createChildContext(i,n,{$ctl:this,$vm:n,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);u.applyBindings(r,i)},e.prototype._isRtl=function(){return h.querySelectorAll("html").attr("dir")==="rtl"},e})(e.Widget);t.Widget=b})(h||(h={})),h}));
define("MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler",["require","exports","ko","MsPortalImpl.Controls/Controls/Base/Base"],(function(n,t,i,r){"use strict";var u;return (function(n){function t(n,t){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,u,f,e,o){var s=i.unwrap(u());i.ignoreDependencies((function(){var i=r.getWidget($(t),n);i!==null&&i.dispose();s&&(i=new n($(t),s,{bindingContext:o}))}))}}}n.getBindingHandler=t})(u||(u={})),u}));
define("_generated/Less/MsPortalImpl.Controls/Controls/IFrame.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-iframe{height:100%;overflow-y:hidden}.fxc-iframe-window{width:100%;height:100%}")}));
define("MsPortalImpl.Controls/Controls/IFrame",["require","exports","f","i","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/MsPortalImpl.Controls/Controls/IFrame.css"],(function(n,t,i,r,u){"use strict";var f;return (function(n){var t=i.Base,o=i.ViewModels.Controls.Internal.IFrame,f=window,s=jQuery,e="fxc-iframe",h="fxc-iframe-window",c=(function(n){function u(u,c,l){var a=n.call(this,u,c,l)||this,p=a.ltm,v=Q.defer(),y,w,nt;p.registerForDispose((function(){Q.isPending(v.promise)&&v.reject(new i.Errors.DisposedCanceledError)}));y=a.isReadyPromise=v.promise.timeout(c.timeoutInMs,new Error("timeout"));w=s(r.createElement("iframe")).addClass(h).attr({"data-bind":"attr: { src: $ctl._src, scrolling: $ctl._scrolling }",frameborder:"0",sandbox:"allow-same-origin allow-scripts allow-popups allow-modals allow-forms",allow:"microphone *"});u.addClass(e).append(w);a.$tabIndex.subscribeAndRun(p,(function(n){u.attr("tabindex",n)}));a._options=c;a._src=c.src;a._scrolling=o.Scroll[c.scrolling].toLowerCase();var tt=new t.UriBuilder(a._src).getAuthority(),b,k=[],d=function(n){b||(b=w[0].contentWindow);b.postMessage({signature:"pcIframe",data:n},a._src)},g;return c.postMessage.subscribeAndRun(p,(function(n){Q.isPending(y)?(k.push(n),g=g||y.then((function(){k.splice(0).forEach(d)}))):i.tryImmediateResolve(y,(function(){d.call(null,n)}))})),a._listener=function(n){var r=n.origin,i=n.data,u;if(i&&i.signature==="pcIframe"){if(r!==nt){if(u=new t.UriBuilder(r).getAuthority(),u!==tt)return;nt=r}switch(i.data){case"ready":v.resolve();break;default:c.receiveMessage(i.data)}}},f.addEventListener("message",a._listener,!1),a._bindDescendants(),a}return __extends(u,n),u.prototype.dispose=function(){this._cleanElement(e);f.removeEventListener("message",this._listener,!1);n.prototype.dispose.call(this)},u})(u.Widget);n.Widget=c})(f||(f={})),f}));
define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","f","i","o","ko"],(function(n,t,i,r,u,f){"use strict";function a(n){e=e||[];e.push(n)}function v(){return t.Internal.assetTypeService.assetTypes.forEach((function(n){return a(n)})),e}function y(n,i){t.Internal.assetTypeService=n;i.registerForDispose(l)}function p(n){var r=[],t,u;return n&&n.length?(r=n.map((function(n){return{name:n.compositeDisplayName.plural,key:n.resourceType.toLowerCase(),keywords:n.keywords}})),f.observable(i.stableSort(r,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)})))):(t=s,t||(t=f.observable(),s=t,u=e||v()||[],r=u.filter((function(n){var i=n.assetTypeManifest,t=i.resourceType,r=i.browseType===1&&!i.privateBrowse&&n.lowerCaseResourceType!==h.Constants.ResourceTypes.ResourceGroups.toLowerCase();return r&&!(t&&(t.routingType===o.Tenant||t.routingType===o.ProviderProxy||t.routingType===o.Extension))})).map((function(n){return{name:n.compositeDisplayName.plural,key:n.lowerCaseResourceType,keywords:n.assetTypeManifest.keywords&&n.assetTypeManifest.keywords.split(",")}})),t(i.stableSort(r,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)})))),t)}var e,s;u.defineProperty(t,"__esModule",{value:!0});var h=i.Base,c=i.Extension,o=c.ResourceRoutingType,l=new r.TriggerableLifetimeManager;t.Internal={};t.initialize=y;t.getResourceTypes=p;t.getLocations=i.memoizeQ((function(){return i.Azure.getLocations().then((function(n){var t=i.forEachKey(n,(function(n,t,i){i.push({displayName:t,name:n})}),[]);return i.stableSort(t,(function(n,t){return n.displayName.localeCompareIgnoreCase(t.displayName)}))}))}))}));
define("_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-simplebutton{display:inline-block;-webkit-user-select:none;min-width:80px;text-align:center;line-height:22px;position:relative}.fxs-button-icon{display:inline-block;height:12px;width:12px}.fxs-button-icon-left{margin-right:5px}.fxs-button-icon-right{margin-left:5px}.fxs-button-spinner{height:10px;width:10px;display:inline-block;position:absolute;right:8px}.fxs-button-text-hide{display:none}")}));
define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","f","o","ko","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var h=i.disposeDisposable,t="fxc-simplebutton",s="fxs-button-text",c="<span>"+i.encodeAttribute(e.Button.validating)+"<\/span><div class='fxs-button-spinner' data-bind='image: MsPortalFx.Base.Images.Loading.Spinner()'><\/div>",l='<div class=\'fxs-button fxt-button\' role=\'button\' data-bind=\'visible: data.visible, css: { "fxs-button-disabled": $disabled, "fxs-portal-button-primary": data.primary, "fxs-button-default": !ko.unwrap(data.primary), "fxs-inner-dotted-border": !ko.unwrap($disabled) }, attr: { tabindex: $tabIndex, "aria-disabled": $disabled, title: data.text }\'><!-- ko if: data.icon() && data.icon().position === 0 --><div class=\'fxs-button-icon fxs-button-icon-left\' data-bind=\'image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: "fxs-escapeShadow"})\'><\/div><!-- /ko -->'+("<span class="+s+" data-bind='text: data.text'><\/span>")+"<!-- ko if: data.icon() && data.icon().position === 1 --><div class='fxs-button-icon fxs-button-icon-right' data-bind='image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: \"fxs-escapeShadow\"})'><\/div><!-- /ko --><!-- ko if: data.loading -->"+("<div class=fxs-button-validating>"+c+"<\/div>")+"<!-- /ko --><\/div>",a=(function(n){function i(i,r,u){var f=n.call(this,i,r,u)||this,e;return f._events=[],f.element.addClass(t).html(l),e=f.element.findByClassName("fxs-button"),f.options.ariaLabel.subscribeAndRun(f.ltm,(function(n){e.attr("aria-label",n?n:null)})),f.options.loading.subscribeAndRun(f.ltm,(function(n){e.findByClassName(s).toggleClass("fxs-button-text-hide",n)})),f._attachEvents(),f._bindDescendants(),f}return __extends(i,n),r.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._detachEvents(),this._cleanElement(t),n.prototype.dispose.call(this))},i.prototype._attachEvents=function(){var n=this,t,i;this._detachEvents();t=function(n){return u.isObservable(n)?n():n};i=function(i){i.stopPropagation();i.preventDefault();!t(n.$disabled)&&n.options.onClick&&t(n.options.onClick)()};this._events.push(this.element.setEvents([f.default.click,i,],[f.default.keypress,function(n){(n.keyCode===13||n.keyCode===32)&&i(n)},]))},i.prototype._detachEvents=function(){h(this._events);this._events=[]},i})(o.Widget);n.Widget=a})(s||(s={})),s}));
define("MsPortalImpl/Base/JQueryHelper",["require","exports","i"],(function(){"use strict";var n;return (function(n){function e(n,t){return n.find("."+t)}function u(n){return n.addClass(t)}function i(n){return n.removeClass(t)}function o(n,t){var r=t?i:u;return r(n)}function f(n){return!!n.offsetParent}function s(n){return n.toArray().some(f)}function h(){return r}function c(n,i){return $(n).find(i+r).filter((function(i,r){var u=$(r).parentsUntil(n,"."+t);return!u.length}))}function l(n,t){return i(n),n.show(t)}var t="fxs-display-none",r=":not(.fxs-display-none)";n.jBody=$(document.body);n.findByClassName=e;n.hide=u;n.unhide=i;n.toggle=o;n.isElementVisible=f;n.isVisible=s;n.getUnhideSelector=h;n.filterVisible=c;n.forceShow=l})(n||(n={})),n}));
define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports","f","i","a","ko","$","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function y(n,t,r){t===void 0&&(t=!0);r===void 0&&(r=!1);var u=c(n,r),f=u.map((function(n){return n.field})),e=u.map((function(n){return n.viewmodel})).filter(i.identity);return(t&&this.gridEnableValidation(e),f.length===0)?Q(!0):a(f)}function p(n){n.forEach((function(n){var t=n&&n.rowMetadata;t&&t.editState&&t.editState()&&n.performValidation&&!n.performValidation()&&n.performValidation(!0)}))}function w(n,t,i,o){var l=u(n),p,a,v,y;if(l.attr(e,"true"),l.data(r,o),l.data(s,t),l.data(h,i),p=!!o.fieldsData,a=(p?l.parent():l).closest(".fxs-validationContainer"),a.length&&a.hasClass("fxs-part-content")){var k=a.parent(),w=f.dataFor(k[0]),b=w&&w.context;v=b&&b.validateElements;v&&v.push(n)}else a.length&&(y=a.data(r),y&&y.fieldsData&&y.fieldsData(c(a,!0)));o.ltm.registerForDispose((function(){v&&v.remove(n);l.data(r,null);l.data(s,null);l.data(h,null)}))}function l(n,t,i){return n.filter((function(n){var f=u(n);return n&&n.hasAttribute(e)&&f.closest(".fxs-suppresschildvalidation").length<1&&f.data(r)&&(!t||t(n))&&(i||o.isElementVisible(n))})).map((function(n){var t=u(n);return{viewmodel:t.data(s),widgetviewmodel:t.data(h),field:t.data(r)}}))}function c(n,t,i){t===void 0&&(t=!1);var f=function(n){var t=u(n).data(r);return t&&(!i||i(n))};return n.length?l(n.find("["+e+"]").toArray(),f,t):[]}function a(n){var t=[];return n.filter((function(n){return n.triggerValidation})).map((function(n){t.push(n.triggerValidation())})),Q.all(t).then((function(n){return n.every(v)}))}var u=jQuery,v=i.identity,b=i.Base.Diagnostics.createLog(n);t.ensureFormFieldValidation=y;t.gridEnableValidation=p;var e="data-validatable",r="field",s="viewmodel",h="widgetviewmodel";t.markFormFieldElement=w;t.gatherFormFieldsFromElements=l;t.gatherFormFields=c;t.performFieldValidation=a})(s||(s={})),s}));
define("MsPortalImpl/AsyncLoader",["require","exports","f","i","o","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f){"use strict";function s(t,r){return i.tryImmediateResolve(i.require(t,n),(function(n){return n[r]}))}function h(n){function t(t,u){return function(f,e){return t.register(n.get(r.Rpc.Client),u,(function(t,r){return i.tryImmediateResolve(s(f,e),(function(i){return i({diContainer:n,messageArg:t,messageContext:r})}))})),null}}var u={"MsPortalImpl/UI/Hubs/UI.ResourceMapManager":{mapAssetIdToResourceId:t(e.mapAssetIdToResourceIdEndPoint),mapResourceIdToAssetId:t(e.mapResourceIdToAssetIdEndPoint),mapResourceIdToDynamicSelectionAndIcon:t(e.mapResourceIdToDynamicSelectionAndIconEndPoint),getResourceAssetInformation:t(e.getResourceAssetInformationEndPoint),getResourceAssetInformationForHubs:t(f.AssetTypes.getResourceAssetInformationEndPoint),getResource:t(e.getResourceEndPoint),getResourceGroup:t(e.getResourceGroupEndPoint),signalResourcesChanged:t(e.signalResourcesChangedEndPoint)},"MsPortalImpl/Services/Services.AzureStorage":{sasEndPointHandler:t(r.InternalAzure.getSasUriForQueueEndPoint,"Microsoft_Azure_Scheduler")},"MsPortalImpl/Services/Services.EditScopeManagement":{loadSerializedEditScope:t(o.loadSerializedEditScopeEndPoint),saveSerializedEditScope:t(o.saveSerializedEditScopeEndPoint),updateEditScopeIsSavingState:t(o.updateEditScopeIsSavingStateEndPoint)},"MsPortalImpl/Services/Services.ExtensionTokensManager":{getAuthorizationTokenEndPoint:t(e.getAuthorizationTokenEndPoint)},"MsPortalImpl/Services/Services.GalleryEndpoints":{getLocalGalleryPackages:t(e.getLocalGalleryPackagesEndpointsDefinition),registerLocalGalleryPackages:t(e.registerLocalGalleryPackagesEndpointDefinition)},"MsPortalImpl/Services/Services.Permissions":{hasPermissionsToShell:t(e.hasPermissionsToShell)},"MsPortalImpl/Services/Services.SharedSettings":{getSharedSettings:t(e.getSharedSettingsEndPoint)},"MsPortalImpl/Widgets/Widgets.SideBar":{isArtBrowseEnabled:t(f.ArtBrowse.isArtBrowseEnabledEndpoint,"HubsExtension")}};i.forEachKey(u,(function(n,t){i.forEachKey(t,(function(t,i){i(n,t)}))}))}u.defineProperty(t,"__esModule",{value:!0});var o=r.Data,e=r.Extension;t.get=s;t.registerRpc=h}));
define("MsPortalImpl/Base/Base.ArmIdHelpers",["require","exports","f","o","Fx/ResourceManagement"],(function(n,t,i,r,u){"use strict";function o(n){return e[n.kind]}function s(n){return u.ArmId.parse(n).kind!==0?i.sanitizeMessage(n):"<REDACTED>"}var e,f;r.defineProperty(t,"__esModule",{value:!0});e=(f={},f[6]=!0,f[3]=!0,f[8]=!0,f);t.isResourceAtAnyLevel=o;t.sanitizeId=s}));
define("MsPortalImpl/Base/Base.Events",["require","exports","f","o"],(function(n,t,i,r){"use strict";function f(){var n=document;return!!(n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement)}function e(){var n=document,t=n.exitFullscreen||n.webkitExitFullscreen||n.mozCancelFullScreen||n.msExitFullscreen;t&&t.call(n)}function o(){var n=document.documentElement,t=n.requestFullscreen||n.webkitRequestFullscreen||n.mozRequestFullScreen||n.msRequestFullscreen;t&&t.call(n)}function u(n){return n._handle}function s(n,t){var r=i.find(t(),(function(t){return u(t)===n}));return r||(r={_handle:n},t.push(r)),r}r.defineProperty(t,"__esModule",{value:!0});t.fxpinmultipleparts="fxpinmultipleparts";t.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange";t.isFullscreen=f;t.exitFullscreen=e;t.requestFullscreen=o;t.unwrapFxElement=u;t.getOrCreateFxElement=s}));
define("MsPortalImpl/Base/Base.SvgHelper",["require","exports","f","i","o","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function v(n,t){var i=n.getAttribute("class");n.setAttribute("class",(i?i+" ":"")+t)}function d(n,t){n.setAttribute("class",(n.getAttribute("class")||"").split(" ").filter((function(n){return n&&n!==t})).join(" "))}function s(n,t){for(var i=0,r=n.length;i<r;++i)t(n[i])}function g(n,i){var r,f,u,e;return i.customClass&&(r=b(i.customClass),(r.startsWith("ext-")||r.startsWith("msportalfx")||r.startsWith("fxt-"))&&!r.includes(" ")&&s(n.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return v(n,r)}))),i.description&&(f=h.createElementNS(l,"desc"),f.textContent=i.description,u=n.getElementsByTagName("title")[0],u&&u.parentNode.insertBefore(f,u.nextSibling)),i.title?s(n.getElementsByTagName("title"),(function(n){n.textContent||(n.textContent=i.title)})):(e=[],s(n.getElementsByTagName("title"),(function(n){return n&&!n.textContent&&e.push(n)})),e.forEach((function(n){return n.remove()}))),i._badgeWidth||(s(n.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return d(n,t.SvgPlaceholderClass)})),s(n.querySelectorAll("[class='']"),(function(n){return n.removeAttribute("class")}))),a(n.firstElementChild||c.cloneNode(),n.innerHTML)}function ht(n,t){var i=tt[n],r;return i||(i=t?et:ft,i.innerHTML=n,t||(r=[],s(i.querySelectorAll(st),(function(n){r.push(n)})),r.forEach((function(n){return n.remove()})),s(i.querySelectorAll("*"),(function(n){for(var i=n.attributes,r=[],f=function(n){var t=i[n].name;ot[t]||r.push(t)},t=0,u=i.length;t<u;++t)f(t,u);r.forEach((function(t){return n.removeAttribute(t)}))}))),tt[n]=i.cloneNode(!0)),i.cloneNode(!0)}function vt(i,u,f,p){var yt,it,wt,ot,tt,dt,bt,et,vt,pt,ui,kt;if(u=u||i.options||{},yt=i&&i.type,it=i&&i.data,yt!==0&&it){if(yt===2)return o.sanitizeUri(it)?(wt=b(u.title||""),ot=r.createElement("img"),wt?ot.setAttribute("alt",wt):ot.setAttribute("aria-hidden","true"),ot.setAttribute("src",rt(it)),ot):(e.logToExtension(n,f,2,"Image has failed to load as an invalid uri was passed in : "+it),a(c.cloneNode(),w))}else return a(c.cloneNode(),w);if(tt=ht(it,p||yt!==1,f),!tt.hasChildNodes())return e.logToExtension(n,f,2,"Svg has failed to load, imageData: "+it),a(c.cloneNode(),w);if(dt=t.SvgsPalettes[u.palette],u.palette&&s(tt.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return v(n,dt)})),bt=!1,u.isLogo||(s(tt.querySelectorAll("[fill]"),(function(n){return n.removeAttribute("fill")})),tt.getElementsByClassName(t.SvgsPalettes[99]).length||(bt=!0,s(tt.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return v(n,k)})))),lt||ct||u.customClass||at.test(tt.outerHTML))return g(tt,u);if(et=nt.get(tt.outerHTML),et)et=et.cloneNode(!0);else{var gt=ut(),ft=c.cloneNode(),ni=r.createElement("div");v(ft,t.SvgPlaceholderClass);bt&&v(ft,k);ft.setAttribute("height","100%");ft.setAttribute("width","100%");ft.appendChild(h.createElementNS(l,"title"));ni.appendChild(ft);var ti=c.cloneNode(),ii=h.createElementNS(l,"defs"),st=h.createElementNS(l,"symbol"),ri=h.createElementNS(l,"use");for(ri.setAttribute("href","#"+gt),ft.appendChild(ri),nt.set(tt.outerHTML,(et=ni).cloneNode(!0)),vt=tt.getElementsByTagName("svg")[0]||tt,pt=0,ui=vt.attributes.length;pt<ui;++pt)kt=vt.attributes[pt],st.setAttribute(kt.name,kt.value);while(vt.hasChildNodes())st.appendChild(vt.firstChild);st.setAttribute("id",gt);d(st,t.SvgPlaceholderClass);ii.appendChild(st);ti.appendChild(ii);y.appendChild(ti)}return g(et,u)}var it=i.Base,yt=it.Diagnostics,rt=i.encodeAttribute,b=i.encodeHtml,p=window,l="http://www.w3.org/2000/svg",h=p.document,k="fxs-portal-svg",a,y;t.SvgPlaceholderClass="msportalfx-svg-placeholder";t.SvgBadgeClass="msportalfx-svg-badge";t.SvgsPalettes=[];t.SvgsPalettes[0]="";t.SvgsPalettes[2]="msportalfx-svg-palette-black";t.SvgsPalettes[3]="msportalfx-svg-palette-blue";t.SvgsPalettes[1]="msportalfx-svg-palette-white";t.SvgsPalettes[4]="msportalfx-svg-palette-green";t.SvgsPalettes[5]="msportalfx-svg-palette-gray";t.SvgsPalettes[99]="msportalfx-svg-palette-inherit";t.SvgsPalettes[100]="msportalfx-svg-disabled";a=p.SVGElement&&"outerHTML"in SVGElement.prototype?function(n){return n}:function(n,t){return n.outerHTML=t,n};y=r.createElement("div");y.setAttribute("id","FxSymbolContainer");h.head.appendChild(y);var ut=i.getIdGenerator("FxSymbol"),nt=new i.Map,ft=h.implementation.createHTMLDocument("").body,et=r.createElement("div"),tt=u.create(null),c=h.createElementNS(l,"svg"),w=(function(){var n=r.createElement("div");return n.appendChild(c),n.innerHTML})(),ot=["aria-hidden","aria-labelledby","class","clip-path","clip-rule","cx","cy","d","enable-background","fill","fill-opacity","fill-rule","filter","focusable","gradientTransform","gradientUnits","height","id","mask","offset","opacity","points","r","role","rx","ry","spreadMethod","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","transform","viewBox","viewbox","width","x","x1","x2","xml:space","xmlns","xmlns:svg","xmlns:xlink","y","y1","y2",i.isFeatureEnabled("sanitizesvghref")?"":"xlink:href",].reduce((function(n,t){return t&&(n[t]=!0,n[t.toUpperCase()]=!0),n}),p.Object.create(null)),st="*:not("+["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","polygon","polyline","radialGradient","rect","stop","svg","symbol","title","use",].join("):not(")+")";var ct=i.isFeatureEnabled("fulldiagnostics"),lt=f.isIe||f.isSafari,at=/msportalfx-svg-c0(5|7)|-animated(\s|'|")|(\s|'|")ext-|<linearGradient|<radialGradient/;t.getSvgReferenceOrFallBackToData=vt})(s||(s={})),s}));
define("MsPortalImpl/Base/Base.ImageHelper",["require","exports","f","i","o","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.SvgHelper"],(function(n,t,i,r,u,f,e,o){"use strict";function h(n){return n.tagName.toLowerCase()==="svg"?n:n.getElementsByTagName("svg")[0]}function c(n,t){n&&i.forEachKey(t,(function(t,i){return n.setAttribute(t,i)}))}function l(t,u,f){var v=t&&t.type,e=t&&t.options||{},p,y,k,w,d,b;return v===0||v===1||v===2?(y=o.getSvgReferenceOrFallBackToData(t,e,u),y.tagName.toLowerCase()==="img"||y.hasChildNodes()?(c(h(y),f),p=Q([y])):p=Q([]),p=Q(y.hasChildNodes()||y.tagName.toLowerCase()==="img"?[y]:[])):(k=t&&t.data&&Q((b={},b[v]=t,b)),p=(k||i.require("MsPortalImpl/Base/Base.ImageLibrary")).then((function(t){var b,i,l;if(v>=999)return b=!e.title?"":a(e.title,n).sanitizedMarkup,i=r.createElement("img"),i.setAttribute("alt",b),i.setAttribute("aria-hidden",(!e.title).toString()),i.setAttribute("src",s(t[v]&&t[v].data)),[i];var y=o.getSvgReferenceOrFallBackToData(t[v],e,u,!0),p=h(y),w=e._badgeWidth;return w&&(l=p&&p.getAttribute("class").indexOf(o.SvgPlaceholderClass)>-1&&p||y.querySelector("svg."+o.SvgPlaceholderClass),l&&(l.setAttribute("class",l.getAttribute("class").replace(o.SvgPlaceholderClass,o.SvgBadgeClass)),typeof w=="number"&&l.setAttribute("style","width:"+w+"%; height:"+w+"%"))),c(p,f),y.childElementCount?[y]:[]}))),e.badge&&(w=e.badge.width,w&&typeof w=="number"||(w=40),d=i.extend2(e.badge.image,{options:{_badgeWidth:w}}),p=Q.all([p,l(d,u)]).then((function(n){return[].concat.apply([],n)}))),p}function v(n){var t=null;return n&&n.type===2&&e.sanitizeUri(n.data)&&(t=s(n.data)),t}u.defineProperty(t,"__esModule",{value:!0});var s=i.encodeAttribute,a=f.sanitizeHTML;t.GetImageData=l;t.GetImageUri=v}));
define("MsPortalImpl/Base/Base.ItemCache",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){return function(t){return n(t.item)}}function c(n){var t=r();return t-n}function f(n){return{age:r(),item:n}}function e(n,t){var i;return n&&(t&&(n.age=r()),i=n.item),i}function b(n,i){var r=(y++).toString();return t.set(r,i),n.registerForDispose((function(){t.delete(r)})),r}function k(n){return t.get(n)}var s=window,h=i.remove,p=i.find,w=i.findIndex,r=Date.now,o=(function(){function n(n,t){n===void 0&&(n=12e4);var i=this;this._map=t;this._maxAge=n;s.setTimeout((function(){return i._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.flush()},n.prototype.hasEntry=function(n){return n in this._map},n.prototype.getEntry=function(n){return e(this._map[n],!0)},n.prototype.peekEntry=function(n){return e(this._map[n])},n.prototype.removeEntry=function(n){n in this._map&&this._delete(n)},n.prototype._removeEach=function(n){for(var t in this._map)n.call(this,t)&&this._delete(t)},n.prototype.removeEach=function(n){this._removeEach(n)},n.prototype.flush=function(){this._removeEach()},n.prototype._delete=function(n){delete this._map[n]},n.prototype._isExpired=function(n){return c(this._map[n].age)>this._maxAge},n.prototype._reduceCache=function(){this._removeEach(this._isExpired)},n})(),l,a,v,t,y;n.BaseItemCache=o;l=(function(n){function t(t){t===void 0&&(t=12e4);var i=this,r={};return i=n.call(this,t,r)||this,i._cache=r,i}return __extends(t,n),t.prototype.addEntry=function(n,t){this._cache[n]=f(t)},t})(o);n.ItemCache=l;a=(function(n){function t(t){t===void 0&&(t=12e4);var i=this,r={};return i=n.call(this,t,r)||this,i._cache=r,i}return __extends(t,n),t.prototype.addEntry=function(n,t,i){this.removeEntry(n);var r=f(t);r.mgr=i;this._cache[n]=r},t.prototype._delete=function(t){this._cache[t].mgr.dispose();n.prototype._delete.call(this,t)},t})(o);n.LifetimeItemCache=a;v=(function(){function n(n){n===void 0&&(n=12e4);var t=this;this._cache=[];this._maxAge=n;s.setTimeout((function(){return t._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.clear()},n.prototype.first=function(n,t){var i=p(this._cache,u(n));return e(i,!t)},n.prototype.peekFirst=function(n){return this.first(n,!0)},n.prototype.pushEntry=function(n){this._cache.push(f(n))},n.prototype.removeEntry=function(n){this.removeFirst((function(t){return i.deepEquals(t,n)}))},n.prototype.removeFirst=function(n){var t=w(this._cache,u(n));t>=0&&this._cache.splice(t,1)},n.prototype.removeEach=function(n){h(this._cache,u(n))},n.prototype.clear=function(){this._cache=[]},n.prototype._isEntryExpired=function(n){return c(n.age)>this._maxAge},n.prototype._reduceCache=function(){var n=this;h(this._cache,(function(t){return n._isEntryExpired(t)}))},n})();n.ItemArrayCache=v;t=new i.Map;y=1;n.rotAdd=b;n.rotFind=k})(r||(r={})),r}));
define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports","o"],(function(){"use strict";var n;return (function(n){function o(n){switch(n){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}}function s(n){return(n.altKey&&1)|(n.metaKey&&2)|(n.shiftKey&&4)|(n.ctrlKey&&8)}function h(n,r){var f=n?t:i;return f[r]||u[r]}var e=window,f=/Firefox\//i.test(e.navigator.userAgent),r,u,t,i;(function(n){n[n.Equals=f?61:187]="Equals";n[n.Minus=f?173:189]="Minus"})(r=n.VariableKeyCode||(n.VariableKeyCode={})),(function(n){n[n.Alt=18]="Alt";n[n.Backslash=220]="Backslash";n[n.Backspace=8]="Backspace";n[n.Comma=188]="Comma";n[n.Control=17]="Control";n[n.Delete=46]="Delete";n[n.Down=40]="Down";n[n.End=35]="End";n[n.Enter=13]="Enter";n[n.Equals=r.Equals]="Equals";n[n.Escape=27]="Escape";n[n.F1=112]="F1";n[n.F2=113]="F2";n[n.F10=121]="F10";n[n.Home=36]="Home";n[n.Left=37]="Left";n[n.Menu=93]="Menu";n[n.Minus=r.Minus]="Minus";n[n.PageDown=34]="PageDown";n[n.PageUp=33]="PageUp";n[n.Period=190]="Period";n[n.Right=39]="Right";n[n.Shift=16]="Shift";n[n.Slash=191]="Slash";n[n.Space=32]="Space";n[n.Tab=9]="Tab";n[n.Up=38]="Up";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.Num0=48]="Num0";n[n.Num1=49]="Num1";n[n.Num2=50]="Num2";n[n.Num3=51]="Num3";n[n.Num4=52]="Num4";n[n.Num5=53]="Num5";n[n.Num6=54]="Num6";n[n.Num7=55]="Num7";n[n.Num8=56]="Num8";n[n.Num9=57]="Num9";n[n.NumPad0=96]="NumPad0";n[n.NumPad1=97]="NumPad1";n[n.NumPad2=98]="NumPad2";n[n.NumPad3=99]="NumPad3";n[n.NumPad4=100]="NumPad4";n[n.NumPad5=101]="NumPad5";n[n.NumPad6=102]="NumPad6";n[n.NumPad7=103]="NumPad7";n[n.NumPad8=104]="NumPad8";n[n.NumPad9=105]="NumPad9"})(u||(u={}));n.isNonWrittenCharacter=o;n.getModifierKeys=s;t=[];t[192]="~";t[219]="{";t[221]="}";t[220]="|";t[59]=":";t[188]="<";t[r.Equals]="+";t[r.Minus]="_";t[49]="!";t[50]="@";t[51]="#";t[52]="$";t[53]="%";t[54]="^";t[55]="&";t[56]="*";t[57]="(";t[48]=")";t[190]=">";t[191]="?";t[32]="SHIFT+SPACE";t[40]="SHIFT+Down";t[38]="SHIFT+Up";i=[];i[220]="\\";i[188]=",";i[r.Minus]="-";i[49]="1";i[50]="2";i[51]="3";i[52]="4";i[53]="5";i[54]="6";i[55]="7";i[56]="8";i[57]="9";i[48]="0";i[190]=".";i[32]="SPACE";i[191]="/";n.mapKeyCodeToString=h})(n||(n={})),n}));
define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o){"use strict";function v(n){h.text=a=n}var a;r.defineProperty(t,"__esModule",{value:!0});var s=u.bindingHandlers,h=u.virtualElements.allowedBindings,c=u.utils,l=c.domData,y=i.wrap({controlsDescendentBindings:!0});s.commands={update:function(n,t){var i=u.unwrap(t()),r,o;if(i&&i.group){r=f(n);o=function(n){var o=u.unwrap(i.viewModel),t=f.Event(e.default.fxrightclick);t.clientX=n.clientX;t.clientY=n.clientY;r.trigger(t,{commandGroup:i.group,viewModel:o,entityType:2});n.preventDefault();n.stopPropagation()};r.on(e.default.fxcontextmenurequest,o);c.domNodeDisposal.addDisposeCallback(n,(function(){r.off(e.default.fxcontextmenurequest,o)}))}}};s.fxclick={init:function(n,t,r,u,f){i.require("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar",(function(i){i.attachFxClickHandler(n,f,t)}))}};s.visible={update:function(n,t){var i=u.unwrap(t());f(n).toggleClass("fxs-display-none",!i)}};s.keyedCss={update:function(n,t){var r=[],e=[];i.forEachKey(u.unwrap(t()),(function(t,f){var o=u.unwrap(f);if(typeof o!="string")i.forEachKey(o,(function(n,t){u.unwrap(t)?r.push(n):e.push(n)}));else{t="_fxCss_"+t;var h=l.get(n,t)||[],s=o.split(" ").filter(i.identity)||[],a=c.compareArrays(h,s,{sparse:!0});a.forEach((function(n){undefined===n.moved&&(n.status==="added"?r.push(n.value):n.status==="deleted"&&e.push(n.value))}));l.set(n,t,s)}}));f(n).removeClass(e.join(" ")).addClass(r.join(" "))}};h.vtext=h.text;s.vtext=s.text;t._vtext=v;v(i.isFeatureEnabled("vtext"));s.text={init:y,update:function(t,i){var r=u.unwrap(i());if(r=r===undefined?"":r,t.nodeType===8){o.logToExtension(n,t,2,'"text" binding not allowed in comment. Use "vtext" binding or non-comment element. ("'+r+'"). To temporarily allow set feature.vtext=true.');a&&s.vtext.update.apply(null,arguments);return}t.textContent=r}}}));
define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:2px 6px 6px 2px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r,u,f,e){"use strict";function a(n,t,u,o){var a="fxs-copyfield",v="fxs-copyfield-copied",h=$(t),s=$(r.createElement("div",{"class":a+"-wrapper","data-bind":"stopBindings: true"})),y=$(r.createElement("div",{"class":a,"data-bind":"pcCopyableLabel: $data"})),l;y.appendTo(s);s.appendTo(h);l=new c.Forms.CopyableLabel.ViewModel(n,o);l.readOnly(!0);f.reactor(n,(function(){var n=f.unwrap(u);l.value(n);h.toggleClass("fxs-copyfield-container",!i.isNullOrWhiteSpace(n))}));f.applyBindingsToDescendants(l,s[0]);n.registerForDispose([h.setEvents([e.default.fxcopybuttonclick,function(){h.addClass(v)},],[e.default.mouseleave,function(){h.removeClass(v)},]),function(){s&&(f.utils.cleanDescendantNodes(s),s.remove())},])}function o(n,t,i){function h(){o&&o.dispose();r&&(clearTimeout(r),r=null)}var c=$(n),o,r,u={};u[e.default.mouseenter]=function(){r||(r=setTimeout((function(){h();a(o=new s,n,t(),i)}),l))};u[e.default.mouseleave]=h;c.on(u);f.utils.domNodeDisposal.addDisposeCallback(n,(function(){h();c.off(u)}))}u.defineProperty(t,"__esModule",{value:!0});var s=r.TriggerableLifetimeManager,h=i.Base,c=i.ViewModels.Controls,v=h.Diagnostics.createLog(n),l=100;t.initializeCopyBinding=o;f.bindingHandlers.copy={init:o}}));
define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports","f"],(function(){"use strict";var n;return (function(n){function r(t,r,u){var e=r.additionalInputArguments=r.additionalInputArguments||[],f;r.outputArguments=r.outputArguments||[];f=t+i;e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallId}]});e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallerParams}]});r.outputArguments.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerResult}]})}function u(t){t.inputs=t.inputs||[];t.inputs.push(n.bindingName_bladeCallId,n.bindingName_bladeCallerParams)}function f(t,r,u,f){var o=r.inputs=r.inputs||[],e;if(r.outputs=r.outputs||[],r.bindings=r.bindings||[],f.inline)e=f.inline.bindings=f.inline.bindings||[];else if(f.reference)e=f.reference.bindings=f.reference.bindings||[];else throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");o.push(n.bindingName_bladeCallId);e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallId}]});o.push(n.bindingName_bladeCallerParams);e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerParams}]});r.outputs.push(n.bindingName_bladeCallerResult);r.bindings.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:0,property:t+i+n.bindingName_bladeCallerResult,part:u}]})}var t="internal_",i=".";n.bindingName_bladeCallId=t+"bladeCallId";n.bindingName_bladeCallerParams=t+"bladeCallerParams";n.bindingName_bladeCallerResult=t+"bladeCallerResult";n.addCallerBindings=r;n.addCallablePartInputs=u;n.addCallableBindings=f})(n||(n={})),n}));
define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","f","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function it(n,t,i){r.sanitizeDefinition(n,o);var u=n;return u.partTypeMap=u.partTypeMap||{},u.bladeMap=u.bladeMap||{},(u.partsCatalog||[]).forEach((function(n){return w(u,t,n,i||{})})),(u.blades||[]).forEach((function(n){return b(u,t,n,i||{})})),et(n),u}function y(n,t){n&&n.extension&&(n.extension=t[n.extension]||n.extension)}function p(n,t){n&&n.length&&n.forEach((function(n){n.bladeExtension&&(n.bladeExtension=t[n.bladeExtension]||n.bladeExtension)}))}function w(n,t,i,u){return i.processed?i:(u=u||{},y(i.reference,u),p(i.details,u),n.partTypeMap[i.name.toLowerCase()]=i,i.assetTypeDefinition=(t.assetTypes||[]).first((function(n){return n.partName===i.name})),f(i.details,0),i.parameterProvider&&k(i),ct(n,i),r.sanitizeInlineTemplate(n.name,i.name,i,o),i.processed=!0,i)}function b(n,t,u,f){if(f=f||{},u.processed)return u;i.isFeatureEnabled("pinnable_default_off")&&i.isNullOrUndefined(u.pinnable)&&(u.pinnable=!!u.pinnedPart);u.attributes&2&&(u.optionalInputs=u.optionalInputs||[],u.optionalInputs.push("_provisioningContext"));u.templateBlade&&ht(u);u.menuBlade&&ut(u);u.frameBlade&&ft(u);(u.lenses||[]).forEach((function(n){(n.partInstances||[]).forEach((function(n){y(n.reference,f);p(n.inline&&n.inline.details,f)}))}));n.bladeMap[u.name.toLowerCase()]=u;u.assetTypeDefinition=(t.assetTypes||[]).first((function(n){return n.bladeName===u.name}));ot(u);u.effectiveInputs||(u.effectiveInputs=u.viewModelInputs||[]);var e=rt(u);return n.partTypeMap[e.name.toLowerCase()]=e,r.sanitizeBladeDefinition(n.name,u,o),u.processed=!0,u}function rt(t){var r=n.PinPrefix+t.name,i;return t.pinnedPart||(t.pinnedPart=r),i={name:r,viewModel:n.PinVMPrefix+t.name,partKind:e.Button,inputs:t.inputs,initialSize:2,details:[{blade:t.name,isMultiple:!1,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:0}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:t.commandGroup,commandGroupReference:t.commandGroupReference,assetIdInputProperty:t.assetIdInputProperty,assetType:t.assetType},(t.inputs||[]).forEach((function(t){i.bindings.push({property:n.collisionPrefix+t,valuesFrom:[{property:t,referenceType:1}]})})),(t.optionalInputs||[]).forEach((function(t){t!==d.ReferrerInfo&&i.bindings.push({property:n.collisionPrefix+t,optional:!0,valuesFrom:[{property:t,referenceType:1}]})})),t.viewModelInputs&&t.viewModelInputs.forEach((function(n){n.property===t.assetIdInputProperty&&i.bindings.push(n)})),i}function t(n,t,i,r){t&&t.forEach((function(t){var u=!r&&i&&i.indexOf(t)>-1;n.inputs.push(t);n.bindings.push({property:t,optional:r,isIdentityInput:u,valuesFrom:[{referenceType:1,property:t}]})}))}function s(n,t,i,r,u,f,o,s,h,c,l){return{name:n,inline:{bindings:[],details:[],inputs:[],partKind:c||e.Custom,viewModelLocator:t.viewModelLocator,viewModel:t.viewModelName,htmlTemplate:i,htmlTemplateInline:r,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:u,viewStateProperties:[],shareVmWithParentBlade:!0,partState:f,styleSheets:s,permissions:h,noFxContentPadding:l},parameterProvider:o}}function ut(n){var u=n.name,e=n.menuBlade.isV2,r=s(u,n,undefined,{content:"<div data-bind='pcControl: "+(e?"viewModel._msPortalFxMenu":"menu")+"' class='ext-menublade-part'><\/div>",file:u+i.getUniqueId()},9,undefined,!1,[],undefined),f;t(r.inline,n.inputs,n.templateKeyInputs);t(r.inline,n.optionalInputs,[],!0);f={name:u,partInstances:[r]};n.lenses.splice(0,0,f);n.effectiveInputs=r.inline.bindings;i.isNullOrUndefined(n.pinnable)&&(n.pinnable=!0)}function ft(n){var r=n.name,i=s(r,n,undefined,undefined,9,n.frameBlade.partState,!1,[],n.permissions,e.Frame),u;t(i.inline,n.inputs,n.templateKeyInputs);t(i.inline,n.optionalInputs,[],!0);n.toolbar={source:{valuesFrom:[{referenceType:0,part:r,property:"content.commandBar"}]}};u={name:r,partInstances:[i]};n.lenses.splice(0,0,u);n.effectiveInputs=i.inline.bindings}function et(n){n.startBoardParts&&n.startBoardParts.forEach((function(n){n.inline&&f(n.inline.details,0)}));n.commandsCatalog&&n.commandsCatalog.forEach((function(n){f([n.details],4)}));n.commandGroups&&n.commandGroups.forEach((function(n){n.commands&&n.commands.forEach((function(n){f([n.details],4)}))}))}function ot(n){n.lenses&&n.lenses.forEach((function(t){t.partInstances&&t.partInstances.forEach((function(t){t.inline&&(t.parameterProvider&&k(t.inline),f(t.inline.details,0));st(n,t.name,t)}))}))}function f(n,t){n&&n.filter((function(n){return n&&!!n.parameterCollector})).forEach((function(n){u.addCallerBindings(n.parameterCollector+".bladeCaller",n,t)}))}function k(n){n.editScopeType=n.editScopeType||"PDLEditScope";n.inputs=n.inputs||[];n.inputs.push(h);u.addCallablePartInputs(n)}function st(n,t,i){if(i.parameterProvider&&(n.attributes|=1,u.addCallableBindings(c+".bladeCallable",n,t,i),n.actionBar)){n.actionBar.bindings=n.actionBar.bindings||[];var r=n.actionBar.bindings.some((function(n){return n.property==="input"}));r||n.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:0,part:t,property:c+".defaultActionBarInput"}]});n.templateBlade||(i.inline||i.reference).bindings.push({property:h,valuesFrom:[{referenceType:2,property:"content.output"}]})}}function ht(n){var i=n.templateBlade,f=i.isV2,o=i.isV2?9:i.partSize||8,r=s(n.name,n,i.htmlTemplate,i.htmlTemplateInline,o,i.partState,i.parameterProvider,i.styleSheets,n.permissions,null,f),u,e;n.lenses=n.lenses||[];n.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[r]});n.locked=!0;f&&(n.style=8);u=r.inline;t(u,n.inputs,n.templateKeyInputs);t(u,n.optionalInputs,[],!0);e=n.effectiveInputs=u.bindings;n.outputs&&n.outputs.forEach((function(t){n.bindings=n.bindings||[];n.bindings.push({property:t,valuesFrom:[{referenceType:0,property:"content."+t,part:r.name}]})}));n.editScopeType&&e.push({property:"editScopeId",valuesFrom:[{referenceType:1,property:"editScopeId"}]});n.actionBar&&(n.actionBar.source={valuesFrom:[{referenceType:0,part:r.name,property:"content.actionBar"}]});n.toolbar&&(n.toolbar.source={valuesFrom:[{referenceType:0,part:r.name,property:"content.commandBar"}]});u.details=i.details}function ct(n,t){var i=t.reference,u,r,f;i&&(u=i.partTypeName===tt&&(i.extension===l||!i.extension&&n.name===l),u&&(r=i.bindings,f=r.first((function(n){return n.property===a})),f||(r.push({property:a,valuesFrom:[{referenceType:9,property:v}],optional:!0}),t.inputDefinitions.push({name:v,type:nt.TimeRangeValueType,optional:!0}))))}var d=i.Base.Constants.BladeParameterNames,lt=i.Extension,g=i.Parts,e=g.PartKind,nt=i.Composition.Configuration,h="internal_parameterProviderActionBarOutput",c="content.parameterProvider",o=i.isDevelopmentMode?1:0;n.PinPrefix="InferredBladePinPart";n.PinVMPrefix="Shell."+n.PinPrefix;n.collisionPrefix="inferredBladePinPartInputs.";var l="Microsoft_Azure_Insights",tt="MetricsSummaryPart",a="timeRange",v="_msPortalFxTimeRange";n.preprocessDefinition=it;n.processPart=w;n.processBlade=b})(f||(f={})),f}));
define("MsPortalImpl/Extension/Extension.Definition.Locator",["require","exports","f","i","o","ko","Fx/ResourceManagement","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionPreprocessor"],(function(n,t,i,r,u,f,e,o,s){"use strict";function a(n,t){for(var u=[],i=n,r;i;)u.unshift(i.getCacheKeyPart()),i=i.parent;return r=u.join("-"),t?r:r.toLowerCase()}function ft(n,t){for(var r=[],i=n;i;)r.unshift(i.getCacheFriendlyKeyPart(t)),i=i.parent;return r.join(t)}function d(n,t,i){return t.definition.partTypeMap[i.toLowerCase()]}function w(n,t){var i="<InvalidJsonString>";try{i=JSON.stringify(t)}catch(r){}return rt.error("{0} JSON: {1}".format(n,i)),c.forExtension("##ErrorDeserializingLocator##-{0}".format(i))}function et(n,t,i){var r=e.ArmId.parse(t).resourceType;return nt(n,r,i)}function nt(n,t,i){var u=t.toLowerCase(),r=n.getExtensions().some((function(n){var r=n.getManifest("assetTypes"),t=r&&r.assetTypes.first((function(n){return n.resourceType&&n.resourceType.resourceTypeName&&n.resourceType.resourceTypeName.toLowerCase()===u&&n.browseType!==3}));return t&&(i.extensionName=n.name,i.value=t),!!t}));return r||(i.error="Unable to locate extension for resource type '{0}'.".format(t),i.value=null),r}var v,y,c,p,g,tt;u.defineProperty(t,"__esModule",{value:!0});var l=r.Extension,b=i.Base.Constants,it=i.Base.Diagnostics,ot=i.Extension,h={extensionNotFound:"Unable to locate extension '{0}'.",bladeNotFound:"Unable to locate blade '{0}' in extension definition.",actionBarNotFound:"Unable to locate action bar '{0}' in extension definition.",partInstanceNotFound:"Unable to locate part instance '{0}' in extension definition.",partTypeNotFound:"Unable to locate part type '{0}' in extension definition.",commandTypeNotFound:"Unable to locate command type '{0}' in extension definition.",lensNotFound:"Unable to locate lens '{0}' in extension definition.",assetTypeNotFound:"Unable to locate asset type '{0}' in extension definition.",commandGroupNotFound:"Unable to locate command group '{0}' in extension definition.",commandNotFound:"Unable to locate command '{0}' in extension definition.",hubNotFound:"Unable to locate hub '{0}' in extension definition."},rt=it.createLog(n),ut="{0} Search path:'{1}'.",k=(function(){function n(n){this.extensionManager=n}return n})();t.LocatorContext=k,(function(n){n[n.Extension=0]="Extension";n[n.Blade=1]="Blade";n[n.Lens=2]="Lens";n[n.AssetType=3]="AssetType";n[n.CommandGroup=4]="CommandGroup";n[n.PartInstance=5]="PartInstance";n[n.PartType=6]="PartType";n[n.StartboardPartInstance=7]="StartboardPartInstance";n[n.BladeActionBar=8]="BladeActionBar";n[n.Command=9]="Command";n[n.ExtensionManifest=10]="ExtensionManifest";n[n.Hub=11]="Hub";n[n.CustomLens=12]="CustomLens";n[n.CommandType=13]="CommandType";n[n.BladeRedirect=14]="BladeRedirect";n[n.PartInstanceRedirect=15]="PartInstanceRedirect";n[n.PartTypeRedirect=16]="PartTypeRedirect"})(v=t.LocatorTypeMap||(t.LocatorTypeMap={}));y=(function(n){function t(t,i,r){var u=n.call(this,r)||this;return u.source=i,u.data=t,u}return __extends(t,n),t})(i.Errors.Error);t.LocatorError=y;c=(function(){function n(n,t,i,r,u,f,e){this.type=n;this.name=t;this.parent=u;this.enumerate=i;this.getValue=f;this.getValueAsync=e;this.errorMessageFormat=r}return n.forExtensionManifest=function(n){return new p(10,n,function(n){return n.extensionManager.getExtensions()||[]},h.extensionNotFound)},n.forExtension=function(n){return new p(0,n,function(n){return n.extensionManager&&n.extensionManager.initializedExtensions},h.extensionNotFound)},n.fromJSON=function(t,i){var r;if(!i||typeof i!="object")return w("Locator object is invalid.",i);var u=i.parent?n.fromJSON(t,i.parent):null,f=v[i.type],e="with{0}".format(f);if(!u&&i.type!==0&&i.type!==10)return w("Locator with name '{0}' has no parent.".format(i.name),i);switch(i.type){case 0:return r=t.resolveExtensionName(i.name),n.forExtension(r);case 10:return r=t.resolveExtensionName(i.name),n.forExtensionManifest(r)}return e in u?u[e](i.name):w("Unknown locator type: {0}.".format(f),i)},n.prototype.getCacheKeyPart=function(){return"["+this.type+"]"+this.name},n.prototype.getCacheFriendlyKeyPart=function(n){return n===void 0&&(n="/"),""+v[this.type]+n+this.name},n.prototype.withBlade=function(t){return new n(1,t,undefined,h.bladeNotFound,this,function(n,t,i){return t.definition.bladeMap[i.toLowerCase()]},function(n,i){return i.getBladeDefinition(t)})},n.prototype.withPartInstance=function(t){return new n(5,t,function(n,t){return t.partInstances},h.partInstanceNotFound,this)},n.prototype.tryLocate=function(n,t,i){var u=a(this),f,r={},o=!1,e,s;return t.hasOwnProperty(u)||(this.parent&&this.parent.tryLocate(n,t,r),(!this.parent||r.value)&&(this.getValue?(e=this.getValue(n,r.value,this.name),e!==undefined&&(t[u]=e)):(s=this.enumerate(n,r.value),this._fillCacheFromArray(t,s)))),f=t[u],f?(i.value=f,o=!0):(i.error=ut.format(this.errorMessageFormat.format(this.name),this.toString()),r.error&&(i.error=r.error+"\n"+i.error)),o},n.prototype.locateAsync=function(n,t,i){var r=this,u={},f,e;return this.tryLocate(n,t,u)?Q(u.value):(f=void 0,e=this.parent,f=e?e.locateAsync(n,t,i||this):Q(),f.then((function(f){if(r.tryLocate(n,t,u))return u.value;if(r.getValueAsync)return r.getValueAsync(n,f,i||r);throw new y(r.type,r.toFriendlyString(),u.error);})).then((function(){if(r.tryLocate(n,t,u))return Q(u.value);throw new y(r.type,r.toFriendlyString(),u.error);})))},n.prototype._fillCacheFromArray=function(n,t){var i=f.toJS(this);t&&t.forEach((function(t){i.readFromIdentifiable(t);var r=a(i);n[r]=t}))},n.forPartInstanceRedirect=function(t,r,u,f,e){var o=t.getPartRedirect(5,r,u,f,e);return new n(15,o.key,undefined,h.assetTypeNotFound,undefined,function(){return o.definition&&i.extend({name:o.key},o.definition)})},n.forPartTypeRedirect=function(t,r,u){var f=t.getPartRedirect(4,r,u);return new n(16,f.key,undefined,h.assetTypeNotFound,undefined,function(){return f.definition&&i.extend({name:f.key},f.definition)})},n.forBladeRedirect=function(t,r,u){var f=t.getBladeRedirect(r,u);return new n(14,f.key,undefined,h.assetTypeNotFound,undefined,function(){return f.definition&&i.extend({name:f.key},f.definition)})},n.prototype.withBladeActionBar=function(t){return new n(8,t,function(n,t){return t.actionBar?[t.actionBar]:[]},h.actionBarNotFound,this)},n.prototype.withStartboardPartInstance=function(t){return new n(7,t,function(n,t){return t.definition.startBoardParts},h.partInstanceNotFound,this)},n.prototype.withPartType=function(t){return new n(6,t,undefined,h.partTypeNotFound,this,d,function(n,r){if(i.startsWith(t,s.PinPrefix)){var u=t.substr(s.PinPrefix.length);return r.getBladeDefinition(u).then((function(){return d(n,r,t)}))}return r.getPartDefinition(t)})},n.prototype.withCommandType=function(t){return new n(13,t,function(n,t){return t.definition.commandsCatalog},h.commandTypeNotFound,this)},n.prototype.withLens=function(t){return new n(2,t,function(n,t){return t.lenses},h.lensNotFound,this)},n.prototype.withCustomLens=function(t){return new n(12,t,function(){return[{name:t,partInstances:[]},]},"N/A",this)},n.prototype.withAssetType=function(t){return new n(3,t,function(n,t){return t.getManifest("assetTypes").assetTypes},h.assetTypeNotFound,this)},n.prototype.withCommandGroup=function(t){return new n(4,t,function(n,t){return t.definition.commandGroups},h.commandGroupNotFound,this)},n.prototype.withCommand=function(t){return new n(9,t,function(n,t){return t.commands},h.commandNotFound,this)},n.prototype.getExtensionLocator=function(){for(var t=this;t.parent;)t=t.parent;return t.type===10?n.forExtension(t.name):t},n.prototype.toString=function(){return a(this,!0)},n.prototype.toFriendlyString=function(n){return n===void 0&&(n="/"),ft(this,n)},n.prototype.equals=function(n){if(this.name&&n&&n.name&&this.name===n.name&&this.type===n.type){if(this.parent)return this.parent.equals(n.parent);if(!n.parent)return!0}return!1},n.prototype.toJSON=function(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}},n.prototype.readFromIdentifiable=function(n){this.name=n.name},n})();t.Locator=c;p=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.getValueAsync=function(n,t,r){var u=r&&{trigger:l.getModule(r.name,r.type)};return n.extensionManager.getExtensionByName(i,u)},f}return __extends(t,n),t.prototype.getCacheKeyPart=function(){var n=l.getWindowId(this);return"[{0}]{1}".format(this.type,n)},t.prototype.getCacheFriendlyKeyPart=function(n){n===void 0&&(n="/");var t=l.getWindowId(this);return"{0}{1}{2}".format(v[this.type],n,t)},t.prototype.equals=function(n){return this.name&&n&&l.isEqualDescriptor(this,n)&&this.type===n.type},t.prototype.readFromIdentifiable=function(n){this.name=n.name},t})(c);t.ExtensionLocator=p;g=(function(){function t(n,t){this._locatorContext=new k(n);this._cache=t||{}}return t.populateCache=function(n,t,i){return n[a(t)]=i,n},t.prototype.locateAsync=function(n,t){return n.locateAsync(this._locatorContext,this._cache,t)},t.prototype.locate=function(t,i){var r={},u=null,f;return this.tryLocate(t,r)?u=r.value:(f=i||t.getExtensionLocator().name,o.logToExtension(n,f,2,r.error)),u},t.prototype.tryLocate=function(n,t){return n.tryLocate(this._locatorContext,this._cache,t)},t})();t.DefinitionFinderImpl=g;t.tryLocateAssetDefinitionFromResourceId=et;t.tryLocateAssetDefinitionFromResourceType=nt;tt=b.BladeNames.Hubs.ResourceMenuBlade;t.hubsLocator=c.forExtension(b.ExtensionNames.Hubs);t.resourceMenu=t.hubsLocator.withBlade(tt)}));
define("MsPortalImpl/Base/Telemetry",["require","exports","f","o"],(function(n,t,i){"use strict";var r;return (function(n){function t(n,t){i.extendArrayIntoMap(n,t)}var r,u,f;(function(n){t(n,["Asset","AzureHomeFeatures","AzureHomeLearnMore","AzureHomeLinks","AzureHomeRecents","Blade","BrowseBlade","BrowseManager","BrowserRefresh","Dashboard","DashboardFilters","Desktop","DirectoryPane","FeedbackPane","FormControl","Gallery","HelpBlade","HelpPane","KeyboardShortcuts","LandingPageSelector","Lens","NotificationHub","PartGallery","Resource","ResourceSummary","Search","Shell","SideBar","StartBoardPart","SettingsBlade","SettingsPane","TileAction","ToastTray","TopBar",])})(r=n.Source||(n.Source={})),(function(n){t(n,["ActionBarClicked","AddPartByDragDrop","AdvisorNotificationShown","AvatarMenuOpenBilling","AvatarMenuOpenFeedback","AvatarMenuOpenAccessDetails","AvatarMenuOpenContactInfo","AvatarMenuSignOut","AvatarMenuSwitchTenant","AzureHomeNavigation","AzureHomeLinkClicked","AzureHomeLoad","AzureHomeRecentsLoad","BannerButtonClicked","BladeClosed","BladeDeepLinkedNotPinnable","BladeLoaded","BladeFullOpened","BladeOpened","BladeFullReady","BladeFullRevealed","BladeReady","BladeRevealed","BladeRebind","BladeLoadErrored","BladeCollapse","MenuCollapse","BreadCrumbClicked","BreadCrumbHomeClicked","BrowseAssetsCollected","BrowseCanceled","BrowseFeedback","BrowseSaved","BrowseStarted","BrowseItemActivated","BrowseRecentItemRemoved","BrowseItemDeactivated","BrowseTypeActivated","BrowseTypeDeactivated","CommandExecuted","ConsoleClosed","ConsoleMaximized","ConsoleMinimized","OpenFileShare","ConsoleOpened","ConsoleRestored","CustomClick","CustomizeModeEntered","CustomizeModeExited","DashboardDiscard","DashboardEditCommandClicked","DashboardPublish","DashboardPublishNew","DashboardSaveACopy","DashboardView","DashboardViewTime","DashboardDelete","DashboardPinPart","DashboardNavigation","DashboardFiltersAdd","DashboardFiltersValueSet","DashboardFiltersRemoved","DashboardFiltersLoaded","DeepLinkVisited","DefaultLandingPageSwitched","DialogClosed","DialogOpened","DirectoryPaneSwitchTenant","DockBlades","ExtensionSignedOut","ExtensionTooManyErrors","ExtensionVersionChanged","FeedbackSmileyClicked","FirstVisited","FormFocused","FormBlurred","GenericFeedback","HashChanged","HelpBladeOpen","HelpMenuOpen","HelpMenuOpenLegal","HelpMenuOpenKeyboardShortcuts","HelpMenuOpenSupportRequest","HelpMenuOpenManageSupportRequest","ManagementPartnerBladeOpen","SearchFeedback","SearchSession","SearchExecuted","SearchAllResourcesExecuted","SearchAllRecentsExecuted","SearchResourceGroupsExecuted","SearchMarketplaceExecuted","SearchResultOpened","JourneyDeactivated","JourneyOpened","JourneyScroll","KeyboardShortcutExecuted","LandingPageNavigation","LandingPageSelectorShows","LinkClicked","NPSDismissed","NPSScoreClicked","NPSShown","NPSSubmitted","NPSOpenSurvey","OnInputsSetResolved","Opened","ShellVersionChanged","SideBarLoaded","SideBarBrowseMenuOpened","SideBarBrowseMenuViewInitialized","SideBarBrowseMenuViewChanged","SideBarFavorite","SideBarFavoriteMoved","SideBarItemOpened","SideBarNewMenuOpened","SideBarUnFavorite","SideBarViewChanged","PartClick","PartGalleryLearnRelatedResources","PartGalleryOpenRelatedResources","PartGalleryStart","PartGalleryItemsLoaded","PartLoaded","PartLoadedNoExtensionDerived","PartPosition","PartReady","PartRevealed","PartErrored","PartMigrated","PartUpdated","PortalInitializeLanguage","PortalInitializeWelcome","PortalRedirect","RelexDisconnected","RelexOnReloadSet","ResourceSummaryCopyProperty","ResourceSummaryAction","RestoreJourney","ResultOpened","NotificationClicked","RecommendationClicked","RecommendationSurfaced","RecommendationAdded","Redirect","RotateTheme","SelectedTheme","SelectedHighContrastMode","SeeAll","SettingsBladeOpen","SettingsBladeSwitchLanguage","SettingsBladeSwitchRegionalFormat","SettingsBladeSwitchTheme","SettingsBladeToggleNotificationToasts","SettingsBladeToggleRelex","SettingsBladeToggleCommandLabels","SettingsBladeRestoreDefaults","SettingsPaneDeleteSettings","SettingsPaneOpen","SettingsPaneRedirect","SettingsPaneSwitchLanguage","SettingsPaneSwitchRegionalFormat","SettingsPaneSwitchTheme","SettingsPaneSwitchIdleTimeout","SettingsPaneToggleNotificationToasts","SettingsPaneToggleRelex","SettingsPaneToggleDblClickTheme","SettingsPaneToggleCommandLabels","SettingsPaneRestoreDefaults","StackLayoutMoveNext","StackLayoutMovePrevious","StartBoardPartLoaded","StartButtonClicked","StartFileDownload","TileActionClicked","ToastClicked","UnhandledExtensionError","UnknownNetworkError","HelpPaneOpen","HelpPaneFeedback","HelpPaneRequestContent","HelpMenuOpenWelcomeSequence","WhatsNewBladeOpen","UpdateContactabilityClose","UpdateContactabilityOpened","UpdateContactabilityPrivacyPolicyClick","UpdateContactabilityUpdateEmailClick",])})(u=n.Action||(n.Action={})),(function(n){t(n,["Default","Failed","Redirect","Succeeded","FailedToGetBlade","FailedPreCheck","FailedToLoadExtension","FailedInvalidUIDefinition","Search","StartBoardRestored","JourneyRestored","PortalScrolled",])})(f=n.ActionModifier||(n.ActionModifier={}))})(r||(r={})),r}));
define("MsPortalImpl/UI/UI.AuthStateManager",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e){"use strict";function c(n,t){return(n&t)===t}function d(n,t){var i=r.mapValues(t,(function(n){if(n.flags&16){var t=n.features,i=(t&&t.allowedUserInfo||"").toLowerCase();return w[i]||0}}));a.getUserInfoEndPoint.register(s.client,null,(function(t,r){return n.getUserInfo(i[r.srcWindowId])}))}function g(){if(!o){var n=Q.defer();l.updateSubscriptionInfoEndPoint.register(s.client,[y],(function(t){n.resolve(t)}));o=n.promise}return o}var w,o;u.defineProperty(t,"__esModule",{value:!0});var s=r.Rpc,l=HubsExtension.Internal.Azure,a=r.Extension,b=r,v=window,h=v.fx.environment.bootstrapAuthorizationKey;t.hasFlag=c;t.Internal={};var y=a.getHubsWindowId(),k={isAnonymous:!0},p=(function(){function n(n){var t=this;this.bootstrapState=n;this.persist=function(){t.bootstrapState&&MsPortalImpl.sessionStorage.setItem(h,JSON.stringify(t.bootstrapState))}}return n.prototype.persistentRefreshToken=function(n){this.bootstrapState&&MsPortalImpl.localStorage.setItem(h,JSON.stringify({refreshToken:this.bootstrapState.refreshToken,aadSessionId:this.bootstrapState.aadSessionId,user:this.bootstrapState.user,tenantId:n}))},n.prototype.clear=function(n){n||(this.bootstrapState=null);MsPortalImpl.localStorage.removeItem(h)},n.prototype.getUserInfo=function(n){var t=this;return this.getTenants().then((function(r){var u=t.getCurrentUser(),f=u.tenantId||"",y=r.tenants,v=new i.Map,o=f,h=f,l=f,a,s;return y.forEach((function(n){f.toLowerCase()===(n.id||"").toLowerCase()?(o=l=n.displayName,h=n.domainName):v.set(n.displayName.toLocaleLowerCase(),!0)})),v.has(o.toLocaleLowerCase())&&(l=e.Services.PortalIdentity.tenantNameAndDomainFormat.format(o,h)),a=i.isNullOrUndefined(n)?7:n,s={},c(a,3)&&i.extend(s,{email:u.emailAddress,givenName:u.firstName,surname:u.lastName}),c(a,4)&&i.extend(s,{directoryId:u.tenantId,directoryName:o,domainName:h,isOrgId:u.isOrgId,objectId:u.objectId,principalId:u.principalId,uniqueDirectoryName:l,isTenantAdmin:u.isTenantAdmin}),s}))},n.prototype.getTenants=function(){var r=this.getCurrentUser(),n;return t.Internal.tenantsPromise||(n=Q.defer(),l.updateTenantInfoEndPoint.register(s.client,[y],(function(t){n.resolve(t.tenantInfo)})),t.Internal.tenantsPromise=n.promise),i.tryImmediateResolve(t.Internal.tenantsPromise,(function(n){var t=n.tenants.first((function(n){return(n.id||"").toLowerCase()===(r.tenantId||"").toLowerCase()})),i=r.tenantDomain;return t&&(t.displayName||(t.displayName=i),t.domainName||(t.domainName=i)),n}))},n.prototype.getSignedInUserTenant=function(){return this.getCurrentUser().tenantDomain||""},n.prototype.getCurrentUser=function(){return this.bootstrapState&&this.bootstrapState.user||k},n.create=function(){return Q(v.fx.early.authBootstrapStatePromise).then((function(t){return new n(t)}))},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",u)],p,"create",null);t.AuthStateManager=p;w={directory:4};b.registerGlobalState({reset:function(){o=null}});t.initializeRpc=d;t.getSubscriptions=g}));
define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/UI/UI.AuthStateManager"],(function(n,t,i,r,u,f,e){"use strict";var c,v;u.defineProperty(t,"__esModule",{value:!0});var o=i.Base,p=o.Net2,it=o.Constants,w=o.Diagnostics,b=w.Telemetry,rt=o.Resources,ut=o.Security,ft=r.Security,k=it.Shell,l=w.createLog(n),d=rt.getAppRelativeUri("/api/DelegationToken"),et=d+"?feature.tokencaching="+i.isFeatureEnabled("tokencaching"),ot=d+"?feature.tokencaching=false",s=ft.tokenErrors,h="",g=s.unknown,nt=s.sessionEnded,y=s.credentialsExpired,st=s.networkError,ht=s.nullToken,a=Date.now,ct=(function(){function n(){}return n.prototype.getToken=function(n){var r={extensionName:n.extensionName,resourceName:n.resourceName,tenant:n.tenant,portalAuthorization:n.portalAuthorization},u=b.start({source:"Services.SecurityTokens",action:"Get",name:n.extensionName}),t,f=n.skipCache?ot:et;return Q(p.postJSON({uri:f,dataType:"json",setAuthorizationHeader:!1,performRetry:!0},r)).catchError(i.Errors.AjaxError,(function(i){return t="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n.extensionName,n.resourceName,i.jqXHR.status,i.textStatus,i.errorThrown),Q.reject(i)})).finally((function(){b.endTrace(u,!t,{error:t,resourceName:n.resourceName,skipCache:n.skipCache})}))},n})(),tt=(function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n){var t=this;return this._pendingAuthorization.then((function(i){var r=t._client.getToken({extensionName:n.extensionName,tenant:t._tenant,resourceName:n.resourceName||h,portalAuthorization:i,skipCache:n.skipCache}).catch((function(n){var r=n.data||{},t=r.status,u;return u=t===401?y:t?g:st,{portalAuthorization:i,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".format(t,r.statusText,n.message,n.stack||"")}}}));return t._pendingAuthorization=r.then((function(n){return t._refreshToken=n.portalAuthorization||i})),r}))},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();t.OAuthTokenProviderImpl=tt;c=(function(){function n(){}return n.create=function(n){var t;return n.bootstrapState.refreshToken&&(t=new tt(new ct,n.bootstrapState)),t},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e.AuthStateManager]),__metadata("design:returntype",c)],c,"create",null);t.OAuthTokenProvider=c;v=(function(){function n(n,t){var e=this;this._authStateManager=n;this._tokenProvider=t;this.sessionEndedHandler=i.noop;this.tokenFailedHandler=i.noop;this._sessionEnded=!1;var r=n.bootstrapState||{},u=r.oAuthToken,o=r.refreshToken,f=r.createdOn||a();o&&(this.shellTokenCache=this._createShellTokenCache(u,f));this.getTokenFunc=this.shellTokenCache?function(n){return e.shellTokenCache.getToken(n).then((function(n){return n&&n.header}))}:createTestInProdTokenFunc(u,f);p.initialize(this.getTokenFunc)}return n.prototype.isSessionEnded=function(){return this._sessionEnded},n.prototype.getDiagnosticsData=function(){return this._tokenProvider.getDiagnosticsData()},n.prototype.getToken=function(n,t,i,r){var u=this,o=this.shellTokenCache,f=a(),e=1,s=function(){return u._tokenProvider.getToken({extensionName:n,resourceName:t,isBackground:i,skipCache:r}).then((function(c){var w=c&&c.value||{},v=w?w.error:ht,b=w.errorMessage,p,d,tt,rt,it;if(!v&&w.authHeader)if(d=a(),p=f+w.expiresInMs,p<=d)if(e>3)l.error("Unable to get token after {0} retry attempts. Ending session.".format(e)),v=y;else return l.warning("Token fetch took longer than token lifetime, retrying operation. Retry attempt: {0}, Token expiration: {1}, Current time: {2}".format(e++,p,d),null,{extensionName:n,resourceName:t,isBackground:i,skipCache:r}),s();else return{token:{header:w.authHeader,expiresAt:p}};return tt=v===y,(v===nt||tt)&&(u._sessionEnded=!0,tt||!o?p=f:(rt=n===k?t:h,p=o.getTokenExpiresAt(rt)),u.sessionEndedHandler(n,p||f)),i||(u.tokenFailedHandler(n,t,b),it="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(n,t,v,b),v===g?l.error(it):l.verbose(it)),{error:v,errorMessage:b}}))};return s()},n.prototype._createShellTokenCache=function(n,t){var i=this,u={},r;return n&&(r=n.expiresInMs||1,u[h]={header:n.authHeader,expiresAt:r>0?t+r:-1}),ut.createAuthTokenCache((function(n){return i._sessionEnded?Q({error:nt}):i.getToken(k,n?n.resourceName:h,n.isBackground,n.skipCache).then((function(t){var u=(t||{}).token;if(!!u&&n.resourceName===h){var f=a(),r=i._authStateManager.bootstrapState||{},e={authHeader:u.header,expiresInMs:u.expiresAt-f,refreshToken:i._tokenProvider.getRefreshToken()||r.refreshToken},o={aadSessionId:r.aadSessionId,refreshToken:r.refreshToken,user:r.user,createdOn:f,oAuthToken:e};i._authStateManager.bootstrapState=o}return t}))}),u)},n})();v=__decorate([f.Class(),__metadata("design:paramtypes",[e.AuthStateManager,c])],v);t.SecurityTokensManager=v}));
define("MsPortalImpl/Services/Services.Storage",["require","exports","f","o","a","Fx/DependencyInjection"],(function(n,t,i,r,u,f){"use strict";function a(){return e.forEach((function(n){var t=o[n.name];t.count=t.keySize=t.valueSize=0})),o}var l,h,c,e,o,s;r.defineProperty(t,"__esModule",{value:!0});l=i.Base.Diagnostics.createLog(n);h=JSON.stringify,(function(n){n[n.DesktopManager=2]="DesktopManager";n[n.AssetMruList=3]="AssetMruList";n[n.ExtensionManager=4]="ExtensionManager";n[n.Router=5]="Router";n[n.UserSettings_Journeys=6]="UserSettings_Journeys";n[n.UserSettings_EditScopes=7]="UserSettings_EditScopes";n[n.Relex=8]="Relex";n[n.ManifestVersions=9]="ManifestVersions";n[n.Redirect=10]="Redirect";n[n.Cdn=11]="Cdn";n[n.UserSettings_NewJourneys=12]="UserSettings_NewJourneys";n[n.Telemetry=13]="Telemetry";n[n.Dashboard=14]="Dashboard";n[n.Avatar=15]="Avatar";n[n.UserSettingsService=16]="UserSettingsService";n[n.HelpContent=17]="HelpContent";n[n.DashboardSession=18]="DashboardSession"})(c=t.ComponentName||(t.ComponentName={}));e=i.getEnumArray(c);o={};e.forEach((function(n){o[n.name]={count:0,keySize:0,valueSize:0}}));s=(function(){function n(){function t(n){return c[n]+"_"}function r(n,i){return t(n)+(i||"")}function n(n){return n===1?f:o}function u(n,t,i){for(var u,r=0;r<n.length;r++)u=n.key(r),t.call(i,n.getItem(u),u,n)}function s(n){var f=a(),t=0,o="",r;u(n,(function(n,r){var c=i.find(e,(function(n){return i.startsWith(r,n.name)})),u,s;c&&(u=f[c.name],u.count++,u.keySize+=r.length,s=h(n).length,u.valueSize+=s,s>t&&(t=s,o=r))}));try{r=h(f)}catch(s){r="Could not stringify the summary. Exception: "+i.getLogFriendlyMessage(s)}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(r,o,t,n.length)}var f=MsPortalImpl.sessionStorage,o=MsPortalImpl.localStorage;this.getValue=function(t,i,u){return n(u).getItem(r(t,i))};this.getAllComponentItems=function(i,r){var f=t(i),o=n(r),e={},s=f.length;return u(o,(function(n,t){if(t.startsWith(f)){var i=t.substring(s,t.length);e[i]=n}})),e};this.setValue=function(t,i,u,f){var o=n(f),h=r(t,i),e;try{o.setItem(h,u)}catch(c){e=new Error("Storage.setItem failed.");e.innerError=c;e.storageState=s(o);e.key=h||i;l.error(e)}};this.clearValue=function(t,i,u){var f=n(u),e=r(t,i),o=f.getItem(e);return f.removeItem(e),o};this.clearAllComponentItems=function(i,r){var o=t(i),f=n(r),e=[];u(f,(function(n,t){t.startsWith(o)&&e.push(t)}));e.forEach((function(n){return f.removeItem(n)}))};this.clearAll=function(){o.clear();f.clear()}}return n})();s=__decorate([f.Class(),__metadata("design:paramtypes",[])],s);t.StorageService=s}));
define("MsPortalImpl/UI/UI.NavigationManager",["require","exports","f","o","FxInternal/Di","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i,r,u,f,e,o){"use strict";function v(n){return function(t){t?o.unhide(n):o.hide(n)}}var h,c;r.defineProperty(t,"__esModule",{value:!0});var l=i.Base,a=l.UriBuilder,y=l.Diagnostics,p=y.Telemetry,w=i.Helpers,b=f.Action,k=f.Source,s=window,d=p.trace,g=i.pathJoin,nt=k.Shell;h=(function(){function n(n,t){this.portal=n;this.splashScreen=t;[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);}));this.showPortal=v(n);this.showSplash=v(t)}return n.create=function(){return new n($(s.document.getElementById("web-container")),$(s.document.querySelectorAll("body>.fxs-splashscreen")))},n.prototype.dispose=function(){this.showPortal(!1)},n})();__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",h)],h,"create",null);t.RootElements=h;c=(function(){function n(n,t){var u=this,r;this.unloadCallbacks=[];this.unloadCallbacks.push(n.persist);r=function(){u.unloadCallbacks.forEach((function(n){return n()}))};s.addEventListener("unload",r);this.location=s.location;this.redirect=function(i){var r=i.uri,o=w.Deferred(),e;t.showSplash(!0);d({source:nt,action:b.PortalRedirect,actionModifier:f.ActionModifier.Redirect,data:r});e=function(){o.resolve()};i.skipFlushBuffers?e():(Q.all(u.unloadCallbacks.map((function(n){return n()}))).finally(e),s.setTimeout(e,5e3));Q.allSettled([i.delayPromise,o]).finally((function(){if(!r){var t=new a(location.href);t.path=g("/",t.path,n.getCurrentUser().tenantId,"/");r=t.toString()}location.href=r}))};this.openWindow=function(t){var r=s.open();return Q(t).then((function(t){var f;if(t){var u=new a(t),e=u.path,o=i.ensureSuffix(e,"/");i.localeCompareIgnoreCase(o,i.ensureSuffix(location.protocol+"//"+location.host,"/"))||(f=u.fragment,f.startsWith("#@")||(u.fragment="#@"+n.getSignedInUserTenant()+(f[0]==="#"?"/"+f.slice(1):""),t=u.toString()))}r.location.href=t}))};this.dispose=function(){s.removeEventListener("unload",r)}}return n})();c=__decorate([u.Class(),__metadata("design:paramtypes",[e.AuthStateManager,h])],c);t.WindowManager=c}));
define("MsPortalImpl/Services/Services.Settings",["require","exports","f","i","o","FxInternal/Di","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/UI/UI.NavigationManager"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function ft(n){return function(t){this[t]=n}}function ht(){return i.map(a,i.identity)}function ct(n){return y[n+1e3]}function lt(n){return a[n]}function at(n,t){if(!t||!t.length)return Q({});var i=t.map((function(t){return n.queryStore(t)}),n);return Q.all(i).then((function(n){var i={};return n.forEach((function(n,r){i[t[r]]=n})),i}))}function vt(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function d(n){return JSON.parse(JSON.stringify(n))}function ut(n){var t=[n?n.flushSettings():Q(),nt.Telemetry.flush(),nt.Upload.flush(),],i=t.every((function(n){return!n||Q.isPromise(n)?!Q.isPending(n):n.state()!=="pending"}));return i?Q():Q.all(t)}var a,y,p,w;u.defineProperty(t,"__esModule",{value:!0});var c=i.Base,g=c.Net2,nt=i.Base.Diagnostics,b=i.tryImmediateResolve;var et=window,tt=et.fx,k=tt.environment,v=k.settingsBaseUri+"{0}"+k.settingsUriQuery,it=v.format("/Update"),rt=v.format("/Select"),ot=v.format("/Clear"),st=v.format("/ClearAll"),l=c.Diagnostics.createLog(n);c.getVersionFromString(k.version).revision=0;a={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,JourneySession:8,EditScopeSession:9,Favorites:10,DashboardInventory:11,FileUpload:12,FirstVisited:14,StartupNotifications:15};y=i.forEachKey(a,(function(n,t,i){i[t]=n}),[]),(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+n,i=n+1e3,a[t]=i,y[i]=t})();t.getAllStoreIds=ht;t.getDashboardStoreName=ct;t.getDashboardStoreId=lt;t.queryStores=at,(function(n){function nt(n,t,i,r){return new w(new s(n,new f(e.createWithWriteDeleteBufferTimeout(t,r),i)))}function t(n){var t=y[n];if(!t)throw new Error("Invalid store: "+n);return t}function h(n,r){return i.forEachKey(r,(function(i,r,u){var f=t(i);u[f]=r;n&&delete n[f]}),{})}function a(n){var i={},t;return n.keys.forEach(ft(null),i),t={},t[n.store]=i,t}function tt(n,t){var f=i.merge(n,t),r={settingsToSet:{},settingsToDelete:{}};return r=f.reduce((function(n,t){return u(n.settingsToSet,n.settingsToDelete,t.settingsToSet),u(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function u(n,t,r){i.forEachKey(r,(function(u){var f=parseInt(u),o=r[f],e;n&&(n[f]||(n[f]={}),v(o,n[f]));t&&(e=t[f],e&&(p(o,e),i.isEmpty(e)&&delete t[f]))}))}function v(n,t){i.forEachKey(n,(function(n,i){t[n]=i}))}function p(n,t){i.forEachKey(n,(function(n){delete t[n]}))}var k,f,d,e,s;n.createUserSettingsManager=nt;n.getSettingStoreName=t;n.convertSettingQueryToDictionary=a;n.updateDictionary=u;n.updateSettingsDictionary=v;n.sanitizeSettingsDictionary=p;k=(function(){function n(){this._maps={}}return n.prototype.setSettings=function(n){i.forEachKey(n.settings,(function(n,t,i){i.set(n,JSON.stringify(t))}),this._getMap(n.store))},n.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach((function(n,i){t[i]=JSON.parse(n)})),Q(t)},n.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},n.prototype.clearSettings=function(){return Q(this._maps={})},n.prototype.flushSettings=function(){return Q()},n.prototype.dispose=function(){},n.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},n})();n.InMemorySettingsManagerImpl=k;f=(function(){function n(n,t){var i=this;this._baseManager=n;this._managersDictionary={};this._managers=[this._baseManager];t&&t.forEach((function(n){i._managers.push(n.manager);n.stores.forEach((function(t){i._managersDictionary[t]=n.manager}))}))}return n.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},n.prototype.deleteSettings=function(n){this._getManager(n.store).deleteSettings(n)},n.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},n.prototype.clearSettings=function(){return Q.all(this._managers.map((function(n){return n.clearSettings()})))},n.prototype.flushSettings=function(){return this._baseManager.flushSettings()},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager},n})();n.RoutingSettingsManager=f;d=(function(){function n(n,t,r){var u=this;this._ajaxState=0;this._memoizedQueryStore=i.memoizeQ((function(n){var t=i.startTimer();return u._ajax(rt,[n]).then((function(i){u._setAjaxState(1);var f=i&&i.content&&i.content[n]||{},r=t();return r>5e3&&l.warning("Request to store '"+n+"' took more than 5s to complete.\n                                                    Request time: "+r+"ms.\n                                                    Response size: "+(i&&i.jqXHR&&i.jqXHR.responseText.length)),f})).catch((function(n){return u._setAjaxState(2,n,"queryStore(duration:"+t()+")"),Q({})}))}));this._clearAllUserSettings=n.isEnabled("clearallusersettings");this._storageService=t;this._preloadingStores=Q(r).then((function(n){return u._setAjaxState(1),n&&n.settings||{}}),(function(n){return i.Helpers.isXMLHttpRequestLike(n)&&g.isRetryable(n)||l.error(new i.Errors.Error({message:"Early Failed to preload stores.",innerErrors:n}),1),{}}));this._preloadingStores.then((function(n){u._preloadStores=i.forEachKey(n,(function(n,t,i){t&&(i[n]=Q(t))}),{});u._preloadingStores=null}))}return n.prototype._ajax=function(n,t){var u=this;return!t&&(n===it||n===rt)?Q.reject(r.createError("Invalid setting ajax call uri: "+n+", data: "+i.getObjectDescriptor(t))):Q(g.ajaxExtended({uri:n,headers:{"x-ms-user-settings-session":this._storageService.getValue(o.ComponentName.UserSettingsService,"x-ms-user-settings-session",1)||""},type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",performRetry:!0})).then((function(n){return u._storageService.setValue(o.ComponentName.UserSettingsService,"x-ms-user-settings-session",n.jqXHR.getResponseHeader("x-ms-user-settings-session"),1),n})).catchError(i.Errors.AjaxError,(function(r){return r.jqXHR.status===400?l.error("Setting _ajax 400 occurred. uri: "+n+", data: "+i.getObjectDescriptor(t,!0)+"."):r.jqXHR.status>=500&&l.error("Setting _ajax 5xx occurred. uri: "+n+", response: "+r.jqXHR.responseText+"."),Q.reject(r)}))},n.prototype._setAjaxState=function(n,t,r){n>this._ajaxState&&(this._ajaxState=n,n===2&&l.error(new i.Errors.Error({message:r+" Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.",innerErrors:t})))},n.prototype.queryStore=function(n){var r=this,i=t(n);return this._ajaxState>=2?Q({}):this._preloadingStores?this._preloadingStores.then((function(n){return n[i]||r._memoizedQueryStore(i)})):this._preloadStores[i]||this._memoizedQueryStore(i)},n.prototype.clearSettings=function(){var n=this,t;return i.forEachKey(this._preloadStores,(function(t){delete n._preloadStores[t]})),this._memoizedQueryStore.clear(),t=i.startTimer(),this._ajax(this._clearAllUserSettings?st:ot).catch((function(i){n._setAjaxState(2,i,"clearSetting(duration:"+t()+"):")}))},n.prototype.updateSettings=function(n){var u=this,t,r;return this._ajaxState===1&&(t={save:h(this._preloadStores,n.settingsToSet),remove:h(this._preloadStores,n.settingsToDelete)},t.save||t.remove)?(r=i.startTimer(),this._ajax(it,t).catch((function(n){return u._setAjaxState(2,n,"updateSettings(duration:"+r()+"):"),Q.reject(n)}))):Q()},n})();n.UserSettingsManagerImpl=d;e=(function(){function n(n,t,i,r){var u=this;this._primitiveSettingsManager=n;this._sequencer=t(tt,(function(n){return u._executeMethod(n[0])}),i,!0,{optionalDataInterval:r})}return n.createWithWriteDeleteBufferTimeout=function(t,i,r){var u=i!==undefined?i:5e3,f=r!==undefined?r:3e5;return new n(t,function(n,t,i,r,u){return new c.Debouncer(n,t,i,r,u)},u,f)},n.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},n.prototype.setSettings=function(n,t){if(!i.isEmpty(n.settings)){var r={};r[n.store]=n.settings;this._sequencer.execute([{settingsToSet:r,settingsToDelete:{}}],t===1)}},n.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:a(n),settingsToSet:{}}],t===1)},n.prototype.flushSettings=function(){return this._sequencer.flush()},n.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function(){t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},n.prototype.dispose=function(){this.flushSettings()},n.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},n})();n.SequencingSettingsManager=e;s=(function(){function n(n,t){var r=this;this._cache={};this._activeUpdatePromises=new i.Map;this._uniqueId=1;this._memoizedQueryPromises=i.memoizeQ((function(n){var t=r._verifySettings()?r._baseManager.queryStore(n):Q({});return b(t,(function(t){return r._updateCaches(n,t)}))}));this._useInMemorySettings=n.isEnabled("inmemorysettings");this._baseManager=t}return n.prototype.queryStore=function(n){return this._memoizedQueryPromises(n)},n.prototype.setSettings=function(n,t,i){this._execute(this._setSettingsInternal,n,t,i)},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype._setSettingsInternal=function(n,t,i,r){var f=this,e=this._writeSettingsToCache(n,!0),u=function(){f._baseManager.setSettings(e,t)};r?(u(),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed(u,i)},n.prototype._resolveSetPromise=function(n){var t=this._activeUpdatePromises.get(n);t&&(t.resolve(),this._activeUpdatePromises.delete(n))},n.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;this._activeUpdatePromises.set(e,Q.defer());t&&(u=t.store,f=function(){n.call(o,t,i,e,r)},this._cache[u]?f():b(this.queryStore(u),f))},n.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},n.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){r._baseManager.deleteSettings(n,t)}),i)},n.prototype.clearSettings=function(){var n=this,t=Q.defer();return this.flushSettings().finally((function(){return Q(n._baseManager.clearSettings()).finally((function(){n._cache={};n._memoizedQueryPromises.clear();t.resolve()}))})),t.promise},n.prototype.flushSettings=function(){var t=this,n=[];return this._activeUpdatePromises.forEach((function(t){return n.push(t)})),Q.all(n).then((function(){return t._baseManager.flushSettings()}))},n.prototype._updateCaches=function(n,t){return this._writeSettingsToCache({store:n,settings:t}),this._cache[n]},n.prototype._verifySettings=function(){return this._useInMemorySettings?!1:!0},n.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){n();this._resolveSetPromise(t)},n.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},n.prototype._writeSettingsToCache=function(n,t){if(n){var r=this._cache[n.store]||(this._cache[n.store]={}),u={};return i.forEachKey(n.settings,(function(n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=u[n]=i)})),{store:n.store,settings:u}}return null},n})();n.CachingSettingsManagerImpl=s})(p=t.Internal||(t.Internal={}));w=(function(){function n(n){this._baseManager=n}return n.prototype.deleteSettings=function(n,t){this._baseManager.deleteSettings(n,t)},n.prototype.clearSettings=function(){return this._baseManager.clearSettings()},n.prototype.flushSettings=function(){return this._baseManager.flushSettings()},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype.queryStore=function(n,t){return b(this._baseManager.queryStore(n),(function(n){return t?n:d(n)}))},n.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=t[n]}))),d(i)})):this.queryStore(n.store)},n.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},n.prototype.setSettings=function(n,t){this._baseManager.setSettings(d(n),t)},n.prototype.setSetting=function(n,t,i,r){this.setSettings(vt(n,t,i),r)},n.create=function(n,t,i){var e={manager:new p.InMemorySettingsManagerImpl,stores:[8,9,13,]},u=n.isEnabled("day0settings"),f=tt.early,r=p.createUserSettingsManager(n,new p.UserSettingsManagerImpl(n,t,!u&&f&&f.preload),[e]);return i.unloadCallbacks.push((function(){return ut(r)})),u?r.clearSettings().then((function(){var n=new c.UriBuilder(i.location.href);return n.query.removeParameters(["day0settings","feature.day0settings"]),i.redirect({uri:n.toString(),skipFlushBuffers:!0}),Q.defer().promise})):r},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.Features,o.StorageService,h.WindowManager,s.SecurityTokensManager]),__metadata("design:returntype",u)],w,"create",null);t.SettingsManager=w;t.flush=ut}));
define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports","f","i","o","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f){"use strict";function s(n,t,i,o,s,h){var l=new r.TriggerableLifetimeManager,v=e.startTrace({source:f.Source.Shell,action:s}),c={},a=u.keys(i);return a.forEach((function(n){c[n]=0;i[n].subscribe(l,(function(i){c[n]!==1&&(c[n]=3,t.setSetting(o,n,i),h&&t.flushSettings())}))})),t.queryStore(o).then((function(n){n=n||{};a.forEach((function(t){var r=n[t];r!==undefined&&c[t]===0&&(c[t]=1,i[t](r),c[t]=2)}));e.completeTrace(v)})).then((function(){return new n(i,function(){return t.flushSettings()},function(){return l.dispose()})}))}u.defineProperty(t,"__esModule",{value:!0});var e=i.Base.Diagnostics.Telemetry,o=(function(){function n(n,t,i){this.value=n;this.flush=t||function(){return Q()};this.dispose=i||function(){}}return n})();t.SettingsProcessor=o;t.create=s}));
define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;u.defineProperty(t,"__esModule",{value:!0});var l=window,a=0,v="InitializeGeneralSettingsInternal",c=(function(n){function t(t,i,u){var o=n.call(this,t,i,u)||this,f="#blade/HubsExtension/BrowseAll",e="#blade/HubsExtension/Resources/resourceType/Microsoft.Resources%2Fresources";return t.optIntoNewBrowse.subscribe(new r.TriggerableLifetimeManager,(function(){var n=l.location.hash||"";(n===f||n===e)&&(l.location.hash=t.optIntoNewBrowse()?f:e)})),o}return __extends(t,n),t.create=function(n,i){var u=new h;return i.registerObjectFactory(r.Constants.RpcMethods.getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:function(){return Q.resolve(u)}}),s.create(t,n,u,a,v)},t})(s.SettingsProcessor);__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SettingsManager,r.Rpc.Client]),__metadata("design:returntype",u)],c,"create",null);t.GeneralSettingsManager=c;h=(function(){function n(){this.rawLocale=f.observable("");this["fxs-theme"]=f.observable();this.npsTimeMs=f.observable(0);this.sideBarCollapsedKey=f.observable(!1);this.notificationToastEnabledKey=f.observable(!0);this.whatsNewEnabledKey=f.observable(!0);this.sideBarBrowseDisplayModeKey=f.observable(0);this.whatsNewVersion=f.observable(0);this.userConsentForNpsContact=f.observable(!1);this.highContrastKey=f.observable(0);this.idleTimeoutMins=f.observable(0);this.dblClickThemeEnabledKey=f.observable(!0);this.optIntoNewBrowse=f.observable(i.isFeatureEnabled("defaulttoartbrowse"));this.landingPage=f.observable(i.isFeatureEnabled("landalltohome")?3:4)}return n.create=function(n){return n.value},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c]),__metadata("design:returntype",h)],h,"create",null);t.GeneralSettings=h}));
define("MsPortalImpl/UI/UI.DesktopManager",["require","exports","f","o","ko","FxInternal/Di"],(function(n,t,i,r,u,f){"use strict";var e,o;r.defineProperty(t,"__esModule",{value:!0});t.DesktopManagerEvents={journeyChange:"journeyChange",bladeRebound:"bladeRebound",bladeClosed:"bladeClosed"};t.isTraceEnabled=!!i.trace.desktop;e=(function(){function n(){this.value=u.observable(0)}return n})();e=__decorate([f.Class()],e);t.DesktopManagerMode=e;o=(function(){function n(){this.value=u.observable()}return n})();o=__decorate([f.Class()],o);t.PreviouslyFocusedElement=o}));
define("MsPortalImpl/Base/Base.Router",["require","exports","f","i","o","ko","Fx/ResourceManagement","FxHubs/MarketplaceRpc","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Telemetry","MsPortalImpl/Services/Services.GeneralSettings"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function it(n){var i=n.get(r.Features),t=n.get(p.GeneralSettings).landingPage();return!i.isEnabled("azurehome")||t===2||t===4}function ni(n,t,r){var o={},f,e,u;try{for(f=0;f<n.length;){if(e=dt(n[f++]),!e)throw new Error("invalid decodeKey:"+e);u=dt(n[f++]);r&&u&&u.match(/^\s*\{.*\}\s*$/)&&(u=vt.safeJSONParse(u));o[e]=u}}catch(s){throw new i.Errors.Error({message:"Deep link "+t+" has illegal inputs",innerErrors:s});}return o}function ii(n,t){return function(){var r,u;try{t.apply(n,arguments)}catch(i){r=!0;i instanceof DOMException&&(u=i,(u.code===DOMException.SECURITY_ERR||u.name==="SecurityError")&&(r=!1));r&&st.error(i,0)}}}function w(){return new v.Uri(location.href)}function lt(n){return n===void 0&&(n=w()),n.getHashParts().category.localeCompareIgnoreCase(k)===0}function hi(n,t){return t===void 0&&(t=w()),lt(t)||t.isHashEmpty()&&it(n)}function at(n,t){return(yt(n)+"dashboard/"+t).toLowerCase()}function ci(n,i,r,u){var f=at(n,i),e;u=u||w();u.hash.toLowerCase()!=="#"+f&&(u.setHash(f),e=r?t.history_replaceState:d,e(null,null,u.href))}function li(n){return n===void 0&&(n=w()),lt(n)?n.getHashParts().rest:""}function ai(n,t,i,r,u){u===void 0&&(u="");var f=r,o=f&&typeof f=="string"&&e.ArmId.parse(f);return o&&o.kind!==0&&(f=f.substring(1)),new v.Uri(u).setHash("#{0}{1}/{2}/{3}/{4}".format(yt(n),"asset",t.name,i,f)).toString()}function vi(n,t,i,r){var u="#{0}/{1}";return r&&(f.unwrap(r.additionalConfig)||{}).preview&&(u+="/preview"),new v.Uri(t).setHash(u.format("create",n)).toString()}function yi(n,t,r,u,e,o){e===void 0&&(e=!1);var s=new v.Uri(r),c=!0,h="";return(o&&(h="/"+o),i.forEachKey(u,(function(n,t){if(n!=="editScopeId"){var i=f.unwrap(t);if(i&&typeof i=="object")if(e)i=JSON.stringify(i);else{c=!1;return}i!==undefined&&(h+="/{0}/{1}".format(encodeURIComponent(n),encodeURIComponent(i||"")))}})),!c)?"":(s.setHash("#blade/{0}/{1}{2}".format(n.name,t,h)),s.href.length>2082)?"":s.toString()}function pi(n){return new vt.RouterImpl(n,r.Rpc.client)}function yt(n){var t=n.get(c.AuthStateManager).getSignedInUserTenant();return t?"@"+t+"/":""}function wi(n,t){var u,f;t=i.trimStart(t,"/");u=t;t.startsWith("dashboard/arm")||t.startsWith("dashboard/private")||(f=e.ArmId.parse(i.ensurePrefix(t,"/")),u=l.isResourceAtAnyLevel(f)?i.ensurePrefix(t,"dashboard/arm/"):i.ensurePrefix(t,"dashboard/private/"));var r=window.location,o=new v.Uri(r.toString()),h=yt(n),s=r.port;return[r.protocol,"//",o.host,s?":"+s:"",r.pathname,o.queryString,"#",h,u,].join("")}var ti,tt,d,vt;u.defineProperty(t,"__esModule",{value:!0});var pt=i.Base,ot=pt.Constants,ri=ot.BladeNames.Hubs,ui=ot.AssetNames,wt=pt.Diagnostics,fi=wt.Telemetry,ei=i.Hubs.Notifications.NotificationStatus,oi=i.ViewModels;t.isLandingPageDashboard=it;var rt=s.Shell,bt=rt.deepLinkInvalid,kt=rt.deepLinkErrorLoading,g=window,ut=g.fx.environment,nt=s.Portal.defaultPageTitle.format(s.NavBar.home,ut.branding.title),st=wt.createLog(n),b=fi.trace,si=/^[\w-]+$/;t.originalHref=g.location.href;var ft=g.history,dt=decodeURIComponent,ht=rt.deepLinkNotFound,gt=ot.ExtensionNames,ct=gt.Marketplace,k="dashboard",et="home";ti={linkFormat:"",invalidLink:"",unfoundAsset:"",noResourceAsset:""};tt=r.getErrorMap(ti);d=ii(ft,ft.pushState);t.history_replaceState=ii(ft,ft.replaceState);t.isDashboardRoute=lt;t.isDashboardUri=hi;t.getDashboardDeepLink=at;t.updateDashboardUri=ci;t.getDashboardIdFromUri=li,(function(n){function f(n){try{return JSON.parse(n)}catch(t){return n}}function u(n,t,i,r){return{extension:n,assetType:t,detailBladeInputs:i,defaultMenuItemId:r}}function c(n){var t=(n||"").split("/"),r=t.length,u,i,f;return r<2?null:(i=r%2,i===1&&(u=t[2]),f=ni(t.slice(2+i),n,!0),{extension:t[0],detailBlade:t[1],detailBladeInputs:f,defaultMenuItemId:u})}n.safeJSONParse=f;var l=(function(){function n(n,t){var f=this,u;this._diContainer=n.diContainer;this._assetTypes=n.assetTypeService;this._desktop=n.desktop;this._extensions=n.extensionManager;this._notifications=n.notificationManager;this._ltm=new r.TriggerableLifetimeManager;u={};this._getHandler=function(n){var t=n.getHashParts().category;return u[t]};i.forEachKey({asset:this._handleAssetRoute,blade:this._handleBladeRoute,create:this._handleCreateRoute,menu:this._handleMenuRoute,resource:this._handleResourceRoute,dashboard:this._handleDashboardRoute},(function(n,t){u[n]=function(n,i,r){return t.call(f,n,i,r)}}));this._diContainer.get(r.Features).isEnabled("azurehome")&&(u[et]=function(){return f._handleHomeRoute()});oi.navigateToDashboardEndPoint.register(t,null,(function(n){var t=n[0],i=n[1];f.navigateToDashboard(t,i)}))}return n.prototype.route=function(n,t){return this._route(new v.Uri(n),{openedByContext:t})},n.prototype._route=function(n,t){var u=this;return i.tryImmediateResolve(Q(),(function(){if(t=t||{},n.isHashEmpty())return u._handleEmptyHashRoute();var i=u._getHandler(n);return i?i(n,t):r.QReject("{0} is not a valid deep link".format(n.hashWithHashQueryString))}))},n.prototype.initialRoute=function(n,t){var f=this,r=w(),i,u;return i=this._getHandler(r)?this._route(r,{skipFocus:t.skipFocus}).catch(n):n(),this.startListening(),i=i.catch((function(n){st.warning(n,1,"Unable to load initial route.");f.goToLandingPage("InitialRouteFailed",!0)})),u=r.getHashParts().category,!u||u===k?Q():i},n.prototype.startListening=function(){var t=this,i=this._desktop,n=this._isListening;n&&n.dispose();n=this._isListening=this._ltm.createChildLifetime();n.registerForDispose([$(window).setEvents([a.default.hashchange,function(){var n=w();t._route(n,{skipFocus:!1}).catch((function(){window.history.back();b({source:"Base.Router",action:"UriHashChange",data:{uri:n}})}))}]),$(i).setEvents([h.DesktopManagerEvents.journeyChange,function(){t._updateNavHistory({addToHistory:!0})},],[h.DesktopManagerEvents.bladeRebound,function(){t._updateNavHistory()},]),])},n.prototype.stopListening=function(){var n=this._isListening;n&&n.dispose();this._isListening=null},n.prototype.dispose=function(){this.stopListening();this._ltm.dispose()},n.prototype.navigateToDashboard=function(n,t){b({source:n||"Base.Router",action:y.Action.DashboardNavigation});var i=t?w().setHash(at(this._diContainer,t)):w().setHash(k).clearHashQueryStringIfEmpty();d({},"",i.href);this._route(i)},n.prototype.goToLandingPage=function(n,i,r){var u=it(this._diContainer);return b({source:n||"Base.Router",action:y.Action.LandingPageNavigation}),(i?t.history_replaceState:d)(null,nt,"#"+(u?k:et)),u?this._handleDashboardRoute(null,{skipFocus:r,interactionSource:n}):this._handleHomeRoute(r)},n.prototype._tryCleanupJourney=function(){if(this._desktop.tryDeactivateJourney()){if(!this._getActiveJourneyId()){var n=this._desktop.portalWidget.getPanorama(),t=n&&n.getJourneyWidget();t&&t.close()}return!0}return!1},n.prototype._handleDashboardRoute=function(n,t){var r=this,i=n&&n.getHashParts().rest;return this._tryCleanupJourney()?this._desktop.getDashboardManager().then((function(n){return i=i||n.currentDashboardId(),n.switchDashboard({id:i,title:i},t&&t.interactionSource||"Router")})).then((function(){r._desktop.portalWidget.trigger(a.default.fxshowstartboard,null,t);r._updateTitle()})):Q.reject()},n.prototype._handleHomeRoute=function(n){return b({source:"Base.Router",action:y.Action.AzureHomeNavigation}),this._tryCleanupJourney()&&(this._desktop.portalWidget.trigger(a.default.fxshowhomepage,null,{skipFocus:n}),this._updateTitle()),Q()},n.prototype._handleEmptyHashRoute=function(){return t.history_replaceState(null,nt,"#"+(it(this._diContainer)?k:et)),this._route(w())},n.prototype._handleBladeRoute=function(n,t){var o=this,f=n.getHashParts().rest,r=t&&t.route||c(f);if(r.openedByContext=t&&t.openedByContext,r.extension&&r.extension.toLowerCase()===gt.Hubs.toLowerCase()&&r.detailBlade&&r.detailBlade.toLowerCase()==="settingsblade")return b({source:"Base.Router",action:y.Action.SettingsPaneRedirect}),d({},nt,w().setHash("#menu/settings").href),this._handleMenuRoute(new v.Uri("#menu/settings"));var u=this._desktop,s=u.generateLoadingJourneyGuid(),e=u.getActiveJourney();return Q.fcall((function(){return e&&e.getDeepLink()||Q("")})).catch((function(){return""})).then((function(t){if(n.hash!==t)return i.tryImmediateResolve(u.createJourneyForBlade(r,s),i.identity,(function(n){return o._notify(kt.format(f)),Q.reject(n)}))}))},n.prototype._handleCreateRoute=function(n){var h=this,t=n&&n.getHashParts().rest,f=(t||"").split("/"),u,e,s,c;return f.length?(b({source:y.Source.Gallery,action:y.Action.DeepLinkVisited,name:t}),u=f.shift(),e=ni(f,t),u!=="hub"&&u!=="Microsoft.Support"?i.require("./MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Provisioning").then((function(t){var r=i.tryImmediateResolve(h._extensions.getExtensionByName(ct),(function(){return Q(o.getCreateFlow({marketplaceGalleryItemId:u,launchingContext:{source:["DeepLink"]},additionalConfig:e,alternateCreateFlowOptions:{useStackSelectionIfAvailable:!0}}))}));return Q.all([t.getMarketplaceItemAndInitialValues({marketplaceResults:r}),r,]).spread((function(t,r){var u=r.bladeSelection;return i.extend(u.detailBladeInputs,t),h._handleBladeRoute(n,{route:{extension:u.extension,detailBlade:u.detailBlade,detailBladeInputs:u.detailBladeInputs,defaultMenuItemId:f[2]}})}))})):(s="",this._extensions.initializedExtensions.some((function(n){return n.name===ct}))||(s="/useDelayedBlade/true/bladeWidth/1"),c="{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined{4}".format(ct,ri.CreateHubBlade,encodeURIComponent(u),encodeURIComponent(JSON.stringify(e)),s),this._handleBladeRoute(new v.Uri("#blade/"+c)))):(this._notify(bt.format(t)),r.QReject("Deep link "+t+" should be #{routeTypes.create}/{package-id}."))},n.prototype._handleMenuRoute=function(n){var t=n.getHashParts().rest,i;return si.test(t)||tt.linkFormat(t),i=this._desktop.portalWidget.element.find(".fxs-menu-"+t.toLowerCase()),i.length!==1&&tt.invalidLink(t),this._updateNavHistory({skipFocus:!0}),i.click(),Q()},n.prototype._handleAssetRoute=function(n){var l=this,h=n.getHashParts().rest,t=h.split("/"),c,v;if(t=h.match(/([^\/]+)\/([^\/]+)\/(.+)/i),!t||t.length<4)return this._notify(bt.format(h)),r.QReject("'"+h+"' is invalid. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}");var o=t[1],f=t[2],s=t[3],a=typeof s=="string"&&e.ArmId.parse("/"+s);return a&&a.kind!==0&&(s="/"+s),c=this._desktop,v=c.generateLoadingJourneyGuid(),i.tryImmediateResolve(this._extensions.getManifestByName(o),(function(n){o=n.name;var i=f.toLowerCase(),t=n.assetTypes.first((function(n){return n.name.toLowerCase()===i}));return t||(l._notify(ht.format(f)),tt.unfoundAsset(f)),f=t.name,b({source:y.Source.Asset,action:y.Action.DeepLinkVisited,name:o,data:f}),c.createJourneyForAsset(u(o,f,{},null),v,s)}),(function(n){l._notify(ht.format(o));throw n;}))},n.prototype._handleResourceRoute=function(n){var r=this,t=n.getHashParts().rest,f,o,s,h;return t="/"+t.replace(/^\//,""),t=decodeURI(t),f=t.split("/"),o=null,f.length%2==0&&(o=f[f.length-1],t=t.substr(0,t.length-o.length-1)),s=this._desktop,h=s.generateLoadingJourneyGuid(),i.tryImmediateResolve(Q(),(function(){var n=e.ArmId.parse(t).resourceType;return i.tryImmediateResolve(r._assetTypes.assetTypesComplete,(function(){var f=r._assetTypes.getAssetTypeByResourceTypeWithFallback(n),e=f.assetTypeManifest,c=e.name,l=f.extension,i=e.resourceType.resourceTypeName;return c||(r._notify(ht.format(i)),tt.noResourceAsset(i)),b({source:y.Source.Resource,action:y.Action.DeepLinkVisited,name:l,data:i||ui.NonAssetResource}),s.createJourneyForAsset(u(l,c,{},o),h,t)}))}),(function(n){r._notify(kt.format(t));throw n;}))},n.prototype._updateTitle=function(){var i=this._desktop,n=i.getActiveJourney(),t,u,f;if(this._titleLifetime&&this._titleLifetime.dispose(),this._titleLifetime=null,n&&n.blades.length>0){this._titleLifetime=this._ltm.createChildLifetime();var r=n.blades[n.blades.length-1],e=r.isDefaultTitle(),o=r.title.subscribe(this._titleLifetime,(function(n){g.document.title=s.Portal.windowTitleFormat.format(n,ut.branding.title)}));e||o.callback(r.title())}else t=nt,i.portalWidget.getDisplayMode()===2?t=s.Portal.windowTitleFormat.format(s.AzureHome.home,ut.branding.title):(u=i.startBoard,f=u&&u.getDashboard()||{},f.title&&(t=s.Portal.windowTitleFormat.format(f.title,ut.branding.title))),g.document.title=t},n.prototype._getActiveJourneyId=function(){var n=this._desktop.getActiveJourney();return!n||n.isStartedWithContextBlade()?"":n.id},n.prototype._notify=function(n){var t=new Date;this._notifications.addClientNotification({title:rt.deepLinkInvalidTitle,description:i.encodeHtml(n),status:ei.Error,timestamp:t,correlationIds:[t.getTime().toString()]})},n.prototype._updateNavHistory=function(n){var u=this,e=n&&n.addToHistory?d:t.history_replaceState,s=n&&n.skipFocus,r=this._desktop.getActiveJourney(),f,o;return r?i.tryImmediateResolve(r.getDeepLink(),(function(n){var s=u._getActiveJourneyId(),t;if(s){var i=r.blades,f=i[i.length-1],o=f&&f.bladeDefinition;o&&o.menuBlade||(t=w(),t.setHash(n),t.href.toLowerCase()!==location.href.toLowerCase()&&e({},document.title,t.href),u._updateTitle())}}),(function(n){st.warning(new i.Errors.Error({message:"Failed to update address bar.",data:{id:u._getActiveJourneyId(),key:r.templateKey},innerErrors:n}))})):(f=this._desktop.portalWidget.getRootPageDisplayType()===1?k:et,o=w(),o.getHashParts().category.localeCompareIgnoreCase(f)&&e(null,nt,"#"+f),this._route(w(),{skipFocus:s}))},n})();n.RouterImpl=l})(vt=t.Internal||(t.Internal={}));t.getAssetDeepLink=ai;t.getGalleryDeepLink=vi;t.getBladeDeepLink=yi;t.createRouter=pi;t.rpcGetDashboardDeepLink=wi}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Blue.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-theme-blue{background-color:#215b7d}.fxs-theme-blue .fxs-startboard-button,.fxs-theme-blue .fxs-startboard-header,.fxs-theme-blue .fxs-startboard-message-container{color:#fff}.fxs-theme-blue .fxs-startboard-button-icon{fill:#fff}")}));
define("_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-mode-light .fxs-blade-locked,.fxs-mode-light .fxs-portal-background{background-color:#fff}.fxs-mode-light .fxs-bladecontent-unlocked,.fxs-mode-light .fxs-portal-background-secondary{background-color:#e4e4e4}.fxs-mode-light .fxs-bladestyle-create,.fxs-mode-light .fxs-bladestyle-help{background-color:#fff}.fxs-mode-light .fxs-portal-background-primary{background-color:#015cda}.fxs-mode-light .fxs-portal-text{color:#000}.fxs-mode-light .fxs-portal-subtext{color:#646464}.fxs-mode-light .fxs-portal-text-primary{color:#015cda}.fxs-mode-light .fxs-portal-title{color:#444}.fxs-mode-light .fxs-portal-border{border-color:rgba(204,204,204,.8)}.fxs-mode-light .fxs-portal-bg-txt-br{color:#000;border-color:rgba(204,204,204,.8);background-color:#fff}.fxs-mode-light .fxs-portal-focus:focus{background-color:#f5fcfe}.fxs-mode-light .fxs-portal-activated,.fxs-mode-light .fxs-portal-selected{background-color:rgba(85,179,255,.2)}.fxs-mode-light .fxs-portal-hover:hover{background-color:rgba(85,179,255,.1)}.fxs-mode-light .fxs-portal-hover:active{background-color:rgba(85,179,255,.2)}.fxs-mode-light .msportalfx-docking-footer{border-color:#bbb}.fxs-mode-light .fxs-portal-svg{fill:#000}.fxs-mode-light .fxs-portal-svg-secondary{fill:#636363}.fxs-mode-light .fxs-tile-overlay{background-color:rgba(255,255,255,.4)}.fxs-mode-light .fxc-infoBox-image-container{background-color:#bbb}.fxs-mode-light .azc-node-fill{fill:#94caff}.fxs-mode-light .azc-node-fill-focused,.fxs-mode-light .azc-node-fill-hovered{fill:#47a5ff}.fxs-mode-light .azc-node-bg{background-color:#94caff}.fxs-mode-light .azc-node-bg-focused,.fxs-mode-light .azc-node-bg-hovered{background-color:#47a5ff}.fxs-mode-light .azc-chart{fill:#fff;stroke:#ccc}.fxs-mode-light .azc-chart text{fill:#333}.fxs-mode-light .azc-chart text.azc-chart-axis-slider-text{fill:#000}.fxs-mode-light .azc-external-hovered:not(.azc-row-disabled){background-color:#e6eef7}.fxs-mode-light .azc-header{background-color:rgba(204,204,204,.8);color:#000}.fxs-mode-light .azc-formControl{border-color:rgba(204,204,204,.8);background-color:#fff}.fxs-mode-light .azc-input{color:#000}.fxs-mode-light .azc-formControl.azc-br-focused,.fxs-mode-light .azc-formControl.azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-formControl:focus{border-color:#0058ad}.fxs-mode-light .azc-bg-default{background-color:#fff}.fxs-mode-light .azc-bg-light{background-color:#e6e6e6}.fxs-mode-light .azc-bg-muted{background-color:#b3b3b3}.fxs-mode-light .azc-bg-muted-80-10{background-color:#333}.fxs-mode-light .azc-bg-console{background-color:#191919}.fxs-mode-light .azc-bg-hover{background-color:#99bcde}.fxs-mode-light .azc-bg-disabled{background-color:#e6e6e6}.fxs-mode-light .azc-bg-inverted{background-color:#4d4d4d}.fxs-mode-light .azc-bg-hover-muted:hover{background-color:grey}.fxs-mode-light .azc-br-muted{border-color:#ccc}.fxs-mode-light .azc-br-muted-80-10{border-color:#333}.fxs-mode-light .azc-br-active{border-color:#000}.fxs-mode-light .azc-br-strong{border-color:grey}.fxs-mode-light .azc-br-focused,.fxs-mode-light .azc-br-focused.azc-br-edited,.fxs-mode-light .azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-br-focused.fxs-br-error,.fxs-mode-light .azc-br-hovered,.fxs-mode-light .azc-br-selected{border-color:#0058ad}.fxs-mode-light .azc-br-top-hovered{border-top-color:#0058ad}.fxs-mode-light .azc-br-bottom-hovered{border-bottom-color:#0058ad}.fxs-mode-light .azc-br-inverted{border-color:#4d4d4d}.fxs-mode-light .azc-stroke-muted{stroke:grey}.fxs-mode-light .azc-stroke-heavy{stroke:#666}.fxs-mode-light .azc-stroke-default{stroke:#fff}.fxs-mode-light .azc-stroke-selected{stroke:#0058ad}.fxs-mode-light .azc-fill-default,.fxs-mode-light svg.azc-fill-default{fill:#fff}.fxs-mode-light .azc-fill-heavy,.fxs-mode-light .azc-fill-hovered-heavy:hover{fill:#666}.fxs-mode-light .azc-fill-text{fill:#000}.fxs-mode-light .azc-fill-hover{fill:#d9e6f3}.fxs-mode-light .azc-fill-selected{fill:#b3cde6}.fxs-mode-light .azc-fill-primary svg{fill:#0058ad}.fxs-mode-light .azc-scrollbar-default,.fxs-mode-light .azc-scrollbar-default:hover{-ms-scrollbar-track-color:#e6e6e6;-ms-scrollbar-face-color:#b3b3b3}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-track-piece,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-track-piece{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-thumb,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-thumb{background:#b3b3b3}.fxs-mode-light .azc-text-muted{color:#757575}.fxs-mode-light .azc-text-console{color:#e6e6e6}.fxs-mode-light .azc-text-primary,.fxs-mode-light a.azc-text-primary{color:#0058ad}.fxs-mode-light .azc-text-disabled,.fxs-mode-light a.azc-text-disabled{color:grey}.fxs-mode-light .azc-text-inverted{color:#fff}.fxs-mode-light .azc-fill-disabled svg{fill:grey!important}.fxs-mode-light .fxc-grid2.fxs-grid-selection tbody td.fxc-grid-activatable{color:#015cda}.fxs-mode-light .fxc-grid2.fxs-grid-selection.fxc-pseudoHover tbody tr.fxc-grid-row:not([aria-disabled=true]):not(.fxs-portal-selected):not(.fxs-portal-activated){background-color:rgba(85,179,255,.1)}.fxs-mode-light .fxc-grid2.fxs-grid-selection.fxc-pseudoHover tbody tr.fxc-grid-row:not([aria-disabled=true])~tr.fxc-grid-row:not([aria-disabled=true]):not(.fxs-portal-selected):not(.fxs-portal-activated):not(:hover),.fxs-mode-light .fxs-blade-has-activation .fxc-grid2.fxs-grid-selection tr:not(.fxs-portal-activated){background-color:transparent}.fxs-mode-light .fxs-blade-has-activation .fxc-grid2.fxs-grid-selection .fxs-portal-activated{background-color:rgba(85,179,255,.2)}.fxs-mode-light .msportalfx-bg-muted-5{background-color:#f2f2f2}.fxs-mode-light .msportalfx-bg-muted{background-color:#e6e6e6}.fxs-mode-light .msportalfx-bg-default{background-color:#fff}.fxs-mode-light .msportalfx-text-default{color:#000}.fxs-mode-light .msportalfx-text-white{color:#fff}.fxs-mode-light .msportalfx-text-muted-50{color:#444}.fxs-mode-light .msportalfx-fill{fill:#000}.fxs-mode-light .msportalfx-bgcolor-paletteLightGray{background-color:#e6e6e6}.fxs-mode-light .msportalfx-highlight{color:#000;background-color:#fff100}.fxs-mode-light .msportalfx-brdr-color:hover,.fxs-mode-light .msportalfx-brdr-selected{border-color:#00bcf2}.fxs-mode-light .msportalfx-border{border-color:rgba(204,204,204,.8)}.fxs-mode-light .msportalfx-text-primary{color:#015cda}.fxs-mode-light .msportalfx-link-primary{color:#015cda!important;fill:#015cda}.fxs-mode-light .fxs-graph-fill{fill:#fff!important}.fxs-mode-light .azc-dockedballoon-validation{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-is-edited.azc-has-focus .azc-dockedballoon-validation{border-color:#0058ad!important}.fxs-mode-light .azc-has-focus .azc-dockedballoon-validation{border-color:#0058ad}.fxs-mode-light .azc-is-edited .azc-dockedballoon-validation{border-color:#8a2da5}.fxs-mode-light .azc-validation-messages,.fxs-mode-light .fxs-text-error,.fxs-mode-light .msportalfx-text-error{color:#e00b1c}.fxs-mode-light .fxs-portal-selected.azc-bg-disabled{background-color:#acd6e2}.fxs-mode-light .fxs-button-default{background-color:#fff;border-color:#015cda;color:#015cda;fill:#015cda}.fxs-mode-light .fxs-button-default .fxs-button-icon .fxs-portal-svg{fill:#015cda}.fxs-mode-light .fxs-button-default:hover{color:#016afe;fill:#016afe;border-color:#016afe;background-color:rgba(127,127,127,.1)}.fxs-mode-light .fxs-button-default:hover .fxs-button-icon .fxs-portal-svg{fill:#016afe}.fxs-mode-light .fxs-button-default:active{color:#014db7;fill:#014db7;border-color:#014db7;background-color:rgba(127,127,127,.1)}.fxs-mode-light .fxs-button-default:active .fxs-button-icon .fxs-portal-svg{fill:#014db7}.fxs-mode-light .fxs-portal-button-primary{background-color:#015cda;border-color:#015cda;color:#fff;fill:#fff}.fxs-mode-light .fxs-portal-button-primary .fxs-button-icon .fxs-portal-svg{fill:#fff}.fxs-mode-light .fxs-portal-button-primary:hover{background-color:#016afe;border-color:#016afe}.fxs-mode-light .fxs-portal-button-primary:active{background-color:#014db7;border-color:#014db7}.fxs-mode-light .fxs-button-disabled,.fxs-mode-light .fxs-button-disabled:active,.fxs-mode-light .fxs-button-disabled:focus,.fxs-mode-light .fxs-button-disabled:hover{cursor:default;background-color:rgba(127,127,127,.1);border-color:transparent;outline:0;color:rgba(127,127,127,.7);fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-button-disabled .fxs-button-icon .fxs-portal-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-button-disabled:active .fxs-button-icon .fxs-portal-svg,.fxs-mode-light .fxs-button-disabled:focus .fxs-button-icon .fxs-portal-svg,.fxs-mode-light .fxs-button-disabled:hover .fxs-button-icon .fxs-portal-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-portal-button-primary.fxs-portal-optionPicker-dirty{background-color:#68217a;border-color:#68217a}.fxs-mode-light .fxs-button-default.fxs-portal-optionPicker-dirty{border-color:#68217a;color:#68217a}.fxs-mode-light .fxs-button-default.fxs-portal-optionPicker-disabled{background-color:#fff;border-color:rgba(127,127,127,.7);color:rgba(127,127,127,.7)}.fxs-mode-light .fxs-portal-button-primary.fxs-portal-optionPicker-disabled{border-color:rgba(127,127,127,.7);color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio-circle{border-color:#7f7f7f;background-color:#fff}.fxs-mode-light .azc-noRadio .azc-radio-circle:active,.fxs-mode-light .azc-noRadio .azc-radio-circle:hover{border-color:#161616}.fxs-mode-light input[type=radio]:checked~.azc-radio-circle:after{background-color:#015cda}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled .azc-radio-circle{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled input[type=radio]:checked~.azc-radio-circle:after{background-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox{border-color:#7f7f7f;background-color:#fff}.fxs-mode-light .azc-checkBox:active,.fxs-mode-light .azc-checkBox:hover{border-color:#161616}.fxs-mode-light .azc-checkBox.azc-control-disabled,.fxs-mode-light .azc-input,.fxs-mode-light .fxc-control-border{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox.azc-control-disabled .azc-checkBox-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox.azc-control-disabled .azc-disabled{background-color:#fff}.fxs-mode-light .azc-checkBox .azc-checkBox-svg{fill:#015cda}.fxs-mode-light .azc-text-label,.fxs-mode-light .azc-text-sublabel,.fxs-mode-light .msportalfx-text-sublabel{color:#595959}.fxs-mode-light .msportalfx-form-formelement-disabled .azc-text-label,.fxs-mode-light .msportalfx-form-formelement-disabled .azc-text-sublabel{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-disabled,.fxs-mode-light .azc-disabled:focus,.fxs-mode-light .azc-disabled:hover,.fxs-mode-light input.azc-disabled{color:rgba(127,127,127,.7);background-color:rgba(127,127,127,.1);border-color:rgba(127,127,127,.7);fill:rgba(127,127,127,.1)}.fxs-mode-light .azc-control ::-webkit-input-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-control ::-moz-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-control :-ms-input-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-input::placeholder{color:#747474}.fxs-mode-light .azc-input:-ms-input-placeholder{color:#747474}.fxs-mode-light .azc-input::-ms-input-placeholder{color:#747474}.fxs-mode-light .fxs-copyfield .fxc-copyablelabel-copyimage{fill:#252525}.fxs-mode-light .fxc-tabs-container.fxc-tabs-block>.fxc-tabs-itemslist li.azc-br-active{border-bottom-color:#fff!important}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .azc-optionPicker li.fxs-bg-dirty{background-color:rgba(85,179,255,.2)!important}.fxs-mode-light .azc-br-focused{border-color:#0058ad!important}.fxs-mode-light .fxs-menu-result-category{background-color:#f3f2f1}.fxs-mode-light .fxs-global-search .fxs-menu-allresources,.fxs-mode-light .fxs-global-search .fxs-menu-update-subscription{color:#015cda;fill:#015cda}.fxs-mode-light .fxs-breadcrumb-crumb-active,.fxs-mode-light .fxs-breadcrumb-overflow-btn{color:#015cda}.fxs-mode-light .fxs-command-like-button,.fxs-mode-light .msportalfx-command-like-button{fill:#015cda;color:#333}.fxs-mode-light .fxs-command-like-button-disabled,.fxs-mode-light .msportalfx-command-like-button-disabled{opacity:.5;fill:#333}.fxs-mode-light .fxs-blade{box-shadow:0 0 8px 0 rgba(0,0,0,.14)}.fxs-mode-light .fxs-portal-contextpane-right,.fxs-mode-light .fxs-topbar{box-shadow:0 8px 16px 0 rgba(0,0,0,.16)}.fxs-mode-light .fxs-portal-contextpane-right .fxs-blade{box-shadow:none}.fxs-mode-light .fxs-portal-contextpane-right.fxs-portal-contextpane-from-topbar{box-shadow:0 8px 16px 0 rgba(0,0,0,.16)}.fxs-mode-light .fxs-blade-progress-translucent>div::after{background-color:#000}.fxs-mode-light .fxs-topbar .fxs-blade-progress-translucent>div::after{background-color:#fff}.fxs-mode-light .fxc-menu-grid .azc-listView-groupheader{box-shadow:inset 0 -1px 0 0 rgba(204,204,204,.8)}.fxs-mode-light .fxs-blade-statusbg.fxs-bg-info{background-color:#cce1ff!important}.fxs-mode-light .fxs-blade-statusbg.fxs-bg-complete,.fxs-mode-light .fxs-blade-statusbg.fxs-bg-success{background-color:#e6ffcc!important}.fxs-mode-light .fxs-blade-statusbg.fxs-bg-dirty,.fxs-mode-light .fxs-blade-statusbg.fxs-bg-upsell{background-color:#efdbf5!important}.fxs-mode-light .fxs-blade-statusbg.fxs-bg-warning{background-color:#ffdfb8!important}.fxs-mode-light .fxs-blade-statusbg.fxs-bg-error{background-color:#fdd8db!important}.fxs-mode-light .fxs-blade-status-text-container{color:#000}.fxs-mode-light .fxs-landingpageselector-select{background-color:#cce1ff}.fxs-mode-light .fxs-landingpageselector-notice{background-color:#e6ffcc}.fxs-mode-light .fxs-home-ad-tile:hover,.fxs-mode-light .fxs-home-target{background-color:#fff}.fxs-mode-light .fxs-home-feature-tile:hover{background-color:#fff;border-color:rgba(204,204,204,.8)}.fxs-mode-light .fxs-home-ad-icon-container{background-image:radial-gradient(#fff,#edebe9)}.fxs-mode-light .fxs-home-ad-tile{border-color:rgba(204,204,204,.8)}.fxs-mode-light .fxs-home-linkicon{fill:#015cda}.fxs-mode-light .fxs-home-container{fill:#000}")}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,':link img,:visited img,a img,fieldset,img,legend{border:0}body,fieldset,legend{margin:0;padding:0}img,svg{overflow:hidden}.fxs-display-none{display:none!important}.fxs-hide-accessible-label{overflow:hidden;position:absolute;top:-1000px;left:-1000px;width:0;height:0}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{font-size:100%;font-weight:inherit}code,p,pre{font-size:12px}body,button,input,p,select,textarea{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_normal,"Segoe WP",Tahoma,Arial,sans-serif;font-weight:400}body,html{height:100%}input::-ms-clear{display:none}[type=button],[type=reset],[type=submit],button{font-size:12px;background:0 0;color:inherit}img{max-height:100%;max-width:100%}[contentEditable=true]:not([tabindex="-1"]):focus,[tabindex="0"]:focus,a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus{outline-offset:-1px}tbody tr[tabindex]:not([tabindex=\'-1\']):focus{box-shadow:none}a{text-decoration:none}p{line-height:18px}b,strong{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}code,pre{font-family:Consolas,"Courier New",monospace}textarea{overflow:auto}hr{border-width:1px 0 0;border-top-style:solid}[data-bind*=fxClick],[data-bind*=fxclick],[role=link],[role=button]{cursor:pointer}@-moz-document url-prefix(http){::-moz-placeholder{opacity:1}::-moz-focus-inner{border:0;padding:0}button:focus,input[type=button]:focus{outline-width:1px;outline-style:dashed}}@supports (outline-offset:-1px){:focus{outline:#00bcf2 dashed 1px}}')}));
define("MsPortalImpl/Base/Themes",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/Base.CssSanitizer","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","_generated/Less/MsPortalImpl/Themes/Themes.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function v(n,t,i,r,u){return{colorCode:n,imageUri:tt.getContentUri(ot+t),name:i,title:r,mode:u}}function y(n,t,i){rt({source:n,action:t,data:i})}var nt,p;u.defineProperty(t,"__esModule",{value:!0});var tt=i.Base.Resources,it=i.Base.Diagnostics.Telemetry,rt=it.trace,w=window,ut="fxs-theme-",ft="fxs-mode-light "+l.extLightClass,et="fxs-mode-dark "+l.extDarkClass,b="fxs-mode-highcontrast "+l.extHcActiveClass,k="fxs-highcontrast-dark "+l.extHcDarkClass,d="fxs-highcontrast-light "+l.extHcLightClass,a=o.Themes.Names,ot="Content/Images/MsPortalImpl/Themes/",g="_generated/Less/MsPortalImpl/Themes/Themes.{0}.css",st="(-ms-high-contrast: active)",ht="(-ms-high-contrast: black-on-white)",ct="(-ms-high-contrast: white-on-black)",lt=window.fx.environment,at={name:"HighContrastMode",mode:1},vt={name:"HighContrastMode",mode:0};nt=(function(){function t(n,t){var e=this,p,c,rt,ot,g,l;this._lifetime=new r.TriggerableLifetimeManager;var u=t["fxs-theme"],i=t.highContrastKey,nt=v("#f1f1f8","Theme_Light.png","light",a.light,0),tt=v("#333","Theme_Dark.png","dark",a.dark,1),it=this._themes=[v("#0078d4","Theme_Azure.png","azure",a.azure,0),v("#215b7d","Theme_Blue.png","blue",a.blue,0),nt,tt,],o=it.map((function(n){return n.name})).indexOf((u()||this.getDefaultTheme()).name);~o||(o=1);this.currentTheme=u;u(it[o]);this.highContrastMode=i;this._themeIndex=o;f.explicitComputed(this._lifetime,[u,i],(function(){var t=u(),h,c;t=t||e._themes[e._themeIndex=0];var r=i(),o=r!==0,f=r===2,s=r===1;o&&(t=f?tt:nt);h=e._injectStyles(t);c=f?e._injectStyles(at):s?e._injectStyles(vt):Q({});Q.all([c,h]).then((function(){var i=t.mode?et:ft;n.removeClass(p).addClass(p=ut+t.name+" "+i).toggleClass(b,o).toggleClass(k,f).toggleClass(d,s)}))}));y(s.Source.Shell,s.Action.SelectedTheme,u().name);i()!==0&&y(s.Source.Shell,s.Action.SelectedHighContrastMode,i());i.subscribe(this._lifetime,(function(){y(s.Source.Shell,s.Action.SelectedHighContrastMode,i())}));n.on(h.default.fxrotatetheme,(function(){var n,i;t.dblClickThemeEnabledKey()&&(n=u().name,e.rotateTheme(),i=u().name,y(s.Source.Shell,s.Action.RotateTheme,{fromTheme:n,toTheme:i}))}));g=[c=w.matchMedia(st),rt=w.matchMedia(ht),ot=w.matchMedia(ct),];l=function(){rt.matches?i(1):ot.matches||c.matches?i(2):i(0)};c.media!=="not all"&&(g.forEach((function(n){return n.addListener(l)})),c.matches&&l());this._lifetime.registerForDispose((function(){n.off(h.default.fxrotatetheme).removeClass(p+" "+b+" "+k+" "+d);g.forEach((function(n){return n.removeListener(l)}))}))}return t.prototype.getThemes=function(){return this._themes},t.prototype.rotateTheme=function(){var n=this._themes,t=this._themeIndex=((this._themeIndex||0)+1)%n.length;this.currentTheme(n[t])},t.prototype.getDefaultTheme=function(){var t=lt.chrome.defaultTheme,n;return t&&(n=this._themes.filter((function(n){return n.name===t})),n&&n.length>0)?n[0]:this._themes[1]},t.prototype._injectStyles=function(t){var r=t.name,u=t.mode,f=r.charAt(0).toUpperCase()+r.slice(1),e=u?"DarkMode":"LightMode",o=[g.format(f),g.format(e),];return Q.all(o.map((function(t){return i.require(t,n)})))},t.prototype.dispose=function(){this._lifetime.dispose()},t})();p=(function(){function n(){}return n.createManager=function(n){return new nt($([window.document.body,window.document.head]),n)},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c.GeneralSettings]),__metadata("design:returntype",p)],p,"createManager",null);t.ThemeManager=p}));
define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","o","Fx/DependencyInjection"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});var u=(function(){function n(n,t){var i=this;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){i._blurStartTime=new Date;i._state=1;i._processCallbacks(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i._blurStartTime=null;i.signalBusy()})}return n.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._state=0,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex((function(t){return n===t.key}));return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===1&&(this._state=2,this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._blurStartTime||(this._blurStartTime=new Date);this._state=1;this._processCallbacks(0)},n.create=function(){return new n(window,9e5)},n.prototype._processCallbacks=function(n){var t=this,i;this._win&&(i=this._timeoutHandle,i&&this._win.clearTimeout(i),this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{t._processIteration()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n))},n.prototype._processIteration=function(){var i=this,t,n;switch(this._state){case 2:this._state=0;t=function(n){n.onBusy(new Date)};break;case 1:this._state=1;t=function(n){return n.onIdle(new Date,i._blurStartTime)};break;default:case 0:return}var r=function(n){var r=i._actions[n];r&&t(r.value)},u=this._actions.length,f=this._iteration%u;for(this._iteration++,n=f;n<u;n++)r(n);for(n=0;n<f;n++)r(n)},n})();__decorate([r.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",u)],u,"create",null);t.PortalIdleStateService=u}));
define("MsPortalImpl/Svg/Startup/Error.svg",[],(function(){"use strict";return{type:6,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='4.5' cy='4.5' r='4.5' class='msportalfx-svg-c22'/><circle cx='4.5' cy='6.438' r='.697' class='msportalfx-svg-c01'/><path d='M4.604 2.186h-.729l.186 3.232h.878l.186-3.232z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Warning.svg",[],(function(){"use strict";return{type:9,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z' class='msportalfx-svg-c10'/><circle cx='4.5' cy='6.178' r='.615' class='msportalfx-svg-c01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports","f","o"],(function(n,t,i,r){"use strict";function v(n){return function(t){return t.id===n}}function y(n,t,i){if(n)if(t){if(!i)throw new Error("Command container name is required.");}else throw new Error("Command name is required.");else throw new Error("Commands list is required.");var r=n.first((function(n){return n.commandName===t}));return r||l.error("Command container '{0}' does not have a command named '{1}'.".format(i,t)),r}function p(n){var t=n.locator&&n.locator.type;return t===5||t===6||t===7}function w(n,t){return r.keys(t).every((function(r){return n.hasOwnProperty(r)&&i.deepEquals(t[r],n[r])}))}function b(n){var t=n&&n.assetTypeId;if(typeof t=="string")return t}function k(n){var t=n;return t&&t.beforeActivateCommandMenuItems&&typeof t.beforeActivateCommandMenuItems=="function"}function d(n){return!!e[o(n)]}function o(n){return n.style===12?4:n.templateBlade?1:n.frameBlade?2:n.menuBlade?3:n.azBlade?5:0}var a,e,u;r.defineProperty(t,"__esModule",{value:!0});var f=i.Base,s=f.Constants,h=s.BladeParameterNames,c=f.Diagnostics,l=c.createLog(n);t.referenceTypeMap={};t.referenceTypeMap[0]="Part";t.referenceTypeMap[1]="BladeInput";t.referenceTypeMap[2]="BladeActionBar";t.referenceTypeMap[3]="BladeProperty";t.referenceTypeMap[4]="Command";t.referenceTypeMap[5]="Constant";t.referenceTypeMap[6]="SelectedItem";t.referenceTypeMap[7]="Adapter";t.referenceTypeMap[8]="Dashboard";t.referenceTypeMap[9]="AdapterInput";t.EditScopeIdPropertyName=h.EditScopeId;t.PartContainerModelIdProperty="##SnapshotContainerId##";t.CompositionInstanceDataName="MsPortalImplCompositionInstance";t.fxreplacedpartcomposing="fxreplacedpartcomposing",(function(n){n[n.Unknown=0]="Unknown";n[n.Part=1]="Part";n[n.StartboardPart=2]="StartboardPart";n[n.Lens=3]="Lens";n[n.BladeActionBar=4]="BladeActionBar";n[n.Blade=5]="Blade";n[n.Journey=6]="Journey";n[n.Startboard=7]="Startboard"})(a=t.CompositionType||(t.CompositionType={}));t.getIdMatchFunc=v;t.findCommand=y;t.isPartComposition=p;t.deepSubset=w;t.tryGetAssetType=b;t.isContextMenuContainer=k;e=(u={},u[1]=!0,u[3]=!0,u[4]=!0,u[2]=!0,u[5]=!0,u);t.bladeImplementedWithVirtualPart=d;t.getBladeType=o}));
define("MsPortalImpl/Base/Base.Timers",["require","exports","f","o","a","ko"],(function(n,t,i,r,u,f){"use strict";function o(n){if(!n&&e.requestAnimationFrame&&e.cancelAnimationFrame)t.requestAnimationFrame=function(n){return e.requestAnimationFrame(n)},t.cancelAnimationFrame=function(n){return e.cancelAnimationFrame(n)};else{var i=0;t.requestAnimationFrame=function(n){var t=Date.now(),r=Math.max(0,16-(t-i)),u=e.setTimeout((function(){n(t+r)}),r);return i=t+r,u};t.cancelAnimationFrame=function(n){e.clearTimeout(n)}}}function s(n){var r,i;return function(){for(var u,o,e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];return r=e,i||(u=Q.defer(),o=i=u.promise,i.timeout(2e3,"requestAnimationFrameQ timout after 2 seconds: callback:"+n).catch((function(){o===i&&(i=null)})),t.requestAnimationFrame((function(){try{var t=Q(n.apply(void 0,r));t.then(u.resolve,u.reject)}catch(f){u.reject(f)}i=null}))),i}}r.defineProperty(t,"__esModule",{value:!0});var e=window;t.setupTimers=o;o(!1);t.throttleByAnimationFrame=s;t.debounce=i.debounce;t.throttle=i.throttle;f.extenders.rateLimit.tasks.debounce=t.debounce;f.extenders.rateLimit.tasks.throttle=t.throttle}));
define("MsPortalImpl/Interactions/Interactions.DismissHandler",["require","exports","f","i","o","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";function k(n,t){c.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".format(t&&t.logName||"unknown"),0,n)}function d(n){var i="function",t=!!n;return n.shouldDismissOnFocusOutFn&&(t=t&&typeof n.shouldDismissOnFocusOutFn===i),n.restoreFocus&&(t=t&&typeof n.restoreFocus===i),n.shouldDismissOnMouseDownFn&&(t=t&&typeof n.shouldDismissOnMouseDownFn===i),n.shouldDismissOnMouseWheelFn&&(t=t&&typeof n.shouldDismissOnMouseWheelFn===i),t}function o(n){var t=n&&typeof n.dismissFn=="function"&&d(n);return t||c.error("The dismiss handle object is null or malformed."),t}function h(n){var r,i,t,u;if(e.length)for(r=e[e.length-1],i=r.length-1;i>=0;i--){t=r[i];try{u=n(t);u!==0&&(t.dismissFn(),u===2&&t.restoreFocus&&t.restoreFocus())}catch(f){k(f,t)}}}function v(n){h((function(t){return t.shouldDismissOnFocusOutFn&&o(t)?t.shouldDismissOnFocusOutFn(n.target):0}))}function y(n){n.keyCode===27&&h((function(n){return o(n)?2:0}))}function s(n){h((function(t){return t.shouldDismissOnMouseDownFn&&o(t)?t.shouldDismissOnMouseDownFn(n.target,n):0}))}function p(n){l||(l=!0,b.setTimeout((function(){l=!1}),250),h((function(t){return t.shouldDismissOnMouseWheelFn&&o(t)?t.shouldDismissOnMouseWheelFn(n.target):0})))}function w(n){h((function(t){return t.shouldDismissOnMouseWheelFn&&t.shouldDismissOnScroll&&o(t)&&!$(n.target).hasClass("azc-resize")?t.shouldDismissOnMouseWheelFn(n.target):0}))}function g(){var n=a.body;n.addEventListener(f.default.focus,v,!0);n.addEventListener(f.default.keydown,y,!0);n.addEventListener(f.default.mousedown,s,!0);n.addEventListener(f.default.touchstart,s,!0);n.addEventListener(f.default.pointerdown,s,!0);n.addEventListener(f.default.mousewheel,p,!0);n.addEventListener(f.default.scroll,w,!0)}function nt(){var n=a.body;n.removeEventListener(f.default.focus,v,!0);n.removeEventListener(f.default.keydown,y,!0);n.removeEventListener(f.default.mousedown,s,!0);n.removeEventListener(f.default.touchstart,s,!0);n.removeEventListener(f.default.pointerdown,s,!0);n.removeEventListener(f.default.mousewheel,p,!0);n.removeEventListener(f.default.scroll,w,!0);e.length=0}function tt(n,t){if(!o(n))throw new Error("The dismiss handle object is null or malformed.");e.some((function(t){return t.indexOf(n)>=0}))||((t||!e.length)&&e.push([]),e.last().push(n))}function it(n){e.forEach((function(t){t.remove(n)}));e=e.filter((function(n){return n.length!==0}))}function rt(n,t){var u="DismissHandle for '"+n.logName+"': previouslyFocusedElement";if(t){if(typeof t.focus!="function")return c.error(r.createError(u+" focus member is not a function. _previouslyFocusedElement.focus: "+t.focus,{data:{previous:i.getObjectDescriptor(t)}})),!1}else return c.warning(u+" was not defined."),!1;return!0}u.defineProperty(t,"__esModule",{value:!0});var b=window,a=document,c=i.Base.Diagnostics.createLog(n),l=!1,e=[];t.initialize=g;t.dispose=nt;t.register=tt;t.unregister=it;t.validatePreviousFocusedElement=rt}));
define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","o","ko","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e){"use strict";i.defineProperty(t,"__esModule",{value:!0});var o=(function(){function n(n,t){var i=this,r;this._element=t.element;this._tabTriggers=t.tabTriggers||6;this._itemSelector=t.itemSelector||":tabbable";this._arrowsOnly=!(this._tabTriggers&2);this._internalLifetime=n.createChildLifetime();this._parentTabIndexContextObservable=t.parentTabIndexContextObservable;this._childrenHaveTabIndexContext=t.childrenHaveTabIndexContext;this._setRootTabIndex();this._internalLifetime.registerForDispose(this._element.setEvents([e.default.focus,function(){i._element.find(i._itemSelector).first().focus()},],[e.default.keydown,function(n){i._handleMenuKeyDown(n)},]));this._arrowsOnly&&(r=this._element.find(this._itemSelector),r.attr("tabindex","-1"),this._internalLifetime.registerForDispose(this._element.setEvents([e.default.focus,this._itemSelector,function(n){i._manageTabIndices($(n.target).closest(i._itemSelector,i._element[0]))}])))}return n.prototype.correctState=function(n){(n||this._lastTarget&&this._lastTarget.length&&this._element.find(this._itemSelector).toArray().indexOf(this._lastTarget[0])<0)&&this._setRootTabIndex()},n.prototype.dispose=function(){this._internalLifetime.dispose()},n.prototype._handleMenuKeyDown=function(n){var r=u.getModifierKeys(n),i=!1,f=this._tabTriggers&2,e=this._tabTriggers&4,o=this._tabTriggers&8,t=r===0;f&&n.keyCode===9&&t||e&&n.keyCode===40&&t||o&&n.keyCode===39&&t?i=this._moveFocusToItem(1,n.target):(f&&n.keyCode===9&&r===4||e&&n.keyCode===38&&t||o&&n.keyCode===37&&t)&&(i=this._moveFocusToItem(-1,n.target));i&&n.preventDefault()},n.prototype._moveFocusToItem=function(n,t){var r=!1,e=this._element.find(this._itemSelector),i=$(e.filter((function(n,t){return f.isElementVisible(t)}))),u=i.index(t);return u!==-1&&($(i[(u+n+i.length)%i.length]).focus(),r=!0),r},n.prototype._manageTabIndices=function(n){var t=this,i=this._element.find(this._itemSelector),u,f;this._lastTarget&&this._lastTarget[0]===n[0]||(this._itemFocusLifetime&&this._itemFocusLifetime.dispose(),this._itemFocusLifetime=this._internalLifetime.createChildLifetime(),this._lastTarget=n,i.index(this._lastTarget[0])>=0&&(this._parentTabIndexContextObservable?this._parentTabIndexContextObservable.subscribeAndRun(this._itemFocusLifetime,(function(n){if(i.attr("tabindex","-1"),t._lastTarget.attr("tabindex",n),t._childrenHaveTabIndexContext){var u=r.contextFor(t._lastTarget[0]).$tabIndex;u&&u(n)}})):(i.attr("tabindex","-1"),this._lastTarget.attr("tabindex","0"))),this._clearRootTabIndex(),u=function(){t._setRootTabIndex()},f=this._lastTarget[0],r.utils.domNodeDisposal.addDisposeCallback(f,u),this._itemFocusLifetime.registerForDispose((function(){r.utils.domNodeDisposal.removeDisposeCallback(f,u)})))},n.prototype._setRootTabIndex=function(){var n=this;this._parentTabIndexContextObservable?(this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._rootFocusLifetime=this._internalLifetime.createChildLifetime(),this._parentTabIndexContextObservable.subscribeAndRun(this._rootFocusLifetime,(function(t){n._element.attr("tabindex",t)}))):this._element.attr("tabindex","0")},n.prototype._clearRootTabIndex=function(){this._rootFocusLifetime&&this._rootFocusLifetime.dispose();this._element.attr("tabindex","-1")},n})();t.KeyboardNavigation=o}));
define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","f","i","o","ko","$","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function it(){if(!d){var n=e(r.createElement("div",{style:"width:50px;height:50px;overflow:auto"},r.createElement("div"))).appendTo("body"),t=n.children();d=t.innerWidth()-t.height(99).innerWidth();n.remove()}return d}function rt(n,t,i){var e,o,s;t===void 0&&(t=0);i===void 0&&(i=!1);var r=n.getBoundingClientRect(),u=document.documentElement,f=!0;return i||(e=v.innerWidth||u.clientWidth,f=r.left>=0&&r.right<=e),o=v.innerHeight||u.clientHeight,s=r.top+t>=0&&r.bottom+t<=o,{elementRect:r,fullyVisible:s&&f}}function ut(n,t){var i,u;if(!n||!t){p.error("Cannot register a template with an undefined "+(n?"content":"name")+".");return}if(!/^[a-z][a-z0-9]*$/ig.test(n)){p.error("Name '"+n+"' is invalid. Name must start with a letter and can only contain letters and numbers.");return}if(i=e(v.document.body),i.find("#"+n).length){p.error("A template with name '"+n+"' was already registered.");return}u=e(r.createElement("script",{id:n,type:"text/html"})).text(t);i.append(u)}function g(n){function r(t){var i=t.element;return n===i||e.contains(n,i)}var i=k.first(r),t;return i?i.promise:(t=b.get(n)||y.first((function(t){return e.contains(n,t.element)})),t)?t.promise.then((function(){return g(n)})):Q()}function ft(n){if(n){if(!e.contains(v.document.documentElement,n))return Q.reject(new i.Errors.CanceledError("container is not in documentElement"))}else return r.QReject("container is "+n);return g(n)}function et(n){n&&e.contains(v.document.documentElement,n)&&y.filter((function(t){var i=t.element;return n===i||e.contains(n,i)})).forEach((function(n){i.remove(y,n);n&&n.dispose()}))}function ot(n,t,i,r,u){var s=e(r),h=o.getWidget(s),c,f;return h!==null&&h.dispose(),u&&(c=new i.Widget(s,u,{bindingContext:t,services:{diContainer:n}}),f=c,f.awaitContentRevealed)?f.awaitContentRevealed():void 0}function st(t,r,u){var h,c,f,o;w.isInstanceOfErrorType(t,w.CanceledError)||(t&&(h=i.getLogFriendlyMessage(t),c=t.stack),f=u?"Failed to load the control module '"+u+"'.":"",h&&(f+="\r\n Error: "+h),o=e(r),o.closest("[class^='ext-']").length||o.closest("[class*=' ext-']").length?s.logToExtension(n,r,2,f):p.error(f,1),o.html(tt),Q.nextTick((function(){o.trigger(a.default.fxportalcontrolloadfailed,new i.Errors.Error({message:f,stack:c,innerErrors:t}))})))}function ht(n,t,r){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,u,e,o,s){var h=f.unwrap(u());f.ignoreDependencies((function(){var e,o=i.tryImmediateResolve(i.require(n),(function(n){if(!e)return ot(r,s,n,t,h)}),(function(r){if(!e&&!i.Errors.isInstanceOfErrorType(r,w.CanceledError))return st(r,t,n),Q.reject(r)})),c,l,u;Q.isFulfilled(o)||(c=function(){i.remove(y,u,-1);b.delete(t);e&&i.remove(k,u,-1)},l=function(){e=!0;c()},f.utils.domNodeDisposal.addDisposeCallback(t,l),u={element:t,promise:o,dispose:l},Q.isPending(o)&&(y.push(u),b.set(t,u)),u.promise=o.catch((function(n){return k.push(u),Q.reject(n)})).finally(c))}))}}}u.defineProperty(t,"__esModule",{value:!0});var nt=i.Base.Diagnostics,w=i.Errors,v=window,tt="<span class='fxs-portal-controlloadfailed'>"+l.getSvgReferenceOrFallBackToData(c).outerHTML+i.encodeHtml(h.PartError.title)+"<\/span>",p=nt.createLog(n),y=[],b=new i.Map,k=[],d;t.getBrowserScrollbarWidth=it;t.isElementFullyInViewport=rt;t.registerKoTemplate=ut;t.waitForBindings=ft;t.cancelBindings=et;t.getAsyncBindingHandler=ht}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-avatarmenu-tenant,.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;line-height:normal;max-width:146px}.fxs-avatarmenu{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu .fxs-dropmenu-content{box-shadow:0 8px 16px 0 rgba(0,0,0,.16)}.fxs-avatarmenu-header{position:relative;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:40px}.fxs-avatarmenu-username{font-size:14px}.fxs-avatarmenu-tenant{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;text-transform:uppercase;opacity:.9}.fxs-avatarmenu-tenant-container{text-align:right;-webkit-flex:1 1 auto;flex:1 1 auto;padding-left:20px}.fxs-avatarmenu-imageonly .fxs-dropmenu-button .fxs-avatarmenu-tenant-container{display:none}.fxs-avatarmenu-dropdown{width:220px}.fxs-avatarmenu-tenant-image-container{height:35px;width:35px;-webkit-flex:0 0 auto;flex:0 0 auto;padding-left:11px;padding-right:5px;box-sizing:content-box}.fxs-avatarmenu-tenant-image{height:35px;width:35px;border:0;border-radius:35px}.fxs-avatarmenu-dropdown-item{display:-webkit-flex;display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^=ja] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=ko] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=zh] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}.fxs-mecontrol-flyout{width:320px;height:240px}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-contextMenu{display:none;position:fixed;width:225px;padding:10px 0;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:200;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:0}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:30px;padding:5px 25px;box-sizing:border-box;font-size:13px;line-height:normal;cursor:pointer}.fxs-contextMenu-text{-webkit-flex:1 1 auto;flex:1 1 auto;height:20px}.fxs-contextMenu-icon{-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-content:flex-end;align-content:flex-end;height:21px;width:21px;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block}.fxs-contextMenu-itemDisabled{cursor:text}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon .azc-balloon-content{padding:0}.fxs-dialogballoon.azc-balloon.azc-balloon-box-bottom .azc-balloon-pointer{border-bottom-color:#464f59}.fxs-dialogballoon.azc-balloon.azc-balloon-box-top .azc-balloon-pointer{border-top-color:#3c454f}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide{display:block}.fxsfxs-contextMenuTouchHint{position:fixed;z-index:500;border:2px solid grey;box-sizing:border-box;background-color:rgba(255,255,255,.2);pointer-events:none}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-contextpane-title,.fxs-sidebar-label{text-overflow:ellipsis;white-space:nowrap}.fxs-sidebar{z-index:3;position:relative;height:100%;font-size:13px;box-sizing:border-box}.fxs-sidebar-list{padding:0;margin:0;list-style:none}.fxs-sidebar-button{cursor:pointer}.fxs-sidebar-browse,.fxs-sidebar-create{font-size:inherit}.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar-bar{width:225px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:100%;overflow:hidden}.fxs-sidebar-top{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-sidebar-top>.fxs-sidebar-button{width:100%;border:none;padding:0;text-align:left}.fxs-sidebar-middle{-webkit-flex:1 1 auto;flex:1 1 auto;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}@-moz-document url-prefix(){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}}@supports (-webkit-appearance:none) and (not (-ms-ime-align:auto)) and (not (-moz-appearance:none)){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}}.fxs-sidebar-favorites-section{height:32px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-sidebar-myfavorites{text-transform:uppercase;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:10px;word-break:keep-all;margin-left:10px}.fxs-sidebar-divider{border-bottom-width:1px;border-bottom-style:solid;height:0;-webkit-flex:1 1 0px;flex:1 1 0px}.fxs-sidebar-divider:first-of-type{margin-right:5px;max-width:13px}.fxs-sidebar-divider:last-of-type{margin-left:5px}.fxs-sidebar-item-link{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:1 1 auto;flex:1 1 auto;height:32px;-webkit-user-drag:none;color:inherit}.fxs-sidebar-icon{-webkit-flex:0 0 18px;flex:0 0 18px;height:18px;padding-left:15px}.fxs-sidebar-icon img,.fxs-sidebar-icon svg{height:18px;width:18px}.fxs-sidebar-label{-webkit-flex:1 1 auto;flex:1 1 auto;overflow:hidden;margin-left:6px}.fxs-sidebar-browse .fxs-sidebar-label,.fxs-sidebar-create .fxs-sidebar-label{margin-right:15px}.fxs-sidebar-collapse-button{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:28px}.fxs-sidebar-collapse-button svg{height:8px;width:8px;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);margin-left:auto;margin-right:10px}.fxs-sidebar-external svg,.fxs-sidebar-fav-icon svg{height:12px;width:12px}.fxs-sidebar-external{-webkit-flex:0 0 12px;flex:0 0 12px;margin:0 10px;padding-top:3px;width:12px;fill:#bbb}.fxs-sidebar-handle{-webkit-flex:0 0 20px;flex:0 0 20px;cursor:move;fill:#bbb}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-contextpane,.fxs-sidebar-flyout-is-hidden,.fxs-sidebar-is-collapsed .fxs-sidebar-external,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-label,.fxs-sidebar-is-collapsed .fxs-sidebar-myfavorites,.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-label{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-collapse-button svg{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{-ms-overflow-style:none}.fxs-sidebar-shadow{pointer-events:none;position:absolute;right:0;top:0;bottom:0}.fxs-contextpane{height:100%;position:relative;z-index:2}.fxs-contextpane-content{box-sizing:border-box;height:100%;overflow:auto}.fxs-contextpane-loadindicator{display:none;position:absolute;top:0;bottom:0;right:0;left:0;background:inherit}.fxs-contextpane-loading .fxs-contextpane-loadindicator{display:block}.fxs-contextpane-visible{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap}.fxs-contextpane-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:18px;line-height:50px;overflow:hidden;margin:0}.fxs-contextpane-close,.fxs-contextpane-expand{cursor:pointer;border:0;background-color:transparent;margin:0;transition:background .2s ease-out;position:absolute;top:0}.fxs-contextpane-close{right:0;height:30px;width:30px}.fxs-contextpane-close:hover{background:#ba141a;fill:#fff}.fxs-contextpane-close svg{height:12px;width:12px}.fxs-contextpane-expand{width:100%;z-index:2}.fxs-contextpane-expand .fxs-contextpane-button-inner{text-align:right}.fxs-contextpane-expand svg{height:8px;width:8px;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);margin:8px 2px}.fxs-sidebar+.fxs-portal-contextpane-left{width:380px;max-width:380px}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left{width:48px;max-width:48px}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery2-partscontainer,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery2-topcontainer>*{display:none}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery2-topcontainer .fxs-partgallery2-title{display:block;white-space:nowrap;-webkit-transform:rotate(90deg);transform:rotate(90deg);-webkit-transform-origin:0 12px 0;transform-origin:0 12px 0;position:absolute;top:25px;width:auto;z-index:3}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand .fxs-contextpane-button-inner{height:100%;display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand .fxs-contextpane-button-inner svg,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand svg{-webkit-transform:rotate(90deg) translateY(-24px);transform:rotate(90deg) translateY(-24px)}.fxs-portal-contextpane-right{position:absolute;right:0;max-width:calc(100% - 225px)}.fxs-portal-contextpane-from-topbar{z-index:5}.fxs-portal-topbar-menu-open .fxs-portal-contextpane-from-topbar{z-index:4}.fxs-portal-contextpane-right.fxs-contextpane-loading{min-width:355px}.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right{max-width:calc(100% - 48px)}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-dropmenu{position:relative;-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:none;padding:0;margin:0;background:0 0;cursor:pointer;display:-webkit-flex;display:flex;position:relative;height:100%;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:-webkit-flex;display:flex}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata{height:130px;width:100%}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata .fxs-journeysmenu-journey-nodata-content{font-size:12px;line-height:18px;margin:0 40px;padding-top:50px;text-align:center}.fxs-dropmenu-content{position:absolute}.fxs-dropmenu-content ol,.fxs-dropmenu-content ul{list-style:none;padding:0;margin:0}.fxs-dropmenu-content li{white-space:nowrap}.fxs-dropmenu-content li a{-webkit-align-items:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton{display:-webkit-flex;display:flex;-webkit-flex:0 0 auto;flex:0 0 auto;background:0 0;cursor:pointer;border:0;margin-right:5px;-webkit-align-items:center;align-items:center}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton svg{opacity:.2;height:15px;width:15px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover svg{opacity:1}.fxs-dropmenu-content .fxs-dropmenu-list-content{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-journeysmenu-journey{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;margin-right:auto}.fxs-dropmenu-content .fxs-journeysmenu-journey-content{-webkit-flex:0 0 auto;flex:0 0 auto;padding:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-dropmenu-image{-webkit-flex:0 0 auto;flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-content .fxs-dropmenu-image img,.fxs-dropmenu-content .fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-content .fxs-dropmenu-line-separator{border-top-width:1px;border-top-style:solid}.fxs-journeysmenu-content{min-width:450px}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}.fxs-journeysmenu-list{display:-webkit-flex;display:flex}.fxs-journeysmenu-journey-wrapper{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-childcontainer>.fxs-tile{transition:height 125ms linear 125ms,width 125ms linear 0s,top 175ms ease-out,left 175ms ease-out,right 175ms ease-out}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-size:13px;line-height:normal}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{-ms-touch-action:none;touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-livepreview,.fxs-flowlayout-resizehandle{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-panorama{position:relative;-ms-scroll-chaining:none}.fxs-panorama .fxs-home-target,.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-startboard-target{display:none;position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama>div[data-popup=true].azc-control{z-index:150}.fxs-show-home .fxs-home-target,.fxs-show-journey .fxs-journey-target,.fxs-show-startboard .fxs-startboard-target{display:-webkit-flex;display:flex}body.fxs-panning-cursor{cursor:ew-resize!important;cursor:-webkit-grabbing!important;cursor:-moz-grabbing!important;cursor:grabbing!important}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target{-webkit-transform:translateX(20px);transform:translateX(20px)}.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target{-webkit-transform:translateX(-20px);transform:translateX(-20px)}.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{-webkit-transform:translateX(0);transform:translateX(0)}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target,.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target,.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{transition:transform .333s ease!important}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"@-webkit-keyframes fxs-search-indicator-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%,50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}@keyframes fxs-search-indicator-animatedEllipses{0%{transform:scale(1);opacity:.3}36.1%,50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.fxs-search-menu{position:absolute;top:30px;left:0;width:100%;display:none;box-sizing:border-box}.fxs-search-text{white-space:normal;overflow:hidden;text-overflow:ellipsis}.fxs-search-wrapper{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;width:100%;border-radius:2px}.fxs-search{position:relative;display:-webkit-flex;display:flex}.fxs-search-icon-mini{padding:0 2px 0 8px;box-sizing:border-box;height:26px;width:22px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-search-icon-mini svg{height:12px;width:12px}.fxs-search-clear{height:26px;width:24px;cursor:pointer;fill:#484644;box-sizing:border-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fxs-search-clear svg{height:12px;width:12px}.fxs-search-box{height:26px;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-search-box .azc-input{border:0;font-size:13px;height:26px;background-color:transparent}.fxs-search-indicator{display:none;-webkit-align-items:center;align-items:center;height:26px;box-sizing:border-box}.fxs-search-indicator>div{height:7px;width:7px;-webkit-animation:fxs-search-indicator-animatedEllipses 1.5s infinite;animation:fxs-search-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search-indicator>div:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.fxs-search-indicator>div:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.fxs-search-indicator>div:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}.fxs-searching .fxs-search-indicator{display:-webkit-flex;display:flex}.fxs-search .fxs-search-icon{display:none}.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-icon{display:-webkit-flex;display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-icon,.fxs-topbar-state-searchcollapsed .fxs-search-wrapper{display:none}.fxs-topbar-state-searchcollapsed .fxs-search-activated .fxs-search-wrapper{display:-webkit-flex;display:flex}.fxs-topbar-state-searchcollapsed .fxs-search-activated.fxs-search-showmenu .fxs-search-menu{display:block}.fxs-topbar-state-searchcollapsed .fxs-search-showmenu .fxs-search-menu{display:none}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-sidebar{z-index:3;position:relative;height:100%;font-size:13px;box-sizing:border-box}.fxs-sidebar-list{padding:0;margin:0;list-style:none}.fxs-sidebar-button{cursor:pointer}.fxs-sidebar-browse,.fxs-sidebar-create{font-size:inherit}.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar-bar{width:225px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;height:100%;overflow:hidden}.fxs-sidebar-top{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-sidebar-top>.fxs-sidebar-button{width:100%;border:none;padding:0;text-align:left}.fxs-sidebar-middle{-webkit-flex:1 1 auto;flex:1 1 auto;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}@-moz-document url-prefix(){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}}@supports (-webkit-appearance:none) and (not (-ms-ime-align:auto)) and (not (-moz-appearance:none)){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:68px}}.fxs-sidebar-favorites-section{height:32px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-sidebar-myfavorites{text-transform:uppercase;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:10px;word-break:keep-all;margin-left:10px}.fxs-sidebar-divider{border-bottom-width:1px;border-bottom-style:solid;height:0;-webkit-flex:1 1 0px;flex:1 1 0px}.fxs-sidebar-divider:first-of-type{margin-right:5px;max-width:13px}.fxs-sidebar-divider:last-of-type{margin-left:5px}.fxs-sidebar-item-link{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:1 1 auto;flex:1 1 auto;height:32px;-webkit-user-drag:none;color:inherit}.fxs-sidebar-icon{-webkit-flex:0 0 18px;flex:0 0 18px;height:18px;padding-left:15px}.fxs-sidebar-icon img,.fxs-sidebar-icon svg{height:18px;width:18px}.fxs-sidebar-label{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:6px}.fxs-sidebar-browse .fxs-sidebar-label,.fxs-sidebar-create .fxs-sidebar-label{margin-right:15px}.fxs-sidebar-collapse-button{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:28px}.fxs-sidebar-collapse-button svg{height:8px;width:8px;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);margin-left:auto;margin-right:10px}.fxs-sidebar-external svg,.fxs-sidebar-fav-icon svg{height:12px;width:12px}.fxs-sidebar-external{-webkit-flex:0 0 12px;flex:0 0 12px;margin:0 10px;padding-top:3px;width:12px;fill:#bbb}.fxs-sidebar-handle{-webkit-flex:0 0 20px;flex:0 0 20px;cursor:move;fill:#bbb}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-sidebar-flyout-is-hidden,.fxs-sidebar-is-collapsed .fxs-sidebar-external,.fxs-sidebar-is-collapsed .fxs-sidebar-middle .fxs-sidebar-label,.fxs-sidebar-is-collapsed .fxs-sidebar-myfavorites,.fxs-sidebar-is-collapsed .fxs-sidebar-top>.fxs-sidebar-item-link .fxs-sidebar-label{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:48px}.fxs-sidebar-is-collapsed .fxs-sidebar-collapse-button svg{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{-ms-overflow-style:none}.fxs-sidebar-shadow{pointer-events:none;position:absolute;right:0;top:0;bottom:0}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-stacklayout{display:-webkit-flex;display:flex}.fxs-stacklayout.fxs-stacklayout-vertical{-webkit-flex-direction:column;flex-direction:column}.fxs-stacklayout.fxs-stacklayout-horizontal{-webkit-flex-direction:row;flex-direction:row;height:100%}.fxs-stacklayout-child{-webkit-flex:0 0 auto;flex:0 0 auto}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-portal-fullscreen .fxs-tile-actionbar-actionlist,.fxs-startboard-loading .fxs-startboard-layout,.fxs-startboard-loading .fxs-startboard-message-container{visibility:hidden}.fxs-startboard{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;overflow:hidden}.fxs-startboard .fxs-startboard-message-container,.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-landingpage{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-header{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;width:100%;height:45px;padding:0 25px 0 40px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-title-next{display:block}.fxs-startboard-header .fxs-startboard-button-text{font-size:13px}.fxs-startboard-header .fxs-startboard-button-icon{height:12px;width:12px;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;-webkit-flex:0 0 12px;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg{-webkit-flex:0 0 16px;flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px;margin:0 -6px -2px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button{position:relative}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-dropdown{font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-size:18px;line-height:24px}.fxs-startboard-header .fxs-startboard-actions,.fxs-startboard-header .fxs-startboard-migration{height:40px;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-fileUpload-overlay{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;display:block;cursor:pointer}.fxs-startboard-header .fxs-startboard-item-focused{outline:#00bcf2 dashed 1px;outline-offset:-1px}.fxs-startboard-header ::-webkit-file-upload-button{cursor:pointer}.fxs-startboard-layout{padding:16px 40px;overflow:auto;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard-dropdown{-webkit-flex:0 1 auto;flex:0 1 auto;min-width:32px;max-width:560px;padding:2px 0}.fxs-startboard-button{-webkit-flex:0 0 auto;flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;min-width:0}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:12px}.fxs-startboard-button:hover,.fxs-startboard-dropdown:hover{background:rgba(255,255,255,.15)}.fxs-startboard-button-browse{padding:0!important}.fxs-startboard-dropdown>.fxs-dropmenu,.fxs-startboard-dropdown>.fxs-dropmenu .fxs-dropmenu-button{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px;max-height:480px}.fxs-startboard-item-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{-webkit-flex:0 0 auto;flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-actions,.fxs-startboard-dropdown,.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit,.fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-actions,.fxs-startboard-header-normal .fxs-startboard-dropdown{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-actions,.fxs-startboard-header-migration .fxs-startboard-dropdown,.fxs-startboard-header-normal .fxs-startboard-migration,.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button{display:none}.fxs-startboard-notfound .fxs-startboard-button-delete,.fxs-startboard-notfound .fxs-startboard-button-new{display:-webkit-flex;display:flex}.fxs-topbar-dashboard-changed .fxs-startboard-header-item{display:none}.fxs-topbar-dashboard-changed .fxs-startboard-title-next{display:block}.fxs-startboard-loadanimation{display:none;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:-webkit-flex;display:flex}.fxs-startboard-loading .fxs-startboard-header-item{display:none}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content{display:none}@media all and (max-width:1300px){.fxs-startboard-button-text{display:none}}.fxs-portal-fullscreen .fxs-sidebar,.fxs-portal-fullscreen .fxs-topbar{display:none!important}.fxs-portal-fullscreen .fxs-portal-main{height:100%}.fxs-portal-fullscreen .fxs-startboard-button{display:none}.fxs-portal-fullscreen .fxs-startboard-button-fullscreen{display:-webkit-flex;display:flex}.fxs-portal-fullscreen .fxs-startboard-dropdown{display:none}.fxs-portal-fullscreen .fxs-startboard-title-next{display:block}.fxs-portal-fullscreen .fxs-tile::after{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-bladestyle-context .fxs-tile .fxs-part,.fxs-bladestyle-contextaction .fxs-tile .fxs-part,.fxs-bladestyle-create .fxs-tile .fxs-part,.fxs-bladestyle-help .fxs-tile .fxs-part,.fxs-tile{box-shadow:none}.fxs-tile-progress-transparent{height:12px;position:absolute;top:0;z-index:195;overflow:hidden}.fxs-tile-progress-transparent>div{margin-left:6px}.fxs-tile-progress-transparent>div::after{height:4px;width:4px;background:#000}.fxs-startboard .fxs-tile,.fxs-startboard .fxs-tile>.fxs-part{border-radius:2px}.fxs-tile{height:175px;width:175px;position:relative}.fxs-tile .fxs-tile-actionbar{z-index:196}.fxs-tile .fxs-tile-container{width:100%;height:100%}.fxs-tile.fxs-tilesize-mini{height:85px;width:85px}.fxs-tile.fxs-tilesize-small{height:85px;width:175px}.fxs-tile.fxs-tilesize-tall{height:355px;width:175px}.fxs-tile.fxs-tilesize-wide{height:175px;width:355px}.fxs-tile.fxs-tilesize-normal{height:175px;width:175px}.fxs-tile.fxs-tilesize-large{height:355px;width:355px}.fxs-tile.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tile.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tile.fxs-tilesize-hero{height:535px;width:535px}.fxs-tile.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tile.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part,.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tile.fxs-tilesize-fullwidthfitheight,.fxs-tile.fxs-tilesize-herowidefitheight{margin-bottom:5px}.fxs-tile.fxs-tilesize-fullwidthfitheight:last-child,.fxs-tile.fxs-tilesize-herowidefitheight:last-child{margin-bottom:0}.fxs-tile.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tile.fxs-tilesize-fittocontainer>.fxs-part{overflow:auto}.fxs-tile div.fxs-tile-overlay{display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-bladecontent-unlocked .fxs-tile .fxs-part,.fxs-startboard-layout .fxs-tile .fxs-part{box-shadow:0 2px 4px 0 rgba(0,0,0,.1)}.fxs-bladecontent-unlocked .fxs-tile .fxs-part:hover,.fxs-startboard-layout .fxs-tile .fxs-part:hover{box-shadow:0 4px 8px 0 rgba(0,0,0,.14)}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-tile-actionbar-actionlist{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;border-radius:0 2px 0 0}.fxs-tile-actionbar-actionlist:empty{height:25px;visibility:hidden}.fxs-tile-actionbar-actionlist .fxs-tile-actionbar-action:last-of-type{border-radius:0 2px 0 0}.fxs-tile-actionbar-action{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actionbar{position:absolute;right:0;cursor:default}.fxs-tile-actionbar-command-unpinfromstartboard{display:none}.fxs-desktop-organize .fxs-tile-actionbar-command-unpinfromstartboard{display:-webkit-flex;display:flex}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-toast-description,.fxs-toast-time,.fxs-toast-title{overflow:hidden;text-overflow:ellipsis}.fxs-nps .fxs-nps-commentstitle,.fxs-nps .fxs-nps-link-survey,.fxs-nps .fxs-nps-submit,.fxs-toast-title.fxs-toast-link:hover{text-decoration:underline}.fxs-toast{position:fixed;top:45px;right:5px;width:355px;list-style-type:none;margin:0}.fxs-toast-header,.fxs-toast-item{display:-webkit-flex;margin-bottom:5px}.fxs-toast-content,.fxs-toast-wrapper{-webkit-flex:1 1 auto;flex:1 1 auto;padding:10px}.fxs-toast-item{display:flex;position:relative}.fxs-topbar-toast .fxs-toast-item.fxs-popup{box-shadow:0 10px 18px 0 rgba(0,0,0,.18)}.fxs-toast-header{display:flex;-webkit-align-items:center;align-items:center;padding-top:5px}.fxs-toast-icon svg{height:14px;width:14px}.fxs-toast-title{-webkit-flex:1 1 auto;flex:1 1 auto;margin-left:10px;max-width:254px;white-space:nowrap}.fxs-toast-time{white-space:nowrap;max-width:60px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:0 0;border:none;padding:5px;cursor:pointer}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-size:12px;line-height:18px;width:335px;position:relative;white-space:pre-wrap}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-nps .fxs-nps-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;margin-bottom:7px}.fxs-nps .fxs-nps-score{display:-webkit-flex;display:flex}.fxs-nps .fxs-nps-score span{-webkit-flex:1 1 auto;flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;font-size:11px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxs-nps-score span.fxs-nps-score-selected,.fxs-nps .fxs-nps-score span:hover{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{color:#758393;display:flex;margin-bottom:10px;font-size:12px;width:335px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-nps-survey{font-size:12px}.fxs-nps .fxs-nps-comments{margin-top:6px;margin-bottom:18px;width:319px;border:1px solid #c5cbd1;height:100px;padding:7px}.fxs-nps .fxs-nps-checkbox{margin:10px 5px 0 10px;padding:0;vertical-align:bottom;width:14px;height:14px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2;margin-left:-10px}.fxs-nps .fxs-nps-submit{margin:15px 10px 5px;background-color:#00bcf2;border-color:#00bcf2;color:#fff}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-topbar{height:40px;position:relative;z-index:5;-webkit-flex:0 0 auto;flex:0 0 auto;font-size:13px}.fxs-topbar-brand{-webkit-flex:0 0 auto;flex:0 0 auto;margin:0;padding:0;height:100%}.fxs-topbar .fxs-topbar-journey-icon{border:none}.fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;display:-webkit-flex;display:flex;-webkit-align-content:center;align-content:center;-webkit-align-items:center;align-items:center}.fxs-topbar-internal{color:#1c1c1c;height:40px;min-width:85px;max-width:225px;box-sizing:border-box;padding:0 12px;line-height:40px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug{display:-webkit-flex;display:flex;height:40px;width:auto;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;padding:0 8px}.fxs-topbar-home{display:inline-block;font-size:15px;padding:0 15px;height:40px;line-height:40px;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.fxs-topbar-button{display:-webkit-flex;display:flex;height:40px;width:48px;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fxs-topbar-button svg{height:16px;width:16px}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-dashboard-message,.fxs-topbar-exit-customize-message{font-size:14px}.fxs-topbar-dashboard .fxs-button,.fxs-topbar-exit-customize-button{-webkit-flex:0 0 auto;flex:0 0 auto;margin-left:10px}.fxs-topbar-dashboard-view{display:none}.fxs-show-journey .fxs-topbar-dashboard-view{display:block}.fxs-show-journey .fxs-topbar-dashboard-discard,.fxs-show-journey .fxs-topbar-dashboard-save{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;-webkit-flex:1 1 auto;flex:1 1 auto;position:absolute;top:-40px;z-index:5;visibility:hidden;width:100%;height:100%;transition:top .3s ease .1ms}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}.fxs-topbar-placeholder{-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-topbar-buttons-container{display:-webkit-flex;display:flex;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-topbar-search{margin-left:15px;width:468px;min-width:250px;-webkit-flex:0 1 auto;flex:0 1 auto}.fxs-topbar-state-searchcollapsed .fxs-topbar-search{width:48px;min-width:48px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search{max-width:468px;width:calc(100% - 5px*2);margin:auto}.fxs-topbar-state-searchcollapsed.fxs-topbar-search-activated .fxs-topbar-search-activated-hidden{display:none}')}));
define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","i","o","a","ko","$","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var u=(function(){function n(){this.disabled=f.observable(!1)}return n})(),t;n.ViewModel=u;t=(function(){function n(t,r){var u=this,f;if(!t||t.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this.options=r;f=this._ltm=new i.TriggerableLifetimeManager;this.element=e(t[0]);f.registerForDispose(t.setEvents([n.widgetRemoveEvent,function(n){n.target!==t[0]||u._disposeTriggered||(u._disposeTriggered=!0,u.dispose())},]));t.data(n._widgetTypesDataKey)||t.data(n._widgetTypesDataKey,[]);t.data(n._widgetTypesDataKey).push(this)}return n.prototype.setFocus=function(){},n.prototype.dispose=function(){this._ltm.dispose();var i=this.element,t=i.data(n._widgetTypesDataKey);t&&(t.splice(t.indexOf(this),1),t.length===0&&i.removeData(n._widgetTypesDataKey))},r.defineProperty(n.prototype,"ltm",{get:function(){return this._ltm},enumerable:!0,configurable:!0}),n.getWidget=function(t,i){var r=n.getWidgets(t,i);return r?r[0]||null:null},n.getWidgets=function(t,i){var r=t.data(n._widgetTypesDataKey)||[];return i?r.filter((function(n){return n instanceof i})):r},n.prototype.trigger=function(n,t,i){var u=this.options[n],r=this.element;return i=i||{},t=t||e.Event(n),t.type=n,t.target=r[0],r.trigger(t,i),!(e.isFunction(u)&&u.apply(r[0],[t].concat(i))===!1||t.isDefaultPrevented())},n.prototype.getTelemetrySource=function(){return null},n.prototype._bindDescendants=function(n){var t={data:this.options,func:this},i=n?e.extend(null,t,n):t;f.applyBindingsToDescendants(i,this.element[0])},n.prototype._cleanDescendants=function(){f.utils.cleanDescendantNodes(this.element)},n.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._cleanDescendants();i=this.element;t.length>0&&i.removeClass(t.join(" "));i.empty()},n.prototype._isRtl=function(){return e.querySelectorAll("html").first().attr("dir")==="rtl"},n})();t.widgetRemoveEvent=o.default.remove+".fxWidget";t._widgetTypesDataKey="fxWidgetTypes";n.Widget=t})(s||(s={})),s}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-formdialog,.fxs-messagebox,.fxs-progressbox{box-shadow:0 4px 8px 0 rgba(0,0,0,.14);font-size:14px;box-sizing:border-box;border-width:1px;border-style:solid;line-height:normal}.fxs-progressbox{color:#fff}.fxs-messagebox-title{font-size:16px;padding:12px 25px 7px;margin:0;line-height:normal;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-messagebox-text,.fxs-modal-template,.fxs-progressbox-text{padding:0 25px 15px;word-wrap:break-word}.fxs-formdialog-buttons,.fxs-messagebox-buttons{border-top-width:1px;border-top-style:solid;padding:15px 25px}.fxs-formdialog-buttons .fxs-button,.fxs-messagebox-buttons .fxs-button{margin-right:5px}.fxs-progressbox-progressbar{padding:7px 25px 24px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 25px 0;display:block}.fxs-formdialog-description{padding:0 25px}.fxs-formdialog-form{padding:15px 25px;width:448px;max-width:calc(100% - 2 * 25px)}")}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","f","o","ko","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/JQueryHelper","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var k;r.defineProperty(t,"__esModule",{value:!0});var v=i.ViewModels.Controls.SimpleButton.ViewModel,d=i.ViewModels.Forms.Section,a=d.ViewModel,y=i.getUniqueId,p="fxs-formdialog",w="fxs-portal-bg-txt-br",b="fxs-popup",g="<div class='fxs-formdialog-header fxs-portal-border'><h2 data-bind='text: data.dialogOptions.title' class='fxs-messagebox-title'><\/h2><div class='fxs-formdialog-description' data-bind='text: data.dialogOptions.description'><\/div><\/div><div class='fxs-formdialog-form msportalfx-form' data-bind='pcControl: func._formSection'><\/div><div class='fxs-formdialog-buttons fxs-portal-border'><div class='fxs-formdialog-okbutton' data-bind='pcControl: func._okButton'><\/div><div class='fxs-formdialog-cancelbutton' data-bind='pcControl: func._cancelButton'><\/div><\/div>",nt=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.okButtonText=u.observable(),t.cancelButtonText=u.observable(),t.onOkClick=i.noop,t.onCancelClick=i.noop,t}return __extends(t,n),t})(s.ViewModel);t.ViewModel=nt;k=(function(n){function t(t,i){var r=n.call(this,t,i)||this,f,u;if(!i.dialogOptions)throw new Error("dialogOptions must be specified for rendering a form dialog.");return t.addClass(p+" "+b+" "+w).html(g),f=document.activeElement,u={dismissFn:function(){r._cancelButton&&i.onCancelClick()},restoreFocus:function(){e.validatePreviousFocusedElement(u,f)&&f.focus()},logName:"formdialog"},new o.KeyboardNavigation(r.ltm,{element:t,tabTriggers:2}),e.register(u),r.ltm.registerForDispose((function(){e.unregister(u)})),r._initializeViewModels(u),r._bindDescendants(),r._setAria(),r.setFocus(),r}return __extends(t,n),t.prototype.setFocus=function(){var t=this,n=this.element;h.waitForBindings(n[0]).finally((function(){var i=n.find("input:first");i.length===0&&(i=n.find(".fxs-formdialog-okbutton:first .fxs-button"));c.requestAnimationFrame((function(){t.ltm&&!t.ltm.isDisposed()&&i.length&&l.isElementVisible(i[0])&&i.focus()}))}))},t.prototype.dispose=function(){this._cleanElement(p,b,w);n.prototype.dispose.call(this)},t.prototype._setAria=function(){var n=this.element,t=y(),i=y();n.attr({role:"alertdialog","aria-labelledby":i,"aria-describedby":t});n.find("h2").attr("id",i);n.findByClassName("fxs-formdialog-description").attr({id:t});this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby tabindex")}))},t.prototype._initializeViewModels=function(n){var s=this,t=this.ltm,r=this.options,e=r.dialogOptions,h=[[e.row1column1,e.row1column2],[e.row2column1,e.row2column2],],c=h.map((function(n){var r=n.filter(i.identity).map((function(n){return new a(t,{style:u.observable(0),children:u.observableArray([n])})}));if(r.length)return new a(t,{style:u.observable(3),children:u.observableArray(r)})})).filter(i.identity),l=this._formSection=new a(t,{children:u.observableArray(c)}),o;this._cancelButton=new v(t,{text:r.cancelButtonText,onClick:function(){r.onCancelClick();n.restoreFocus()}});o=this._okButton=new v(t,{text:r.okButtonText,primary:!0,onClick:function(){f.ensureFormFieldValidation(s.element,!0).then((function(t){t&&(r.onOkClick(),n.restoreFocus())}))}});u.computed(t,[this._formSection.valid],(function(){o.disabled(!l.valid())}))},t})(s.Widget);t.Widget=k}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup .fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup .fxs-listpopup-item{font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}")}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var b;r.defineProperty(t,"__esModule",{value:!0});var k=i.Base.Diagnostics,c=".fxs-commandBar-item",l="fxs-listpopup",d=k.createLog(n),a="fxs-portal-bg-txt-br",v="fxs-popup",y="fxs-listpopup-list",p="fxs-listpopup-item",w="."+p,g="<ul class='"+y+"' data-bind='foreach: func._items' role='menu'>"+("<li role='menuitem' class='"+p+" fxs-portal-hover' tabindex='-1'")+'data-bind=\'text: text, css: { "fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary": text === $root.data.dialogOptions.selectedItem() }, event: { click: onClick, keydown: onKeyDown}, attr: { title: text, "aria-setsize": $parent.func._items().length, "aria-posinset": $index() + 1, "aria-selected": text === $root.data.dialogOptions.selectedItem() }\'><\/li><\/ul>',nt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(h.ViewModel);t.ViewModel=nt;b=(function(n){function t(t,i){var r=n.call(this,t,i)||this;i.dialogOptions||d.error("dialogOptions must be specified for rendering a list popup.");var h=document.activeElement,p=function(n){return n===h||f.contains(h,n)?0:!(t[0]===n)&&!f.contains(t[0],n)?2:0},b=r._dismissHandle={dismissFn:function(){var n=i.onLostFocus;n&&n()},shouldDismissOnFocusOutFn:p,shouldDismissOnMouseDownFn:p,shouldDismissOnMouseWheelFn:p,restoreFocus:function(){e.validatePreviousFocusedElement(b,h)&&h.focus()},logName:"listpopup"};return r._items=u.computed(r.ltm,(function(){var n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),b.restoreFocus())};return i.dialogOptions.listItems().map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){if((r.keyCode===13||r.keyCode===32)&&o.getModifierKeys(r)===0)r.stopPropagation(),n(t);else return!0}}}))})),t.addClass(l+" "+v+" "+a).html(g),new s.KeyboardNavigation(r.ltm,{element:t.find("."+y),tabTriggers:12,itemSelector:w}),t.closest(c).attr("aria-expanded","true"),r._bindDescendants(),Q.nextTick((function(){r.setFocus()})),e.register(b),r}return __extends(t,n),t.prototype.dispose=function(){e.unregister(this._dismissHandle);this._cleanElement(l,v,a);this.element.removeAttr("tabindex").closest(c).attr("aria-expanded","false");n.prototype.dispose.call(this)},t.prototype.setFocus=function(){this.element.find(w).first().focus()},t})(h.Widget);t.Widget=b}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","MsPortalImpl.Controls/Controls/SimpleButton"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){var i=n.closest("."+v),t;i.length>0&&(t=h.Widget.getWidget(i,y),t.cancelBtn&&t.cancelBtn.onClick.call(this))}function d(n,t){var r=n.closest("."+v),i;for(r.length>0&&c.waitForBindings(r[0]).then((function(){var t=h.Widget.getWidget(r,y),n=r.findFirstTabbable();n.closest(".fxs-messagebox-buttons").length>0?t.element.find(".fxs-portal-button-primary").focus():n.focus()})),i=t||document.activeElement;i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];w=i}var g,y;r.defineProperty(t,"__esModule",{value:!0});var nt=i.Base.Diagnostics,tt=i.ViewModels.Controls.SimpleButton.ViewModel,a=nt.createLog(n),b=i.getUniqueId,l=e.Dialogs.ButtonText,k="fxs-portal-bg-txt-br",v="fxs-messagebox",p="fxs-messagebox-text",it='<h2 data-bind="text: data.title" class="fxs-messagebox-title msportalfx-tooltip-overflow"><\/h2><!-- ko if: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="sanitizedHtml: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class="fxs-modal-template" data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko ifnot: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="text: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class=\'msportalfx-padding\' data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko if: data.confirmationRequired --><div data-bind="pcControl: func.checkboxVm" class="fxs-messagebox-confirmation"><\/div><!-- /ko --><div class="msportalfx-form fxs-messagebox-buttons fxs-portal-border" data-bind="foreach: func.buttonVms"><div data-bind="pcControl: $data.vm, attr: { \'data-result\': $data.result }"><\/div><\/div>',w=document.activeElement;t.cancelMessageBox=rt;t.setFocusOnMessageBox=d;g=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.title=u.observable(),t.text=u.observable(),t.template=u.observable(),t.templateViewModel=u.observable(),t.modal=!1,t.buttons=1,t.confirmationRequired=!1,t}return __extends(t,n),r.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!0,configurable:!0}),t})(h.ViewModel);t.ViewModel=g;y=(function(n){function t(t,r){var e=n.call(this,t,r)||this,h,c;return e.buttonVms=u.observableArray([]),t.html(it).addClass(v).addClass(k),h=e.ltm,c=function(n){var t=e.element[0];return!e.options.modal&&!(t===n)&&!f.contains(t,n)?2:0},e._dismissHandle={dismissFn:function(){e.cancelBtn&&e.cancelBtn.onClick.call(e)},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,restoreFocus:function(){o.validatePreviousFocusedElement(e._dismissHandle,w)&&w.focus()},logName:"messagebox"},r.confirmationRequired&&(e.checkboxVm=new i.ViewModels.Forms.CheckBox.ViewModel(h,{label:u.observable(r.confirmationMessage),inlineLabel:!0})),e._getButtonHtml(r.buttons,h),e._bindDescendants(),e._setAria(),d(t,document.activeElement),new s.KeyboardNavigation(e.ltm,{element:t,tabTriggers:2}),o.register(e._dismissHandle),h.registerForDispose((function(){o.unregister(e._dismissHandle)})),r.confirmationRequired&&(e.checkboxVm.value(!1),u.reactor(h,(function(){e.defaultBtn.disabled(!e.checkboxVm.value())}))),e}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(v,k);n.prototype.dispose.call(this)},t.prototype.generateBtns=function(n,t){var u=this,r=this.buttonVms,f=function(n,t,i){return new tt(n,{text:i.text,primary:t,disabled:i.disabled,onClick:function(){if(typeof u.options.onButtonClick=="function")u.options.onButtonClick(i.result);u._dismissHandle.restoreFocus()}})};r().forEach((function(n){n.vm.dispose()}));r().length=0;r([]);this.defaultBtn=null;this.cancelBtn=null;this.extraBtn=null;t.forEach((function(t,i){i===0&&t.kind!==1&&a.error("The first button should be the default button for this dialog.");u.defaultBtn&&t.kind===1&&a.error("Only one default button should be defined.");u.cancelBtn&&t.kind===2&&a.error("Only one cancel button should be defined.");switch(t.kind){case 1:r.push({vm:f(n,!0,t),result:t.result});u.defaultBtn=r().last().vm;break;case 2:r.push({vm:f(n,!1,t),result:t.result});u.cancelBtn=r().last().vm;break;case 3:default:r.push({vm:f(n,!1,t),result:t.result});u.extraBtn=r().last().vm}}));t.length===1&&(this.cancelBtn=this.defaultBtn);i.isNullOrUndefined(this.cancelBtn)&&a.error("Cancel button should be defined.")},t.prototype._getButtonHtml=function(n,t){var i=this.options;if(i.customBtns)this.generateBtns(t,i.customBtns);else{switch(n){case 0:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.abort,result:0},{kind:3,text:l.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:l.ok,result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:l.ok,result:4},{kind:2,text:l.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:2,text:l.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:3,text:l.no,result:3},{kind:2,text:l.cancel,result:1}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}this.defaultBtn&&i.defaultButtonText&&this.defaultBtn.text(i.defaultButtonText);this.cancelBtn&&i.cancelButtonText&&this.cancelBtn.text(i.cancelButtonText);this.extraBtn&&i.extraButtonText&&this.extraBtn.text(i.extraButtonText)}return},t.prototype._setAria=function(){var n=this.element,t=b(),i=b();n.attr({role:"alertdialog","aria-labelledby":i,"aria-describedby":t});n.find("h2").attr("id",i);n.findByClassName(p).attr("id",t);this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby tabindex")}))},t})(h.Widget);t.Widget=y}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css"],(function(n,t,i,r,u,f,e){"use strict";var y;r.defineProperty(t,"__esModule",{value:!0});var p=f.Dialogs.ProgressBar,s="fxs-progressbox",h="fxs-progressbox-text",w="<h2 data-bind='text: data.title' class='fxs-messagebox-title'><\/h2><div data-bind='text: data.text' class='"+h+"'><\/div><div data-bind='text: data.completionText' class='fxs-progressbox-progressbar'><\/div>",c="fxs-popup",l="fxs-portal-bg-txt-br",o=u.observable,a=u.isObservable,v=i.getUniqueId,b=(function(n){function t(t,i){var r=n.call(this)||this;return r.title=o(),r.text=o(),r.completionPercentage=o(-1),a(t)&&(r.text=t),a(i)&&(r.completionPercentage=i),r.completionText=u.pureComputed((function(){var n=r.completionPercentage();return n<0||n>100?"":p.percentComplete.format(n)})),r}return __extends(t,n),t})(e.ViewModel);t.ViewModel=b;y=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.element.html(w).addClass(s).addClass(c).addClass(l),r._bindDescendants(),r._setAria(),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(s,c,l);n.prototype.dispose.call(this)},t.prototype._setAria=function(){var n=this.element,t=v(),i=v();n.attr({role:"alertdialog","aria-labelledby":i,"aria-describedby":t});n.find("h2").attr("id",i);n.findByClassName(h).attr("id",t);n.attr("tabindex",-1).focus();this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby tabindex")}))},t})(e.Widget);t.Widget=y}));
define("MsPortalImpl/UI/UI.DialogManager",["require","exports","f","i","o","a","ko","FxInternal/Di","MsPortalImpl/Base/Themes","Viva.Controls/Util/Viva.Util","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","MsPortalImpl/Svg/Startup/Error.svg","MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";function ut(n){return"The {0} used to render the dialog was not specified.".format(n)}function yt(n,t){var r=i.getUniqueId();return n.replaceAll(t,r).replaceAll("msportalfx-svg-c01",t).replaceAll(r,"msportalfx-svg-c01")}function pt(n,t,r,u,f){var e,o;switch(r.type){case 1:e=new g.Widget(t,ui(f,r,u));break;case 2:e=new y.Widget(t,ei(null,r));break;case 4:o=si(f,r);o.onLostFocus=function(){n.dismissOpenDialog()};e=new a.Widget(t,o);break;case 3:e=new c.Widget(t,oi(f,r));break;case i.ViewModels.Internal.Dlg2:r.positionHint=r.positionHint||3;e=new g.Widget(t,fi(f,r,u))}return e}function ui(n,t,i){var r=new g.ViewModel;return r.title(t.title),t.templateViewModel?(r.template(t.text),r.templateViewModel(t.templateViewModel)):r.text(t.text),r.buttons=t.buttons,r.onButtonClick=function(t){n(t)},r.modal=i,r.defaultButtonText=t.defaultButtonText,r.cancelButtonText=t.cancelButtonText,r.extraButtonText=t.extraButtonText,r.confirmationRequired=t.confirmationRequired,r.confirmationMessage=t.confirmationMessage,r}function fi(n,t,r){var u=new g.ViewModel;return u.title(t.title),typeof t.content=="object"?(u.template(t.content.htmlTemplate),u.templateViewModel(t.content.viewModel)):typeof t.content=="string"&&u.text(t.content),f.isArray(t.buttons)?(u.customBtns=[],t.buttons.forEach((function(n){var t=n.displayText||it[n.button];u.customBtns.push({kind:3,text:t,result:n.button,disabled:n.disabled})})),u.customBtns.length&&(u.customBtns[0].kind=1,u.customBtns.length>1&&(i.last(u.customBtns).kind=2))):u.buttons=t.buttons,u.onButtonClick=function(t){n(t)},u.modal=r,u}function ei(n,t){var i=new y.ViewModel(t.text,t.completionPercentage);return i.title(t.title),i}function oi(n,t){var i=new c.ViewModel;return i.dialogOptions=t,i.okButtonText(tt.Dialogs.okButtonText),i.cancelButtonText(tt.Dialogs.cancelButtonText),i.onOkClick=function(){n(4)},i.onCancelClick=function(){n(1)},i}function si(n,t){var i=new a.ViewModel;return i.dialogOptions=t,i.onItemSelected=function(){n(4)},i}function wt(n,t){var r=n.closest(".fxs-tile").data(k.CompositionInstanceDataName),u;return r&&k.isPartComposition(r)?u=r.locator:t!=="sideload"&&ti.error("Unable to determine the extension that opened the dialog. "+i.getCurrentCallStack(!0)),u}function bt(n){var r=n.closest(".fxs-bladecontent"),t=d.Widget.getWidgets(r),i;return t&&t.length&&(i=t[0],n=et(i.getForm())),n}function kt(n,t){dt(at.DialogOpened,n,t)}function ft(n,t,i){dt(at.DialogClosed,n,i,t+"")}function dt(n,t,i,r){i=i?"/"+i:"fxDefault";var u=""+(t&&t.toFriendlyString())+i;gt.trace({source:ri,name:u,action:n,extension:t&&t.getExtensionLocator().name,data:r})}var rt,it,ct,vt,ot;u.defineProperty(t,"__esModule",{value:!0});var st=i.Base,lt=st.Diagnostics,gt=lt.Telemetry,ni=i.ViewModels.Dialogs,et=jQuery,ht=et(window.document.body),ti=lt.createLog(n),ii="<div class='fxs-portal-shield-icon fxs-portal-shield-icon-on-topbar'><\/div><div class='fxs-portal-shield-modaldialog'><div><\/div><\/div>",ri=b.Source.Shell,at=b.Action;rt=tt.Dialogs.ButtonText;it=[];it[0]=rt.abort;it[1]=rt.cancel;it[2]=rt.ignore;it[3]=rt.no;it[4]=rt.ok;it[5]=rt.retry;it[6]=rt.yes;ct=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(ni.MessageBox);t.MessageBox=ct;vt=(function(){function n(n,t){this._portalIdleService=n;this._diContainer=t}return u.defineProperty(n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!0,configurable:!0}),n.prototype.dismissOpenDialog=function(){this._dismissOpenDialog&&(this._dismissOpenDialog(),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var s=this,t=et(r.createElement("div",{"class":"fxs-portal-shield",trustedInnerHTML:ii})),u,v,h,o,c,f,a,y,e;return ht.append(t),u=t.findByClassName("fxs-portal-shield-icon"),v=t.findByClassName("fxs-portal-shield-modaldialog"),n.showErrorIcon?(h=nt.getSvgReferenceOrFallBackToData(i.extend2(p,{data:yt(p.data,"msportalfx-svg-c22")})),o="fxs-portal-shield-icon-error"):(h=nt.getSvgReferenceOrFallBackToData(i.extend2(w,{data:yt(w.data,"msportalfx-svg-c10")})),o="fxs-portal-shield-icon-warning"),u.empty().append(h),u.addClass(o),c=ht.findByClassName("fxs-topbar-content").width(),f=ht.findByClassName("fxs-topbar-notifications").position(),c&&f&&(a=c-(f.left+40),u.css({top:f.top,right:a}),v.css({top:f.top+40,right:a})),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),y=t.find(".fxs-portal-shield-modaldialog > div"),e=new ct(n.title,n.description,n.buttons),e.defaultButtonText=n.defaultButtonText,e.cancelButtonText=n.cancelButtonText,e.templateViewModel=n.templateViewModel,l.unhide(t),this._portalIdleService.signalIdle(),this._showDialog(y,e,!0,null).then((function(i){var r=n.uiShield&&n.uiShield.hidePromise;return r?(s._currentCancelToken=new st.Promises.CancelationToken,st.Promises.wrapWithCancelablePromise(r,s._currentCancelToken).then((function(){l.hide(t)}))):l.hide(t),u.removeClass(o),i})).finally((function(){s._portalIdleService.signalBusy()}))},n.prototype.showDialog=function(n,t,i,r){return n?t?(this.dismissOpenDialog(),this._showDialog(n,t,!1,i,r)):Q.reject(ut("options")):Q.reject(ut("element"))},n.prototype.showDialogWithCallback=function(n,t,i,r){if(!n)throw new Error(ut("element"));if(!t)throw new Error(ut("options"));this.dismissOpenDialog();this._showDialogWithCallback(n,t,!1,i,r)},n.prototype.showShellDialog=function(n,t,r,u,f,o){var s=Q.defer();if(!t)return Q.reject(ut("formTarget"));if(!r)return Q.reject(ut("sourceTarget"));if(!n)return Q.reject(ut("options"));f=i.isUndefined(f)?!0:f;this.dismissOpenDialog();var c=et(t.getForm()),l=this._showDialog(c,n,f,u,o?"sideload":"").then((function(n){return t.hideForm(),n})),a=h.getBox(r);return t.showForm(a,n.positionHint),e.dataFor(c[0]).func.ltm.registerForDispose([c.setEvents(["closed",function(){s.resolve(1)},]),]),l.then(s.resolve).catch(s.reject),s.promise},n.prototype._showDialog=function(n,t,r,u,f){var e=this;return i.tryImmediateResolve(this._diContainer.getAsync(s.ThemeManager),(function(){var o=t.telemetryName,i=Q.defer(),h=function(n){i.resolve(n)},s;return u||r||(u=wt(n,f)),t.type!==4&&(n=bt(n)),s=pt(e,n,t,r,h),kt(u,o),s?(e._dismissOpenDialog=function(){s.dispose();i.reject();ft(u,"Dismissed",o)},i.promise.then((function(n){s.dispose();e._dismissOpenDialog=null;ft(u,n,o)}))):(ft(u,"InvalidDialogType",o),i.reject("Invalid type specified in dialogOptions.")),i.promise}))},n.prototype._showDialogWithCallback=function(n,t,r,u,f){var e=this;i.tryImmediateResolve(this._diContainer.getAsync(s.ThemeManager),(function(){var o=t.telemetryName,i,s;f||r||(f=wt(n));t.type!==4&&(n=bt(n));s=function(n){i&&i.dispose();e._dismissOpenDialog=null;ft(f,n,o);u&&u(n)};i=pt(e,n,t,r,s);kt(f,o);i?e._dismissOpenDialog=function(){i.dispose();ft(f,"Dismissed",o)}:ft(f,"InvalidDialogType",o)}))},n})();ot=(function(){function n(){}return n.create=function(n,t){return new vt(n,t)},n})();__decorate([o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[v.PortalIdleStateService,o.Container]),__metadata("design:returntype",ot)],ot,"create",null);t.DialogManager=ot}));
define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","f","i","o","a","ko","Fx/ResourceManagement","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function ri(n){return st=new rt(n)}function ui(){return st}function at(n,t){var i=s.getBladeDeepLink({name:t.extension},t.detailBlade,"",t.detailBladeInputs,!0);n.route(i)}function vt(n){return ut.getWindowId({name:n})}function fi(n){return vt(n.name)}function k(n){return n&&n.trim()}function yt(n){if(n.additionalProperties||(n.additionalProperties={}),!n.additionalProperties[tt]){var t=n.asset,i=t&&t.assetId,r=o.ArmId.parse(i).subscription;n.additionalProperties[tt]=r}}function pt(n){return yt(n),r.ViewModels.getBladeSelection("Microsoft_Azure_ActivityLog","ActivityLogBlade",{queryInputs:{correlatedEvents:{correlationId:n.correlationIds[0],duration:n.timestamp.getMinutes(),subscriptionId:(n.additionalProperties||{})[tt]||null}}})}function ei(n,t,i){var y=t.isRecommendation?nt.RecommendationClicked:nt.NotificationClicked,e,u,r,o,f;if(bt(t,y),e=n.router,u=t.asset,u){var h=u.assetType,l=h.toLowerCase(),a=u.extensionName,v=a.toLowerCase(),w=i||!n.extensionManager.getExtension(ht)||v===p.Billing.toLowerCase()&&l===et.SubscriptionDetail.toLowerCase()||v===ii.toLowerCase()&&l===et.Deployments.toLowerCase();if(w){e.route(s.getAssetDeepLink(n.diContainer,{name:a},h,u.assetId));return}}if(r=t.uri,r){o=t.uriAction||d.Resources.isUriAbsolute(r)&&lt||g.NavigatePortal;o===lt?n.diContainer.get(c.WindowManager).openWindow(r):o===g.OpenInCurrentTab?ni.location.href=r:e.route(r);return}f=t.linkedBlade;f||i||(f=pt(t));f&&at(n.router,f)}function oi(n){switch(n){case 0:return v.Error;case 1:return v.Warning;case 2:return v.Success;case 3:return a;case 4:return v.Information}}function bt(n,t){var u=n.additionalProperties||{},f=n.correlationIds,r;i.extend(u,{status:v[n.status],correlationId:f&&f.join(",")});r=n.asset;dt.trace({source:ti,action:t,assetType:r&&r.assetType||"UnknownAsset",data:u})}function y(n,t){if(n&&t)return vt(n)+"."+t}var wt,rt;u.defineProperty(t,"__esModule",{value:!0});var kt=r.Constants,ut=r.Extension,d=i.Base,ft=d.Constants,et=ft.AssetNames,p=ft.ExtensionNames,ot=d.Diagnostics,dt=ot.Telemetry,gt=i.Hubs.Notifications,v=gt.NotificationStatus,w=r.Hubs.Notifications,g=w.ClientNotificationUriAction,b=r.NotificationManager,nt=h.Action,ni=window,si=ot.createLog(n),st,ti=h.Source.NotificationHub,ii=p.Hubs,ht=p.AzureMonitoring,ct=ut.getHubsWindowId(),tt="subscriptionId",lt=g.OpenInNewTab,a=v.InProgress,it=u.keys;t.createNotificationManager=ri;t.getNotificationManager=ui;wt=(function(){function n(n,t){this.extensionWindowId=n;this.notificationDefinition=t}return n})();rt=(function(){function t(n){var t=this,u,f,o,s;this.notifications=e.observableArray();this._notificationDefinitions={};this._extensionNotifications={};this._serverEventToNotificationMap={};this._extensionsHeldByCorrelationId={};this._extensionsLoaded={};this._notificationsLifetime=new r.TriggerableLifetimeManager;this._services=n;u=n.rpcClient;f=function(n){return Q(t._extensionsLoaded[n]?!0:t.itemsPromise)};b.addNotificationsEndPoint.register(u,null,(function(n,i){var r=i.srcWindowId;r&&f(r).finally((function(){var i=n.notifications.map((function(n){return t._mapFxNotificationV1ToClientNotification(n)}));i=i.filter((function(n){return!!n}));i.forEach((function(n){return t._addOrUpdateNotification(n,r)}))}))}));b.addNotification2EndPoint.register(u,null,(function(n,i){var r=i.srcWindowId;r&&f(r).finally((function(){var i=t._mapNotificationV2ToClientNotification(r,n.id,n.name,n.status,n.subStatus,n.assetId,n.properties);t._addOrUpdateNotification(i,r)}))}));b.updateNotificationEndPoint.register(u,null,(function(n,i){f(i.srcWindowId).finally((function(){var i=t.notifications().first((function(t){return(t.correlationIds||[]).some((function(t){return t.toLowerCase()===n.id}))}));if(i){var u=n.propertyName.toLowerCase(),f=n.propertyValue,r=i.correlationIds;u==="correlationid"?(r||(i.correlationIds=r=[]),r.push(f),t._addOrUpdateNotification(i)):u==="percentcomplete"&&(i.percentComplete=f,t._addOrUpdateNotification(i))}}))}));o=function(n,r){var u=r.srcWindowId,f;u&&(f=i.merge(n),f.forEach((function(n){n.notificationId=u+"#"+n.notificationId;t._addOrUpdateNotification(n,u)})))};w.addClientNotificationDefinition.register(u,null,o);w.addClientNotificationsDefinition.register(u,null,o);b.addServerEventsEndPoint.register(u,ct,(function(n,i){n.serverEvents.forEach((function(n){n&&f(i.srcWindowId).finally((function(){t._addServerEvent(n)}))}))}));w.showModalNotification.register(u,ct,(function(i){var r=i.notification;return t.addClientNotification(r),t._services.diContainer.getAsync(l.DialogManager).then((function(n){return t.addClientNotification(r),n.showModalDialog({title:r.title,description:r.description,buttons:2,defaultButtonText:i.primaryButtonText,cancelButtonText:i.secondaryButtonText,showErrorIcon:!0})})).then((function(u){var f=undefined;return u===4?f=i.primaryButtonClickAction:u===1&&(f=i.secondaryButtonClickAction),f===1?t.handleNotificationClick(r):f===2&&n.diContainer.get(c.WindowManager).redirect({uri:"/"}),u}))}));s=this._services.extensionManager;this.itemsPromise=i.memoizeQ((function(){return s.on("notifications",(function(n){return t._collectNotificationDefinitions(n)}))}));s.onLoad((function(n){return t._collectNotificationDefinitions(n.getManifest("notifications"))}))}return t.prototype.listenForClientNotifications=function(){var i=this,n=[],t=this._services;t.extensionManager.getExtensions().forEach((function(t){t.name===p.AzureInsights?n.push(t.getWindowId()):t.name===ht&&n.push(t.getWindowId())}));t.rpcClient.registerRpcEndPoint(kt.RpcMethods.getClientNotifications,{allowedOrigin:n,handler:function(){return i.notifications()}})},t.prototype.addClientNotification=function(n){yt(n);this._addOrUpdateNotification(n)},t.prototype.showNotificationDetails=function(n){at(this._services.router,pt(n))},t.prototype.handleNotificationClick=function(n,t){ei(this._services,n,t)},t.prototype.definitionCount=function(){return it(this._notificationDefinitions).length},t.prototype.newDefinitionCount=function(){return it(this._extensionNotifications).length},t.prototype.serverEventsCount=function(){return it(this._serverEventToNotificationMap).length},t.prototype._setLoadedExtension=function(n){this._extensionsLoaded[n]=!0},t.prototype.removeNotification=function(n){var t=this.notifications().first((function(t){return(t.correlationIds||[]).some((function(t){return t===n}))}));t&&this.notifications.remove(t)},t.prototype._addOrUpdateNotification=function(t,r){var u=this,f;t&&k(t.title)&&k(t.description)&&(f=function(){t.clickable=e.observable(!!t.asset||!!t.linkedBlade||!!t.uri);t.descriptionAsHtml||(t.descriptionAsHtml=!1);(t.correlationIds||[]).length||(t.correlationIds=["clientNotification-"+i.getUniqueId()]);var n=u.notifications(),f=n.first((function(n){var i=n.correlationIds||[];return i.filter((function(n){return t.correlationIds.indexOf(n)!==-1})).length>0}));if(f)if(f.timestamp.getTime()<t.timestamp.getTime()||f.status===a)n.remove(f);else return;n.unshift(t);t.status!==a&&(n=i.stableSort(n,(function(n,t){return n.status===a?t.status===a?0:-1:t.status===a?1:t.timestamp.getTime()-n.timestamp.getTime()})));n.length>100&&n.pop();u.notifications(n);t.isRecommendation&&bt(t,nt.RecommendationAdded);r&&u._holdOntoExtension(r,t)},t.inlineForm?i.require(n.normalize("./UI.ActionableNotifications")).then((function(n){var i=u._notificationsLifetime;n.makeActionable(i,t,u._services);f()})):(t.formSection=undefined,f()))},t.prototype._addServerEvent=function(n){var t,i;n.source&&n.operationName&&(t=this._serverEventToNotificationMap[y(n.source,n.operationName)],t&&(i=this._mapNotificationV2ToClientNotification(t.extensionWindowId,n.correlationId,t.notificationName,n.status,n.subStatus,n.assetId,n.properties,n.timestamp,!0),i&&this.addClientNotification(i)))},t.prototype._collectNotificationDefinitions=function(n){var t=this,i=fi(n),f=n.name,u=n.notifications,r;return u&&u.forEach((function(n){var r=y(n.eventSource,n.eventType);t._notificationDefinitions[r]||(t._notificationDefinitions[r]=new wt(i,n))})),r=n.notifications2,r&&r.forEach((function(n){var u=n.name,o=y(f,u),r,e;t._extensionNotifications[o]=n;r=n.serverEvent;r&&r.operation&&r.source&&(e=y(r.source,r.operation),t._serverEventToNotificationMap[e]={extensionWindowId:i,notificationName:u})})),this._extensionsLoaded[i]=!0,!0},t.prototype._holdOntoExtension=function(n,t){var i=this,r=t.correlationIds,o,u,f,e;r&&(t.status===a?(o=r.some((function(n){return!!i._extensionsHeldByCorrelationId[n]})),o||(u=this._services,f=u.extensionManager.getExtension(n),f&&(e=u.rpcClient.acquireWindow(f.getWindowId(),6e5),r.forEach((function(n){i._extensionsHeldByCorrelationId[n]=e;e.onDispose((function(){i._extensionsHeldByCorrelationId[n]&&delete i._extensionsHeldByCorrelationId[n]}))}))))):r.forEach((function(n){var t=i._extensionsHeldByCorrelationId[n];t&&t.dispose()})))},t.prototype._mapNotificationV2ToClientNotification=function(n,t,i,r,u,f,e,o,s){var c,h,l,a,v,p;if(s===void 0&&(s=!1),c=this._extensionNotifications[y(n,i)],c&&(l=c.messages.filter((function(n){return n.status.toLowerCase()===r.toLowerCase()})),u?h=l.first((function(n){return n.subStatus&&n.subStatus.toLowerCase()===u.toLowerCase()})):l.length===1&&(h=l[0]),h))return a=h.message,e&&(a=a.format(e)),v={title:h.title,description:a,timestamp:o||new Date,isRecommendation:!1,status:oi(h.type),correlationIds:[t],additionalProperties:[],isServerEvent:s},!!(h.assetType||c.assetType)&&f&&(p=h.assetType||c.assetType,v.asset={extensionName:n,assetType:p,assetId:f}),v},t.prototype._mapFxNotificationV1ToClientNotification=function(n){var t=this._formatNotificationV1FromExtensionManifest(n),i,r;if(t)return i={title:t.label,description:t.description,timestamp:t.timestamp,isRecommendation:!1,percentComplete:t.percentOperationComplete,status:t.state,correlationIds:[],additionalProperties:{}},r=t.clientDetails,t.assetId&&r&&(i.asset={extensionName:r.assetOwner,assetType:r.assetType,assetId:t.assetId}),t.correlationId&&i.correlationIds.push(t.correlationId),t.operationId&&i.correlationIds.push(t.operationId),t.subscriptionId&&(i.additionalProperties.subscriptionId=t.subscriptionId),i},t.prototype._formatNotificationV1FromExtensionManifest=function(n){var i=n.eventType,u=n.source,r,t;return u&&i&&(r=this._notificationDefinitions[y(u,i)],t=void 0,r?(t=r.notificationDefinition,n.label=t.label,n.description=t.message.format(n.descriptionArgs),n.clientDetails=t.assetType?{assetOwner:r.extensionWindowId,assetType:t.assetType}:null):(n.label=n.label||i,n.description=n.description||i,n.assetId||(n.clientDetails=null))),k(n.label)&&k(n.description)?n:void 0},t})();t.NotificationManager=rt}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f,e){"use strict";r.defineProperty(t,"__esModule",{value:!0});var h=i.Azure.ResourceManager,v=i.Base,y=v.Diagnostics,c=i.Services.Gallery.Constants,s=f.Gallery.Notifications,o=y.createLog(n),l=c.GalleryParametersKey,a=i.clone,p=u.observable,w=(function(){function n(){this.status=p()}return n.prototype.execute=function(t){var f;if("data"in t&&"options"in t){if(f=t.data,l in f.outputParameters){var i=f.outputParameters[l],r=t.options[c.GalleryOptionsKey],u=r&&r.launchingContext||{},e=this._getGalleryItemId(r.galleryItem);if(e||(o.warning("Null GalleryItemId."),e=i.deploymentName),u=a(u,!0),u.oldCreateApi=!0,u.galleryItemId=u.galleryItemId||e,this._validateOptions(i,r,f)){var y=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),p={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:a(f.outputParameters[i.selectedTemplateId],!0),templateLinkUri:!i.templateJson&&y||undefined,templateJson:i.templateJson,deploymentMode:1,launchingContext:u},v=new Date;return h.Deployments.deployTemplate(p).then((function(n){if(n===void 0&&(n={}),n.deploymentStatusCode===h.DeploymentStatusCode.Success){var i=(n.deployment||{}).properties||{},t=new Date(i.timestamp&&i.timestamp.valueOf()||n.timestamp&&n.timestamp.valueOf());return t&&t.getTime()<=v.getTime()&&(t=new Date(v.getTime()+1)),{correlationId:i.correlationId||n.correlationId,timestamp:t}}return Q.reject(0)}))}return this._notify(s.createArgumentsValidationFailedMessage),Q.reject(1)}return this._notify(s.createOptionsNotSpecifiedMessage),o.error("Create options are not specified in the output parameters."),Q.reject(2)}return this._notify(s.createCommandMissingArgumentsMessage),o.error("The data or the options needed by the deployment command are not specified."),Q.reject(3)},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ";if(t){if(!t.templateJson&&!t.selectedTemplateId)return o.error(u+"neither templateJson nor selectedTemplateId were specified."),!1;if(t.templateJson)try{JSON.parse(t.templateJson)}catch(f){return o.error(u+"templateJson was malformed."),!1}if(!t.subscriptionId)return o.error(u+"subscriptionId not specified."),!1;if(!t.resourceGroupName)return o.error(u+"resourceGroupName not specified."),!1;if(!t.resourceGroupLocation)return o.error(u+"resourceGroupLocation not specified."),!1;if(i){if("subscriptionId"in i&&i.subscriptionId!==t.subscriptionId)return o.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return o.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in i&&i.resourceGroupLocation!==t.resourceGroupLocation)return o.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return o.error(u+"galleryParameters not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return o.error(u+"templateJson wasn't defined and selectedTemplateId isn't defined in the deploymentTemplateFileUris."),!1}else return o.error(u+"deploymentTemplateFileUris not specified."),!1;if(!("deploymentName"in i))return o.error(u+"deploymentName not specified."),!1}else return o.error(u+"configurationOptions not specified."),!1;return r?!0:(o.error(u+"create outputs not specified."),!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:s.createResourceFailedLabel,description:n,status:i.Hubs.Notifications.NotificationStatus.Error};e.getNotificationManager().addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=(n||{}).launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return h.deployTemplate(n).then((function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}}))},n})();t.CsmCommand=w}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",["require","exports","f","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s){"use strict";function p(){return h||(h=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),h}function w(n,t){u.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(i,r){var f=u.unwrap(r());f&&new l($(i),f,n,t)}}}var c,l;r.defineProperty(t,"__esModule",{value:!0});var v=i.Base.Constants.ExtensionNames.Hubs,y=i.Base.Diagnostics.createLog(n),a=s.Part.Provisioning,h;c=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(o.ViewModel);t.ViewModel=c;l=(function(n){function t(t,r,o,s){var k=n.call(this,t,r||new c)||this,h=r.privatePcPrBI,l=k.ltm,w,b;return h.triggerProvisioningInStartboardPart.subscribe(l,(function(n){var t;if(n){var r=h.provisioningPartExtensionName(),u=h.provisioningPartName(),e=f.Locator.forExtension(r).withPartType(u);r===v&&(n=i.clone(n,!0));o.addPartToStartBoard({originPartLocator:e,model:n,modelContainsSensitiveData:!0,initialSize:2});t=o.getActiveJourney();t&&h.forceDiscardJourney()&&o.forceDiscardJourney(t.id)}})),w=function(){h.provisioningCommand(new e.CsmCommand)},h.triggerProvisioningCommand.subscribe(l,w),h.triggerProvisioningCommand.peek()&&u.ignoreDependencies(w),h.provisioningAttempted.subscribe(l,(function(n){if(n){var t=o.getActiveJourney();t&&h.forceDiscardJourney()&&o.forceDiscardJourney(t.id)}})),b=function(n){n&&(n.galleryParameters?p().then((function(t){return t.processResourceGroupChange(s,n.galleryParameters,n.configurationOptions,n.deploymentResponse).then((function(){return h.provisioningCompleted({succeeded:!0})}),(function(n){return h.provisioningCompleted({succeeded:!1,statusUnavailable:n===a.deploymentStatusUnavailable,pollingFailed:n===a.pollingFailed,errorMessage:n})}))})):y.error("galleryParameters should be specified in the provisioningStarted object."))},h.provisioningStarted.subscribe(l,(function(n){return b(n)})),b(h.provisioningStarted()),k}return __extends(t,n),t})(o.Widget);t.Widget=l;t.initialize=w}));
define("MsPortalImpl/Controls/ControlBindings",["require","exports","ko"],(function(n,t,i){"use strict";var r;return (function(){function n(n,i){t[n]=i}function f(n,t){var r=i.unwrap(n()),f;if(r){if(f=t[r.controlType],!f)throw new Error("Unsupported ControlType in formControl binding handler: "+r.controlType+".");return u[f]}}function e(n,t,i,r,u,e){var s=f(t,e),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function o(n,t,i,r,u,e){if(n){var o=f(t,e);if(o)return o.update(n,t,i,r,u)}}var u=i.bindingHandlers,t={},r;n(127,"pcAccordion");n(20,"pcArtifactLinks");n(106,"pcAsyncFileUpload");n(16,"pcAttachment");n(63,"pcChart");n(7,"pcCheckBoxField");n(75,"pcConsole");n(40,"pcCopyableLabel");n(83,"pcCreatorAndSelector");n(85,"pcCreatorAndSelectorV2");n(23,"pcCustomHtmlField");n(91,"pcCustomValueSlider");n(111,"pcCustomRangeSlider");n(25,"pcDatePickerField");n(26,"pcDateTimePickerField");n(27,"pcDateTimeRangePickerField");n(92,"pcDayPickerField");n(76,"pcDeleteAssetConfirmation");n(33,"pcDiffEditor");n(32,"pcDockedBalloon");n(65,"pcDonut");n(3,"pcDropDownField");n(99,"pcDurationPickerField");n(15,"pcSection");n(37,"pcEditor");n(120,"pcEssentials");n(82,"pcFileDownloadButton");n(28,"pcFileUpload");n(81,"pcFileUploadWidget");n(12,"pcFilterComboField");n(55,"pcGallery");n(67,"pcGraph");n(103,"pcGrid2");n(125,"pcEditableGrid");n(130,"pcArrayGrid");n(131,"pcDataGrid");n(132,"pcPagedDataGrid");n(133,"pcSequentialDataGrid");n(98,"pcGroupDropDownField");n(77,"pcHeroBanner");n(19,"pcHistory");n(84,"pcHotSpot");n(108,"pcIFrame");n(113,"pcIFrame2");n(78,"pcInfoBox");n(121,"pcIntuneAppFileUpload");n(118,"pcLegend");n(88,"pcHotSpot");n(87,"pcInfoBox");n(104,"pcList2");n(58,"pcLogStream");n(68,"pcMap");n(109,"pcMediaPlayer");n(115,"pcMenu");n(69,"pcMetrics");n(122,"pcMonitorChart");n(126,"pcMonitorChartV2");n(13,"pcMultiLineTextField");n(8,"pcMultiselectDropDownField");n(79,"pcNotice");n(10,"pcNumericTextBoxField");n(29,"pcOAuthButtonField");n(4,"pcOptionsGroupField");n(70,"pcPairedTimeline");n(94,"pcPairedTimelineBadges");n(5,"pcPasswordField");n(39,"pcCheckBox");n(42,"pcDropDown");n(43,"pcFilterCombo");n(54,"pcGrid");n(56,"pcListView");n(110,"pcMarkdown");n(45,"pcMultiLineTextBox");n(46,"pcMultiselectDropDown");n(47,"pcNumericTextBox");n(48,"pcOptionPicker");n(49,"pcPassword");n(50,"pcRangeSlider");n(52,"pcSlider");n(57,"pcTreeView");n(112,"pcPartPinner");n(80,"pcPicker");n(128,"pcPill");n(129,"pcPillCollection");n(123,"pcPillList");n(89,"pcPreviewTag");n(71,"pcProgressBar");n(31,"pcQueryBuilder");n(72,"pcQuotaGauge");n(9,"pcRangeSliderField");n(93,"pcSearchBox");n(114,"pcResourceFilter");n(1,"pcFormSection");n(11,"pcSelectorField");n(60,"pcSettings");n(100,"pcSimpleButton");n(97,"pcChart");n(61,"pcSingleSetting");n(73,"pcSingleValueGauge");n(6,"pcSliderField");n(95,"pcSpecComparisonTable");n(21,"pcSplitter");n(17,"pcStringListField");n(134,"pcSummary");n(135,"pcPricingControl");n(124,"pcResourceDropDown");n(136,"pcTagsByResource");n(101,"pcTextBlock");n(2,"pcTextField");n(24,"pcTimePickerField");n(30,"pcTokenComboBox");n(62,"pcToolbar");n(105,"pcTree2");n(22,"pcTriStateCheckBox");n(116,"pcVideo");n(107,"pcWizard");n(119,"pcHeatMap");n(137,"pcArmErrorList");n(201,"pcFileShareDropDown");r={};[127,20,16,7,83,85,23,91,111,25,26,27,92,3,99,15,120,201,81,12,98,124,19,108,113,110,13,8,10,29,4,112,5,128,129,123,135,89,9,1,11,6,21,17,134,136,2,24,30,22,].forEach((function(n){return r[n]=t[n]}));u.pcControl={init:function(n,i,r,u,f){return e(n,i,r,u,f,t)},update:function(n,i,r,u,f){return o(n,i,r,u,f,t)}};u.formElement={init:function(n,t,i,u,f){return e(n,t,i,u,f,r)},update:function(n,t,i,u,f){return o(n,t,i,u,f,r)}}})(r||(r={})),r}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",["require","exports","f","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.LruMap","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Controls/ControlBindings"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(){function l(){return{controlsDescendantBindings:!0}}function y(t,i,e){var o=t===1?d:it;return function(s,h,l,v,y){var p=c(h()),w=p,b,k,g;p!==null&&typeof p=="object"&&(w=c(p.html),k=p.data,b=c(k),g=c(p.isolated));r.ignoreDependencies((function(){var c=t,l=o,h,p;e&&e(y)&&(c=1,l=d);h=w&&l.getOrAdd(w,(function(t){if(c!==1){var r=u.sanitizeHTML({value:t,localRequire:n,windowContext:s,contextData:{BindingName:i}});t=r.sanitizedMarkup}return t&&tt.createContextualFragment(t)}));g?y=f.createIsolatedContext(b||v,y):k&&(y=y.createChildContext(b));a.cleanDescendantNodes(s);h?(p=h.cloneNode(!0),s.innerHTML="",s.appendChild(p),r.applyBindingsToDescendants(y,s)):s.innerHTML=""}))}}var c=r.unwrap,a=r.utils,t=r.bindingHandlers,p=a.domData,w="htmlTemplate",b="untrustedHtml",v="untrustedContent",k="trustedHtml",nt=/(&.*?;)|(<.*?>)/,tt=document.createRange(),it=new s.LruMap(100),d=new s.LruMap(100),g=y(0,b,(function(n){var t=n.$ctl;return t&&t.isTrusted})),rt=[,,g,t["pcControl"].update,];t[w]={init:l,update:y(0,w)};t[b]={init:l,update:g};t[k]={init:l,update:y(1,k)};t[v]={init:l,update:function(t,u,f,s,c){var l=r.unwrap(u())||"",y=1;r.ignoreDependencies((function(){var r=p.get(t,v),u;l.controlType?y=3:l.htmlTemplate?(y=2,l={html:l.htmlTemplate,data:l.viewModel}):nt.test(l)&&(y=2,l={html:l},h.logToExtension(n,t,1,"Html is not allowed in this binding, please pass in an HtmlContent object if you wish to use html here: "+JSON.stringify(l)));p.set(t,v,y);r===3&&(e.cancelBindings(t),u=o.getWidget($(t)),i.disposeDisposable(u));r&&r!==1&&a.cleanDescendantNodes(t);y===1?t.textContent=l:t.innerHTML=""}));y!==1&&rt[y](t,(function(){return l}),f,s,c)}}})(c||(c={})),c}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","f","ko","MsPortalImpl/Base/Base.ImageHelper"],(function(n,t,i,r,u){"use strict";var f;return (function(){var t={"aria-hidden":"true",role:"presentation",focusable:"false"},n=!i.isFeatureEnabled("nokosvgcaching")&&new i.Map;r.bindingHandlers.image={init:function(){return{controlsDescendantBindings:!0}},update:function(f,e){var s=r.unwrap(e()),h,o;s&&(h=JSON.stringify(s),o=n&&n.get(h),o||(o=u.GetImageData(s,f,t).then((function(n){for(var i=document.createDocumentFragment(),t=0,r=n.length;t<r;t++)i.appendChild(n[t].cloneNode(!0));return i})),n&&n.set(h,o)),i.tryImmediateResolve(o,(function(n){f.innerHTML="";f.appendChild(n.cloneNode(!0))})))}}})(f||(f={})),f}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed",["require","exports","ko"],(function(n,t,i){"use strict";var r;return (function(){i.extenders.allowOverride||(i.extenders.allowOverride=function(n,t){var r,u,f=i.computed(t,{read:n,write:function(t){u=t;r||n(t)}});return f.override=function(t){r=!0;n(t)},f.restoreLastWrittenValue=function(){r=!1;n(u)},u=n(),f})})(r||(r={})),r}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","exports","f","o","ko","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(){function o(n,t){var i=u.unwrap(n()),r=c(i,t);return function(){return r}}function c(n,t){if(n&&typeof n=="object"){var e={};return r.getOwnPropertyNames(n).forEach((function(r){if(i.isSerializableProperty(r)){var o=u.unwrap(n[r]);if(f.getWhitelistedAttr().indexOf(r)>-1)e[r]=o?o:null;else switch(r){case"href":o?f.validateLinkUri(o)?e[r]=o:t.push('The value "'+o+'" is not a valid absolute URI or deep link, which should start with "http://" or "https://" or "#".'):e[r]=null;break;case"poster":case"src":o?f.validateUriOrBlank(o)||r==="src"&&f.validateDataImage(o)?e[r]=o:t.push('The value "'+o+'" is not a valid absolute URI, which should start with "http://" or "https://".'):e[r]=null;break;default:t.push("The attribute '{0}' is not allowed.".format(r))}}})),e}return null}var s=i.Base,l=s.Diagnostics,h="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}",t=u.bindingHandlers;t.sanitizedAttr={init:function(n,i,r,u,f){var e=t.attr,s;return e.init?(s=o(i,[]),e.init(n,s,r,u,f)):null},update:function(i,r,u,f,s){var c=[],a=o(r,c),l;return c.length>0&&(l=c.reduce((function(n,t){var r=i.getAttribute("data-bind")||"None",u=h.format(String(i.tagName),r,t);return n+(u+"\n")}),""),e.logToExtension(n,i,2,l)),t.attr.update(i,a,u,f,s)}}})(o||(o={})),o}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","f","o","a","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(){function h(n,t){var i=f.unwrap(n()),r=l(i,t);return function(){return r}}function l(n,t){var f;if(n&&typeof n=="object")return f={},r.getOwnPropertyNames(n).forEach((function(r){i.isSerializableProperty(r)&&(e.isAllowedCssClassName(r)?f[r]=n[r]:r&&t.push(r))})),f;var o=String(n||""),s=o.split(" "),h=u.prototype.map.call(s,(function(n){return n=String(n||""),e.isAllowedCssClassName(n)?n:(n&&t.push(n),"")}));return h.join(" ")}function a(t,i){var r=t.getAttribute("data-bind")||"None",u=c.format(String(t.tagName),r,i.join(", "));o.logToExtension(n,t,2,u)}var c="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",s=f.bindingHandlers,t=s.css;s.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var e=h(i,[]);return t.init(n,e,r,u,f)}return null},update:function(n,i,r,u,f){var e=[],o=h(i,e);return e.length&&a(n,e),t.update(n,o,r,u,f)}}})(s||(s={})),s}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","exports","f","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer"],(function(n,t,i,r,u){"use strict";var f;return (function(){var t=r.bindingHandlers,f=t.html;t.sanitizedHtml={init:function(n,t,i,r,u){return f.init(n,t,i,r,u)},update:function(t,e,o,s,h){var c=r.unwrap(e());(c===null||c===undefined)&&(c="");var l=c.toString().substring(0,1e5),a=u.sanitizeHtmlWithoutKOBindings(l,n,t),v=i.wrap(a.sanitizedMarkup);return f.update(t,v,o,s,h)}};t.html=t.sanitizedHtml;t.unsanitizedHtml=f})(f||(f={})),f}));
define("MsPortalImpl/Base/Base.Pipeline",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(){function u(t){n.push(t)}function f(t,r,u,f){function e(n,e,o,s){return u(e,o,s)?i.require(t,f).then((function(t){return r(n,t,e,o,s)})):undefined}n.push(e)}function e(t,i,r,u){return n.map((function(n){return n(t,i,r,u)}))}var n=[],r={registerFactory:u,registerAsyncFactory:f,getHandlers:e,createPipeline:undefined};return r.createPipeline=function(n,i,u){return t(n,r,i,u)},r}function t(n,t,i,r){function u(u){function c(t){t=t.filter((function(n){return!!n}));var i=f(t);return e(i,u,n,h).finally((function(){h.dispose()}))}var h=n.createChildLifetime(),s=t.getHandlers(h,i,r,u),o;return(s.forEach((function(n,t){Q.isPromise(n)&&(o||(o=[]),o[t]=n.then((function(n){s[t]=n})))})),o)?Q.all(o.filter((function(n){return!!n}))).then((function(){return c(s)})):c(s)}return{startTask:u}}function f(n){for(var i=[],r=Math.max.apply(Math,n.map((function(n){return n.length}))),u=function(t){n.forEach((function(n){n[t]&&i.push({e:t,f:n[t]})}))},t=0;t<r;t++)u(t);return i}function e(n,t,i,u){function a(i){var r;try{r=n[f].f(l,t)}catch(u){return Q.reject(u)}return o?undefined:r&&f<n.length?r.then(i):r}function h(){var t=undefined;for(f++;f<n.length&&!o;f++)if(t=a(h),t)break;return t}var f=-1,e,o=!1,c=r++,s=function(){o=!0},l={indicateTaskComplete:s,taskId:c,lifetime:u};return i.registerForDispose(s),e=h(),e||(e=Q.resolve(undefined)),e}var r=1;n.createDescriptor=u;n.createPipelineInstance=t})(r||(r={})),r}));
define("MsPortalImpl/Base/Base.Selectable2",["require","exports","f","i","o","a","ko","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Pipeline"],(function(n,t,i,r,u,f,e,o,s){"use strict";function d(n){var t=new r.TriggerableLifetimeManager;return n.setLifetimeReference(1,t),{selectable:n,dispose:function(){t.dispose()}}}function g(n){return p(n)}function p(n){var i="Selectable",t=l.disposableData(n,i),r;return t||(r=new y(n),t=d(r),l.disposableData(n,i,t)),t.selectable}function nt(n,t){if(t){var i=n.options||{},r=n.metadata||{},u=r.outputParameters||[];return i.onClosed||u.length?!1:!w(n)}return!0}function tt(n,t){var i=n.bladeReference,u=n.flags,s=n.operationId,f=i.parameters,e=i.metadata||{},o=n.reason===3,h=nt(i,o),r=0;return h||(r|=2),o&&(r|=4),u&2&&(r|=8),u&4&&(r|=128),{detailBlade:i.bladeName,extension:i.extensionName,detailBladeInputs:f?f:{},openInContextPane:!!(u&1)||e.isContextBlade,persistentContextPane:e.persistentContextPane,flags:r,operationId:s,onClosed:t}}function it(n){return n.parents("["+h+"]")}function rt(n,t,i){var r=o.rotAdd(n,t);i.attr(h,r);n.registerForDispose((function(){i.removeAttr(h)}))}function ut(n,t){t=t.attr(h)?t:it(t);var i=t.attr(h);return o.rotFind(i)}function w(n){var t=a(n);return t&&t.type===20560}function ft(n){var t=a(n);return t&&t.type===19792}var y,h;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base.ProxiedObservables,a=r.shellInterface,v=window,b=500,k=1,c=s.createDescriptor();c.registerAsyncFactory("./Base.Selectable2.Pipeline",(function(n,t,i,r){return t.openBladeHandler(i,r)}),(function(){return!0}),n);c.registerAsyncFactory("../UI/Compositions/UI.Composition.BladeOpener.Selectable2",(function(n,t,i,r){return t.parameterCollectorHandler(i,r)}),(function(n,t){return t.openBladeRequest?w(t.openBladeRequest.bladeReference):!0}),n);c.registerAsyncFactory("../UI/Compositions/UI.Composition.BladeOpener.Provisioning",(function(n,t,i,r){return t.openBladeHandler(i,r)}),(function(n,t){return t.openBladeRequest?ft(t.openBladeRequest.bladeReference):!0}),n);y=(function(n){function t(t){function rt(n){if(n){if(n.operationId in y){delete y[n.operationId];return}if((n.reason===3||n.reason===4)&&s(!0),n.reason===4){g(n.operationId,!!(n.flags&2),n.initialWidth);return}(n.reason===2||n.reason===3)&&(a.openBladeRequest=n,it.startTask({}))}}var u=n.call(this)||this,d,g,nt;u.id=k++;u.callbacks=e.observableArray();var o=e.observable(),l=r.shellInterface(t),s=e.observable(!1),a={selectable:u,selectedValue:o,openBladeRequest:undefined,extensionVm:l},it=c.createPipeline(u,{},a),y={},h,p,w=0;return u.setLifetimeReference=function(n,t){n===(w&n)&&(w|=n,t.registerForDispose({dispose:function(){w^=n;w||u.dispose()}}))},u.value=e.computed(u,{read:function(){var n=s()?o():undefined;return n!==undefined?(p&&p!==h&&(p=h),h=d.peek()):h&&(p=h,h=undefined),n},write:function(n){n===undefined&&(s(!1),o(undefined))}}),u.getBladeSelection=function(n){var f,t=n.bladeReference,i=n.operationId,r=t&&t.options&&t.options.onClosed;return r&&i&&(u.callbacks.push({id:i,fn:r}),f=function(n,t){Q(r(n,t)).finally((function(){u.callbacks.remove((function(n){return n.id===i}))}))}),tt(n,f)},d=l.request,g=function(n,t,r){var f=u.createChildLifetime(),h=v.setTimeout((function(){var u=16;u|=t?8:0;o({operationId:n||i.getUniqueId(),flags:u,initialWidth:r})}),b),e=function(){f.dispose()};o.subscribe(f,e);s.subscribe(f,e);f.registerForDispose((function(){v.clearTimeout(h)}))},u.isSelected=e.computed(u,{read:function(){return s()},write:function(n){if(s()!==n)if(s(n),n===!0){var t=i.getUniqueId();g(t);a.openBladeRequest=undefined;it.startTask({operationId:t})}else o(undefined)}}),u.onClick=function(){u.isSelected(!0)},u.invokeClickCallback=function(n,t,i,r,u,f,e){t.invokeClickHandler(n,i,r,l,u,f,e)},u.fetchRequest=function(n){return Q(l.fetchRequest(n)).then((function(n){return n&&n.operationId in y&&(delete y[n.operationId],n=null),a.openBladeRequest=n,n}))},u.getOutputProperties=function(){var n=a.openBladeRequest.bladeReference.metadata,t=n&&n.outputParameters;return f.isArray(t)?t:[]},u.getOutputsChangedHandler=function(){var n=a.openBladeRequest.bladeReference;return n.options&&n.options.callbacks?function(t){r.invokeCallback(n,"onOutputsChanged",[t])}:null},nt=function(n){return n?{item:n.selectedItem,metadata:n.controlMetadata}:undefined},u.activationState=e.computed(u,(function(){u.value();var n=nt(p),t=nt(h);return{previous:n,current:t}})),u.notifyBladeOpenCompleted=function(n,t){l.result({operationId:n,success:t})},u.cancel=function(n){var t=o();t&&t.operationId===n&&(t.flags&16&&(y[n]=!0),s(!1),o(undefined),u.notifyBladeOpenCompleted(n,!1))},u.openBlade=function(n){l.request({bladeReference:n,reason:3,operationId:i.getUniqueId(),flags:2})},d.subscribeAndRun(u,rt),u}return __extends(t,n),t.prototype.isClickable=function(){return!0},t})(r.TriggerableLifetimeManager);t.createListSelectable=g;t.getOrCreate=p;h="data-fxselectable";t.setSelectableContext=rt;t.findExtensionViewModel=ut}));
define("MsPortalImpl/Base/Base.Selectable2.ClickContext",["require","exports","f","i","ko"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function f(){return i.require("../UI/Compositions/UI.Composition.Selectable2Registrar",n)}function e(n,t,i){var r=u.observable();return{onClick:function(u){if(r())r().onClick(u);else f().then((function(f){r()||r(f.getListSelectableWithClickHandler(n,t,i));r().onClick(u)}))},activationState:u.pureComputed((function(){return r()?r().activationState():{previous:undefined,current:undefined}}))}}function o(n,t,i){function l(){s&&(s=!1,e().onClick());o&&(o=!1,e().isSelected(!0))}function c(){f().then((function(r){if(!e()){var u=r.getSelectableWithClickHandler(n,t,i);u&&(u.registerForDispose(h),e(u))}e()&&l()}))}function p(){e()?e().onClick():s||(s=!0,c())}var h=new r.TriggerableLifetimeManager,e=u.observable(),s,o,a=u.computed(h,{read:function(){return e()?e().isSelected():o},write:function(n){e()&&e().isSelected(n);n&&!o&&(o=!0,c())}}),v=u.pureComputed((function(){return e()?e().isClickable():!1})),y=u.pureComputed((function(){return e()?e().value():undefined}));return{isSelected:a,isClickable:v,value:y,onClick:p}}t.getListSelectableWithClickHandler=e;t.getSelectableWithClickHandler=o})(f||(f={})),f}));
define("MsPortalImpl/Base/Base.SelectableSet2",["require","exports","f","i","o","a","ko"],(function(n,t,i,r,u,f,e){"use strict";function rt(n){var i="SelectableSet",t=b.disposableData(n,i);return t||(t=new v(n),b.disposableData(n,i,t)),t}function ut(n){return n instanceof v?n.selectedItems():n.selectableItems().filter((function(n){return n.isSelected()}))}function ft(n){return n?!!n._msPortalFxSelectableSet:!1}function o(){return{added:[],removed:[]}}function g(n,t){var r=o(),u=n.peek(),f=u.length,i;return f&&(t?(i=!1,t.forEach((function(t){var f=u.firstIndex((function(n){return s(n,t)}));f>=0&&(i||(n.valueWillMutate(),i=!0),u.splice(f,1),r.removed.push(t))})),i&&n.valueHasMutated()):r.removed=n.removeAll()),r}function a(n,t,i,r,u,f){var e=o(),h=n.peek(),c,l;return u?h.length&&n.removeAll():t.peek().length===0?h.length>0&&(e.removed=n.removeAll()):(c=!1,l=[],e.removed=h.slice(0),t.peek().forEach((function(n){var t,r,u;i&&(t=et(i,n));r=ot(e.removed,n);r>=0&&(u=e.removed.splice(r,1)[0],t?t.data!==u.data&&(c=!0):t=u);t&&(l.push(t),r<0&&e.added.push(t))})),(e.removed.length||e.added.length||c)&&n(l)),r&&(e.removed=e.removed.concat(r.filter((function(n){return f.some((function(t){return s(n.id,t)&&!e.removed.some((function(n){return s(t,n.id)}))}))})))),e}function nt(n,t,i,r){var u=o(),e,h,f;return!i&&t.length>1&&(t=t.slice(0,1)),e=n.peek(),h=e.length,t=t.filter((function(n){return!e.some((function(t){return s(t,n)}))})),u.added=t,u.added.length&&(f=void 0,f=i?r?[0,0]:[h,0]:[0,h],f=f.concat(u.added),u.removed=n.splice.apply(n,f)),u}function et(n,t,i){var u,f=l(t),r;return k(f)||(r=l(n),r&&(u=r.first((function(n){var t=n.id;return(!i||i(n))&&s(t,f)})))),u}function ot(n,t,i){var u=-1,f=l(t),r;return k(f)||(r=l(n),r&&(u=r.firstIndex((function(n){var t=n.id;return(!i||i(n))&&s(t,f)})))),u}function p(n){return{id:n.id,data:n.data}}var w,v;u.defineProperty(t,"__esModule",{value:!0});var tt=r.TriggerableLifetimeManager,c=r.Po,b=i.Base.ProxiedObservables,it=i.ViewModels,s=it.Internal.Selection2.compareIds,k=i.isNullOrUndefined,y=e.observable,h=e.observableArray,l=e.utils.peekObservable,d;(function(n){n.None=1;n.Single=2;n.Multiple=3})(d=t.ActivationModeInternal||(t.ActivationModeInternal={}));t.getSelectableSet2=rt;t.getSelectedItems=ut;t.isSelectableSet2=ft;w=(function(){function n(n,t,i,r,u,f){this.ids=n;this.includeAll=t;this._allowMultiple=r;this._prepend=u;this._onChanged=f;this.itemsArePinnable=y(!0);this.items=h();this.excludedIds=i;this.excludedItems=h()}return n.prototype.addAll=function(){var r=this._allowMultiple,u=this.includeAll.peek(),i=!1,n,t;r&&(this.excludedIds.removeAll(),u||(this.includeAll(!0),i=!0),n=this.ids,n.peek().length&&n.removeAll(),t=this.items,t.peek().length&&t.removeAll());this._fireChanged([],[],[],[],i,!1,[],[],[],[])},n.prototype.addId=function(n){this._add([n])},n.prototype.addIds=function(n){this._add(n)},n.prototype.addItem=function(n){this._add([n.id],[n])},n.prototype.addItems=function(n){var t=n.map((function(n){return n.id}));this._add(t,n)},n.prototype.removeId=function(n){this._remove([n],null)},n.prototype.removeIds=function(n){this._remove(n,null)},n.prototype.removeItem=function(n){this._remove([n.id],[n])},n.prototype.removeItems=function(n){var t=n.map((function(n){return n.id}));this._remove(t,n)},n.prototype._add=function(n,t){var e=this.includeAll.peek(),i=o(),r=o(),u=o(),f;e?(r=g(this.excludedIds,n),u=a(this.excludedItems,this.excludedIds,t,null,!1,r.removed)):i=nt(this.ids,n,this._allowMultiple,this._prepend);f=a(this.items,this.ids,t,null,e,i.removed);this._fireChanged(i.added,i.removed,f.added,f.removed,!1,!1,r.added,r.removed,u.added,u.removed)},n.prototype._remove=function(n,t){var e=this.includeAll.peek(),i=o(),r=o(),u=o(),f;e?(r=nt(this.excludedIds,n,!0,!1),u=a(this.excludedItems,this.excludedIds,t,null,!1,r.removed)):i=g(this.ids,n);f=a(this.items,this.ids,null,t,e,i.removed);this._fireChanged(i.added,i.removed,f.added,f.removed,!1,!1,r.added,r.removed,u.added,u.removed)},n.prototype.removeAll=function(){var n=!1,t=[],i=[],r=[],u=[];this.includeAll.peek()&&(n=!0,this.includeAll(!1),this.excludedIds.peek().length&&(r=this.excludedIds.removeAll()),this.excludedItems.peek().length&&(u=this.excludedItems.removeAll()));this.ids.peek().length&&(t=this.ids.removeAll());this.items.peek().length&&(i=this.items.removeAll());this._fireChanged([],t,[],i,!1,n,[],r,[],u)},n.prototype._fireChanged=function(n,t,i,r,u,f,e,o,s,h){(n.length||t.length||i.length||r.length||u||f||e.length||o.length||s.length||h.length)&&this._onChanged(n,t,i,r,u,f,e,o,s,h)},n.prototype.fireCurrentChanges=function(){this._fireChanged(this.ids(),[],this.items(),[],this.includeAll(),!1,this.excludedIds(),[],this.excludedItems(),[])},n})();v=(function(){function n(n){var t=this,r=n,i;if(!r._msPortalFxSelectableSet)throw new Error("SelectableSet is missing internal members.  Ensure the SelectableSet is constructed from FxViewModels.SelectableSet2Contract.");this._viewModel=r;this._lifetime=new tt;i=this._lifetime;this.activationMode=n.activationMode||1;this.selectionMode=n.selectionMode||1;var u=n.activatedIds||h(),f=n.selectedIds||h(),e=n.selectedAll||y(!1),o=n.unselectedIds||h();c.disallowRemoteMutations(u);c.disallowRemoteMutations(f);c.disallowRemoteMutations(e);c.disallowRemoteMutations(o);this._activationSet=new w(u,y(!1),h(),this.activationMode===d.Multiple,!0,function(n,i,r,u){t._onActivationChanged&&t._onActivationChanged(n,r,i,u)});this._selectionSet=new w(f,e,o,this.selectionMode===3,!1,function(n,i,r,u,f,e,o,s,h,c){var l=t.selectedAll.peek();t._onSelectionChanged&&t._onSelectionChanged(f,l?s:n,l?c:r,e,l?o:i,l?h:u)});this.activatedItems=this._activationSet.items.mapInto(i,(function(n,t){return p(t)}));this.selectedItems=this._selectionSet.items.mapInto(i,(function(n,t){return p(t)}));this.unselectedItems=this._selectionSet.excludedItems.mapInto(i,(function(n,t){return p(t)}));this.activatedIds=this._activationSet.ids;this.selectedIds=this._selectionSet.ids;this.selectedAll=this._selectionSet.includeAll;this.unselectedIds=this._selectionSet.excludedIds;this.itemsArePinnable=this._selectionSet.itemsArePinnable;this.commandGroupProvider=this._viewModel.commandGroupProvider;this.dynamicSelectionProvider=this._viewModel.dynamicSelectionProvider;this.pinProvider=this._viewModel.pinProvider}return n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.registerItemController=function(n,t,i,r){var f=this._activationSet,e=this._selectionSet,u=function(i){return{id:n(i),data:t(i),item:i}};return i&&(this._onActivationChanged=function(n,t,r,u){i(n,t.map((function(n){return n.item})),r,u.map((function(n){return n.item})))},f.fireCurrentChanges()),r&&(this._onSelectionChanged=function(n,t,i,u,f,e){r(n,t,i.map((function(n){return n.item})),u,f,e.map((function(n){return n.item})))},e.fireCurrentChanges()),{activateItem:function(n){var t=u(n);f.addItem(t)},activateItems:function(n){var t=n.map(u);f.addItems(t)},deactivateItem:function(n){var t=u(n);f.removeItem(t)},deactivateItems:function(n){var t=n.map(u);f.removeItems(t)},selectItem:function(n){var t=u(n);e.addItem(t)},selectItems:function(n){var t=n.map(u);e.addItems(t)},unselectItem:function(n){var t=u(n);e.removeItem(t)},unselectItems:function(n){var t=n.map(u);e.removeItems(t)}}},n.prototype.activateId=function(n){this._activationSet.addId(n)},n.prototype.activateIds=function(n){this._activationSet.addIds(n)},n.prototype.activateAllSelectedItems=function(){this._activationSet.addIds(this._selectionSet.ids.peek())},n.prototype.deactivateId=function(n){this._activationSet.removeId(n)},n.prototype.deactivateIds=function(n){this._activationSet.removeIds(n)},n.prototype.deactivateAll=function(){this._activationSet.removeAll()},n.prototype.selectId=function(n){this._selectionSet.addId(n)},n.prototype.selectIds=function(n){this._selectionSet.addIds(n)},n.prototype.selectAll=function(){this._selectionSet.addAll()},n.prototype.unselectId=function(n){this._selectionSet.removeId(n)},n.prototype.unselectIds=function(n){this._selectionSet.removeIds(n)},n.prototype.unselectAll=function(){this._selectionSet.removeAll()},n})();t.SelectableSet2=v}));
define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","i","o","a","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e){"use strict";function l(n){var t=Q.defer(),i=new FileReader,u="data:image/jpeg;base64,";return i.onload=function(n){for(var i=n.target.result,r="",e=new Uint8Array(i),f=0;f<e.byteLength;f++)r+=String.fromCharCode(e[f]);try{atob(r);i=u+r}catch(o){if(o.code===5)i=u+btoa(r);else{t.reject(o);return}}t.resolve(i)},i.onerror=function(){return t.reject(r.createError("Error reading thumbnail photo. Error:"+i.error))},i.readAsArrayBuffer(n),t.promise}function a(n,t,i,r,u){var f=i,o,s;return t&&(o=e.ComponentName.Avatar,s=0,f=!u&&r.getValue(o,n,s),!f)?Q(h.ajax({uri:t,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return l(n)}),(function(n){var t=n.jqXHR&&n.jqXHR.status;return t!==404&&t!==403&&c.warning("Failed to get user's profile image. Status code: "+t+". Error: \n"+n),i})).then((function(t){return r.setValue(o,n,t,s),t})):Q(f)}u.defineProperty(t,"__esModule",{value:!0});var o=i.Base,s=o.Diagnostics,h=o.Net2,c=s.createLog(n);t.getAvatarImage=a}));
define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f","i","o","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o){"use strict";function w(n,t,r){var u=i.find(n,(function(n){var t=f(n);return!t.hasClass(v)&&!t.hasClass("fxs-display-none")&&!i.startsWith(t.attr("tabindex"),"-")&&e.isVisible(t)&&(!r||r(t))}),t?-1:0);return u?f(u):f([])}function l(n){return function(t){var i=this;return[y,p].reduce((function(r,u){return(r&&r.length)?r:w(i.find(u).toArray(),n,t)}),null)}}u.defineProperty(t,"__esModule",{value:!0});var h=e.findByClassName,c=window,a=c.document,f=jQuery,v="msportalfx-skip-initial-focus",s=f.fn,y="select, button, [tabindex=0], input, textarea",p="a";s.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return n=this,i=function(t){var i=function(){return n[t].apply(n,arguments)};r.forEach((function(n){var u=n[0],t=n[1],r;typeof t=="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};s.findByClassName=function(n){return h(this,n)};s.findFirstTabbable=l();s.findLastTabbable=l(!0);s.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t.length||!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};s.handleTransitionEndOnce=function(n,t,i){var e=this,r,s=!1,u;this.on(o.default.transitionend,r=function(t){for(var f,h=[],u=1;u<arguments.length;u++)h[u-1]=arguments[u];(f=t&&t.originalEvent,f&&f.propertyName!==n)||s||(s=!0,e.off(o.default.transitionend,r),i.apply(e,[t].concat(h)))});return u=function(){var t=f.Event("transitionend",{originalEvent:{propertyName:n}});r(t)},f.fx.off?u():c.setTimeout(u,t),this};f.enableAnimations=function(n){var t="fxs-transition-off-style-head-marker",u=f(r.createElement("style")).addClass(t).text("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),i=f.querySelectorAll("head");f.fx.off=!n;n?h(i,t).remove():h(i,t).length===0&&i.append(u)};f.querySelectorAll=function(n){return f(a.querySelectorAll(n))}}));
define("MsPortalImpl/Base/Languages",["require","exports","f","o","ko","MsPortalFx/Globalization","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e){"use strict";function o(n,t){return["en-"+n,"English ("+t+")","English ("+t+")‎"]}function c(n,t,i){return["de-"+n,"German ("+t+")","Deutsch ("+i+")‎"]}function h(n,t,i){return["es-"+n,"Spanish ("+t+")","Español ("+i+")‎"]}function s(n,t,i){return["fr-"+n,"French ("+t+")","Français ("+i+")‎"]}function y(n,t,i){return["pt-"+n,"Portuguese ("+t+")","Português ("+i+")‎"]}function k(){function t(t){var r=this,i=t[0];n[i]={locale:i,name:t[1],localizedName:t[2],neutralCulture:r,specificCulture:t[3]}}var n={},i=[c("be","Belgium","Belgien"),c("de","Germany","Deutschland"),c("li","Liechtenstein","Liechtenstein"),c("lu","Luxembourg","Luxemburg"),c("ch","Switzerland","Schweiz"),c("at","Austria","Österreich"),o("as","American Samoa"),o("ai","Anguilla"),o("ag","Antigua and Barbuda"),o("au","Australia"),o("bs","Bahamas"),o("bb","Barbados"),o("be","Belgium"),o("bz","Belize"),o("bm","Bermuda"),o("bw","Botswana"),o("io","British Indian Ocean Territory"),o("vg","British Virgin Islands"),o("cm","Cameroon"),o("ca","Canada"),o("029","Caribbean"),o("ky","Cayman Islands"),o("cx","Christmas Island"),o("cc","Cocos (Keeling) Islands"),o("ck","Cook Islands"),o("dm","Dominica"),o("er","Eritrea"),o("150","Europe"),o("fk","Falkland Islands"),o("fj","Fiji"),o("gm","Gambia"),o("gh","Ghana"),o("gi","Gibraltar"),o("gd","Grenada"),o("gu","Guam"),o("gg","Guernsey"),o("gy","Guyana"),o("hk","Hong Kong SAR"),o("in","India"),o("ie","Ireland"),o("im","Isle of Man"),o("jm","Jamaica"),o("je","Jersey"),o("ke","Kenya"),o("ki","Kiribati"),o("ls","Lesotho"),o("lr","Liberia"),o("mo","Macao SAR"),o("mg","Madagascar"),o("mw","Malawi"),o("my","Malaysia"),o("mt","Malta"),o("mh","Marshall Islands"),o("mu","Mauritius"),o("fm","Micronesia"),o("ms","Montserrat"),o("na","Namibia"),o("nr","Nauru"),o("nz","New Zealand"),o("ng","Nigeria"),o("nu","Niue"),o("nf","Norfolk Island"),o("mp","Northern Mariana Islands"),o("pk","Pakistan"),o("pw","Palau"),o("pg","Papua New Guinea"),o("ph","Philippines"),o("pn","Pitcairn Islands"),o("pr","Puerto Rico"),o("rw","Rwanda"),o("kn","Saint Kitts and Nevis"),o("lc","Saint Lucia"),o("vc","Saint Vincent and the Grenadines"),o("ws","Samoa"),o("sc","Seychelles"),o("sl","Sierra Leone"),o("sg","Singapore"),o("sx","Sint Maarten"),o("sb","Solomon Islands"),o("za","South Africa"),o("ss","South Sudan"),o("sh","St Helena, Ascension, Tristan da Cunha"),o("sd","Sudan"),o("sz","Swaziland"),o("tz","Tanzania"),o("tk","Tokelau"),o("to","Tonga"),o("tt","Trinidad and Tobago"),o("tc","Turks and Caicos Islands"),o("tv","Tuvalu"),o("um","U.S. Outlying Islands"),o("vi","U.S. Virgin Islands"),o("ug","Uganda"),o("gb","United Kingdom"),o("us","United States"),o("vu","Vanuatu"),o("001","World"),o("zm","Zambia"),o("zw","Zimbabwe"),h("ar","Argentina","Argentina"),h("bo","Bolivia","Bolivia"),h("cl","Chile","Chile"),h("co","Colombia","Colombia"),h("cr","Costa Rica","Costa Rica"),h("cu","Cuba","Cuba"),h("ec","Ecuador","Ecuador"),h("sv","El Salvador","El Salvador"),h("es","Spain, International Sort","España, alfabetización internacional"),h("us","United States","Estados Unidos"),h("ph","Philippines","Filipinas"),h("gt","Guatemala","Guatemala"),h("gq","Equatorial Guinea","Guinea Ecuatorial"),h("hn","Honduras","Honduras"),h("419","Latin America","Latinoamérica"),h("mx","Mexico","México"),h("ni","Nicaragua","Nicaragua"),h("pa","Panama","Panamá"),h("py","Paraguay","Paraguay"),h("pe","Peru","Perú"),h("pr","Puerto Rico","Puerto Rico"),h("do","Dominican Republic","República Dominicana"),h("uy","Uruguay","Uruguay"),h("ve","Venezuela","Venezuela"),s("dz","Algeria","Algérie"),s("be","Belgium","Belgique"),s("bf","Burkina Faso","Burkina Faso"),s("bi","Burundi","Burundi"),s("bj","Benin","Bénin"),s("cm","Cameroon","Cameroun"),s("ca","Canada","Canada"),s("km","Comoros","Comores"),s("cg","Congo","Congo"),s("cd","French Congo (DRC)","Congo, République démocratique du"),s("ci","Côte d’Ivoire","Côte d’Ivoire"),s("dj","Djibouti","Djibouti"),s("fr","France","France"),s("ga","Gabon","Gabon"),s("gp","Guadeloupe","Guadeloupe"),s("gq","Equatorial Guinea","Guinée équatoriale"),s("gn","Guinea","Guinée"),s("gf","French Guiana","Guyane française"),s("ht","Haiti","Haïti"),s("re","Réunion","La Réunion"),s("lu","Luxembourg","Luxembourg"),s("mg","Madagascar","Madagascar"),s("ml","Mali","Mali"),s("ma","Morocco","Maroc"),s("mq","Martinique","Martinique"),s("mu","Mauritius","Maurice"),s("mr","Mauritania","Mauritanie"),s("yt","Mayotte","Mayotte"),s("mc","Monaco","Monaco"),s("ne","Niger","Niger"),s("nc","New Caledonia","Nouvelle-Calédonie"),s("pf","French Polynesia","Polynésie française"),s("rw","Rwanda","Rwanda"),s("cf","Central African Republic","République centrafricaine"),s("bl","Saint Barthélemy","Saint-Barthélemy"),s("mf","Saint Martin","Saint-Martin"),s("pm","Saint Pierre and Miquelon","Saint-Pierre-et-Miquelon"),s("sc","Seychelles","Seychelles"),s("ch","Switzerland","Suisse"),s("sy","Syria","Syrie"),s("sn","Senegal","Sénégal"),s("td","Chad","Tchad"),s("tg","Togo","Togo"),s("tn","Tunisia","Tunisie"),s("vu","Vanuatu","Vanuatu"),s("wf","Wallis and Futuna","Wallis-et-Futuna"),["it-it","Italian (Italy)","Italiano (Italia)‎"],["it-sm","Italian (San Marino)","Italiano (San Marino)‎"],["it-ch","Italian (Switzerland)","Italiano (Svizzera)‎"],["hu-hu","Hungarian (Hungary)","Magyar (Magyarország)‎"],["nl-aw","Dutch (Aruba)","Nederlands (Aruba)‎"],["nl-be","Dutch (Belgium)","Nederlands (België)‎"],["nl-bq","Dutch (Bonaire, Sint Eustatius and Saba)","Nederlands (Bonaire, Sint Eustatius en Saba)‎"],["nl-cw","Dutch (Curaçao)","Nederlands (Curaçao)‎"],["nl-nl","Dutch (Netherlands)","Nederlands (Nederland)‎"],["nl-sx","Dutch (Sint Maarten)","Nederlands (Sint-Maarten)‎"],["nl-sr","Dutch (Suriname)","Nederlands (Suriname)‎"],["pl-pl","Polish (Poland)","Polski (Polska)‎"],y("br","Brazil","Brasil"),y("pt","Portugal","Portugal"),["sv-fi","Swedish (Finland)","Svenska (Finland)‎"],["sv-se","Swedish (Sweden)","Svenska (Sverige)‎"],["sv-ax","Swedish (Åland Islands)","Svenska (Åland)‎"],["tr-cy","Turkish (Cyprus)","Türkçe (Kıbrıs)‎"],["tr-tr","Turkish (Turkey)","Türkçe (Türkiye)‎"],["qps-ploc","Pseudo (Pseudo)","[Þšéųδô (Ρŝέũδθ) !!! !!]‎"],["cs-cz","Czech (Czechia)","Čeština (Česko)‎"],["ru-by","Russian (Belarus)","Русский (Беларусь)‎"],["ru-kz","Russian (Kazakhstan)","Русский (Казахстан)‎"],["ru-kg","Russian (Kyrgyzstan)","Русский (Киргизия)‎"],["ru-md","Russian (Moldova)","Русский (Молдова)‎"],["ru-ru","Russian (Russia)","Русский (Россия)‎"],["ru-ua","Russian (Ukraine)","Русский (Украина)‎"],["zh-cn","Chinese (Simplified, China)","中文(中国)‎"],["zh-tw","Chinese (Traditional, Taiwan)","中文(台灣)‎"],["zh-sg","Chinese (Simplified, Singapore)","中文(新加坡)‎"],["zh-mo","Chinese (Traditional, Macao SAR)","中文(澳門特別行政區)‎"],["zh-hk","Chinese (Traditional, Hong Kong SAR)","中文(香港特別行政區)‎"],["ja-jp","Japanese (Japan)","日本語 (日本)‎"],["ko-kp","Korean (North Korea)","한국어 (조선민주주의인민공화국)‎"],["ko-kr","Korean (Korea)","한국어(대한민국)‎"],];return[["de","German","Deutsch‎","de-de"],["en","English","English‎","en-us"],["es","Spanish","Español‎","es-es"],["fr","French","Français‎","fr-fr"],["it","Italian","Italiano‎","it-it"],["hu","Hungarian","Magyar‎","hu-hu"],["nl","Dutch","Nederlands‎","nl-nl"],["pl","Polish","Polski‎","pl-pl"],["pt","Portuguese","Português‎","pt-br"],["sv","Swedish","Svenska‎","sv-se"],["tr","Turkish","Türkçe‎","tr-tr"],["cs","Czech","Čeština‎","cs-cz"],["ru","Russian","Русский‎","ru-ru"],["zh","Chinese","中文‎","zh-cn"],["zh-hans","Chinese (Simplified)","中文(简体)‎","zh-cn"],["zh-chs","Chinese (Simplified) Legacy","中文(简体) 旧版‎","zh-cn"],["zh-hant","Chinese (Traditional)","中文(繁體)‎","zh-tw"],["zh-cht","Chinese (Traditional) Legacy","中文(繁體) 舊版‎","zh-tw"],["ja","Japanese","日本語‎","ja-jp"],["ko","Korean","한국어‎","ko-kr"],].forEach(t,!0),i.forEach(t,!1),n}function d(n){var i=t.knownCulturesMap[n];return i?i.localizedName:null}function g(n){var i=a.NativeIntl||a.Intl,t=n.split(".")[1];try{if(!i||t==="en-in"&&i.DateTimeFormat(t).format(new Date(2016,0,9))==="1/9/2016")return!0;t&&i.DateTimeFormat(t,{hour:"numeric",minute:"numeric"})}catch(r){return!0}return!1}function nt(){var n=i.find(t.currentLocaleContext.selectableDisplayLanguages,(function(n){return n.locale&&n.locale.localeCompareIgnoreCase(t.currentLocaleContext.selectedDisplayLanguage)===0}));return n&&(n.specificCulture||n.locale)||"en-us"}function tt(n,t){var i=[];return n.forEach((function(n){n in t&&i.push(t[n])})),i}function it(n){var r=i.convertArrayToMap(n,(function(n){return n.locale.split("-")[0]}));return v(t.knownCulturesMap,(function(n,t,i){var u=n.split("-");u.length>1&&!t.neutralCulture&&r[u[0]]&&i.push(t)}),[])}function rt(n,t,i){return n?n.split(".")[1]:i}function p(n){var i=n.displayLanguage,r=tt(n.supportedLocales,t.knownCulturesMap);return{selectableDisplayLanguages:r,selectedDisplayLanguage:i,selectedFormatCulture:rt(n.rawLocaleSetting,i,n.formatCulture),selectableFormatCultures:it(r)}}function ut(n,r,e,o,s){r.setValue(l,"LastUsedLocale",o,0);var h=!1;return u.reactor(n,(function(){var c=e(),n=JSON.parse(r.getValue(l,t.redirectQueryKey,0)||"{}"),u,f;n.l=c||"";u=c||o;s||u===o||(h=!0);f=i.getFeatureValue("intlpolyfill");f!=="false"&&(n["feature.intlpolyfill"]=g(u)?"true":"",n["feature.intlpolyfill"]&&f==="true"&&(h=!0));r.setValue(l,t.redirectQueryKey,JSON.stringify(n),0)})),t.currentLocaleContext=p({supportedLocales:b,displayLanguage:f.displayLanguage,formatCulture:f.formatCulture,rawLocaleSetting:e()}),h}var v,l;r.defineProperty(t,"__esModule",{value:!0});var a=window,w=a.fx.environment,b=w.supportedLocales;t.knownCulturesMap=k();v=i.forEachKey;t.redirectQueryKey="LocaleQuery";t.localeDelimiter=".";l=e.ComponentName.Redirect;t.getLocalizedName=d;t.getCultureSpecificLanguage=nt;t.createLocaleContext=p;t.initialize=ut}));
define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",["require","exports","f","i","o","a","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";u.defineProperty(t,"__esModule",{value:!0});var w=i.Base,l=w.Diagnostics.createLog(n),c=e.Shell.Dialogs,a=0,y=1,p=0,v=c.loadOnlySafeExtensionsButtonText,b=(function(){function n(n,t,i,r,u,f,e,o,s,h,c){this._temporaryTestCodeComponents=[];this.canModifyCodeComponents=f;this._trustedCodeComponents=n;this._settingsManager=t;this._storageService=i;this._dialogManager=r;this._dialogContainer=u;this._acceptWithoutPrompt=e;this._storageServiceKey=o;this._createFunction=s;this._componentType=h;this._settingsKey=c}return n.prototype.getCodeComponentsMetadata=function(){var n=this,i=JSON.parse(JSON.stringify(this._trustedCodeComponents)),t=i.map((function(t){return n._createFunction(t)}));return this._loadUntrustedCodeComponentsIfAllowed().then((function(i){if(i.length>0){var r=function(n){return n.logUsageWarning()};n._merge(t,i,r)}return t.filter((function(n){return n.isValid()}))}))},n.prototype.listTestCodeComponents=function(){var t=this,n=this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(a,this._settingsKey).then((function(i){return i=i&&i.map((function(n){return t._createFunction(n)})),f.isArray(i)&&(n=n.concatUnique(i,(function(n,t){return n.isEqual(t)}))),n.filter((function(n){return n.isValid()}))})).then(null,(function(n){return l.error("Error listing code components",2,n),[]}))},n.prototype.registerTestCodeComponent=function(n,t){var r=this,u;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then((function(t){return r._addOrUpdateCodeComponent(t,n),r._settingsManager.setSetting(a,r._settingsKey,t),r._settingsManager.flushSettings()})).catch((function(t){l.error("Error registering code component",4,{codeComponent:n,error:t})})):(u=new i.Errors.Error("Invalid codeComponent"),u.data=n,Q.reject(u))},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then((function(i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(a,t._settingsKey,i),t._settingsManager.flushSettings()})).catch((function(n){l.error("Error unregistering code component.",6,{name:name,error:n})}))},n.prototype.unregisterAll=function(){this.clearTemporaryTestCodeComponents();var n=this._settingsManager;return n.deleteSettings({store:a,keys:[this._settingsKey]}),n.flushSettings().catch((function(n){l.error("Error registering all code components",5,n)}))},n.prototype.clearTemporaryTestCodeComponents=function(){var n=this._temporaryTestCodeComponents;n.splice(0,n.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this;return this.canModifyCodeComponents?this.listTestCodeComponents().then((function(t){return t.length===0?(n.canModifyCodeComponents&&l.verbose("No untrusted code components were found. Will load the portal in normal mode.",3),[]):n.prompt().then((function(i){return i?(t.forEach((function(t){n._componentType===p&&t.markAsTestExtension()})),t):[]}))})):Q([])},n.prototype.prompt=function(){var l=this,f=s.ComponentName.ExtensionManager,e=this._storageServiceKey,o=this._storageService,n,t,i,u;if(o.getValue(f,e,y)||this._acceptWithoutPrompt)return Q(!0);switch(this._componentType){case p:n=c.untrustedExtensionsTitle;t=c.untrustedExtensionsDescriptionFmt.format(v);break;case 1:n=c.untrustedGalleryPackageTitle;t=c.untrustedGalleryPackageDescriptionFmt.format(v);break;case 2:n=c.untrustedPatchTitle;t=c.untrustedExtensionsDescriptionFmt.format(v);break;default:throw new Error("Unsupported componentType");}return i=$(r.createElement("div")),u=new h.MessageBox(n,t,5),this._dialogContainer.prepend(i),u.defaultButtonText=v,u.extraButtonText=c.loadUnsafeExtensionsButtonText,this._dialogManager.showDialog(i,u,null,"sideload").then((function(n){var t=n===3;return l._dialogManager.dismissOpenDialog(),i.remove(),t?o.setValue(f,e,"true",y):o.clearValue(f,e,y),t}))},n.prototype._registerTestCodeComponentFromUri=function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){var i=-1;return(i=n.firstIndex((function(n){return n.isEqual(t)})),i>=0)?(n.splice(i,1),!0):!1},n.prototype._merge=function(n,t,i){var r=this;n!==null&&t!==null&&t.forEach((function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)}))},n.prototype._addOrUpdateCodeComponent=function(n,t){var i=n.first((function(n){return n.isEqual(t)}));i?i.updateWith(t):n.push(t)},n})();t.CodeComponentSideLoadManagerImpl=b}));
define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function a(n){return l.test(n)}function v(n,t,i){var r=n.isEnabled("canmodifyextensions"),u=n.isEnabled("canmodifystamps"),o=!n.isEnabled("disableextensions"),s=n.isEnabled("enableextensionflights"),e=[];return t.forEach((function(t){var h=new f(t),y=h.name.toLowerCase(),l,c,a,v;s||(h.flights=null);l=o&&!(h.flags&1)&&!i.includes(h.name);c=n.getValue(y);typeof c=="string"&&(c==="true"?(l=!0,h.isTestExtension=r):r&&c==="false"?l=!1:u&&/^[a-z0-9_\-]+$/i.test(c)&&(l=!0,h.uri=h.uriFormat.replace("{0}",c),h.isTestStamp=!0,h.prewarmUri=h.uri,h.flights=null));l&&((r||u)&&(h.cacheability=0,h.flags|=128),a=n.getValue(y+"_urlredirect"),r&&typeof a=="string"&&/^[a-z0-9]+$/i.test(a)&&(v=/(^(?:https?:)?\/\/)(?:\w+)((?:\.\w+)+)(?:\/)?(?:\w+)(?:\/)?(.*$)/.exec(h.uri),v&&(h.uri=v[1]+a+v[2]+"/"+a+"/"+v[3]),h.prewarmUri=h.uri,h.isTestExtension=!0,h.flights=null),e.push(h))})),e}var c=i.Base,u=c.Diagnostics.createLog(n),e=/^[a-zA-Z][\w]*$/,l=/^(https?:)?\/\/(localhost|127\.0\.0\.1|\[\:\:1\])(\:\d+)?(\/|$)/,o=function(n,t){return(n&&n.toLowerCase())===(t&&t.toLowerCase())},f,s,h;t.isLocalhostUri=a;f=(function(){function n(n){i.extend(this,n)}return n.prototype.isValid=function(){if(typeof this.name!="string")return u.error("Invalid extension name",1,this),!1;if(typeof this.uri!="string"||!this.uri)return u.error("Invalid extension uri",1,this),!1;if(!e.test(this.name))return u.error("Invalid extension name '{0}'. Expected pattern '{1}'".format(this.name,e),8),!1;return!0},n.prototype.isEqual=function(n){var t=n;return r.Extension.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask;this.features=t.features;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.isTestExtension=!0},n.prototype.logUsageWarning=function(){u.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),7,this)},n})();t.ExtensionMetadataExt=f;t.createExtensionMetadataExt=v;s=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n||{uri:""};return o(this.uri||"",t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted gallery package '{0}' is running".format(this.uri),7,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n})();t.GalleryPackageExt=s;h=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return o(this.uri,t&&t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted patch '{0}' is running".format(this.uri),7,this)},n})();t.PatchExt=h})(u||(u={})),u}));
define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","o","ko","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Controls/ControlBindings"],(function(n,t,i,r,u){"use strict";function h(n,t,i,r){s.push({name:t,moduleId:n+i,initOptions:r})}function f(n,t,i){h("MsPortalImpl.Controls/",n,t,i)}function e(n,t,i){h("MsPortalImpl/Controls/",n,t,i)}function c(n){t.portalControlBindings.forEach((function(t){r.bindingHandlers[t.name]=u.getAsyncBindingHandler(t.moduleId,t.initOptions,n)}))}var s,o;i.defineProperty(t,"__esModule",{value:!0});s=[];o={controlsDescendantBindings:!1};f("pcAccordion","Controls/Accordion");f("pcButton","Controls/SimpleButton");f("pcChart","Controls/Visualization/Chart");f("pcCheckBoxField","Fields/CheckBoxField");f("pcConsole","Controls/Console");f("pcCopyableLabel","Controls/Forms/CopyableLabel");f("pcCreatorAndSelector","Fields/CreatorAndSelectorField");f("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");f("pcCustomHtmlField","Fields/CustomHtmlField");f("pcCustomValueSlider","Fields/CustomValueSliderField");f("pcCustomRangeSlider","Fields/CustomRangeSlider");f("pcDatePickerField","Fields/DatePickerField");f("pcDateTimePickerField","Fields/DateTimePickerField");f("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");f("pcDayPickerField","Fields/DayPickerField");f("pcDiffEditor","Controls/Documents/DiffEditor");f("pcDockedBalloon","Controls/DockedBalloon");f("pcDonut","Controls/Visualization/Donut");f("pcDropDownField","Fields/DropDownField");f("pcDurationPickerField","Fields/DurationPickerField");f("pcEditor","Controls/Documents/Editor");f("pcFileUpload","Controls/Forms/FileUpload");f("pcFilterComboField","Fields/FilterComboField");f("pcFormSection","Fields/SectionField",o);f("pcGallery","Controls/Lists/List1/Gallery");f("pcGraph","Controls/Visualization/Graph");f("pcGrid","Controls/Lists/Grid1/Grid1");f("pcGrid2","Controls/Lists/Grid2/GridB");f("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl");f("pcArrayGrid","Controls/Lists/Grid2/Grid2.ArrayGrid.ctl");f("pcDataGrid","Controls/Lists/Grid2/Grid2.DataGrid.ctl");f("pcPagedDataGrid","Controls/Lists/Grid2/Grid2.PagedDataGrid.ctl");f("pcSequentialDataGrid","Controls/Lists/Grid2/Grid2.SequentialDataGrid.ctl");f("pcHeatMap","Controls/HeatMap");f("pcIFrame","Controls/IFrame");f("pcIFrame2","Controls/IFrameV2");f("pcLegend","Controls/Visualization/Legend");f("pcListView","Controls/Lists/List1/ListView");f("pcLogStream","Controls/LogStream");f("pcMap","Controls/Visualization/Map");f("pcMediaPlayer","Controls/AzureMediaPlayer");f("pcMenu","Controls/Lists/Menu");f("pcMetrics","Controls/Visualization/Metrics");f("pcMonitorChart","Controls/Visualization/MonitorChart/MonitorChart");f("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2");f("pcMultiLineTextField","Fields/MultiLineTextField");f("pcMultiselectDropDownField","Fields/MultiselectDropDownField");f("pcNumericTextBoxField","Fields/NumericTextBoxField");f("pcOAuthButtonField","Fields/OAuthButtonField");f("pcOptionsGroupField","Fields/OptionsGroupField");f("pcPairedTimeline","Controls/Visualization/PairedTimeline");f("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");f("pcPartPinner","Controls/PartPinner");f("pcPasswordField","Fields/PasswordField");f("pcPricingControl","Controls/PricingControl");f("pcPreviewTag","Controls/PreviewTag");f("pcProgressBar","Controls/Visualization/ProgressBar");f("pcQueryBuilder","Controls/Data/QueryBuilder");f("pcQuotaGauge","Controls/Visualization/QuotaGauge");f("pcRangeSliderField","Fields/RangeSliderField");f("pcSearchBox","Controls/SearchBox");f("pcResourceFilter","Controls/ResourceFilter");f("pcSection","Fields/Section");f("pcSelectorField","Fields/SelectorField");f("pcSettings","Controls/Settings");f("pcSimpleButton","Controls/SimpleButton");f("pcSingleSetting","Controls/SingleSetting");f("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");f("pcSliderField","Fields/SliderField");f("pcSpecComparisonTable","Controls/SpecComparisonTable");f("pcSplitter","Fields/Splitter",o);f("pcStringListField","Fields/StringListField");f("pcSummary","Controls/Summary");f("pcTextBlock","Controls/TextBlock");f("pcTextBox","Fields/TextField");f("pcTextField","Fields/TextField");f("pcTimePickerField","Fields/TimePickerField");f("pcToolbar","Controls/Toolbars/Toolbar");f("pcTreeView","Controls/Lists/Tree1/TreeView");f("pcTriStateCheckBox","Fields/TriStateCheckBox");f("pcMarkdown","Controls/Markdown");f("pcVideo","Controls/Video");e("pcAsyncFileUpload","Forms/AsyncFileUpload");e("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");e("pcEssentials","Controls.Essentials");e("pcFileDownloadButton","Controls.FileDownloadButton");e("pcFileUploadWidget","Forms/Controls.FileUpload");e("pcGroupDropDownField","Forms/GroupDropDown");e("pcResourceDropDown","Forms/ResourceDropDown");e("pcHeroBanner","Controls.HeroBanner");e("pcHotSpot","Controls.HotSpot",o);e("pcInfoBox","Controls.InfoBox");e("pcNotice","Controls.Notice");e("pcPicker","Controls.Picker");e("pcPickerV3","Controls.PickerV3");e("pcPill","Controls.Pill");e("pcPillCollection","Controls.PillCollection");e("pcPillList","Controls.PillList");e("pcTagsByResource","Controls.TagsByResource");e("pcTokenComboBox","Forms/Controls.TokenComboBox");e("pcWizard","Controls.Wizard");e("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");e("pcFileShareDropDown","Storage/FileShareDropDown");e("pcArmErrorList","ArmErrorList/Controls.ArmErrorList");t.portalControlBindings=s;t.initialize=c}));
define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","o","a","ko"],(function(n,t,i,r,u,f){"use strict";function h(n,t){i.forEachKey(n,(function(n,i){i!==undefined&&t(n,i)}))}function g(n){var i=new c,t=i.errors;return n?(h(n,(function(i,r){switch(i){case"name":o("Extension name",r,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":o(i,r,t);break;case"isPreview":v(i,r,t);break;case"assetTypes":e(i,r,t);break;case"blades":nt(n,r,t);break;case"startBoardParts":ft(r,t);break;case"partsCatalog":vt(r,t);break;case"commandsCatalog":at(r,t);break;case"commandGroups":ct(r,t);break;case"htmlTemplates":ot(r,t);break;case"styleSheets":st(r,t);break;case"galleryService":break;case"dashboardProvider":ht(r,t);break;case"requireConfig":break;default:t.push("Unexpected attribute '{0}' on definition.".format(i))}})),i):(t.push("Definition is null or undefined."),i)}function o(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(n))}function v(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function e(n,t,i){var r=u.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function nt(n,t,i){t&&e("blades",t,i)&&t.forEach((function(t,r){y(n,t,r,i)}))}function y(n,t,i,r){var u=t.name;t.inputs&&e("Blade: {0}. Property: blades[{1}].inputs".format(u,i),t.inputs,r);t.optionalInputs&&e("Blade: {0}. Property: blades[{1}].optionalInputs".format(u,i),t.optionalInputs,r);e("Blade: {0}. Property: blades[{1}].lenses".format(u,i),t.lenses,r)&&t.lenses.forEach((function(n,t){var f="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(u,n.name,i,t);n.partInstances&&e(f,n.partInstances,r)&&n.partInstances.forEach((function(f,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(u,n.name,f.name,i,t,e);w(o,f,r)}))}));t.permissions&&e("Blade: {0}. Property: blades[{1}].permissions".format(u,i),t.permissions,r)&&t.permissions.forEach((function(n,t){l("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(u,i,t),n,r)}));tt(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(u,i),r);it(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(u,i),r)}function tt(n,t,i){n&&(n.source?p(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function it(n,t,i){n&&n.source&&p(n.source,t+".source",i)}function p(n,t,i){n.property&&o(t+".property",n.property,i);n.optional&&typeof n.optional!="boolean"&&i.push("The attribute 'optional' should be of type boolean. "+t);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&i.push("The attribute 'isIdentityInput' should be of type boolean. "+t);e(t+".valuesFrom",n.valuesFrom,i)&&n.valuesFrom.forEach((function(n,r){rt(t+".valuesFrom[{0}]".format(r),n,i)}))}function rt(n,t,i){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:i.push("Unknown reference type '{0}' found for {1}.referenceType.".format(t.referenceType,n))}o(n+".property",t.property,i);t.part&&o(n+".part",t.part,i)}function ut(n,t,i){switch(t.sourceType){case 0:t.providerKey&&i.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case 1:t.providerKey||i.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));o(n+".providerKey",t.providerKey,i);break;case 2:t.providerKey||i.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));o(n+".providerKey",t.providerKey,i);break;default:i.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,n))}o(n+".property",t.property,i)}function l(n,t,i){var r,u;switch(t.permissionType){case 0:r=t;r.extensionName&&o(n+".extensionName",r.extensionName,i);o(n+".assetType",r.assetType,i);r.assetId?ut(n+".assetId",r.assetId,i):i.push("Permission missing assetId found for {0}.assetId.".format(n));o(n+".action",r.action,i);break;case 1:u=t;switch(u.requirement){case s.All:case s.Any:break;default:i.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(u.requirement,n))}e(n+".permissions",u.permissions,i)&&u.permissions.forEach((function(t,r){l("{0}.permissions[{1}]".format(n,r),t,i)}));break;default:i.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,n))}}function ft(n,t){e("startBoardParts",n,t)&&n.forEach((function(n,i){w("startBoardParts[{0}]".format(i),n,t)}))}function w(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&b(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}function b(n,t,i){t&&(et(n,t.partState,i),t.permissions&&e("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach((function(t,r){l("{0}.permissions[{1}]".format(n,r),t,i)})))}function et(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=k(o),u=k(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function k(n){var t={},i=[];return(n||[]).forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function ot(n,t){h(n,(function(n,i){typeof i!="string"&&(o("htmlTemplates['{0}'].file".format(n),i.file,t),o("htmlTemplates['{0}'].content".format(n),i.content,t))}))}function st(n,t){u.isArray(n)?n.forEach((function(n,i){o("StyleSheet at position {0}".format(i),n,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}function ht(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function ct(n,t){n&&e("commandGroups",n,t)&&n.mapMany((function(n){return n.commands})).forEach((function(n){n.reference&&lt(n,t)}))}function lt(n,t){if(n&&n.reference){var i=!1;h(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(f.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(f.toJSON(n)))}}function at(n,t){n&&e("commandsCatalog",n,t)&&n.forEach((function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");!n.reference||t.push(i+"cannot specify a 'reference' property.")}))}function vt(n,t){n&&e("partsCatalog",n,t)&&n.forEach((function(n){d(n,t)}))}function d(n,t){n.inputDefinitions&&e("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&yt(n,t);b("PartType: {0}".format(n.name),n,t)}function yt(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==7&&i.referenceType!==9&&i.referenceType!==5&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var a,s,c;r.defineProperty(t,"__esModule",{value:!0});a=i.Extension;s=a.SetRequirement;c=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();t.ValidationResult=c;t.validateDefinition=g;t.validateIsString=o;t.validateIsBoolean=v;t.validateIsArray=e;t.validateBlade=y;t.validatePartType=d}));
define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","f","o","FxInternal/Di","MsPortalImpl/Extension/Extension.DefinitionValidator"],(function(n,t,i,r,u,f){"use strict";function h(n,t,i,r,u){return"["+n+"]"+t+"-"+i+"-"+r+"-"+u}function c(n,t){return n+"-"+t}function l(n){var t=new f.ValidationResult,i=t.errors,r;return n?(n.assetTypes&&f.validateIsArray("manifest.assetTypes",n.assetTypes,i)&&n.assetTypes.forEach((function(t){a(t,n.name,i)})),t):(r="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the MsPortalFx.Extension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",i.push(r),t)}function e(n,t,i,r){n.push(t.format(i,r))}function a(n,t,r){var u=n.name;if(o(u)&&e(r,"The name for the asset type in manifest '{0}' was not specified.",t),n.browseType!==undefined&&typeof n.browseType!="number"&&e(r,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",u,t),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&e(r,"The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&e(r,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",u,t),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&e(r,"The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",u,t),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&e(r,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",u,t),n.browseRequirements!==undefined&&typeof n.browseRequirements!="number"&&e(r,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",u,t),n.browseType!==undefined){switch(n.browseType){case 0:n.browseServiceViewModel||e(r,"The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.",u,t);break;case 1:n.browseServiceViewModel&&e(r,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.",u,t);break;case 2:n.browseServiceViewModel&&e(r,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.",u,t);break;case 3:n.browseLinkUri||e(r,"The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.",u,t)}n.privateBrowse!==undefined&&n.browseType===undefined&&e(r,"The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.",u,t);n.browseType!==0&&n.browseServiceViewModel&&e(r,"The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.",u,t);o(n.pluralDisplayName)&&o(n.text)&&e(r,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",u,t);i.isNullOrUndefined(n.icon)&&e(r,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",u,t)}else n.browseServiceViewModel!==undefined?n.browseType=0:n.privateBrowse!==undefined&&e(r,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",u,t);n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&e(r,"The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t);n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!="string"&&e(r,"The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&e(r,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t)}var o,s;r.defineProperty(t,"__esModule",{value:!0});o=i.isNullOrWhiteSpace;s=(function(){function n(){this._partRedirectsMap={};this._bladeRedirectsMap={}}return n.prototype.addPartRedirect=function(n,t){this._partRedirectsMap[h(t.type,t.fromExtension||n,t.fromPart,t.fromBlade,t.fromLens)]=i.extend({toExtension:n},t)},n.prototype.addBladeRedirect=function(n){this._bladeRedirectsMap[c(n.fromExtension,n.fromBlade)]=n},n.prototype.getPartRedirect=function(n,t,i,r,u){var f=h(n,t,i,r,u);return{key:f,definition:this._partRedirectsMap[f]}},n.prototype.getBladeRedirect=function(n,t){var i=c(n,t);return{key:i,definition:this._bladeRedirectsMap[i]}},n})();s=__decorate([u.Class()],s);t.RedirectMap=s;t.validate=l}));
define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function o(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function s(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function h(n,e,o){var s=null,h=null;return(e in t?(s=t[e].modulePath,h=t[e].factory):e in r&&(s=r[e].modulePath,h=function(n){return r[e].factoryWithState(n,o)}),f(u,(function(t,i){e.startsWith(t)&&(s=i.modulePath,h=function(t){return i.factoryWithPrefix(t,o,e,n)})})),s)?i.require(s).then((function(n){return h(n)})):null}var t={},r={},u={},f=i.forEachKey;n.register=e;n.registerWithState=o;n.registerPrefix=s;n.resolve=h})(r||(r={})),r}));
define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports","f"],(function(){"use strict";var n;return (function(n){n.desktopSettingsKey="sprint2";n.startBoardSettingsKey="Startboard";n.fxThemeKey="fxs-theme";n.highContrastKey="highContrastKey";n.favoritesKey="favorites";n.testExtensionsKey="TestExtensions";n.testGalleryPackagesKey="TestGalleryPackages";n.testPatchesKey="TestPatches";n.npsTimeMs="npsTimeMs";n.rawLocaleKey="rawLocale";n.sideBarCollapsedKey="sideBarCollapsedKey";n.sideBarBrowseDisplayModeKey="sideBarBrowseDisplayModeKey";n.showCommandLabelsKey="showCommandLabelsKey";n.notificationToastEnabledKey="notificationToastEnabledKey";n.whatsNewEnabledKey="whatsNewEnabledKey";n.showLabelsKey="showLabelsKey";n.whatsNewVersionKey="whatsNewVersion";n.userConsentForNpsContactKey="userConsentForNpsContact";n.settingsVersionSettingKey="Version";n.defaultAssetTypeIdKey="MsPortalFx.Browse.DefaultAssetTypeId";n.idleTimeoutMinsKey="idleTimeoutMins";n.optIntoNewBrowseKey="optIntoNewBrowse";n.generalSettingsKeys=[n.defaultAssetTypeIdKey,n.fxThemeKey,n.highContrastKey,n.idleTimeoutMinsKey,n.notificationToastEnabledKey,n.npsTimeMs,n.rawLocaleKey,n.settingsVersionSettingKey,n.showCommandLabelsKey,n.showLabelsKey,n.sideBarCollapsedKey,n.sideBarBrowseDisplayModeKey,n.testExtensionsKey,n.testGalleryPackagesKey,n.userConsentForNpsContactKey,n.whatsNewVersionKey,n.optIntoNewBrowseKey,]})(n||(n={})),n}));
define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","i","o","MsPortalImpl/AsyncLoader","FxInternal/Di","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var b;u.defineProperty(t,"__esModule",{value:!0});var nt=i.Base,tt=nt.Diagnostics,p=s.ExtensionMetadataExt,k=window,d=k.fx,it=tt.createLog(n),rt="testExtensions",ut="loadUntrustedExtensions",g="Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.",w=(function(){function n(n){this.value=n}return n.create=function(){var i=d.bootParameters.environment,t;return i?new n(i):(t=d.early,Q(t&&t.preload).then((function(t){return new n(t.shellBootEnvironment)})))},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",u)],w,"create",null);t.ShellBootEnvironmentState=w;b=(function(n){function t(t,i,r,u,f,e,o){return n.call(this,t,i,r,u,f,e,o,ut,(function(n){return new p(n)}),0,h.testExtensionsKey)||this}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=new p(n);return this.registerTestCodeComponent(i,t).then((function(){console.log(g)}))},t.prototype.registerTestExtensionsFromUri=function(n){var e=this,h=new y.Uri(n),o=h.getHashQueryStringValue(rt),t,f;return o?(t=JSON.parse(decodeURIComponent(o)),f=u.keys(t),!this.canModifyCodeComponents&&f.length&&console.warn(g),Q.allSettled(f.map((function(n){var u=new p(null),c,h,f,o,l;return u.name=n,c=r.Extension.getWindowId(u),h=i.find(e._trustedCodeComponents,(function(n){return r.Extension.getWindowId(n)===c})),h&&(u.obsoleteBundlesBitmask=h.obsoleteBundlesBitmask),f=t[n],typeof f=="string"?o=f:(o=f.uri,!f.azExtension||(u.azExtension=!0)),u.uri=o,s.isLocalhostUri(o)?e._registerTestCodeComponentFromUri(u):(l="Invalid extension: '{0}', only allowed on 'localhost'.".format(o),it.error(l,1),null)})))):Q(null)},t.prototype.unregisterTestExtension=function(n){var t=new p(null);return t.name=n,this.unregisterTestCodeComponent(t)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.create=function(n,r,u,e,o,h,c,l){var p=s.createExtensionMetadataExt(r,l.value.extensionsMetadata,k.fx.environment.disabledExtensions),y=r.isEnabled("canmodifyextensions"),v=new t(p,u,e,o,h.splashScreen,y,i.isDevelopmentMode),a;return MsPortalImpl.Extension=v,a=v.registerTestExtensionsFromUri(c.location.href),y&&(a=a.then((function(){return n.getAsync(f.get("MsPortalImpl/Extension/ExtensionPatch","PatchMetadataSource")).then((function(n){return n.registerTestPatchesFromUri(location.href).then((function(){return n.listTestPatches().then((function(n){(t=MsPortalEarly.ExtensionLoader.patchUris).push.apply(t,(n||[]).map((function(n){return n.uri})));var t}))}))}))}))),a.then((function(){return v}))},t})(o.CodeComponentSideLoadManagerImpl);__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e.Container,r.Features,c.SettingsManager,l.StorageService,a.DialogManager,v.RootElements,v.WindowManager,w]),__metadata("design:returntype",u)],b,"create",null);t.ExtensionMetadataSource=b}));
define("MsPortalImpl/Extension/ExtensionManagerOptions",["require","exports","f","i","o","FxInternal/Di","MsPortalFx/Globalization","MsPortalImpl/Extension/ExtensionMetadataSource"],(function(n,t,i,r,u,f,e,o){"use strict";u.defineProperty(t,"__esModule",{value:!0});var s=(function(){function n(n,t,u,f,o){var s;this.region=t;this._normalizedNameMap={};this.displayLanguage=f||e.displayLanguage;this.formatCulture=o||e.formatCulture;var l=(n.getValue("disabledextensionredirects")||"").toLowerCase().split(","),h=u.filter((function(n){return n.azExtension})),c=r.partition(u,(function(n){return n.redirectTo&&!l.includes(n.name.toLowerCase())}));this.extensionRedirectMap=i.convertArrayToMap(c[0],(function(n){return n.name}),(function(n){return n.redirectTo}));s=c[1];!n.isEnabled("azblade")&&h.length>0&&(s=s.filter((function(n){return!n.azExtension})),console.warn("Extensions '"+h.map((function(n){return n.name})).join(", ")+"' won't be used.  Supply '?feature.azblade=true' to enable."));this.extensionsAsMap=i.convertArrayToMap(s,(function(n){return n.name}));this.extensionsAsArray=s;this._normalizedNameMap=i.convertArrayToMap(u,(function(n){return n.name.toLowerCase()}),(function(n){return n.name}))}return n.create=function(t,i,r){return i.getCodeComponentsMetadata().then((function(i){return new n(t,r.value.region,i)}))},n.prototype.normalizeExtensionName=function(n){var t=this._normalizedNameMap[n.toLowerCase()];if(!t)throw new Error("The extension name '"+n+"' is not valid");return this.resolveExtensionName(t)},n.prototype.resolveExtensionName=function(n){return this.extensionRedirectMap[n]||n},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[r.Features,o.ExtensionMetadataSource,o.ShellBootEnvironmentState]),__metadata("design:returntype",u)],s,"create",null);t.ExtensionManagerOptions=s}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",["require","exports","f","i","o","a","ko","$"],(function(n,t,i,r,u,f,e,o){"use strict";function ft(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return ut(it,this,[n,t].concat(r.map(e.toJS)))}function h(n,t,i){for(var f=t?t.split("."):[],u={exists:n&&f.length>0,value:undefined},r=n,o=0,s=i?e.utils.peekObservable:e.unwrap;u.exists&&o<f.length;)r=s(r),r&&r.hasOwnProperty(f[o])?r=r[f[o]]:u.exists=!1,o++;return u.exists&&(u.value=r),u}function a(n,t,r){for(var h=function(i){if(!i||typeof i!="object")throw new Error(ot("A property in model hierarchy is not an object. Path: '{0}'.".format(t),n));return i},o=t.split("."),f=h(n),u,s=0;s<o.length-1;s++)u=o[s],i.isNullOrUndefined(f[u])&&(f[u]={}),f=h(e.unwrap(f[u]));u=o.last();f[u]&&e.isObservable(f[u])?f[u](r):f[u]=r}function v(n){var t;try{t=e.toJSON(n)}catch(i){return i.message}return t}function ot(n,t){var i=v(t);return i?"{0}\nModel: '{1}'".format(n,i):n}function st(n,t,i,r){var o=y(r,b),u={};return f.isArray(t)&&t.forEach((function(t){var r=t.source,s=t&&r&&r.scope===k.CurrentContainer&&r.modelType===i,f=s&&h(n,r.property);f&&f.exists&&(p(o,t.targetProperty,f.value),a(u,t.targetProperty,e.toJS(f.value)))})),u}function y(n,t){if(t){var s=n.toLowerCase(),r=function(n){return i.isPlainObject(n)&&!i.isEmptyObject(n)?u.keys(n).every((function(n){return s.indexOf(n.toLowerCase())>=0})):!1},f=r(t.debug),h=r(t.log),e=r(t.verbose),o;return(h||f||e)&&(o={debugId:n,breakOnInputsSet:f,verbose:e}),o}}function p(n,t,r){n&&n.verbose&&!i.canSendThroughPostMessage(r)&&w.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(n.debugId,t,e.toJSON(r)))}function g(n){return n&&n.modelType===t.inferredReferenceType}function ht(n){return n.isDynamicBinding&&!g(n.source)}var k,et,s,l,c,d;u.defineProperty(t,"__esModule",{value:!0});var nt=r.TriggerableLifetimeManager,tt=i.Base,w=tt.Diagnostics.createLog(n),b=i.trace.inputsset,it=f.prototype.splice,rt=r.quickApplyArrayEdits,ut=i.applyCall;(function(n){n[n.CurrentContainer=0]="CurrentContainer";n[n.MasterContainer=1]="MasterContainer";n[n.DetailsContainer=2]="DetailsContainer"})(k=t.ReferenceScope||(t.ReferenceScope={})),(function(n){n[n.OneToOne=0]="OneToOne";n[n.OneToMany=1]="OneToMany";n[n.ManyToOne=2]="ManyToOne"})(et=t.ReferenceCardinality||(t.ReferenceCardinality={}));s=(function(){function n(n,t){this.kind=n;this.propertyName=t}return n.forObject=function(t,i,r){var u=new n(0,t);return u.propertyValue=i,u.propertyOldValue=r,u},n.forArray=function(t,i){var r=new n(1,t);return r.propertyArrayEdits=i||[],r},n.forNewArray=function(t,i){var r=new n(1,t);return r.propertyValue=i,r},n})();t.ObservableChangeArgs=s;l=(function(){function n(n,t,i,r,u){this.cancel=!1;this.propertyChanges=[];this.sourceModelId=n;this.sourceModel=t;this.sourceProperty=i;this.targetModel=r;this.targetProperty=u}return n})();t.PropertyTransformerArgs=l;c=(function(){function n(n,t,i,r,u,f){this.transformers=[];this.compositionBindingDefinition=null;this._callbacks=o.Callbacks();this._errCallbacks=o.Callbacks();this._awaitBound=Q.defer();this._tgtHasValue=!1;this.sourceProperty=n;this.targetProperty=t;this.targetModel=i;this._tgtModelName=r;this.transformers=u;this._tgtPropExists=f;this._traceOptions=y(r,b)}return n.prototype.sourceModelName=function(){return this._srcModelName},u.defineProperty(n.prototype,"sourceModel",{get:function(){return this._srcModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isBound",{get:function(){return!!this._srcModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"awaitBound",{get:function(){return this._awaitBound.promise},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetHasValue",{get:function(){return this._tgtHasValue},enumerable:!0,configurable:!0}),n.prototype.addValueChangedHandler=function(n){n&&this._callbacks.add(n)},n.prototype.removeValueChangedHandler=function(n){this._callbacks.remove(n)},n.prototype.addErrorHandler=function(n){n&&this._errCallbacks.add(n)},n.prototype.bind=function(n,t,i,r,u){var o=this,l,a,h,c;if(i===void 0&&(i=!0),this.isBound){this._err("Property binding is already bound.");return}return this.addValueChangedHandler(r),this.addErrorHandler(u),this._validateBinding(n,t)?(this._srcModelName=n,this._srcModel=t,l=this._getSrcValue(),a=e.utils.peekObservable(l),i&&a!==undefined&&this._changeTgtModel(s.forObject(this.targetProperty,a)),e.isObservable(l)?(h=l,this._bindingLifetime=new nt,h.subscribe(this._bindingLifetime,(function(n){var t,r,i;f.isArray(n)?(r=n,t=n.slice(0)):t=n;(h.splice||h.map)&&(i="arrayChange");c&&c.dispose();c=o._bindingLifetime.createChildLifetime();h.subscribe(c,(function(n){var u,l;c.dispose();c=undefined;i==="arrayChange"&&(u=n,n=h());f.isArray(t)&&f.isArray(n)?r===n?(u=u||e.utils.compareArrays(t,n,{sparse:!0}),l=s.forArray(o.targetProperty),l.propertyArrayEdits=e.utils.adjustArrayEdits(u),o._changeTgtModel(l)):o._changeTgtModel(s.forNewArray(o.targetProperty,n)):o._changeTgtModel(s.forObject(o.targetProperty,h(),t))}),null,i)}),null,"beforeChange")):i||this._err("Error when binding. The value is not an observable and importInitialValue is false."),this._awaitBound.resolve()):this._awaitBound.reject(),this},n.prototype.unbind=function(){this._bindingLifetime&&this._bindingLifetime.dispose();this._srcModel=null;this._srcModelName=null;this._callbacks.empty();this._errCallbacks.empty()},n.prototype.toString=function(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this.sourceProperty,this._tgtModelName,this.targetProperty||"<DYNAMIC>",this._srcModel?v(this._srcModel):"<UNBOUND>",v(this.targetModel))},n.prototype._changeTgtModel=function(n){var i=this,r=new l(this._srcModelName,this._srcModel,this.sourceProperty,this.targetModel,this.targetProperty),t,u;n&&r.propertyChanges.push(n);this._processTransformers(r)&&((r.propertyChanges||[]).forEach((function(n){var r,o,s;n.propertyName&&(r=i._traceOptions,n.kind===0?(i._tgtHasValue=n.propertyValue!==undefined,p(r,n.propertyName,n.propertyValue),a(i.targetModel,n.propertyName,e.toJS(n.propertyValue))):(t=h(i.targetModel,n.propertyName).value,u=e.unwrap(t),o=n.propertyArrayEdits,f.isArray(u)?o?(r&&r.verbose&&o.forEach((function(t){t.status==="added"&&p(r,n.propertyName,t.value)})),e.isObservable(t)&&t.valueWillMutate(),i._tgtHasValue=!0,rt(u,o,{inplaceFixup:!1,spliceFunc:ft}),e.isObservable(t)&&t.valueHasMutated()):n.propertyValue&&(i._tgtHasValue=!0,s=n.propertyValue,t.splice?t.splice.apply(t,[0,u.length].concat(s)):t(s)):i._err("[Property Binding] Array change detected on source property, but target property is not an array.")))})),this._callbacks.fire(r.propertyChanges))},n.prototype._processTransformers=function(n){return this.transformers.some((function(t){return t(n),n.cancel})),!n.cancel},n.prototype._getSrcValue=function(){return h(this._srcModel,this.sourceProperty).value},n.prototype._validateBinding=function(n,t){var i,r=this.compositionBindingDefinition,u=!(r&&r.optional);return this._validateModel(n,t,this.sourceProperty,u,(function(n){i=n}))?this.sourceProperty?this._validateModel(this._tgtModelName,this.targetModel,this.targetProperty,this._tgtPropExists,(function(n){i=n}))||(i="[Property Binding] Invalid target model - {0}".format(i)):i="[Property Binding] Invalid source model - Source property must be defined.":i="[Property Binding] Invalid source model - {0}".format(i),i&&this._err(i),!i},n.prototype._validateModel=function(n,t,i,r,u){var f;return n?t?i&&r&&!h(t,i).exists&&(f="Model is missing property '{0}'.".format(i)):f="Model is undefined.":f="Model is missing an identifier.",f&&u&&u(f+"\nModel id: '{0}'.".format(n||"N/A")),!f},n.prototype._err=function(n){this.isBound&&(n+=""+this);var t=i.trace;(i.isDevelopmentMode||t&&t.diagnostics)&&w.error(n);this._errCallbacks.fire(n)},n})();t.PropertyBinding=c;t.getModelValue=h;t.setModelValue=a;d=(function(){function n(n,t,i){var r=this;this._properties=[];this._propertyChangedCallbacks=o.Callbacks();this._aggregatePropertyChangedHandler=function(n){r._propertyChangedCallbacks.fire(n)};this._targetModel=t;this._targetModelName=n;this._validateTargetPropertiesExist=i!==!1}return u.defineProperty(n.prototype,"properties",{get:function(){return this._properties.slice(0)},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetModelName",{get:function(){return this._targetModelName},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetModel",{get:function(){return this._targetModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"awaitAllBound",{get:function(){var n=this._properties.map((function(n){return n.awaitBound}));return Q.all(n)},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"allBound",{get:function(){return this.properties.every((function(n){return n.isBound}))},enumerable:!0,configurable:!0}),n.prototype.addPropertyChangedHandler=function(n){this._propertyChangedCallbacks.add(n)},n.prototype.addProperty=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return i=new c(n,n,this._targetModel,this._targetModelName,r,this._validateTargetPropertiesExist),i.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(i),i},n.prototype.mapProperty=function(n,t){for(var r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];return r=new c(n,t,this._targetModel,this._targetModelName,u,this._validateTargetPropertiesExist),r.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(r),r},n.prototype.removeProperty=function(n){var t=this._properties.indexOf(n);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))},n.prototype.getProperty=function(n){return this._properties.first((function(t){return t.targetProperty===n}))},n.prototype.unbind=function(){this._properties.forEach((function(n){n.unbind()}));this._propertyChangedCallbacks.empty()},n.prototype.toString=function(){for(var t="",i=this.properties,r=this.properties.length,n=0;n<r;++n)t+="properties[{0}]: {1}".format(n,i[n].toString());return t},n})();t.PropertyBindings=d;t.mapSourceModelToTargetModel=st;t.extractTraceOptions=y;t.inferredReferenceType=-999;t.isOverridesOrContainerModelSourceReference=g;t.isDynamicBindingWithNonLocalSource=ht}));
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","f","o","ko","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.DesktopManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";function v(n,t,i){b.error("Error invoking detail blade for master '{0}'. ".format(t)+n+"Selection model: '{0}'".format(JSON.stringify(i)))}function k(n,t){var i=arguments.length===2?h(n,t).value:n,r;return i?(r=[i.selectedValue,i.value,i.isSelected,i.isActivated,i.isCommandSelected,i.hasChildEdits],r.every(u.isObservable)):!1}function d(n,t){var i=arguments.length===2?h(n,t).value:n,r;return i?(r=[i.selectableItems,i.selectedItems,i.activatedItems,i.itemsWithChildEdits],r.every(u.isObservable)):!1}function g(n){var t=n;return!!t.isLocked()}function nt(n){return n.blade?n.selectablePath||"container.selectable":tt(n)}function l(n){var t=n&&n.invocationInputArguments,i=t&&t[0],r=i&&i.valuesFrom,u=r&&r[0];return u&&u.property}function tt(n){var r=l(n),t,i,u;return r&&(t=r.split("."),i=t.length,i>1)?(u=t[i-1],["value","activatedItems","selectedItems","selectedItem"].some((function(n){return n===u}))&&(t=t.slice(0,i-1)),t.join(".")):null}function it(n){var t,i,r;return n?(t=n.filter((function(n){return n&&!n.selectablePath&&!n.invocationInputArguments})),!t.length&&(i=n.filter((function(n){return n&&n.selectablePath==="container.selectable"})),!i.length&&(r=n.filter((function(n){var t=l(n);return t==="container.selectable.value"||!n.blade&&t==="container.selectable"})),!r.length)))?!1:!0:!1}function rt(n,t,i){var r,f=n.invocationInputArguments,o=f&&f.length!==1,e=f&&!o&&f[0].valuesFrom,u=n.outputArguments;return(o?r="Invocation arguments must exist and have only one element.":e&&e.length>1?r="Multiple 'valuesFrom' not supported for invocation arguments.":!n.blade&&f[0].property?r="Static invocation property is not supported when omitting the details blade name.":e&&e[0].constantValue!==undefined?r="Constants are not allowed on invocation argument.":u&&u.length>0&&(u.some((function(n){return!n.property}))?r="Output arguments must specify a target property.":u.some((function(n){return n.valuesFrom.length!==1}))?r="Output arguments support only one valueFrom property.":u.some((function(n){return n.valuesFrom[0].constantValue!==undefined}))?r="Constants are not allowed on output arguments.":u.some((function(n){return n.valuesFrom[0].referenceType!==1}))&&(r="Output arguments only support source ReferenceType.BladeInput.")),!r&&i&&(r=i(n)),r)?(t.push(r),!1):!0}function ut(n,t,i,r){var h=t,l=t,a=t,y,u,o={},s;return st(r,t)&&(t.extension&&(s=t.extension,s=n.diContainer.get(f.ExtensionManagerOptions).resolveExtensionName(s),i=c.forExtension(s)),y=c.forExtensionManifest(i.name),h.detailBlade?u=i.withBlade(h.detailBlade):l.assetType&&n.finder.tryLocate(y.withAssetType(l.assetType),o)?u=p(i.name,o.value):a.resourceId&&e.tryLocateAssetDefinitionFromResourceId(n.extensionManager,a.resourceId,o)?u=p(o.extensionName,o.value):v("Unable to locate asset. Error: '{0}'. ".format(o.error),r,t)),u||(u=i.withBlade("##NOT_SPECIFIED##")),u}function ft(n,t,i){var r=t&&t.container,u=i.details;return r&&r.selectable===n?u.first((function(n){return y(n)})):n?(u||[]).first((function(i){var r=i.invocationInputArguments,u=i.selectablePath;return r?r.some((function(i){return i.valuesFrom.some((function(i){var r=[];return i.property.split(".").some((function(i){return r.push(i),h(t,r.join(".")).value===n}))}))})):u?h(t,u).value===n:!1})):null}function y(n){var r=l(n),u=n.selectablePath,i=!0;return r?i=r===t.PartContainerSelectableValue_ViewModelPath:u&&(i=u===t.PartContainerSelectable_ViewModelPath),i}function et(n,t,r,u,f){var e,s;if(t.setLifetimeReference(8,r),s=function(){var t,h,s;u.length||(u=r.bladeDefinition&&r.bladeDefinition.outputs||[]);u.length&&(t={},e=new o.PropertyBindings(r.id+"-"+n,t,!1),h=r.getViewModel(1),e.addPropertyChangedHandler((function(){s=i.clone(t,!0)})),u.forEach((function(n){e.mapProperty(n,n).bind(r.id,h,!0)})),s&&f&&f(s),e.addPropertyChangedHandler((function(){var n=i.clone(t,!0);f&&f(n)})))},u.length||f){r.isComposed?s():r.awaitComposed().then(s);r.onDispose((function(){e&&(e.unbind(),e=null)}))}}function ot(n,t,i,r,f){function e(){return i.referenceComposition.getPartsContainer().detailContainers.map((function(n){return"\n    "+n.toString()+". Model: "+u.toJSON(n.getInputsOnlyViewModel())})).join("")||"<None>"}s.isTraceEnabled&&n.verbose("[BladeOpener] "+t+("\n Master Identifier: "+i.masterModelId+".")+("\n  Master Property: "+r.source.property)+("\n  Master Value: "+(f!==undefined?u.toJSON(f):"<undefined>")+".")+("\n  Current Detail Blades from Container: "+e()))}function st(n,t){var i,r=t,u=t,f=t;return t?r.detailBlade||u.assetType||f.resourceId?r.detailBlade&&u.assetType?i="'detailBlade' and 'assetType' cannot be specified at the same time.":r.detailBlade&&f.resourceId?i="'detailBlade' and 'resourceId' cannot be specified at the same time.":u.assetType&&f.resourceId?i="'assetType' and 'resourceId' cannot be specified at the same time.":t.detailBladeInputs||(i="Model must define a 'detailBladeInputs' property."):i="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":i="Dynamic selection must be specified. ",i&&v(i,n,t),!i}function p(n,t){if(!t)return null;var i=t.contracts;return(i&8)==8?c.forExtension(a.ExtensionNames.Hubs).withBlade(a.BladeNames.Hubs.ResourceMenuBlade):c.forExtension(t.bladeExtensionName||n).withBlade(t.bladeName)}var h;r.defineProperty(t,"__esModule",{value:!0});var c=e.Locator,a=i.Base.Constants,w=i.Base.Diagnostics,b=w.createLog(n);t.PartContainerSelectable_ViewModelPath="container.selectable";t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath+".value";h=o.getModelValue;t.DefaultConfiguration={services:null,masterModelId:null,masterModel:null,referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:i.noop,onBladesOpening:i.noop,onBladeOpened:i.noop,addOutputBindings:i.noop,removeOutputBindings:i.noop,getCloseOwnedDetailBladesHandler:i.wrap(null),getCloseOtherDetailBladesHandler:i.wrap(null)};t.isSelectable=k;t.isSelectableSet=d;t.isSelectableLocked=g;t.getSelectablePath=nt;t.needContainerSelectable=it;t.validateDetailsDefinition=rt;t.mapDynamicSelectionToBladeLocator=ut;t.getAssociatedDetailDefinition=ft;t.detailsIsPartContainer=y;t.bindOutputsToSelectable2=et;t.traceInvocationChange=ot}));
define("MsPortalImpl/Extension/Extension",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/JQueryExtensions"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function ei(n,t,i,r){return n.azExtension?new it(n,t):new k(n,t,i,r)}function oi(n,t,i){for(var r=[],u=Q(),f=function(){r.length<t&&(u=u.then((function(){if(r.length<t)return i().then((function(n){r.push(n)})).catch((function(n){p.error(n,6)}))})))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(4e3).then(f),r.pop()},size:function(){return r.length}}}function ht(n,t,i){var r=typeof t=="object"?t:{name:t};return{type:n,locator:r,initialState:i.initialState,createSelectable:i.createSelectable,telemetryContext:ui.getState(),partSize:i.partSize,contentSize:i.contentSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags}}function ct(n,t,i){var r=i;return(r.redirects||[]).forEach((function(i){switch(i.type){case 2:case 3:var r=i;r.fromBlade&&(r.toExtension||(r.toExtension=r.type!==3?t:""),r.fromExtension||(r.fromExtension=t),st&&r.toExtension.toLowerCase()===st||r.toExtension!==t&&r.fromExtension!==t||n.addBladeRedirect(r));break;case 4:case 5:n.addPartRedirect(t,i)}})),r}function lt(n,t,r,u,f){var o=c.validate(t),s,e;if(o.valid())if(n!==t.name)s="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",u(v.InvalidExtensionName,s.format(t.name,n));else try{return r||fi(ii.cachedManifestTypes,(function(n){f(n,t)})),f("assetTypes",t)}catch(h){e="validateAndSetManifest throws";p.error(new i.Errors.Error({message:e,data:t,innerErrors:h}));u(v.Unexpected,e)}else o.errors.forEach(p.error,p),u(v.InvalidManifest,"The extension manifest has validation errors.")}function at(n,t,i){ot.trace({source:et,action:ft,actionModifier:"complete",duration:t,name:n,data:i})}function vt(n,t,i,u,f){var o="Failed to initialize extension '{0}'. ErrorState: {2}. Error: {3}.".format(n,v[t],i),e=r.createError(o,{data:{extVersion:u,timeThisExtensionFailed:gt(),extensionTelemetry:f}});return p.error(e,1),b.Upload.flush(),e}function yt(n){var t="style[{0}='{1}']".format(ri,n);ni.remove(t)}var k,w,nt,tt,it,d;u.defineProperty(t,"__esModule",{value:!0});var y=r.Extension,pt=r.TelemetryContext,rt=i.Base,wt=MsPortalEarly.ExtensionLoader,ut=rt.Constants,bt=ut.ExtensionNames.Hubs,b=rt.Diagnostics,kt=b.Telemetry,dt=r.Rpc,g=window,gt=g.fx.getTimestamp,ni=$(g.document.head),p=b.createLog(n),ti=g.fx.environment,ii=ti.relex,ft="ExtensionLoad",ri="data-extensionname",et="ExtensionManager",ot=kt,ui=pt,fi=i.forEachKey,st=(i.getFeatureValue("blockbladeredirect")||"").toLowerCase(),v;(function(n){n[n.None=0]="None";n[n.InvalidExtensionName=1]="InvalidExtensionName";n[n.InvalidManifest=2]="InvalidManifest";n[n.InvalidDefinition=3]="InvalidDefinition";n[n.Unexpected=4]="Unexpected";n[n.TooManyRefreshes=5]="TooManyRefreshes";n[n.CantLoadMetadata=6]="CantLoadMetadata"})(v||(v={}));t.create=ei;k=(function(){function n(n,t,i,u){var e=this;this.metadata=n;this._redirectMap=t;this._rpcClient=i;this._loaderOptions=u;this.lastError=f.observable();this.initializedExtension=f.observable();this._manifests={};this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._alwaysInitialize=!1;this._loaderError=function(n){var t="Error while loading extension "+e.metadata.name+": "+n.type,i={errorObject:n,telemetry:e._extensionLoader.telemetry},u;n.type!=="TooManyRefreshes"?(u=r.createError(t,{data:i}),p.error(u,7)):(e._onError(v.TooManyRefreshes,t),ot.trace({source:et,action:ft,actionModifier:"cancel",data:i,name:e.name}));b.Upload.flush()};this.name=n.name;this.isTestExtension=!!n.isTestExtension;this.isTestStamp=!!n.isTestStamp;this._extensionLoader=new wt.ExtensionLoader(u,n,this._loaderError)}return n.prototype.getVersion=function(){return this._extVersion},n.prototype._unloaded=function(){return!this._rpcChannel},n.prototype.getManifest=function(n){return this._manifests[n]},n.prototype.setManifest=function(n,t){var i=ct(this._redirectMap,this.name,t);return this._manifests[n]=i,i},n.prototype.getManifestAsync=function(){return this._manifestLoaded.promise},n.prototype.whenInitialized=function(){return this._initializedDeferred.promise},n.prototype.getOrLoadChannel=function(){var t=this,i,n,r,u;if(!this._rpcChannel){this._manifests.assetTypes&&(i=this._manifests.assetTypes.pageVersion,this._extVersion=i,this._extensionLoader.setPageVersion(i));n=this._extensionLoader;n.loadExtension();r=n.shellPort;u=this._rpcChannel=new dt.RpcChannel(r);n.initializeReceived.then((function(i){t._parseInitializationMessage(i);r!==n.shellPort&&u.swapPort(n.shellPort)}),this._loaderError);u.onDispose((function(){t._initializedDeferred=Q.defer();t.initializedExtension(void 0);yt(t.name);t._rpcChannel=null;n.unloadExtension()}))}return this._rpcChannel},n.prototype.getWindowId=function(){return y.getWindowId(this)},n.prototype.initiateManifestLoad=function(n){if(this._unloaded()){n||(n={});var t=n.manifest;t&&this._validateAndSetManifest(t,!0)||this.getOrLoadChannel()}},n.prototype.initiateExtensionLoad=function(n){MsPortalEarly.ExtensionLoader.registerExtensionLoadTrigger(this.name,n);this._rpcClient.acquireWindow(this.getWindowId(),24e4)},n.prototype.dispose=function(){this._rpcChannel&&(this._rpcChannel.dispose(),this._rpcChannel=null)},n.prototype._parseInitializationMessage=function(n){var t=!1;this._validateAndSetManifest(n.manifest,!1)&&!this._alwaysInitialize&&(t=this._rpcClient.gcWindow(this.getWindowId()),t&&i.disposeDisposable(this._rpcChannel),this._alwaysInitialize=!0);t||this._loadDefinition(n.definition,n.bootstrapTelemetry)},n.prototype._loadDefinition=function(n,t){var h=this.getManifest("assetTypes"),f=s.validateDefinition(n),u;if(f.valid()){var c=o.preprocessDefinition(n,h,this._loaderOptions.extensionRedirectMap),r=new tt(this,this._rpcClient,this._loaderOptions,c),e=this._extensionLoader.loadTime;r.loadTime=e;at(this.name,e,{shellSide:this._extensionLoader.telemetry,extSide:t});this.initializedExtension(r);this._initializedDeferred.resolve(r)}else return u="The extension definition has validation errors. Errors: {0}".format(JSON.stringify(f.errors)),this._onError(v.InvalidDefinition,u),Q.reject(new i.Errors.Error(u))},n.prototype._validateAndSetManifest=function(n,t){var i=lt(this.name,n,t,this._onError.bind(this),this.setManifest.bind(this));return i&&this._manifestLoaded.resolve(i),!!i},n.prototype._onError=function(n,t){var i=vt(this.name,n,t,this._extVersion,this._extensionLoader.telemetry);this._manifestLoaded.reject(i);this._initializedDeferred.reject(i);this.lastError(i);this.dispose()},n})();t.ExtensionImpl=k;w=ut.BladeNames.Hubs.ResourceMenuBlade;nt={};nt[bt]=[{partName:w+"$"+w,locator:h.resourceMenu.withLens(w).withPartInstance(w),getPartDefinition:function(n){return n.getBladeDefinition(w).then((function(n){return n.lenses[0].partInstances[0].inline}))}},];tt=(function(){function n(n,t,i,u){var f=this,e,o;this.extension=n;this._rpcClient=t;this._loaderOptions=i;this.definition=u;this._proxiedObjects=[];this._pools={};this._bladeDefMap={};this._partDefMap={};e=this._lifetime=new r.TriggerableLifetimeManager;e.registerForDispose(this.extension=n);o=this.name=n.name;(nt[o]||[]).forEach((function(n){f._pools[n.locator.toString()]=oi(e,5,(function(){return n.getPartDefinition(f).then((function(t){var i=t.details;return f.getPartViewModel(t.viewModelLocator||n.partName,129,{initialState:{},createSelectable:l.needContainerSelectable(i),partSize:t.initialSize,partLocation:2,collapsed:null})}))}))}))}return n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.processMessages=function(){return y.pingEndPoint.invoke(this._rpcClient,this.extension.getWindowId(),undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.isDisposed=function(){return this._lifetime.isDisposed()},n.prototype.getManifest=function(n){return this.extension.getManifest(n)},n.prototype.getBladeDefinition=function(n){var u=this,f=this.definition,t=n.toLowerCase(),e=f.bladeMap[t],i,h;return e?Q(e):(i=this._bladeDefMap,h=/^[A-Za-z0-9_$]*$/,!h.test(n))?Q.reject(r.createError("Blade name is invalid identifier")):i[t]||(i[t]=Q(y.getBladeDefinitionEndPoint.invoke(this._rpcClient,this.extension.getWindowId(),n)).then((function(n){return o.processBlade(f,u.getManifest("assetTypes"),n,u._loaderOptions&&u._loaderOptions.extensionRedirectMap)})).then((function(n){var t=[];if(s.validateBlade(f,n,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]})))},n.prototype.getPartDefinition=function(n){var r=this,u=this.definition,t=n.toLowerCase(),f=u.partTypeMap[t],i;return f?Q(f):(i=this._partDefMap,i[t]||(i[t]=Q(y.getPartDefinitionEndPoint.invoke(this._rpcClient,this.extension.getWindowId(),n)).then((function(n){return o.processPart(u,r.getManifest("assetTypes"),n,r._loaderOptions&&r._loaderOptions.extensionRedirectMap)})).then((function(n){var t=[];if(s.validatePartType(n,t),t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getViewModel=function(n,t,i){return this._getViewModel(t,n,i,y.getViewModelEndPoint)},n.prototype.getPartViewModel=function(n,t,r){var e,u,f;return r&&r.locator&&(e=this._pools[r.locator.toString()])&&!r.onInputsSetParameters&&!i.keysLength(r.initialState)&&(u=e.getItem(),u)?(f=r&&r.onViewModelAcquired,f&&f(u),Q(u)):this._getViewModel(t,n,r,y.getPartViewModelEndPoint)},n.prototype._getViewModel=function(n,t,i,r){var o=this,u,e;return(i=i||{},u=ht(n,t,i),e=a.resolve(this,u.locator.name,i.initialState),e)?e.then((function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&f.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q(n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.onInputsSetParameters.traceOptions))),n})):r.acquireObject(this._rpcClient,this.extension.getWindowId(),u,i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then((function(n){return o._proxiedObjects.push(n),n.getValue()}))},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,(function(t){return t.getValue()===n}));t!==-1&&this._proxiedObjects.splice(t,1)[0].dispose()},n.prototype.isPreview=function(){return this.getManifest("assetTypes").isPreview},n.prototype.onDispose=function(n){this._lifetime.registerForDispose(n)},n})();t.InitializedExtensionImpl=tt;t.getViewModelOptions=ht;it=(function(){function t(n,t){this.metadata=n;this._redirectMap=t;this.lastError=f.observable();this.initializedExtension=f.observable();this._manifests={};this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this.name=n.name;this.isTestExtension=!!n.isTestExtension;this.isTestStamp=!!n.isTestStamp}return t.prototype.getVersion=function(){return this._extVersion},t.prototype.getManifest=function(n){return this._manifests[n]},t.prototype.setManifest=function(n,t){var i=ct(this._redirectMap,this.name,t);return this._manifests[n]=i,i},t.prototype.getManifestAsync=function(){return this._manifestLoaded.promise},t.prototype.whenInitialized=function(){return this._initializedDeferred.promise},t.prototype.getWindowId=function(){return y.getWindowId(this)},t.prototype.initiateManifestLoad=function(t){var r=this,u;!this._manifestLoadInitiated&&Q.isPending(this._manifestLoaded.promise)&&(u=t&&t.manifest,u&&this._validateAndSetManifest(u,!0)||(this._manifestLoadInitiated=!0,i.require("../AzFramework/AzExtension",n).then((function(n){return n.loadMetadataAsManifest(r).then((function(n){r._validateAndSetManifest(n,!1)}))})).catch((function(n){r._onError(v.CantLoadMetadata,i.getLogFriendlyMessage(n))}))))},t.prototype.initiateExtensionLoad=function(){var t=this;!this._extensionLoadInitiated&&Q.isPending(this._initializedDeferred.promise)&&(this._extensionLoadInitiated=!0,i.require("../AzFramework/AzExtension",n).then((function(n){var i=new n.InitializedExtensionImpl(t);i.onDispose((function(){t._initializedDeferred=Q.defer();t.initializedExtension(void 0);yt(t.name);t._extensionLoadInitiated=!1}));at(t.name);t.initializedExtension(i);t._initializedDeferred.resolve(i)})))},t.prototype.dispose=function(){},t.prototype._validateAndSetManifest=function(n,t){var i=lt(this.name,n,t,this._onError.bind(this),this.setManifest.bind(this)),r;return i&&(this._manifestLoaded.resolve(i),t||(r=n.pageVersion,this._extVersion=r)),!!i},t.prototype._onError=function(n,t){var i=vt(this.name,n,t,this._extVersion,null);this._manifestLoaded.reject(i);this._initializedDeferred.reject(i);this.lastError(i);this.dispose()},t})();d=(function(){function n(){}return n.prototype.createExtension=function(n,t,i,r){return n.azExtension?new it(n,t):new k(n,t,i,r)},n})();d=__decorate([e.Class()],d);t.ExtensionFactory=d}));
define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","i","o","ko","$","FxInternal/Di","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function w(n){return u.keys(n||{}).filter((function(t){var i=n[t];return i&&!!i.manifest})).length}function y(n,t){var i={};return n&&(i["x-ms-effective-locale"]=n),Q(a.Net2.ajax({uri:b.getUri(n,t),performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",headers:i}))}function k(n){var t;return t=n==="assetTypes"?rt=rt||Q(b.promise).catch((function(n){return v.warning(n,6),null})).then((function(n){return w(n)?n:y(undefined)})):y(undefined,n),t.then((function(n){return n||{}})).catch((function(n){return v.error(n,7),{}}))}var b,rt,d,p;u.defineProperty(t,"__esModule",{value:!0});t.ExtensionManagerOptions=h.ExtensionManagerOptions;var ut=r.Extension,a=i.Base,g=a.Constants.ExtensionNames.Hubs,nt=a.Diagnostics,ft=nt.Telemetry,et=r.Rpc,ot=window,tt=ot.fx,st=tt.early,v=nt.createLog(n),ht=tt.environment,it=ft.trace,ct=i.startTimer;b=st.manifestCache;t.getManifestsAjax=y;t.getManifests=k;d=(function(){function n(n,t,u,o){var s=this,h;this._options=o;this.lastExtensionError=f.observable();this.initializedExtensions=[];this._callbacksMap={};this._callbacks=e.Callbacks();this._unloadCallbacks=e.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=Q.defer();this._ltm=new r.TriggerableLifetimeManager;this.getHubsExtension=function(){return s.getExtensionByName(g)};this.manifestLoadComplete=!1;this._manifestsMap={};this._initializedExtensionMap={};this._extensionsMap=r.mapValues(o.extensionsAsMap,(function(r){var f=n.createExtension(r,u,t,o);return f.lastError.subscribeAndRun(s._ltm,(function(n){n&&s.lastExtensionError(f)})),f.initializedExtension.subscribeAndRun(s._ltm,(function(n){if(n&&!n.isDisposed()){s.initializedExtensions.push(n);s._callbacks.fire(n);n.onDispose((function(){i.remove(s.initializedExtensions,n);s._unloadCallbacks.fire(n)}))}})),f}));t.start({originId:"fx",loadChannelFunction:function(n){var t=s._extensionsMap[n];if(!t)throw new Error("Failed to load extension '{0}'.".format(n));return t.getOrLoadChannel()},windowRedirectMap:o.extensionRedirectMap});h=this._extensionsMap[ut.getHubsWindowId()];h&&t.acquireWindow(h.getWindowId())}return n.prototype.getExtension=function(n){return this._extensionsMap[n]},n.prototype.getManifestByName=function(n){var i=this,t=this._manifestsMap;return t[n]||(t[n]=this._manifestLoadStarted.promise.then((function(){return i.getExtension(n).getManifestAsync()})).catch((function(i){return delete t[n],Q.reject(i)})))},n.prototype.getExtensionByName=function(n,t){var u=this,f=this._options.normalizeExtensionName(n),i,r;return t=t||{},i=this._initializedExtensionMap,r=JSON.stringify([].slice.call(arguments)),i[r]||(i[r]=this._manifestLoadStarted.promise.then((function(){return u._extensionsMap[f]})).then((function(f){var o=f.getWindowId(),e;return t.onlyIfLoaded||f.initiateExtensionLoad(t.trigger),e=f.whenInitialized(),t.timeout>0&&(e=Q(e).timeout(t.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),e.then((function(){var n=u._getLoadedExtensionByWindowId(o),t;return n&&(t=u._ltm.createChildLifetime(),n.extension.initializedExtension.subscribe(t,(function(n){n||(delete i[r],t.dispose())}))),n}))})).catch((function(n){return delete i[r],Q.reject(n)})))},n.prototype.initialize=function(n){var t=this,e=ct(),i,f;return n.useCachedManifests?(i=k("assetTypes"),this._callbacksMap.assetTypes||(this._callbacksMap.assetTypes={initialPromise:i,callbacks:new a.Callbacks})):i=Q({}),f=i.then((function(n){var i=w(n);return it({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:l.ActionModifier.Default,data:i,duration:e()}),Q.allSettled(u.keys(t._extensionsMap).map((function(u){var f=t._extensionsMap[u],o=n[f.name],e;return f.isTestExtension||f.isTestStamp?f.initiateManifestLoad():f.initiateManifestLoad(o),e=f.getManifestAsync(),e.then((function(n){t._callbacksMap.assetTypes&&t._callbacksMap.assetTypes.callbacks.fire(n)})),r.internalEnv.inManifestCache||f.name===g||f.name==="Microsoft_Intune_Edu"||!i||f.isTestExtension||f.isTestStamp?e:void 0})))})),this._manifestLoadStarted.resolve(),Q.any([f,Q.delay(6e4)]).then((function(){t._allManifestsLoaded.resolve();t.manifestLoadComplete=!0}))},n.prototype.unloadExtension=function(n){n.dispose()},n.prototype.on=function(n,t){var u=this,f,i,r;return this._callbacksMap[n]||(f=void 0,f=ht.relex.cachedManifestTypes[n]?k(n).then((function(t){it({source:"ExtensionManager",action:"CachedManifestTypeCount",actionModifier:n,data:w(t)});var i=u.getExtensions().map((function(i){var e=i.isTestExtension||i.isTestStamp?null:t[i.name],r=e&&e.manifest,f;if(r)i.setManifest(n,r),u._callbacksMap[n].callbacks.fire(r);else return i.initiateManifestLoad(),f=i.getManifestAsync(),f.then((function(t){u._callbacksMap[n].callbacks.fire(t)})),f.timeout(2e3)})).filter((function(n){return!!n}));return Q.allSettled(i)})):this._allManifestsLoaded.promise,this._callbacksMap[n]={initialPromise:f,callbacks:new a.Callbacks}),i=this._callbacksMap[n],t&&(r=function(n){try{t(n)||i.callbacks.remove(r)}catch(u){v.error(u,11)}},i.callbacks.add(r),this.getExtensions().forEach((function(t){var i=t.getManifest(n);i&&r(i)}))),i.initialPromise},n.prototype.onLoad=function(n){var i=this,r=this.initializedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){v.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t)}))},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){v.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=function(n){return y(n)},n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._getLoadedExtensionByWindowId=function(n){return this.initializedExtensions.first((function(t){return t.extension.getWindowId()===n}))},n.prototype.getExtensions=function(){var n=this;return u.keys(this._extensionsMap).map((function(t){return n._extensionsMap[t]}))},n})();t.ExtensionManagerImpl=d;p=(function(){function n(){}return n.create=function(n,t,i,r){return new d(n,t,i,r)},n})();__decorate([o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.ExtensionFactory,et.Client,c.RedirectMap,h.ExtensionManagerOptions]),__metadata("design:returntype",p)],p,"create",null);t.ExtensionManager=p}));
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-keyboardshortcuts{padding:0 25px;width:355px}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:98px}")}));
define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Telemetry","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(t){function tt(n){var t=n.getDisplayMode()===3&&n.getPanorama();return t&&t.getJourneyWidget()}function l(n){var t=tt(n),r=t&&t.getFocusedBlade();return r?r:t&&i.last(t.getBlades())}function it(n,t,i,r,u){return new a(n,t,i,r,u)}var h=i.Base.Diagnostics,v=h.Telemetry,y=window,c="#blade/HubsExtension/Resources",p=c+"/resourceType/",w="fxs-sidebar-collapse-button",b="fxs-topbar-home",o=u.KeyboardShortcuts,s=o.GoTo,k=h.createLog(n),d=v.trace,g=[49,50,51,52,53,54,55,56,57,48,],nt=[97,98,99,100,101,102,103,104,105,96,],a;t.setup=it;a=(function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this._goToShortcuts={};this._errorLoggingFunc=u||function(n){k.error(n)};this._addKeyShortcuts(n);this._addGoToShortcuts(t.router,n);this._registerShortcut(o.showDiagnostics,i,65,9);this._registerShortcut(o.showDebugHelper,r,68,9);this._registerShortcut(o.moveFavoritesUp,(function(){n.getSideBarWidget().reorderFavorites(38)}),38,5);this._registerShortcut(o.moveFavoritesDown,(function(){n.getSideBarWidget().reorderFavorites(40)}),40,5);this._attachEventHandlers()}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push($(y.document).setEvents([r.default.keydown,function(i){var r,o=f.getModifierKeys(i),s,u;if(i.keyCode===71&&o===0){n=!0;return}(s=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],u=s&&s[o],u)&&((r=$(document.activeElement),r.length>0&&o===0&&(r.is("input")||r.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((function(n){return r.closest("."+n).length>0}))))||(u.handler(),d({source:e.Source.KeyboardShortcuts,action:e.Action.KeyboardShortcutExecuted,name:u.id}),i.preventDefault()))}],[r.default.keyup,function(t){var i=f.getModifierKeys(t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=function(){i.disposeDisposable(this._disposables);this._disposables=[]},n.prototype._registerShortcut=function(n,t,i,r){r===void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(n){this._registerGotoShortcut(o.toggleFocusSideAndTopBar,(function(){var n=$(document).findByClassName(b)[0];$(document.activeElement)[0]===n?$(document).findByClassName(w)[0].focus():n.focus()}),190);this._registerGotoShortcut(o.moveFocusToCommandBar,(function(){var t=l(n),i=t&&t.getContentWidget();i&&i.setFocusOnCommandBar()}),188);this._registerShortcut(o.bladeSearch,(function(){var t=l(n);t&&t.focusSearchBox()}),191,8)},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._addGoToShortcuts=function(n,t){var r=this,i;this._registerGotoShortcut(o.browse,(function(){t.getSideBarWidget().toggleFlyout()}),66);this._registerGotoShortcut(o.new,(function(){t.getSideBarWidget().openCreate()}),78);this._registerGotoShortcut(o.search,(function(){t.getTopBarWidget().searchWidget.setFocus()}),191);[[s.allResources,c,65],[s.resourceGroups,p+"Microsoft.Resources%2Fsubscriptions%2FresourceGroups",82],].forEach((function(t){r._registerGotoShortcut(t[0],(function(){n.route(t[1])}),t[2])}));this._registerGotoShortcut(s.dashboard,(function(){n.navigateToDashboard(e.Source.KeyboardShortcuts)}),68);i=function(n,i){var u=i+1;r._registerGotoShortcut(s.sideBarItem+u,(function(){t.options.sideBarViewModel.openFavorite(i)}),n)};g.forEach(i);nt.forEach(i)},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+f.mapKeyCodeToString((t&4)==4,n)},n.prototype.getShortcuts=function(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}},n})()})(o||(o={})),o}));
define("MsPortalImpl/Interactions/Interactions.PortalReader",["require","exports","f","i","o","MsPortalImpl/Base/Base.Timers"],(function(n,t,i,r,u,f){"use strict";function h(n){if(s)throw new Error("Interactions.PortalReader cannot be initialized twice");else s=!0,$(n).append(o)}function c(){o.remove();s=!1}function l(n,t,r){var e,u,f;return r===void 0&&(r=""),n=(n||"").trim(),n?(e=v(r),u={active:!0,msg:n,msgElem:null},e.queue.push(u),e.act(),f=function(){u&&(u.active=!1,u.msgElem&&(u.msgElem.remove(),u.msgElem=null),u=null)},t===0?setTimeout(f,2e3):t===1&&setTimeout(f,5e3),f):i.noop}function v(n){var t=e[n];return t||(t={queue:[],act:f.debounce((function(){for(var f,s=t.queue,i=null,u=s.length-1;u>=0;--u)if(f=s[u],f.active){i=f;break}i&&o.append(i.msgElem=$(r.createElement("div")).text(i.msg));t.queue=null;t.act=null;e[n]=null}),a)},e[n]=t),t}var e;u.defineProperty(t,"__esModule",{value:!0});t.initialize=h;t.shutdown=c;t.read=l;var o=$(r.createElement("div",{"class":"fxs-hide-accessible-label","aria-live":"polite","aria-relevant":"additions"})),a=500,s=!1;e={}}));
define("MsPortalImpl/Interactions/Interactions.FocusHandler",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function a(n){var t=document.createEvent("CustomEvent");t.initCustomEvent(o.default.fxreadyforfocus,!1,!1,null);n.dispatchEvent(t)}function c(n,t){var u=e(n),r,f,o;if(!e.contains(u[0],document.activeElement)){if(r=u.findFirstTabbable((function(n){return n.isInScrollView(t)})),!r.length&&u.hasClass("fxs-blade-content")){var s=u.closest(".fxs-blade"),c=s.hasClass("fxs-menublade"),h=c?[]:[s.find(".fxs-blade-header [tabindex]")];h.push(u.closest("[tabindex]"));f=i.find(h,(function(n){return!!n.attr("tabindex")}));f&&(r=f)}if(r.length)return r.hasClass("fxs-part")&&(o=r.findFirstTabbable(),o.length===1&&(r=o)),r.focus()}}var t,h=i.isFeatureEnabled("skipautofocus"),l;n.setFocusOnContainer=s.throttleByAnimationFrame((function(n,t){return c(n,t)}));l=(function(){function n(){var n=this;if(this._containerTargets=[],this._mapToContainer=new i.Map,this._mapTofocusableTargets=i.memoize((function(){return[]})),this._mapSkipAutoFocus=new i.Map,this._debounceFocus=s.debounce((function(n){s.requestAnimationFrame((function(){if(n&&n.parentElement){var i=f.dataFor(n),t=i&&i.func;t&&t.setFocus?t.setFocus():c(n,"fxs-blade-content")}}))}),250),this._debounceMenuBladeCleanup=s.debounce((function(){n._containerTargets.length===0&&(n._menuBladeToSetFocus=undefined)}),1e3),this.journey=f.observable(!0),t)throw new Error("FocusHandler operates as a singleton.");this._ltm=new r.TriggerableLifetimeManager;t=this;this._ltm.registerForDispose([this._debounceMenuBladeCleanup,this._debounceFocus,e.querySelectorAll("body").setEvents(["focusin",this._cancelAutofocus=function(t){h||n._mapTofocusableTargets.map().forEach((function(i,r){var u=!!t||r!==n._menuBladeToSetFocus;n._mapSkipAutoFocus.set(r,u)}))},]),])}return n.prototype.dispose=function(){this._ltm.dispose();t=null},u.defineProperty(n,"Instance",{get:function(){return t||(t=new n)},enumerable:!0,configurable:!0}),n.prototype.waitForJourney=function(){var t=this,n;return this.journey()?Q():(this._journeyPromise||(n=this._ltm.createChildLifetime(),this._journeyPromise=this.journey.fxAwait(n).finally((function(){n.dispose();t._journeyPromise=null}))),this._journeyPromise)},n.prototype.registerContainerForFocus=function(n){if(n){if(!this._menuBladeToSetFocus){var r=e(n),t=r.closest(".fxs-blade"),u=t.length&&t.hasClass("fxs-menublade"),f=u&&r.closest(".fxs-blade-content-container-details",t[0]).length>0;u&&!f&&(this._menuBladeToSetFocus=n)}this._cancelAutofocus();i.pushUnique(this._containerTargets,[n])}},n.prototype.registerTargetForFocus=function(n){var t,r;n&&(t=e(n).closest(".fxs-blade-content")[0],t&&this._containerTargets.indexOf(t)>=0&&(this._mapToContainer.set(n,t),r=this._mapTofocusableTargets(t),i.pushUnique(r,[n])))},n.prototype.notifyTargetReadyForFocus=function(n){var r=this,o;try{var t=this._mapToContainer.get(n),u=this._mapTofocusableTargets(t),f=u.indexOf(n);f>-1&&(u.splice(f,1),this._mapToContainer.delete(n),u.length===0&&(i.remove(this._containerTargets,t),o=t,this.waitForJourney().finally((function(){var i,n;h||r._mapSkipAutoFocus.get(t)||(i=t,r._menuBladeToSetFocus&&r._menuBladeToSetFocus!==t&&(n=e(r._menuBladeToSetFocus).closest(".fxs-blade-content-container"),n[0]&&e.contains(n[0],t)&&(i=n.children(".fxs-blade-content-container-default").children(".fxs-blade-content-wrapper")[0])),r._debounceFocus(i));r._mapSkipAutoFocus.delete(t);r._mapTofocusableTargets.delete(t);a(o)})),this._menuBladeToSetFocus&&this._containerTargets.length===0&&this._debounceMenuBladeCleanup()))}catch(s){}},n})();n.FocusHandler=l})(h||(h={})),h}));
define("MsPortalImpl/Svg/Startup/DashboardPartFilter.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M2 2v1.547l4 3.787V12h3V7.334l4-3.787V2zm1 1.253V3h9v.253L8 7v4H7V7z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path fill='#8a8886' d='M26 0H0v26L26 0z'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2z' fill='#8a2da5'/><path d='M7 8L3 4.035V2H2v2.421l4 3.965V12h1V8z' class='msportalfx-svg-c01'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2zm1 1.253V3h9v.253L10 7v4H9V7z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Resources/Resources.Images",["require","exports","f","o"],(function(n,t,i,r){"use strict";function e(n){return function(){return i.getImages(u,n)}}var u,f;r.defineProperty(t,"__esModule",{value:!0});u=[{MsPortalImpl:[{AdvisorNotifications:[{AdvisorDashboard:["cscz.png","dede.png","enus.png","eses.png","frfr.png","huhu.png","itit.png","jajp.png","kokr.png","nlnl.png","plpl.png","ptbr.png","ptpt.png","ruru.png","svse.png","trtr.png","zhcn.png","zhtw.png"]}]},{AvatarMenu:[{AvatarMenu:["defaultAvatarSmall.png"]}]},{Blade:[{Blade:["icon.gif"]}]},{ControlsWizard:[{ControlsWizard:["loadingImage.gif"]}]},{General:[{FlowLayout:["gridShadow.png"]}]},{Notice:[{Notice:["comingSoon.png","noSubscription.png","unauthorized.png"]}]},{PartError:[{PartError:["icon.png"]}]},{PartGallery:[{PartGallery:["collectionPartWithRollup.svg","collectionSummary.svg","donutChart.svg","donutChartPartial.svg","extensions.svg","gridWithMoreData.svg","map.svg","multiLineChartMultiTrendLine.svg","multiScatterChart.svg","multiStackedBarChart.svg","mutliLineChart.svg","pricingTier.svg","quotaGauge.svg","resourceMap.svg","singleAreaChart.svg","singleAreaChartSingleThreshold.svg","singleAreaChartSingleTrendline.svg","singleBarChartLarge.svg","singleBarChartSmall.svg","singleLineChart.svg","singleScatterChart.svg","singleScatterSingleThreshold.svg","singleValueGauge.svg","splitBarChart.svg","stackedAreaChart.svg"]}]},{ProvisioningPart:[{ProvisioningPart:["running.gif"]}]}]}];f=["AdvisorDashboard","AvatarMenu","Blade","ControlsWizard","FlowLayout","Notice","PartError","PartGallery","ProvisioningPart"];f.forEach((function(n){t["get"+n]=e(n)}))}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-portal .fxs-tile .fxs-part-error-devmode{background-color:#b00000!important;color:#fff}.fxs-part-error{background-color:#f4f5f6}.fxs-part .fxs-part-content.fxs-errorpart-clickable{cursor:pointer}.fxs-part-error-content{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;height:100%;box-sizing:border-box}.fxs-part-error-content .fxs-part-error-title{font-size:14px;line-height:normal;margin:0}.fxs-part-error-content .fxs-part-error-reason{font-size:12px;line-height:normal}.fxs-part .fxs-part-content.fxs-errorpart~.fxs-part-nodatamessage{display:none!important}.fxs-part-error-icon{-webkit-flex:0 0 auto;flex:0 0 auto;margin:auto;display:block;height:50px;width:50px}.fxs-part-error-subtitle{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase}.fxs-tilesize-fullwidthfitheight .fxs-part .fxs-part-content.fxs-errorpart,.fxs-tilesize-herowidefitheight .fxs-part .fxs-part-content.fxs-errorpart{position:relative}.fxs-tilesize-fullwidthfitheight .fxs-part-error-content,.fxs-tilesize-herowidefitheight .fxs-part-error-content{position:static}.fxs-tilesize-mini .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error-icon{display:none}.fxs-tilesize-mini .fxs-part-error-text{order:1}.fxs-tilesize-mini .fxs-part-error-reason,.fxs-tilesize-mini .fxs-part-error-text{text-align:center}.fxs-tilesize-small .fxs-part-error-reason{margin-top:auto}html[lang^=ja] .fxs-part-error-subtitle,html[lang^=ko] .fxs-part-error-subtitle,html[lang^=zh] .fxs-part-error-subtitle{font-size:11px}')}));
define("_generated/Templates/PartError",["require","exports"],(function(){"use strict";return function(){return"<div class='fxs-part-error-content'> <div class='fxs-part-error-text'> <h3 class='fxs-part-error-title' data-bind='visible: data.title, text: data.title'><\/h3> <div class='fxs-part-error-subtitle fxs-portal-title' data-bind='visible: data.subtitle, text: data.subtitle'><\/div> <\/div> <img class='fxs-part-error-icon' data-bind='attr: { src: data.uri.icon, title: data.title, alt: data.title}'/> <div class='fxs-part-error-reason' data-bind=\"text: data.reason\"><\/div> <\/div> "}}));
define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/PartError","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/Resources.Images","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var a;r.defineProperty(t,"__esModule",{value:!0});var l="fxs-errorpart",v="fxs-errorpart-clickable",c=f.PartError,y=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.uri=h.getPartError(),t.title=u.observable(i.isDevelopmentMode?c.titleDevMode:c.title),t.subtitle=u.observable(c.subtitle),t.reason=u.observable(""),t.clickable=!0,t}return __extends(t,n),t})(e.ViewModel);t.ViewModel=y;a=(function(n){function t(t,r){var u=n.call(this,t,r)||this,f,e;if(t.html(o()).addClass(l),r.clickable){f=function(){t.trigger(s.default.fxerrorpartclicked)};t.addClass(v).on(s.default.click,f);u.ltm.registerForDispose((function(){t.off(s.default.click,f)}))}return u._bindDescendants(),e=i.getUniqueId(),t.findByClassName("fxs-part-error-title").attr("aria-describedby",e),t.findByClassName("fxs-part-error-subtitle").attr("id",e),u}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(l);n.prototype.dispose.call(this)},t})(e.Widget);t.Widget=a}));
define("_generated/Less/MsPortalImpl/CustomForm.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{font-size:12px;line-height:normal}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer{display:inline-block;vertical-align:middle;width:68%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:68%;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement{min-height:43px;width:48.75%!important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.msportalfx-customHtml>.azc-formElementSubLabelContainer,.msportalfx-customHtml>.azc-formElementSubLabelContainer>.azc-formElementContainer,.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% 0 -49.75%!important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.fxs-bladestyle-create .msportalfx-form .msportalfx-form{margin-top:0}.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .msportalfx-form-labelcontainer{box-sizing:border-box;min-height:20px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{max-width:calc(100% - 25px)}.msportalfx-form:not(.msportalfx-selectable) .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form:not(.msportalfx-selectable) .azc-form-labelcontainer label,.msportalfx-form:not(.msportalfx-selectable) .msportalfx-form-labelcontainer label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form.msportalfx-form-row{padding:0 25px;width:calc(100% - 50px)}.azc-text-sublabel{float:right;margin-bottom:-1px}.fxc-has-sublabel-html .azc-text-sublabel{float:none}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(19px)}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}.msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-customHtml .msportalfx-form-extralabel{margin-top:0}.msportalfx-form-formelement .azc-dockedballoon.azc-dockedballoon-info{height:16px;width:16px}.fxc-resource-dropdown .msportalfx-nested-control:not(.fxc-left-label)::before,.msportalfx-nested-control:not(.fxc-left-label)::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;left:3px;width:32px}.msportalfx-nested-control:not(.fxc-left-label){padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-nested-control:not(.fxc-left-label)::before{position:absolute;top:-9px;height:calc(50% + 7px)}.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer{padding-left:45px;position:relative;box-sizing:border-box}.msportalfx-form-regular .fxc-resource-dropdown div.msportalfx-nested-control::before,.msportalfx-form-regular .msportalfx-nested-control::before,.msportalfx-nested-control.fxc-left-label>.azc-form-labelcontainer::before{display:block;content:"";border-left:1px solid #a9a9a9;border-bottom:1px solid #a9a9a9;position:absolute;top:-13px;left:3px;height:22px;width:32px}.fxc-resource-dropdown .msportalfx-nested-control:not(.fxc-left-label)::before{position:absolute;top:-9px;height:40px}.fxc-left-label-fixed.fxc-smart-labels .msportalfx-nested-control .azc-form-labelcontainer{max-width:205px!important}')}));
define("_generated/Less/MsPortalImpl/CustomPart.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-docking,.msportalfx-fill{width:100%;height:100%}.azc-graph-node-container .msportalfx-overflowY,.fxs-tilesize-fittocontainer .msportalfx-overflowY,.msportalfx-docking-body{overflow-x:hidden;overflow-y:auto}.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:12px;line-height:18px;line-height:normal}.msportalfx-clearfix::after,.msportalfx-layoutChildren-horizontal-float::after{content:"\\0000a0";clear:both;visibility:hidden;font-size:0;line-height:0}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{display:block;height:0}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#ff8c00}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-padding{padding:25px;box-sizing:border-box}.msportalfx-docking{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.msportalfx-docking-header{-webkit-flex:0 0 auto;flex:0 0 auto}.msportalfx-docking-body{-webkit-flex:1 1 auto;flex:1 1 auto;height:100%;min-height:0}.msportalfx-docking-footer{-webkit-flex:0 0 auto;flex:0 0 auto;border-top:1px solid}.msportalfx-vertical-center{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-align-items:center;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-clearfix::after{display:block;height:0}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider:after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-regular{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_normal,"Segoe WP",Tahoma,Arial,sans-serif;font-weight:400}.msportalfx-font-bold{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}.msportalfx-font-semibold{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-font-light,.msportalfx-font-semilight{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200}.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace;font-size:12px}.msportalfx-text-header{font-size:14px;line-height:18px}a.msportalfx-text-header{cursor:pointer}.msportalfx-text-header-small,.msportalfx-text-label{font-size:12px;line-height:normal;text-transform:uppercase}.msportalfx-text-small{font-size:12px;line-height:normal}.msportalfx-text-subheader{font-size:10px;line-height:10px}html[lang^=ja] .msportalfx-text-subheader,html[lang^=ko] .msportalfx-text-subheader,html[lang^=zh] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:18px}.msportalfx-text-regular{font-size:12px;line-height:18px}.msportalfx-text-preview{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:11px;line-height:11px;text-transform:uppercase;color:#fff}.msportalfx-text-createsectionheader{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200;font-size:20px;line-height:normal}.msportalfx-number-jumbo,.msportalfx-number-large,.msportalfx-number-medium,.msportalfx-number-small{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-number-jumbo{font-weight:600;font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-weight:600;font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-weight:600;font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-weight:600;font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn,.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn,.msportalfx-number-small-adorn{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}.msportalfx-number-jumbo-adorn{font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn{font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-code{font-family:Consolas,"Courier New",monospace;font-size:12px;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-lineheight-reset{line-height:normal}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-refresh-icon img,.msportalfx-refresh-icon svg{height:12px;width:12px;vertical-align:baseline}.msportalfx-tile-status-icon img,.msportalfx-tile-status-icon svg{height:16px;width:16px;vertical-align:middle}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px!important;height:21px!important}.msportalfx-gridcolumn-assetsvg-badge,.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.msportalfx-iconcontainer>img,.msportalfx-iconcontainer>svg{height:50px;width:50px}.fxs-tilesize-mini .msportalfx-iconcontainer>img,.fxs-tilesize-mini .msportalfx-iconcontainer>svg,.fxs-tilesize-small .msportalfx-iconcontainer>img,.fxs-tilesize-small .msportalfx-iconcontainer>svg{height:30px;width:30px}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td,.msportalfx-grid-borderless .azc-grid table tbody tr.azc-grid-row:first-of-type td,.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted{border-top-width:0;border-bottom-width:0;border-color:transparent!important}.msportalfx-create-tab{max-width:700px}.msportalfx-create-tab .msportalfx-create-description{font-size:13px;line-height:normal}.msportalfx-create-tab .fxc-section{margin-bottom:15px}.msportalfx-create-section-label{text-transform:uppercase;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:11px;line-height:normal}.msportalfx-create-footer .fxc-simplebutton{margin-right:12px}.msportalfx-create-footer a{margin-left:12px}.msportalfx-ext-link::after{content:" ";background-image:url(data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2016%22%3E%3Cpath%20d=%22M4.992%209.819l8.018-7.991v4.005H14V0H8.167v1h4.038L4.232%208.987l.76.833z%22/%3E%3Cpath%20d=%22M12.993%2013.03H1.01V1.028h4.823V0H0v14h14V8.167h-1.007v4.863z%22/%3E%3C/svg%3E);width:11px;height:11px;display:inline-block;margin-left:4px;background-size:11px 11px}.fxs-mode-dark .msportalfx-ext-link::after{background-image:url(data:image/svg+xml;utf8,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2016%2016%22%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M4.992%209.819l8.018-7.991v4.005H14V0H8.167v1h4.038L4.232%208.987l.76.833z%22/%3E%3Cpath%20fill=%22%23ffffff%22%20d=%22M12.993%2013.03H1.01V1.028h4.823V0H0v14h14V8.167h-1.007v4.863z%22/%3E%3C/svg%3E)}.msportalfx-customtopo-text-name-donotuse{font-size:12px;line-height:normal}.msportalfx-customtopo-text-description-donotuse{font-size:10px;line-height:normal;color:#8f9ca8}.msportalfx-inherit-color{color:inherit!important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span{font-size:12px;line-height:18px}.msportalfx-statuspart .msportalfx-statuspart-metricsection,.msportalfx-statuspart .msportalfx-statuspart-propertysection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px;font-size:12px;line-height:18px}.msportalfx-statuspart .msportalfx-statuspart-propertysection>div,.msportalfx-statuspart .msportalfx-statuspart-propertysection>span{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100% / 3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:none}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-size:12px;line-height:normal;text-transform:uppercase}.msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}.msportalfx-property{padding:5px 0;white-space:nowrap;line-height:0;font-size:0}.msportalfx-property>*{display:inline-block;vertical-align:middle;box-sizing:border-box;white-space:normal;font-size:medium;line-height:normal}.msportalfx-property .msportalfx-property-label-wrapper{font-size:12px;line-height:normal;width:32%;margin-top:5px}.msportalfx-property .msportalfx-property-label-wrapper .msportalfx-property-name{text-transform:uppercase;max-width:100%;width:auto;white-space:wrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.msportalfx-property .msportalfx-property-name{font-size:12px;line-height:normal;text-transform:uppercase;width:32%;white-space:wrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-property .msportalfx-property-value{font-size:14px;line-height:normal;width:64%;margin-left:3%;margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon,.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-tooltip-overflow{display:inline-block;vertical-align:middle}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon+.msportalfx-tooltip-overflow{max-width:calc(100% - 27px)}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield{margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield input{padding-left:9px}.msportalfx-property.msportalfx-property-compact>*{vertical-align:top}.msportalfx-property.msportalfx-property-compact .msportalfx-property-name{margin-top:4px;width:95px}.msportalfx-property.msportalfx-property-compact .msportalfx-property-value{font-size:12px;line-height:18px;max-width:calc(100% - 3% - 95px)}.msportalfx-property-callback-icon,.msportalfx-property-text-icon{width:27px}.msportalfx-property-callback-icon svg,.msportalfx-property-text-icon svg{height:25px;width:25px}.msportalfx-property-callback-icon{float:left}')}));
define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-part,.fxs-part-content{background-color:inherit;width:100%}.fxs-part{height:100%;position:relative;box-sizing:border-box;overflow:hidden;padding:15px}.fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part-content,.fxs-part-title{position:relative;box-sizing:border-box}.fxs-part-title{height:49px;top:-4px}.fxs-part-assetname,.fxs-part-titleText{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-titleText{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part-assetname{font-size:10px;line-height:10px;margin-top:3px}.fxs-part-content{font-size:12px;line-height:18px;line-height:normal;height:100%}.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part-clickable:focus,.fxs-part[tabindex="0"]:focus{outline-offset:0;outline-width:2px;outline-style:dotted}.fxs-part-clickable:hover,.fxs-part[tabindex="0"]:hover{cursor:pointer}.fxs-part-unbound{z-index:1}.fxs-part.fxs-part-no-fx-content-padding{padding:0}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-part-title-visible .fxs-part-content>.msportalfx-padding:first-child{padding:0 15px 15px}.fxs-part.fxs-part-no-fx-content-padding .fxs-part-content>.msportalfx-padding{padding:15px}.fxs-part.fxs-part-no-fx-content-padding.fxs-part-for-template-blade .fxs-part-content>.msportalfx-padding{padding:10px 25px 25px}.fxs-part.fxs-part-nodata,.fxs-part.fxs-part-notfound{-webkit-filter:grayscale(100%);filter:grayscale(100%);min-height:85px}.fxs-part .fxs-part-noaccessmessage,.fxs-part .fxs-part-nodatamessage,.fxs-part .fxs-part-notfoundmessage{position:absolute;left:0;top:0;height:100%!important;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-part .fxs-part-nodatamessage>.fxs-part-nodatamessage-text,.fxs-part .fxs-part-notfoundmessage>.fxs-part-notfoundmessage-text{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-size:12px;line-height:18px;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part,.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage{padding-left:3px;padding-right:3px}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:none;position:absolute;bottom:0;margin-bottom:13px;font-size:12px;line-height:18px;text-align:left}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text{display:none}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:block;bottom:0}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-text{display:none}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{display:block}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall,.fxs-tile.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{margin-bottom:7px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{top:0;bottom:auto;width:calc(94%);text-align:center}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none!important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100%!important;top:0!important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title h5{display:none}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}html[lang^=ja] .fxs-part .fxs-part-title,html[lang^=ko] .fxs-part .fxs-part-title,html[lang^=zh] .fxs-part .fxs-part-title{top:-5px}html[lang^=ja] .fxs-part .fxs-part-titleText,html[lang^=ko] .fxs-part .fxs-part-titleText,html[lang^=zh] .fxs-part .fxs-part-titleText{font-size:11px;line-height:11px}.fxs-part-filter-button{border:0;padding:0;width:26px;height:26px;cursor:pointer;z-index:1}.fxs-part-filter-button,.fxs-part-filter-button>svg{position:absolute;top:0;left:0}')}));
define("_generated/Templates/Part",["require","exports"],(function(){"use strict";return function(){return'<!-- ko if: context.isFilterApplied --> <div role="button" class="fxs-part-filter-button" data-bind="image: context.filterIcon, click: context.openPartSettingsBlade"><\/div> <!-- /ko --> <div class="fxs-part-title"> <h3 data-bind="text: container.partTitle" class="fxs-part-titleText msportalfx-tooltip-overflow"><\/h3> <div data-bind="visible: container.assetName() && !context.inContainerOfSameAsset(), text: container.assetName" class="fxs-part-assetname fxs-portal-subtext msportalfx-tooltip-overflow"><\/div> <\/div> <div class="fxs-part-content fxs-validationContainer"><\/div> <!-- ko if: context.isUiBlocked --> <div class="fxs-part-blockui-shield"><\/div> <!-- ko if: !context.notFoundMessage() --> <div class="fxs-part-nodatamessage" data-bind="visible: container.noDataMessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: container.noDataMessage" class="fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <div class="fxs-part fxs-part-noaccessmessage" data-bind="visible: container.unauthorizedMessage, css: { \'fxs-part-noaccessmessage-withtitle\': container.partTitle }"> <!--The extra nested div is to enable vertical centering--> <div class="fxs-part-title" data-bind="visible: container.partTitle"> <h3 data-bind="text: container.partTitle" class="fxs-part-titleText msportalfx-tooltip-overflow"><\/h3> <div data-bind="visible: container.assetName() && !context.inContainerOfSameAsset(), text: container.assetName" class="fxs-part-assetname fxs-portal-subtext msportalfx-tooltip-overflow"><\/div> <\/div> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-textsmall msportalfx-tooltip-overflow"><\/div> <\/div> <!-- /ko --> <!-- ko if: context.notFoundMessage --> <div class="fxs-part-notfoundmessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: context.notFoundMessage" class="fxs-part-notfoundmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <!-- /ko --> <!-- /ko -->'}}));
define("MsPortalImpl/Parts/Parts",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.PartError","_generated/Templates/Part","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/UI/UI.DesktopManager","FxInternal/Composition/ViewModel","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/DashboardPartFilter.svg","MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CustomPart.css","_generated/Less/MsPortalImpl/CustomForm.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){"use strict";function kt(n){n.findByClassName("fxs-bg-error").eq(0).closest("[data-validatable='true']").findByClassName("azc-input").focus()}function vi(n,t){if(at[n])throw new Error("The part kind '"+n+"' has already been registered and cannot be registered again.");at[n]=t}function gt(n){return at[n]}function ni(n){var t=n&&n.initialSize;return lt.InternalPartSize[t]!==undefined?t:2}function yi(n,t,i){t.addClass(ht(i.extensionWindowId)).addClass((i.styleSheets||[]).map((function(n){return ht(n.file)})).join(" "));ti(n,i)}function ti(n,t){var h=t.styleSheets||[],i=t.extensionWindowId,f="",c=h.filter((function(n){return n.content&&!(ct[i]||{})[n.file]})).map((function(n){var e=ct[i]||(ct[i]={}),r,t,u;return e[n.file]=!0,r="."+ht(i),n.file&&(r+="."+ht(n.file)),t=[],u=o.sanitizeStyleSheetText(n.content,r,t),t.length&&t.forEach((function(t){f+="\n"+n.file+" - "+t.errorMessage+"\nCSS rule: "+t.rule.cssText})),{file:n.file,css:u}})),u,e,s;for(f&&Q.fcall((function(){r.Rpc.client.log(i||"fx",{level:i?2:1,code:1,area:"Parts",message:"Sanitization error found in following extension("+i+") styleSheets:"+f})})),u=0,e=c;u<e.length;u++)s=e[u],ot.fx.injectCss({id:t.extensionWindowId+"_"+s.file},s.css)}function pi(n,t,i,r,u){return new n.Part(t,i,r,u)}function wi(n,t,i){var u=t.partKind,r,f;if(u===et.Custom){var o=t.htmlTemplateInline,s=t.htmlTemplate,e=o||i[s];r=ii(e&&e.content,{supportedSizes:t.supportedSizes})}else r=u===et.Frame?yt("MsPortalImpl/Parts/Parts.Frame",pi,{supportedSizes:t.supportedSizes}):u===et._Internal_Az?yt("MsPortalImpl/AzFramework/Parts.Az",(function(n,i,r,u,f){var e=t,o=e.isBlade,s=e.bladeOrPartName;return new n.Part(i,r,u,f,o,s)}),{supportedSizes:t.supportedSizes}):gt(et[u]);return f=r.supportedSizes,f&&f.length||(r.supportedSizes=[ni(t)]),r}function yt(n,t,r){return{createPart:function(r,u,f,e){return i.tryImmediateResolve(i.require(n),(function(n){return t(n,r,u,f,e)}))},defaultSize:r.defaultSize,supportedSizes:r.supportedSizes,viewStateProperties:r.viewStateProperties,moduleId:n}}function ii(n,t){return t===void 0&&(t={}),{createPart:function(i,r,u,f){var o=t.partClass||dt,e=new o(i,r,u,f);return e.template=n,Q(e)},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,viewStateProperties:t.viewStateProperties}}var vt,ct,ut;u.defineProperty(t,"__esModule",{value:!0});var ri=r.TriggerableLifetimeManager,pt=i.Base,wt=pt.Diagnostics,ui=pt.Images,fi=wt.Telemetry,lt=i.Parts,ei=i.ViewModels,et=lt.PartKind,ft=lt.PartState,ot=window,st=h.Dashboard.PartFilters,oi=wt.createLog(n),si=h.Parts.partSettingNotReceivedErrorDescription,e=jQuery,at={},hi="attr: { 'role': context._computedRole },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }",ci="fxs-part-no-fx-content-padding",li="fxs-part-for-template-blade",ht=o.getScopeName,bt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(ei.ClickableLink);t.InternalClickableLink=bt;vt=(function(){function n(){this._onStartboard=f.observable();this.inContainerOfSameAsset=f.observable(!0);this.partSettingFailed=f.observable(!1);this.notFoundMessage=f.observable();this.lockedUiContext=f.observable(!0)}return n.prototype.getSelectable=function(){return this._selectable},n.prototype.configure=function(n){this._onStartboard(n.onStartboard);this._selectable=n.selectable||this._selectable},n})();t.PartBase=vt;t.runFocusOnFirstInvalid=kt;var ai=(ut={},ut[1]="fxs-part-success",ut[2]="fxs-part-warning",ut[3]="fxs-part-error",ut[4]="fxs-part-dirty",ut[5]="fxs-part-info",ut),dt=(function(t){function u(n,u,o,c){var l=t.call(this)||this,b,g,p,ct,ot,ht,ut,lt,nt,at;l.isFilterApplied=f.observable(!1);l.filterIcon=f.observable();l.partFilterState=f.observable(0);l.openPartSettingsBlade=function(){return e.noop};l.ariaLabel=f.observable();var w=l._lifetime=new ri,y=u.container,et=r.tryGetSelectableViewModelContract(y);if(!y)throw new Error("Cannot create a part without a container viewmodel.");return l._selectable=et&&et._msPortalFxSelectable2?v.getOrCreate(et._msPortalFxSelectable2):undefined,b=l._selectable=l._selectable||y.selectable,b||(g=u.content,g&&typeof g().onClick=="function"&&(b=l._selectable=d.getSelectableWithClickHandler(g(),e(n),g().onClick))),l._viewModel=u,p=l._partContainer=e(n).attr("data-bind",hi).html(k()),l._accessibility(),o.noFxContentPadding&&p.addClass(ci),o.isVirtualPartForTemplateBlade&&p.addClass(li),l._partContent=p.findByClassName("fxs-part-content")[0],ct=p.findByClassName("fxs-part-title"),ot=l.validateElements=f.observableArray([]),ot.extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),l._options=o,l._services=c,ht=function(n){return!!l.notFoundMessage()||!!n.noDataMessage()||!!n.unauthorizedMessage()},l.isUiBlocked=f.pureComputed((function(){return l._viewModel.internal.allowUiBlocking()&&(y.operations.blockingUi()||ht(y))})),ut=f.pureComputed((function(){return l._viewModel.internal.allowUiBlocking()&&ht(y)})),l._isPartClickable=f.computed(w,(function(){return y.operations.blockingUi()||y.partState&&y.partState()===ft.Failed||l.notFoundMessage()||y.unauthorizedMessage()!==null&&y.unauthorizedMessage()!==undefined?!1:!!y.clickableLink||y.isSelectable()&&!!b})),f.computed(w,(function(){y.partTitle();setTimeout((function(){p.trigger(tt.default.fxsizechanged)}),50)})),f.computed(w,(function(){l.lockedUiContext()?p.removeAttr("aria-label"):p.attr("aria-label",y.ariaLabel()||l.ariaLabel()||y.partTitle())})),lt=f.computed(w,(function(){var n=y.partTitle()&&y.partState()!==ft.Failed;return a.toggle(ct,n),n})),l._computedClasses=f.computed(w,(function(){var n=[],t;return lt()&&n.push("fxs-part-part-title-visible"),l._isPartClickable()&&n.push("fxs-part-clickable"),l.notFoundMessage()?n.push("fxs-part-notfound"):y.noDataMessage()&&n.push("fxs-part-nodata"),b&&y.isSelectable()&&(b.isSelected()&&n.push("fxs-part-selected"),b.isCommandSelected&&b.isCommandSelected()&&n.push("fxs-part-selected-command")),l._viewModel.content()._msPortalFxUnboundPart&&n.push("fxs-part-unbound"),t=ai[y.contentState()],t&&n.push(t),n.join(" ")})),l._computedRole=f.computed(w,(function(){var n=[],t,u;return(p.find(".fxs-part-clickdesc, .fxs-part-tabback").remove(),l.lockedUiContext())?(p.removeAttr("aria-describedby"),null):(t=i.getUniqueId(),p.append(r.createElement("div",{"class":"fxs-part-tabback",id:t,style:"display:none;"},i.encodeHtml(h.Parts.tabbackcmds))),n.push(t),l._isPartClickable()&&(u=i.getUniqueId(),p.append(r.createElement("div",{"class":"fxs-part-clickdesc",id:u,style:"display:none;"},i.encodeHtml(h.Parts.clickableAriaDesc))),n.push(u)),p.attr("aria-describedby",n.join(" ")),"group")})),f.dataFor(p[0])&&f.cleanNode(p[0]),f.applyBindings({container:y,context:l},p[0]),ut.subscribeAndRun(w,(function(n){if(n){if(!nt){nt=w.createChildLifetime();var t=l._partContainer;nt.registerForDispose([t.setEvents([tt.default.focus,l._onFocus=function(){l._toggleDisableTabbableElements(ut())}],[tt.default.focusin,l._onFocusIn=function(){ut()&&t[0].focus()}]),function(){l._onFocus=l._onFocusIn=null},])}p.find(document.activeElement).length>0&&p[0].focus()}else nt&&nt.dispose(),l._toggleDisableTabbableElements(n)})),f.reactor(w,(function(){!l.lockedUiContext()&&(l._isPartClickable()||l._onStartboard())?p.attr("tabindex",0):p.removeAttr("tabindex")})),at=r.shellInterface(y),at.triggerValidation((function(n,t){return s.ensureFormFieldValidation(p,!0,t).then((function(t){return n&&kt(l._partContainer),t}))})),f.computed(w,(function(){var u=ot(),i=s.gatherFormFieldsFromElements(u),n=y.form.validationState,t=i.map((function(n){var t=n.field;return t.validatableViewModel&&t.validatableViewModel.validators().length?t.validatableViewModel.validationState():2})),r;~t.indexOf(1)?n(1):~t.indexOf(0)?n(0):~t.indexOf(3)?n(3):n(2);r=i.some((function(n){return f.unwrap(n.viewmodel&&n.viewmodel.dirty)}));y.form.dirty(r)})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),i.isFeatureEnabled("dashboardfilters")&&l.partFilterState.subscribeAndRun(w,(function(n){var i=n===4||n===3,u=n===2||n===1,r,t;l.isFilterApplied(i||u);r=i?rt:it;t="";switch(n){case 1:t=st.Applied.dashboardTimeRange;break;case 0:case 2:t=st.Applied.dashboardFilters;break;case 3:t=st.Conflicted.timeRange;break;case 4:t=st.Conflicted.multiple}l.filterIcon(ui.CustomImageWithOptions(r,{title:t,isLogo:!0}))})),l}return __extends(u,t),u.prototype.setupContent=function(n){var t=this;return f.computed(this._lifetime,(function(){if(t.partSettingFailed())oi.error(si),f.ignoreDependencies((function(){t._bindErrorTemplate()}));else{var r=nt.isV2(t._viewModel.content())&&!t._viewModel.content()._msPortalFx_contentRevealedOnce(),i=t._viewModel.container.partState();if(r&&i!==ft.Failed)return;f.ignoreDependencies((function(){t._bindContentTemplate(i,t.template,n)}))}})).extend({deferred:!0}),w.waitForBindings(this._partContent)},u.prototype.selectOnReady=function(n,t){var i=this,c=function(){i._selectable.isSelected(!0)},f,e;t=t||{};t.selectablePath=t.selectablePath||"container.selectable";t.timeoutInMilliseconds=t.timeoutInMilliseconds===undefined?5e3:t.timeoutInMilliseconds;t.execute=t.execute||c;var o=this._viewModel.container.operations.inProgress,u=Q.defer(),s=p.getModelValue(this._viewModel,t.selectablePath),l=typeof this._viewModel.content().onInputsSet=="function"&&o(),h=function(){var r=n();r&&t.execute(i._viewModel);u.resolve(r)};return s.exists&&s.value?l?this._inProgressLifetime||(f=t.timeoutInMilliseconds,e=ot.setTimeout((function(){i._inProgressLifetime.dispose();u.reject(r.createError("Unable to select part because its onInputsSet promise did not resolve after {0} milliseconds.".format(f)))}),f),this._inProgressLifetime=this._lifetime.createChildLifetime(),o.subscribe(this._inProgressLifetime,(function(n){n||(i._inProgressLifetime.dispose(),ot.clearTimeout(e),e=null,h())}))):h():u.reject(r.createError("Unable to select part because it is missing selectable property '{0}' from its view model.".format(t.selectablePath))),u.promise},u.prototype.setFocus=function(n){var f=this._partContainer.closest(".fxs-blade"),t=f.length>0?f[0]:this._partContainer[0],u=document.activeElement,r;return(n=n.trim(),r=i.first(n.match(/^(?:(?:\.ext-[\w\-\.]+)[, ]*)+$/g)),r!==n)?Q({success:!1,errorMsg:"Selector must use classes with '.ext-' prefix. Other selectors aren't supported. Current: '{0}'.".format(n)}):u===document.body||u===t||t.contains(u)?w.waitForBindings(t).then((function(){var n=e(t).find(r).findFirstTabbable();return n.length<1?{success:!1,errorMsg:"No focusable element found on or within '{0}'".format(r)}:(n.focus(),{success:!0})})):Q({success:!1,errorMsg:"Requesting container does not own the focus."})},u.prototype._setupAutofocusReadyListener=function(){var t=this,n=this._partContainer[0];l.FocusHandler.Instance.registerTargetForFocus(n);w.waitForBindings(n).then((function(){return Q(t._viewModel.onInputsSetPromise).catch(i.noop)})).then((function(){l.FocusHandler.Instance.notifyTargetReadyForFocus(n)})).catch((function(){}))},u.prototype._logClick=function(n){var t=this._services.desktop.getActiveJourney();fi.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onStartboard()?y.Source.StartBoardPart:y.Source.Blade,action:y.Action.PartClick,name:this._options.locator.toFriendlyString(),data:n,journeyId:t&&t.id})},u.prototype._onClick=function(n,t){return this._activatePart(n,t)},u.prototype._onKeyDown=function(n,t){return t.target===this._partContainer[0]&&t.keyCode===13?this._activatePart(n,t):!0},u.prototype._activatePart=function(n,t){if(this._services.diContainer.get(g.DesktopManagerMode).value.peek()===1&&!this._viewModel.content()._msPortalFxUnboundPart)return!0;var c=this._viewModel.container,o=e(t.target),l=!0,s=ot.getSelection(),h=s.rangeCount>0&&s.getRangeAt(0),r=c.clickableLink;if(this._isPartClickable()&&!(o.closest("a").length>0)&&(s.isCollapsed||!h||h.commonAncestorContainer.ownerSVGElement||h.commonAncestorContainer.nodeName==="svg"))if(r)if(r instanceof bt&&e.isFunction(r.onClick))r.onClick();else{var u=r.target(),f=String(r.uri()||""),a=i.startsWith(f,"#"),v=!1;u==="auto"&&(u=a?"_self":"_blank");u==="_self"&&(t.ctrlKey||t.shiftKey?u="_blank":a&&(this._services.router.route(f),v=!0));v||window.open(f,u);this._logClick({effectiveTarget:u,target:r.target(),scrubbedUri:f.split("?")[0]})}else t.shiftKey||t.ctrlKey||t.which===2?o.trigger(tt.default.fxopeninnewtab,{selectable:c.selectable}):(this._selectable&&(this._selectable.isSelected()?o.trigger(tt.default.fxensurebladevisible,{}):(this._selectable.onClick(),this._logClick())),l=!1);return l},u.prototype._accessibility=function(){for(var t,r,u=this._partContainer.findByClassName("fxs-part-title"),n=0;n<u.length;n++)t=i.getUniqueId(),r=e(u[n]),r.findByClassName("fxs-part-titleText").attr("aria-describedby",t),r.findByClassName("fxs-part-assetname").attr("id",t)},u.prototype._bindContent=function(n,t,i){i&&yi(document,e(this._partContent),i);e(n).html(t);f.applyBindings(this._getContentForBinding(this._lifetime),n);this._nodeToCleanup=n},u.prototype.dispose=function(){var n,t;this._lifetime.dispose();n=this._nodeToCleanup;n&&f.cleanNode(n);t=this._partContainer[0];t&&(f.cleanNode(t),this._partContainer[0]=this._partContent=null);i.disposeViewModelProperties(this._viewModel)},u.prototype._getContentForBinding=function(){return this._viewModel.content},u.prototype._getExtensionName=function(){return this._options.locator.getExtensionLocator().name},u.prototype._bindContentTemplate=function(t,r,u){var f=this._viewModel.container;if(t===ft.Ready)try{f.contentState(0);this._resetContentTemplateContainer();this._bindContent(this._partContent,r,u)}catch(e){c.logToExtension(n,this._partContainer,2,"Part {0} failed to bind. Error: {1}".format(this._options.getDebugId(),i.getLogFriendlyMessage(e)));this._bindErrorTemplate()}else t===ft.Failed&&(this._options.traceErrorTelemetry(f.failureMessage()),this._bindErrorTemplate());this._setupAutofocusReadyListener()},u.prototype._bindErrorTemplate=function(){this.notFoundMessage(null);this._viewModel.container.contentState(3);this._resetContentTemplateContainer();var n=new b.ViewModel;new b.Widget(e(this._partContent),n);n.title(this._options.locator.name);n.subtitle(this._getExtensionName());l.FocusHandler.Instance.notifyTargetReadyForFocus(this._partContainer[0])},u.prototype._resetContentTemplateContainer=function(){f.cleanNode(this._partContent);e(this._partContent).html("")},u.prototype._toggleDisableTabbableElements=function(n){var r,t,u,i,f="tabindex",o="data-initialtabindex";if(n)for(r=this._partContainer.find(":tabbable"),i=0;i<r.length;++i)t=e(r[i]),u=t.attr(f),t.attr(f,"-1"),t.attr(o,u||"unset");else for(r=this._partContainer.find("["+o+"]"),i=0;i<r.length;++i)t=e(r[i]),u=t.attr(o),u!=="unset"?t.attr(f,u):t.removeAttr(f),t.removeAttr(o)},u})(vt);t.PartImpl=dt;t.registerFactory=vi;t.getFactory=gt;t.getPartSizeOrDefault=ni;ct={};t.injectStyles=ti;t.getPartFactory=wi;t.createAmdPartFactory=yt;t.createPartFactory=ii}));
define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-part-buttonpart-assetname,.fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{display:-webkit-flex;display:flex;width:100%;height:100%;box-sizing:border-box;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto;height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-size:10px;line-height:10px}.fxs-part-buttonpart-desc{display:none;position:relative;margin-top:10px;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-part-buttonpart-desc::after,.fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-desc:empty{margin-top:0}.fxs-part-buttonpart-titlecontainer{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-align-items:flex-start;align-items:flex-start;-webkit-justify-content:center;justify-content:center}.fxs-part-buttonpart-title{position:relative;margin:0;font-size:14px;font-family:az_ea_font,\"Segoe UI\",wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-weight:600;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart,.fxs-tilesize-wide .fxs-part-buttonpart{text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-wide .fxs-part-buttonpart-titlecontainer{-webkit-justify-content:flex-start;justify-content:flex-start}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer{padding-top:3px}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-normal .fxs-part-buttonpart-titlecontainer{margin:13px 0 5px}.fxs-tilesize-normal .fxs-part-buttonpart-iconcontainer{padding-top:28px}.fxs-tilesize-normal .fxs-part-part-title-visible .fxs-part-buttonpart-iconcontainer{padding-top:0}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block}.fxs-part-buttonpart-externallink{height:12px;width:12px;margin-left:3px;margin-top:2px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title,.fxs-part-buttonpart .fxs-part-buttonpart-titlecontainer{background-color:inherit}")}));
define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","o","ko","MsPortalImpl/Parts/Parts","FxInternal/Composition/ViewModel","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f,e){"use strict";r.defineProperty(t,"__esModule",{value:!0});t.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, attr: { title: _displayTitle }'><\/div><div class='fxs-part-buttonpart-textcontainer'><div class='fxs-part-buttonpart-titlecontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible }, attr: { \"aria-describedby\": _assetName() && _id }'><\/h3><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='image: _linkSvg, attr: { \"aria-label\": _linkUri }'><\/div><!-- /ko --><\/div><div data-bind='text: _assetName, visible: _assetNameVisible, attr: { id: _id }' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow'><\/div><div data-bind='text: description' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><\/div>";var o=(function(n){function r(){var i=n!==null&&n.apply(this,arguments)||this;return i.template=t.template,i}return __extends(r,n),r.prototype._getContentForBinding=function(t){var o=this,v=this._viewModel,f=v.content,h=v.container,r=h.clickableLink,c=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},l=u.observable(!!r&&!c(r)),a,s,y;return u.computed(t,(function(){o.ariaLabel(f().title())})),a=r&&r.target,a&&a.subscribe(t,(function(){l(!c(r))})),s=r&&r.uri,s&&s.subscribe(t,(function(){l(!c(r))})),y=e.isV2(f())?function(){return o._options.size()}:function(){return f().size&&f().size()},u.computed(t,(function(){return i.extend2(n.prototype._getContentForBinding.call(o,t)(),{_displayTitle:u.computed(t,(function(){var n=y(),t=f(),i=t.title();return n===0||n===1?t.shortTitle()||i:i})),_assetName:h.assetName,_isExternalLink:l,_linkUri:s,_linkSvg:i.Base.Images.Hyperlink({isLogo:!0}),_assetNameVisible:u.computed(t,(function(){return!o.inContainerOfSameAsset()&&h.assetName()})),_id:i.getUniqueId()})}))},r})(f.PartImpl);t.ButtonPart=o}));
define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-size:10px;line-height:10px;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')}));
define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","o","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";r.defineProperty(t,"__esModule",{value:!0});var h=s.Parts,c='<div class="fxs-part-collectionpart" data-bind="css: {\'fxs-part-collectionpart-rollup-forceshow\': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"><\/span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }"><\/div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"><\/h4><\/div><!-- ko if: emptyGrid() && noRowsHtml() --><div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"><\/div><!-- /ko --><!-- ko if: !emptyGrid() || !noRowsHtml() --><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+('<a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">'+i.encodeHtml(h.more)+"<\/a>")+"<!-- /ko --><!-- /ko --><\/div>",l=(function(n){function t(t,i,r,u){var e=n.call(this,t,i,r,u)||this,o;e.template=c;o=e._container=f(t);o.on("click keydown","a.fxs-part-collectionpart-more-data",(function(n){n.preventDefault();n.stopPropagation();var t=f.Event(n.type);t.keyCode=n.keyCode;f(n.delegateTarget).trigger(t)}));return e}return __extends(t,n),t.prototype._getContentForBinding=function(n){var t=this._viewModel,r=this._container.findByClassName("fxs-part-collectionpart-part-title"),f=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return u.computed(n,(function(){var n=t.content().size();e.toggle(r,n!==0||!!t.container.partTitle());e.toggle(f,n!==0&&n!==1)})),u.observable(i.extend2(t.content(),{_partTitle:t.container.partTitle}))},t})(o.PartImpl);t.CollectionPart=l}));
define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}));
define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")}));
define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-specpicker-footer-value,.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode,.msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker:after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker:after,.fxs-mode-dark .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker:after,.fxs-mode-light .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker-footer-statusMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')}));
define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","o","MsPortalImpl/Parts/Parts","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r,u){"use strict";r.defineProperty(t,"__esModule",{value:!0});var f=i.Parts.PartKind,c=0,s=1,o=2,e=3,l=10,a=4,v=5,y=6,b=7,p=8,k=9,h="<div data-bind='{0}: $root'><\/div>",w={defaultSize:p,supportedSizes:[p],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};t.parts=[{kind:f.Asset,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:s,supportedSizes:[c,s,o]})},{kind:f.Button,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(t,i,r,u)}),{supportedSizes:[c,s,o,e,]})},{kind:f.Chart,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",(function(n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[s,o,a,e,l,v,y,b,p,k,]})},{kind:f.Collection,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[c,s,o,e,a,l,v,y,b,k,p,]})},{kind:f.CollectionSummary,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[c,s,o,e]})},{kind:f.DiffEditor,factory:u.createPartFactory(h.format("pcDiffEditor"))},{kind:f.Donut,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[o,v,e,l,a,y,]})},{kind:f.Editor,factory:u.createPartFactory(h.format("pcEditor"))},{kind:f.Grid,factory:u.createPartFactory(h.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:f.InfoList,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),w)},{kind:f.ItemSummary,factory:u.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:f.LogStream,factory:u.createPartFactory(h.format("pcLogStream"))},{kind:f.Properties,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),w)},{kind:f.Provisioning,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[o,e,]})},{kind:f.QuickStart,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:s,supportedSizes:[c,s,o,e,]})},{kind:f.QuotaGauge,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:[o,l,e,a,y,v,]})},{kind:f.ResourceSummary,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),w)},{kind:f.Settings,factory:u.createPartFactory(h.format("pcSettings"),{defaultSize:e,supportedSizes:[e]})},{kind:f.SingleSetting,factory:u.createPartFactory(h.format("pcSingleSetting"))},{kind:f.SingleValueGauge,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[o,l,e,a]})},{kind:f.Unavailable,factory:u.createPartFactory("<div><\/div>")},];t.parts.forEach((function(n){u.registerFactory(f[n.kind],n.factory)}))}));
define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","f","i","o","a","ko","Fx/ResourceManagement","FxInternal/Di","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/UI/UI.AuthStateManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function vi(n){st.push(n)}function b(n){return(n||"").toLowerCase()}function ht(n,t){return n===t||b(n)===b(t)}function yi(n,t){var r=o.ArmId.parse(n),u=o.ArmId.parse(t);return r.kind!==0&&u.kind!==0&&ht(n,t),i.deepEquals(n,t)}function hr(n,t){var i=o.ArmId.parse(t.assetId),r;return i.kind===1||i.kind===4||l.isResourceAtAnyLevel(i)?!0:(r=dt(n),!!(r&&r.mappingViewModel))}function wi(n){return n.replace(pi,(function(n,t,i){return i&&b(i)}))}function cr(n,t,i){return wi(n+" "+t+i||(i?" "+i:""))}function lr(n,t,r){var u;return wt.isInstanceOfErrorType(n,wt.Error)?u=d(n,r):rr.isXMLHttpRequestLike(n)?(u=d(n.message||t,n.stack,r),i.shallowCopyFromObject(u,n,["readyState","status","statusText","responseText"])):u=d(new wt.Error({message:t,data:r,innerErrors:n})),u}function ar(n){var t=n.text||n.name,i=n.pluralDisplayName||t;return{plural:i,singular:n.singularDisplayName||t,lowerPlural:n.lowerPluralDisplayName||t,lowerSingular:n.lowerSingularDisplayName||t,service:n.serviceDisplayName||i}}function ki(n,t,i){var r;return st.some((function(u){return r=u.provideAssetTypeKeywords(n,t,i),!!r})),r}function vr(n){var t;return st.some((function(i){return t=i.provideCategoryName(n),!!t})),t||n}function dt(n){return n&&n.assetTypeManifest.resourceType}function gt(n){var t=n.resourceType;return t&&b(t.resourceTypeName)}function ct(n,t,i,u,f){var e;return(i===void 0&&(i=null),u===void 0&&(u=null),f===void 0&&(f=null),!n)?{icon:et.Images.Polychromatic.ResourceDefault(),selection:r.ViewModels.getBladeSelection(nt,rt,{id:t})}:(e=n.assetTypeManifest,u=u||e.bladeExtensionName||n.extension,i=i||e.bladeName,!i&&e.resourceType&&(i=rt,u=nt),{icon:f||n.icon,selection:r.ViewModels.getBladeSelection(u,i,{id:t}),isPreview:n.isPreview})}function ni(n,t){var r;if(t){var u=n.assetTypeManifest,f=gt(u),i=function(n){return(t&n)===n};if(i(1)&&((r=u.browseType,r===undefined)||i(5)&&(r!==1||!f)||i(9)&&(r!==3||!u.browseLinkUri||i(25)&&r!==3))||i(2)&&!f)return!1}return!0}function yr(n,t,i){return n.extensionName===t&&n.assetType===i}function lt(n,t,i,r){return yr(n,t,i)&&yi(n.assetId,r)}function pr(n,t){return"Extension <"+n+"> : AssetType <"+t+"> : ID <REDACTED>"}function ti(n,t,i){return d("Asset type does not specify a resource type. Extension <"+t+"> : AssetType <"+i+"> : "+n)}function at(n){return d("Resource ID <"+l.sanitizeId(n)+"> is not a subscription ID, resource group ID or resource ID.")}function vt(n,t,i){return new Error("The "+n+" view model was already disposed. Extension <"+t+"> : ViewModel <"+(typeof i=="string"?i:i.name)+">")}function wr(n,t){var u=function(n,t){return i.unique((n||"").split(",").filter((function(n){return!!n})).concat(t)).join(",")},f=t.name,r=ki(n,f,""),e;r&&r.length&&(t.keywords=u(t.keywords,r));e=t.resourceType||{};(e.kinds||[]).forEach((function(t){var r=b(t.name),i=ki(n,f,r);i&&i.length&&(t.keywords=u(t.keywords,i))}))}function br(n,t,r){var f=r.resourceType&&r.resourceType.kinds||[],e=f.first((function(n){return n.isDefault}));return{lowerCaseAssetType:b(r.name),lowerCaseExtension:b(t.name),lowerCaseResourceType:gt(r)||"",kindMap:i.extendArrayIntoMap(u.create(null),f,(function(n){return b(n.name)}),i.identity),defaultKind:e&&b(e.name),assetTypeManifest:r,id:n,extension:t.name,compositeDisplayName:ar(r),icon:r&&r.icon||sr,isPreview:t.isPreview||!!r.isPreview}}function kr(n,t){it.getAssetTypeInformationEndPoint.register(n,null,(function(n){return t.getAssetTypeInformation(n.extensionName,n.assetType)}));it.getResourceTypeAssetTypeInformationEndPoint.register(n,null,(function(n){return t.getResourceTypeAssetTypeInformation(n)}));it.mapAssetIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,i){var r={reason:"mapAssetIdToDynamicSelectionAndIcon",extension:i.srcWindowId};return t.mapAssetIdToDynamicSelectionAndIcon(n.assetId,r)}))}function dr(n,t){function o(n){return"resourceType:"+n.lowerCaseResourceType}function s(n){return"assetType:"+n.lowerCaseExtension+n.lowerCaseAssetType}var u=it.getHubsWindowId(),f=i.memoizeQ((function(){return t.assetTypesComplete.then((function(){return t.assetTypes.map((function(n){return t.mapAssetTypeToResourceTypeAssetTypeInformation(n)}))}))})),e;h.AssetTypes.getAssetTypesInformationObservableEndPoint.registerObjectFactory(n,{allowedOrigin:[u],allowRemoteChanges:!1,handler:function(){return f()}});e=i.memoizeQ((function(){return f().then((function(n){return n.reduce((function(n,t){return n[o(t)]=n[s(t)]=t,n}),{})}))}));h.AssetTypes.getSingleAssetTypeInformationObservableEndPoint.registerObjectFactory(n,{allowedOrigin:[u],allowRemoteChanges:!1,handler:function(n){return e().then((function(t){var u=n.lowerCaseResourceType?o(n):s(n),i=t[u];return i&&MsPortalEarly.ExtensionLoader.registerExtensionLoadTrigger(i.extensionName,r.Extension.getModule(i.bladeName,1)),Q(i)}))}})}function ii(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)}function ft(n,t,i){var r=t&&(f.isArray(t)?t:[t]),u;r&&(u=n.length+r.length-i,u>0&&n.splice(0,u),n.push.apply(n,r))}function g(n,t){return i.find(n,t,-1)}function gr(n){var t=n.rpcClient,i=n.assetTypeService;kr(t,i);dr(t,i)}function ri(n,t){n&&n.split(",").forEach(t)}function di(n){var t=3;return n.privateBrowse&&(t-=2),n.isPreview&&(t-=1),t}var st,pi,bi,gi,yt;u.defineProperty(t,"__esModule",{value:!0});var it=r.Extension,et=i.Base,ot=et.Constants,ui=ot.AssetNames,pt=ui.NonAssetResource,nt=ot.ExtensionNames.Hubs,fi=ot.ResourceTypes,rt=ot.BladeNames.Hubs.ResourceMenuBlade,nr=ot.BladeNames.Hubs.BrowseServiceBlade,tr=i.Extension,ei=i.Assets,oi=r.Assets,ir=tr.ResourceRoutingType,wt=i.Errors,rr=i.Helpers,k=i.tryImmediateResolve,ur=window,si=ur.fx.environment,bt=et.Diagnostics.createLog(n),hi=function(n){return bt.warning(n)},ci="Timeout trying to load extension manifest",ut=i.remove,li={name:"ResourceMap$ResourceProviderViewModel",module:"HubsExtension/ResourceMap/ViewModels/ResourceProviderViewModel","export":"ResourceProviderViewModel"},fr="MsPortalImpl/Services/Services.AssetTypesDelayed",tt=ei.supportsContract,d=et.Diagnostics.createIgnoreUnhandledRejectionError,er=oi.getAssetTypeOrResourceTypeId,or=it.isEqualDescriptor,kt=it.getWindowId,ai=it.getDescriptor(nt),sr=et.Images.Polychromatic.ResourceDefault();t.failedToFindAssetTypePrefix="Could not find the asset type";st=[];t.registerStringProvider=vi;t.compareAssetId=yi;pi=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;bi=/^https?:\/\//i;vi({provideCategoryName:function(n){return c.BrowseCategories[wi(n)]||n},provideAssetTypeKeywords:function(n,t,i){var r=c.AssetTypeKeywords[cr(n,t,i)];return r?r.split(","):[]}});t.provideCategoryName=vr;t.createViewModelDisposedError=vt;t.setupAssetTypeServiceRpc=gr;t.Internal={};gi=(function(){function n(n,t,u){var f=this,e;this.assetTypes=[];this._resourceTypeMap={};this._assetIdToResourceIdPromises=[];this._resourceIdToAssetIdPromises=[];this._assetTypeByIdBrowseLink={};this._assetTypeByResourceTypePromises=[];this._resourceTypeMappingPromises=[];this._selectionFromAssetIdPromises=[];this._selectionFromResourceIdPromises=[];this._resourcePromises=[];this._apiVersionOverrides={};this._assetTypeOverrides={};this._callbacks=[];this._memoizedManifestsLoadedError=i.memoize((function(n){return d(n)}));this._getResourceProvider=i.memoizeQ((function(){return k(f._extensionManager.getHubsExtension(),(function(n){return n.getViewModel(li,11).then((function(t){f._resourceProviderLifetime||(f._resourceProviderLifetime=f._lifetimeManager.createChildLifetime());if(f._resourceProviderLifetime.registerForDispose((function(){ii(n,t)})),!0)return t.content();throw vt("resource map provider",nt,li);}))}))}));this._getResourceTypeCachePromise=i.memoizeQ((function(){return k(f._getResourceProvider(),(function(n){return Q(n.getResourceTypeCache())}))}));this._serviceMenuEnabled=t.isEnabled("servicemenu");this._lifetimeManager=new r.TriggerableLifetimeManager;this._extensionManager=n;this._cachedUser=u;this.assetTypesComplete=this._listenForExtensions();this.assetTypesComplete.then((function(){ut(f._callbacks,(function(n){return!n()}))}));ri(t.getValue("assettypeapiversion"),(function(n){var t=n.split(":");t.length===2&&(f._apiVersionOverrides[b(t[0])]=t[1])}));e=function(n){return function(t){f._assetTypeOverrides[b(t)]=n}};ri(t.getValue("showassettypes"),e(!0));ri(t.getValue("hideassettypes"),e(!1))}return n.prototype.dispose=function(){i.disposeDisposable(this._memoizedManifestsLoadedError,this._getResourceProvider,this._getResourceTypeCachePromise,this._lifetimeManager,this._resourceCache,this._resourceGroupCache,this._resourceIdSelectionCache,this._assetIdSelectionCache,this._resourceAssetIdCache,this._resourceMappingCache)},n.prototype.getMappedBladeLocator=function(n){if(n.type===1){var t=this._mappedBrowseBlades.get(kt(n.getExtensionLocator()));if(t&&t.get(n.name))return y.Locator.forExtension(ai.name).withBlade(rt)}return n},n.prototype.getAssetType=function(n,t,i){var r={name:n};return g(this.assetTypes,(function(n){return or({name:n.extension},r)&&n.assetTypeManifest.name===t&&ni(n,i)}))},n.prototype.getAssetTypeById=function(n,t){return g(this.assetTypes,(function(i){return i.id===n&&ni(i,t)}))},n.prototype.getAssetTypeByResourceType=function(n,t){if(n){var i=b(n);return g(this.assetTypes,(function(n){return n.lowerCaseResourceType===i&&ni(n,t)}))}},n.prototype.getAssetTypeByResourceTypeWithFallback=function(n,t){var r=this.getAssetTypeByResourceType(n,t);return r||(r=i.clone(this.getAssetType(nt,pt,t)),r.assetTypeManifest.resourceType={resourceTypeName:n}),r},n.prototype.getAssetTypeDeepLink=function(n,t){var r=n.assetTypeManifest,f=r.name,e=r.bladeName,o=n.extension,s=r.bladeExtensionName||o,l=r.resourceType,h=l&&l.resourceTypeName,u=function(n,t){return v.getBladeDeepLink(ai,n,"",t,!1)},i="",a=this._serviceMenuEnabled&&r.serviceMenuBlade,y,c,p;if(a)i=v.getBladeDeepLink({name:r.serviceMenuBladeExtension||n.extension},a,"",{id:r.serviceMenuItemId},!1);else switch(r.browseType){case 0:i=u(nr,{assetTypeId:oi.getAssetTypeOrResourceTypeIdByWindowId(o,f)});break;case 1:i=t?u("Resources",{resourceType:h,kind:t}):u("Resources",{resourceType:h});break;case 2:s===nt&&(y={BrowseAllResourcesBlade:fi.AllResources,BrowseRecentResourcesBlade:fi.RecentResources},c=y[e],c&&(i=u("Resources",{resourceType:c})));i||(p=f==="Dashboard"&&s===nt,i=p?"#":v.getBladeDeepLink({name:s},e,"",{},!1),f===ui.Gallery&&(i+="/selectedMenuItemId/home"));break;case 3:i=this.getBrowseLinkUri(n);break;case 999:i=v.getBladeDeepLink({name:o},e,"")}return i||bt.error("<"+h+"> asset type does not have a deep link. Side bar & search results will not be able to open any blades."),i},n.prototype.getBrowseLinkUri=function(n){var t=this._cachedUser,r=this._assetTypeByIdBrowseLink[n.id],i,u;return r?r:(i=n.assetTypeManifest.browseLinkUri,i&&(u=si.links.classicPortal.format({domain:t&&t.tenantDomain}),i=i.format({accountPortal:si.links.accountPortal,classicPortal:u,domain:t&&t.tenantDomain,tenantId:t&&t.tenantId})),this._assetTypeByIdBrowseLink[n.id]=i,i)},n.prototype.getAssetTypeInformation=function(n,i){var u=this,r=t.Internal.getAssetTypeInformationOverride;return r?Q(r(n,i)):k(this._getAssetTypePromise(n,i),(function(t){if(!t)throw d("Asset type not found: AssetType <"+n+":"+i+">");return u.mapAssetTypeToAssetTypeInformation(t)}))},n.prototype.getResourceTypeAssetTypeInformation=function(n){var f=this,e=t.Internal.getResourceTypeAssetTypeInformationOverride;if(e)return Q(e(n));var o=function(n,t){return{resourceType:n,topLevelTenantAlias:null,topLevelResourceTypeAlias:null,extensionName:null,assetType:null,browseType:-1,compositeDisplayName:null,icon:null,viewModelLocator:null,viewModel:null,contracts:0,lowerCaseExtension:null,lowerCaseAssetType:null,lowerCaseResourceType:b(n),reason:i.getLogFriendlyMessage(t)}},u=[],s=[],h=r.lowerCaseStringMap();return n.forEach((function(n){var t=n.split("/").length>=2;t?h.set(n,!0):s.push(n)})),u.push.apply(u,s.map((function(n){return o(n,"Invalid resource type")}))),h.forEach((function(n,t){var i=k(f.assetTypesComplete,(function(){var n=f.getAssetTypeByResourceType(t);return n?f.mapAssetTypeToResourceTypeAssetTypeInformation(n):o(t,"Asset type not found")}));u.push(i)})),Q.all(u)},n.prototype.mapAssetIdToResourceId=function(n){var y=this,e=this._assetIdToResourceIdPromises,i=n.extensionName,r=n.assetType,t=n.assetId,s,h,c,u,f,v;return(this._resourceAssetIdCache=this._resourceAssetIdCache||new a.ItemArrayCache(216e5),s=this._resourceAssetIdCache.first((function(n){return lt(n.assetId,i,r,t)})),s)?Q(s.resourceId):(h=g(e,(function(n){return lt(n.assetId,i,r,t)})),h)?h.promise:(c=function(t){return y._resourceAssetIdCache.pushEntry({assetId:n,resourceId:t}),t},u=o.ArmId.parse(t),u.kind===1||u.kind===4||l.isResourceAtAnyLevel(u))?Q(c(t)):(f=k(this._getAssetTypePromise(i,r),(function(n){if(!n)throw d("Asset type not found: AssetType <"+i+":"+r+">");var u=dt(n);if(!u)throw ti("ID <"+l.sanitizeId(t),i,r);if(!u.mappingViewModel)throw d("Asset ID not a resource ID but asset type does not provided mapping view model. "+pr(i,r,t));return y._getMappingViewModel(n).then((function(n){return Q(n.mapAssetIdToResourceId(t)).then((function(n){var t=o.ArmId.parse(n);if(t.kind===0)throw at(n);return c(n)}))}))})),v={assetId:n,promise:f},ft(e,v,200),f.catch((function(){ut(e,v)})),f)},n.prototype.mapResourceIdToAssetId=function(n){var s=this,i=this._resourceIdToAssetIdPromises,r=o.ArmId.parse(n),u,f,t,e;return r.kind===0?Q.reject(at(n)):(this._resourceAssetIdCache=this._resourceAssetIdCache||new a.ItemArrayCache(216e5),u=this._resourceAssetIdCache.first((function(t){return ht(t.resourceId,n)})),u)?Q(u.assetId):(f=g(i,(function(t){return ht(t.resourceId,n)})),f)?f.promise:(t=this._getAssetTypeByResourceType(r.resourceType).then((function(t){var i;if(!t)throw d("Asset type not found: ResourceId <"+l.sanitizeId(n)+"> / ResourceType <"+r.resourceType+">");var u=t.assetTypeManifest,f=u.name,e=u.resourceType,o=t.extension;if(!e)throw ti("ResourceId <"+l.sanitizeId(n)+">",o,f);return(i=function(t){var i={extensionName:o,assetType:f,assetId:t};return s._resourceAssetIdCache.pushEntry({assetId:i,resourceId:n}),i},!e.mappingViewModel)?i(n):s._getMappingViewModel(t).then((function(t){return Q(t.mapResourceIdToAssetId(n)).then((function(n){return i(n)}))}))})),e={resourceId:n,promise:t},ft(i,e,200),t.catch((function(){ut(i,e)})),t)},n.prototype.mapAssetIdToDynamicSelectionAndIcon=function(n,t){var i=this;this._assetIdSelectionCache=this._assetIdSelectionCache||new a.ItemArrayCache(216e5);var r=n.extensionName,u=n.assetType,f=n.assetId,s=this._assetIdSelectionCache.first((function(n){return lt(n.assetId,r,u,f)}));return s?Q(s.value):k(k(this._getAssetTypePromise(r,u),(function(s){if(n.assetId=f&&e.unwrap(f),hr(s,n))return k(i.mapAssetIdToResourceId(n),(function(r){var u=o.ArmId.parse(r);if(u.kind===0)throw at(r);return i._getDynamicSelectionAndIconFromResourceId(s,r,u,n,t)}));if(!s)throw d("Asset type not found: AssetType <"+r+":"+u+">");return i._getDynamicSelectionAndIconFromAssetId(s,n)})),(function(t){return i._assetIdSelectionCache.pushEntry({assetId:n,value:t}),t}))},n.prototype.mapResourceIdToDynamicSelectionAndIcon=function(n,t){var r=this,i=o.ArmId.parse(n),u;return(this._resourceIdSelectionCache=this._resourceIdSelectionCache||new a.ItemArrayCache(216e5),i.kind===0)?Q.reject(at(n)):(u=this._resourceIdSelectionCache.first((function(t){return ht(t.resourceId,n)})),u)?Q(u.value):k(k(this._getAssetTypeByResourceType(i.resourceType),(function(u){if(!u)throw d("Asset type not found: ResourceId <"+l.sanitizeId(n)+"> / ResourceType <"+i.resourceType+">");var f=u.assetTypeManifest,e=f.name;if(!f.resourceType)throw ti("ResourceId <"+l.sanitizeId(n)+">",u.extension,e);return k(r.mapResourceIdToAssetId(n),(function(f){return r._getDynamicSelectionAndIconFromResourceId(u,n,i,f,t)}))})),(function(t){return r._resourceIdSelectionCache.pushEntry({resourceId:n,value:t}),t}))},n.prototype.mapAssetTypeToAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=t.keywords;return{extensionName:n.extension,assetType:t.name,browseType:t.browseType!==undefined?t.browseType:-1,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,dynamicBladeServiceViewModelLocator:t.dynamicBladeServiceViewModelLocator,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,isPreview:n.isPreview,privateBrowse:t.privateBrowse,keywords:!i?undefined:i.split(",")}},n.prototype.mapAssetTypeToResourceTypeAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=t.resourceType||{},u=t.browseType,f=t.keywords,r=i.proxyRoutingFilters;return r||n.lowerCaseExtension!=="microsoft_azure_marketplace"||n.lowerCaseAssetType!=="galleryrpitem"||(r=[1,3]),{resourceType:i.resourceTypeName,topLevelTenantAlias:i.topLevelTenantAlias,topLevelResourceTypeAlias:i.topLevelResourceTypeAlias,apiVersion:i.apiVersion,routingType:i.routingType,bladeName:t.bladeName,bladeExtensionName:t.bladeExtensionName,partName:t.partName,kinds:i.kinds,kindMap:n.kindMap,defaultKind:n.defaultKind,proxyRoutingFilters:r,extensionName:n.extension,assetType:t.name,browseType:u!==undefined?u:-1,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModelLocator:t.viewModelLocator,viewModel:t.viewModel,dynamicBladeServiceViewModelLocator:t.dynamicBladeServiceViewModelLocator,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,isPreview:n.isPreview,marketplaceItemId:t.marketplaceItemId,marketplaceMenuItemId:t.marketplaceMenuItemId,staticOverview:t.staticOverview,privateBrowse:t.privateBrowse,keywords:f&&f.split(","),lowerCaseAssetType:n.lowerCaseAssetType,lowerCaseExtension:n.lowerCaseExtension,lowerCaseResourceType:n.lowerCaseResourceType,description:t.description,links:t.links}},n.prototype._getDynamicBladePromiseForAssetType=function(n,t){var i=n.assetTypeManifest,r=n.extension,u=i.dynamicBladeServiceViewModelLocator||i.dynamicBladeServiceViewModel;if(!u)throw d("Missing dynamic blade service view model. Extension <"+r+"> : AssetType <"+i.name+">");return this._extensionManager.getExtensionByName(r).then((function(n){return n.getViewModel(u,11).then((function(i){var f=!1;if(t.registerForDispose((function(){f=!0;ii(n,i)})),!f)return i.content();throw vt("dynamic blade service",r,u);}))}))},n.prototype._getAssetTypePromiseWorker=function(n){var t=n();return t?Q(t):k(this.assetTypesComplete,(function(){return Q(n())}))},n.prototype._getAssetTypeByResourceType=function(n,t){var u=this,f=b(n),e=g(this._assetTypeByResourceTypePromises,(function(n){return n.resourceType===f&&n.requirements===t})),i,r;return e?e.promise:(i=this._getAssetTypePromiseWorker((function(){return u.getAssetTypeByResourceType(n,t)})),Q.isRejected(i)||(r={resourceType:f,promise:i,requirements:t},ft(this._assetTypeByResourceTypePromises,r,200),Q.isPending(i)&&i.catch((function(n){n.message===ci&&bt.warning(ci);ut(u._assetTypeByResourceTypePromises,r)}))),i)},n.prototype._getResourceTypeMappingPromiseForAssetType=function(n,t){var i=dt(n),r=i&&(i.mappingViewModelLocator||i.mappingViewModel),u;if(!r)throw d("Resource type missing resource type mapping view model. AssetType <"+n+">");return u=n.extension,this._extensionManager.getExtensionByName(u).then((function(n){return n.getViewModel(r,11).then((function(i){var f=!1;if(t.registerForDispose((function(){f=!0;ii(n,i)})),!f)return i.content();throw vt("resource type mapping",u,r);}))}))},n.prototype._getMappingViewModel=function(n){var e=this,i=this._resourceTypeMappingPromises,r,t;if(this._resourceMappingCache=this._resourceMappingCache||new a.LifetimeItemCache(3e4),this._resourceMappingCache.hasEntry(n.id))return Q(this._resourceMappingCache.getEntry(n.id));if(r=n.lowerCaseResourceType,t=g(i,(function(n){return n.resourceType===r})),t)return t.promise;var u=this._lifetimeManager.createChildLifetime(),f=this._getResourceTypeMappingPromiseForAssetType(n,u).then((function(f){return e._resourceMappingCache.addEntry(n.id,f,u),t=g(i,(function(n){return n.resourceType===r})),t&&ut(i,t),f})),o={resourceType:r,promise:f};return ft(i,o,200),f},n.prototype._getDynamicBladeReference=function(n,t){var i=this._lifetimeManager.createChildLifetime();return this._getDynamicBladePromiseForAssetType(n,i).then((function(n){if(typeof n.onInputsSet!="function")return null;var i=n.onInputsSet({assetId:t.assetId});return Q(i||!0).then((function(){return n}))})).then((function(n){return n&&n.bladeName()?{blade:n.bladeName(),extension:n.extensionName()}:null})).finally((function(){i.dispose()}))},n.prototype._getDynamicSelectionAndIconFromAssetId=function(n,t){var i=ct(n,t.assetId),e=this._selectionFromAssetIdPromises,r=n&&n.assetTypeManifest,u,f;return!r||r.name===pt?Q(i):(u=g(e,(function(n){return lt(n.assetId,t.extensionName,t.assetType,t.assetId)})),u)?u.promise:(f=function(n){return ft(e,{assetId:t,promise:n},200),n},r.dynamicBladeServiceViewModel)?f(this._getDynamicBladeReference(n,t).then((function(r){return r?ct(n,t.assetId,r.blade,r.extension):i}))):f(Q(i))},n.prototype._getResourceReference=function(n,t,i){var r=this,u,f;return(this._resourceCache=this._resourceCache||new a.ItemCache(5e3),this._resourceCache.hasEntry(n))?Q(this._resourceCache.getEntry(n)):(u=g(this._resourcePromises,(function(t){return t.resourceId===n})),u)?u.promise:(f=this._getResourceProvider().then((function(u){var f;return f=t&&tt(t.assetTypeManifest.contracts,64)?Q(u.getExtensionResource(n,r.mapAssetTypeToResourceTypeAssetTypeInformation(t),i)):Q(u.getResource(n,i)),f.then((function(t){return r._resourceCache.addEntry(n,t),ut(r._resourcePromises,(function(t){return t.resourceId===n})),t}))})),ft(this._resourcePromises,{resourceId:n,promise:f},200),f)},n.prototype._getDynamicSelectionAndIconFromResourceId=function(n,t,r,u,f){var y=this,o=ct(n,u.assetId),s=o.selection,e=n&&n.assetTypeManifest,h,l,a,c,v;return r.kind===1||r.kind===4?(s.extension=nt,s.detailBlade=rt,Q(o)):(h=e&&e.resourceType,h&&h.routingType===ir.Extension&&!tt(e.contracts,64))?Q(o):e&&tt(e.contracts,128)?(s.extension=nt,s.detailBlade=rt,Q(o)):(l=function(){return e.dynamicBladeServiceViewModel?y._getDynamicBladeReference(n,u).then((function(t){return t?ct(n,u.assetId,t.blade,t.extension,o.icon):o})):Q(o)},a=g(this._selectionFromResourceIdPromises,(function(n){return n.resourceId===t})),a)?a.promise:(c=!e||h&&h.kinds&&(!tt(e.contracts,512)||tt(e.contracts,1024)||tt(e.contracts,8192)||tt(e.contracts,4096))?k(this._getResourceReference(t,n,f),(function(t){if(t.error)throw t.error;if(!e||e.name===pt)return Q(o);var r=!1;return e.viewModel&&tt(e.contracts,8)&&(s.extension=nt,s.detailBlade=rt,r=!0),k(i.require(fr),(function(i){if(h&&h.kinds){var f=!1,c=!1,u=!1;if(i.getIconAndBladeFromAssetTypeInformation(t,n.kindMap,n.defaultKind,null,(function(n){n?e.viewModel&&tt(e.contracts,16)&&(s.extension=nt,s.detailBlade=rt,r=!0):r=!1}),(function(n){c||(c=!0,o.isPreview=n)}),(function(n){f||(f=!0,o.icon=n)}),(function(t,i){u||r||(u=!0,s.extension=t||n.extension,s.detailBlade=i)})),u||r)return o}return l()}))})).catch((function(i){var r=lr(i,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:n,resourceId:t,assetId:u,telemetry:f});throw r;})):k(l(),i.identity),v={resourceId:t,promise:c},ft(this._selectionFromResourceIdPromises,v,200),c.catch((function(){y._selectionFromResourceIdPromises.remove(v)})),c)},n.prototype._preventDuplicateResourceTypes=function(n,t,i){if(this._resourceTypeMap[n]){var r=g(this.assetTypes,(function(t){return t.lowerCaseResourceType&&t.lowerCaseResourceType===n})),u=di(r.assetTypeManifest),f=di(i);if(u<f)delete this._resourceTypeMap[n],this.assetTypes.remove(r);else return u>f?!1:(hi("Extension <"+t+"> has duplicate resource type <"+n+"> also found in <"+r.extension+"> extension"),!1)}return!0},n.prototype._listenForExtensions=function(){var n=this,f=this._extensionManager,t=this._mappedBrowseBlades=r.lowerCaseStringMap();return f.on("assetTypes",(function(f){var o=kt(f),e;return t.has(o)||t.set(o,r.lowerCaseStringMap()),e=f.assetTypes,e&&e.forEach((function(e){var o,l,k,a,s,h,v,y,p,w;if(e.browseType!==4&&(e.browseType!==3||(e.browseLinkUri||"").match(bi))){if(o=e.resourceType,l=o&&o.resourceTypeName,l){if(k=l.split("/"),k.length<2){hi("Skipping asset type <"+e.name+"> with invalid resource type <"+l+"> in extension <"+f.name+">");return}if(a=gt(e),!n._preventDuplicateResourceTypes(a,f.name,e))return;n._resourceTypeMap[a]=!0}var d=function(n,i,u){if(n&&u){var e=kt({name:i||f.name});t.has(e)||t.set(e,r.lowerCaseStringMap());t.get(e).set(n,!0)}},c=o&&o.kinds,g=ei.supportsContract(e.contracts,8);c&&c.length?(c.forEach((function(n){d(n.bladeName||e.bladeName,n.bladeExtensionName||e.bladeExtensionName,n.useResourceMenu!==undefined?n.useResourceMenu:g);n.filterMap=i.extendArrayIntoMap(u.create(null),n.kinds||[n.name],(function(n){return b(n)}),(function(){return!0}));n.isDefault&&(n.filterMap[""]=!0)})),f.name==="SqlAzureExtension"&&e.name==="Database"&&(s=c.first((function(n){return b(n.name)==="v12.0,user,datawarehouse"})),h=c.first((function(n){return b(n.name)==="v12.0,user,datawarehouse,gen2"})),s&&h&&(s.filterMap[b(s.name)]=!0,s.filterMap[b(h.name)]=!0,h.filterMap[b(s.name)]=!0,h.filterMap[b(h.name)]=!0))):d(e.bladeName,e.bladeExtensionName,g);wr(f.name,e);v=er(f.name,e.name);y=b(v);o&&(p=n._apiVersionOverrides[y],p&&(e.resourceType.apiVersion=p));w=n._assetTypeOverrides[y];w!==undefined&&(e.privateBrowse=!w);n.assetTypes.push(br(v,f,e))}})),ut(n._callbacks,(function(n){return!n()})),!0}))},n.prototype._getAssetTypePromise=function(n,t,i){var r=this;return this._getAssetTypePromiseWorker((function(){return r.getAssetType(n,t,i)}))},n})();yt=(function(){function n(){}return n.create=function(n,t,i){return new gi(n,t,i.getCurrentUser())},n})();__decorate([s.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[p.ExtensionManager,r.Features,w.AuthStateManager]),__metadata("design:returntype",yt)],yt,"create",null);t.AssetTypeService=yt}));
define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","f","i","o","$","Fx/ResourceManagement","FxInternal/Di","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base,a=r.Rpc,v=l.Diagnostics.createLog(n),c=(function(){function n(n,t){var o=this,u;this._assetDeletedCallbacks=f.Callbacks();u=function(t,i,u){var f,h,c,l;u.reason=u.reason||"Received asset deletion notification from the extension '"+t+"'";f=u.assetId;h=u.assetType;h===r.AssetManager.resourceAssetType?(c=e.ArmId.parse(f),l=c.resourceType,l&&n.mapResourceIdToAssetId(f).then((function(n){o.handleAssetDeleted({name:n.extensionName},n.assetType,n.assetId,u.reason)})).catch((function(n){(n&&n.message||"").indexOf(s.failedToFindAssetTypePrefix)!==0&&v.warning(n)}))):o.handleAssetDeleted(i,h,f,u.reason)};t&&(r.AssetManager.notifyAssetDeletedDefinition.register(t,null,(function(n,t){var f=t.srcWindowId,e=r.Extension.getDescriptor(f);i.makeArray(n).forEach((function(n){u(f,e,n)}))})),r.AssetManager.hubsNotifyAssetDeletedDefinition.register(t,[r.Extension.getHubsWindowId()],(function(n,t){var r=t.srcWindowId;i.makeArray(n).forEach((function(n){u(r,{name:n.extensionName},n)}))})))}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},n.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},n})();t.AssetManagerImpl=c;h=(function(){function n(){}return n.create=function(n){return new c(n,a.client)},n})();__decorate([o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.AssetTypeService]),__metadata("design:returntype",h)],h,"create",null);t.AssetManager=h}));
define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","f","i","o","a","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o){"use strict";function w(n){if(n&&!g.test(n)){v.warning("Invalid curation file name: <"+n+">, skipping this curation file.");return}return n}function nt(n,t,i){var r=f.isArray(t[0])?t:[t];return{base:h(n),associated:b.apply(void 0,r),infoTextOverride:i}}function h(n){var t,i;if(n&&!(n.length<2)&&n[0].length&&n[1].length)return t={extensionName:n[0],assetType:n[1]},n.length>2&&(i=n[2],i&&typeof i=="string"?t.kind=i:n[2]===!1&&(t.isHidden=!0)),t}function b(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.map((function(n){return h(n)})).filter((function(n){return!!n}))}function tt(){e.Curation.getSharedCurationEndpoint.register(k.client,[r.Extension.getHubsWindowId()],(function(){return t.getSharedCuration()}))}var s;u.defineProperty(t,"__esModule",{value:!0});var c=i.Base,k=r.Rpc,l=i.Hubs.Notifications,d=window,a=d.fx.environment,v=c.Diagnostics.createLog(n),g=/^[a-z\_]+[a-z\d\-\_]*$/i,y=o.BrowseCuration,p=i.lowerCaseAllStrings;s=w(i.getFeatureValue("browsecuration"))||w(a.browseCuration)||"default";t.getMergedAssetType=nt;t.getAssetType=h;t.getAssetTypes=b;t.getBrowseCuration=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/BrowseCuration/"+s).then((function(n){return n.getCuration()})).catch((function(n){var i="Failed to get the browse curation file <"+s+">",t=i;return n&&n.statusText?t+=": "+(n.status||"")+" ("+n.statusText+")":n&&n.message&&(t+=": "+n.message),v.warning(t),l.ClientNotification.publish({title:y.noCurationTitle,description:y.noCuration,status:l.NotificationStatus.Warning}),{}}))}));t.getSharedCuration=i.memoizeQ((function(){var n=o.SearchTypeDisplayText,r=o.SearchTypeKeywords,u=o.SearchTypeSubText;return t.getBrowseCuration().then((function(t){var f=(t&&t.search||[]).map((function(t){var i=(t.id||"").toLowerCase(),f=i&&n[i];if(f)return{id:t.id,displayName:f,subText:u[i],keywords:(r[i]||"").split(","),icon:typeof t.icon=="string"?c.Images.ImageUri(t.icon):t.icon,link:(t.link||"").format({accountPortal:a.links.accountPortal})}})).filter(i.identity);return{searchCuration:f,resourceTypesExcludedFromBrowse:p(t&&t.resourceTypesExcludedFromBrowse),mergedAssetTypes:p(t&&t.mergedAssetTypes)}}))}));t.testReset=i.noop;t.initializeRpc=tt}));
define("MsPortalImpl/Services/Services.ExtensionTokensManager",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.SecurityTokens"],(function(n,t,i,r,u,f,e,o){"use strict";u.defineProperty(t,"__esModule",{value:!0});var c=r.Extension,l=i.Base,a=l.Security,v=r.Security,h=v.tokenErrors,y=h.accessDenied,p=h.sessionEnded,s=(function(){function n(n,t){this._shellTokenManager=n;this._extensions=t}return n.prototype.createAuthTokenCache=function(n){var t=this,i=a.createAuthTokenCache((function(i){return t.getSecurityToken(n,i.resourceName||"",i.isBackground,!1)}));return{getToken:function(n){return Q(i.getToken(n))}}},n.prototype.getSecurityToken=function(n,t,i,r){var u=this._extensions[n],f=u&&u.flags,e=this._shellTokenManager.shellTokenCache;return t&&f&16?Q({error:y}):this._shellTokenManager.isSessionEnded()?Q({error:p}):e&&!t&&f&8&&!r?e.getToken({resourceName:""}).then((function(n){return{token:n}})):this._shellTokenManager.getToken(n,t,i,r)},n.create=function(t,i){return new n(t,i.extensionsAsMap)},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.SecurityTokensManager,e.ExtensionManagerOptions]),__metadata("design:returntype",s)],s,"create",null);t.ExtensionTokensManager=s;t.getAuthorizationTokenEndPoint=f.defineHandler(c.getAuthorizationTokenEndPoint,(function(n){var t=n.messageArg;return n.diContainer.get(s).getSecurityToken(n.messageContext.srcWindowId,t.resourceName||"",t.isBackground,t.skipCache)}))}));
define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","o","ko","FxInternal/Di","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u,f,e){"use strict";var l,h,o,c,s;i.defineProperty(t,"__esModule",{value:!0});l="InitializeFavoritesSettingsInternal";h=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.create=function(n){return e.create(t,n,new o,10,l,!0)},t})(e.SettingsProcessor);__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f.SettingsManager]),__metadata("design:returntype",i)],h,"create",null);t.FavoritesSettingsManager=h;o=(function(){function n(){this.favorites=r.observable("");this.version=r.observable(0)}return n.create=function(n){return n.value},n})();__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h]),__metadata("design:returntype",o)],o,"create",null);t.FavoritesSettings=o;c=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.create=function(n){return e.create(t,n,new s,7,l,!0)},t})(e.SettingsProcessor);__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f.SettingsManager]),__metadata("design:returntype",i)],c,"create",null);t.UserDirectorySettingsManager=c;s=(function(){function n(){this.favoriteDirectoriesList=r.observableArray();this.userDefaultDirectory=r.observable();this.signInToLastVisitedDirectory=r.observable(!0)}return n.create=function(n){return n.value},n})();__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c]),__metadata("design:returntype",s)],s,"create",null);t.UserDirectorySettings=s}));
define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function c(){s||(s=!0,e.uploadActionEndPoint.register(f.client,null,(function(n){return o().then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),e.getUploadInfosEndPoint.registerObjectFactory(f.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return o().then((function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)}))}}))}u.defineProperty(t,"__esModule",{value:!0});var f=r.Rpc,e=r.FileUpload,h="MsPortalImpl/Services/Services.FileUploadManager",o=i.memoizeQ((function(){return i.require(h).then((function(n){return n.fileUploadManagerInstance()}))})),s=!1;t.registerFileUploadEndpoints=c}));
define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f","o"],(function(n,t,i,r){"use strict";function e(n){u||(u=!0,t.uploadSettingsManager=n,Q(n.querySettings({store:12})).then((function(t){i.isEmpty(t)||f().then((function(t){return t.init(n)}))})))}r.defineProperty(t,"__esModule",{value:!0});var f=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/Services.FileUploadSettings").then((function(n){return n.fileUploadResumableTrackerInstance()}))})),u=!1;t.init=e}));
define("MsPortalImpl/Services/Services.SelectedSubscriptions",["require","exports","f","i","o","a","ko","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function it(){l=undefined;a=undefined;y=undefined}function d(n){var i=(n||[]).map((function(n){return n.subscriptionId})).join(";");t.userSettingsManager.setSetting(p,b,i)}function lt(n,t){var r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),i;if(r!==u){if(r===tt)return 1;if(u===tt)return-1}return i=n.displayName.localeCompareIgnoreCase(t.displayName),i===0&&(i=n.subscriptionId.localeCompareIgnoreCase(t.subscriptionId)),i}function w(n,t){var u=n||[],r=[],f;return t&&t.length&&(f=i.convertArrayToMap(t,(function(n){return n})),r=u.filter((function(n){return!!f[n.subscriptionId]}))),(r.length?r:u).stableSort(lt)}function at(n){it();t.userSettingsManager=n;var i=ct.getHubsWindowId();ht.getOrSetUserSettingsSelectedSubscriptionsEndPoint.register(c.client,[i],(function(n){return n&&d(n),t.userSettingsManager.querySetting(p,b).then((function(n){return n&&n.split(";")||[]}))}));g.Azure.getSelectedSubscriptionsInSessionEndPoint.register(c.client,null,(function(){return ut()}));t.selectedSubsUpdateTriggered.subscribe(new g.TriggerableLifetimeManager,(function(n){st.pingSelectedSubscriptionsListEndPoint.invoke(c.client,ot.ExtensionNames.Hubs,n)}))}function rt(){if(l)return Q(l);if(!y){var n=void 0;i.isFeatureEnabled("mgsubs")?(n=Q(v.getSelectedSubscriptions(c.client)),Q.spread([n,v.getAllSubscriptionsCount(c.client),],(function(n,i){return n=n||[],t.allSubscriptionsSelected(i.type===1&&n.length===i.value),l=n,n}))):n=Q(r.Azure.getAllSubscriptionsInternal()).then((function(n){return t.userSettingsManager.querySetting(p,b).then((function(i){var f=(i||"").split(";"),r=w(n,f),u;return t.allSubscriptionsSelected(n.length===r.length),r.length>t.selectedSubscriptionsCap&&(r=r.slice(0,t.selectedSubscriptionsCap),d(r),u=n.length,nt.ClientNotification.publish({status:nt.NotificationStatus.Information,title:k.cappedTitleFmt.format(t.selectedSubscriptionsCap,u),description:k.cappedFmt.format(t.selectedSubscriptionsCap,u),uri:"#menu/settings"})),l=r,r}))}));y=n.catch((function(n){return y=null,Q.reject(n)}))}return y}function ut(){return!a||!a.length?rt():Q(a)}function vt(n){return i.isFeatureEnabled("mgsubs")?v.processSelectedSubscriptionChanges(c.client,n).then((function(n){a=n.selectedSubscriptions})):t.getAllSubscriptionsInternal().then((function(t){a=w(t,n)}))}function yt(n){var r=i.isFeatureEnabled("mgsubs"),u=function(n,i){var u=n.length,f=u===i;l=n.slice(0);t.selectedSubsUpdateTriggered(l);r&&u>100&&(n.length=100);d(f?[]:n);t.allSubscriptionsSelected(f)};return r?Q.spread([v.processSelectedSubscriptionChanges(c.client,n),v.getAllSubscriptionsCount(c.client),],(function(n,t){u(n.selectedSubscriptions,t.value)})):t.getAllSubscriptionsInternal().then((function(t){var i=w(t,n);u(i,t.length)}))}var k,p,y,l,a;u.defineProperty(t,"__esModule",{value:!0});var ft=o.Keys,g=r,et=i.Base,ot=et.Constants,c=r.Rpc,st=s.SelectedSubscriptions,ht=s.Subscriptions,ct=r.Extension,nt=i.Hubs.Notifications,v=s.Impl,b=ft.subscriptionsSelected,tt="disabled";t.selectedSubscriptionsCap=60;k=h.SubscriptionsNotification;p=6;t.allSubscriptionsSelected=e.observable(!0);t.selectedSubsUpdateTriggered=e.observable();t.resetState=it;t.getValidSelectedSubscriptions=w;t.init=at;t.getSelectedSubscriptions=rt;t.getAllSubscriptionsInternal=i.memoizeQ((function(){return Q(r.Azure.getAllSubscriptionsInternal())}));t.getSelectedSubscriptionsInSession=ut;t.setSelectedSubscriptionsInSession=vt;t.setSelectedSubscriptions=yt}));
define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","i","o","FxInternal/Di"],(function(n,t,i,r,u){"use strict";r.defineProperty(t,"__esModule",{value:!0});var e=window,f=e.fx.environment.links;t.getSharedSettings=u.defineHandler(i.Extension.getSharedSettingsEndPoint,(function(){return{links:{accountPortal:f.accountPortal,classicPortal:f.classicPortal,createSupportRequest:f.createSupportRequest,helpAndSupport:f.helpAndSupport,manageSupportRequests:f.manageSupportRequests,submitAnIdea:f.submitAnIdea,privacyAndTerms:f.privacyAndTerms,learnRelatedResources:f.learnRelatedResources,resourceGroupOverview:f.resourceGroupOverview,roadmap:f.roadmap,filteringGranularity:f.filteringGranularity}}}))}));
define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function c(n){return o||(o=new f(n.desktop,n.rpcClient))}var u=r.ViewModels.ParameterCollectionV3,s=i.Base,h=s.Diagnostics,e,o,f;t.promiseCleanupDelay=3e4;e=h.createLog(n);t.create=c;f=(function(){function n(n,t){this._desktopManager=n;this.provisioningPromisesLookup={};this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n){var u=this,o=!0,f="Provisioning request is ",s,t,r,e;if(!n)throw new Error(f+" undefined.");if(s=n.provisioningRefKey,!s)throw new Error(f+"missing the provisioningReferenceKey.");if(!n.provisioningPromise)throw new Error(f+"missing the provisioningPromise.");return n.provisioningPromise.catch((function(n){var t=(n||{}).error||n;u._logWarning("Provisioning promise rejected. "+(t.message||JSON.stringify(t)))})),t=n.provisioningConfig,t&&!!t.dontDiscardJourney&&(o=!1),r=t&&t.launchPostCreate&&t.postCreateBladeInputs,r&&r.then((function(n){u._desktopManager.createJourneyForBlade({extension:i.Base.Constants.ExtensionNames.Hubs,detailBlade:"DeploymentDetailsBlade",detailBladeInputs:{id:n.deploymentId,packageId:n.galleryItemId,packageIconUri:n.galleryItemIconUri,primaryResourceId:n.primaryResourceId},openInContextPane:!1,defaultMenuItemId:undefined},u._desktopManager.generateLoadingJourneyGuid())})),o&&!r&&(e=this._desktopManager.getActiveJourney(),e&&this._desktopManager.forceDiscardJourney(e.id)),n.provisioningPromise},n.prototype._registerRpcCallbacks=function(n){var t=this;u.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var e=r.srcWindowId,f="Can't initiate the provisioning request. ";return i.provisionerId?i.provisioningRefKey?(u.getProvisioningRequestEndPoint.acquireObject(n,e,i).then((function(n){var i=n.getValue();t.processProvisioningRequest(i).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q(i)):Q.reject(f+"provisioningRefKey unspecified."):Q.reject(f+"provisionerId unspecified.")}});u.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){e.warning(n)},n})();t.ShellProvisionerImpl=f})(u||(u={})),u}));
define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r,u,f,e){"use strict";u.defineProperty(t,"__esModule",{value:!0});var c=i.Base,h=c.Constants,o=r.Rpc,s=(function(){function n(n,t){var i=this;this._extensionManager=n;this._extensions={};t.registerRpcEndPoint(h.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){i._extensions[o.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(){var n=this;this._extensionManager.onUnload((function(t){var i=r.Extension.getWindowId(t);return n._extensions[i]&&delete n._extensions[i],!0}))},n.prototype.trace=function(n){var t=n.extension,i=n.data&&n.data.srcExtension,r=h.TelemetrySharing.TraceTelemetry;this._extensions[t]&&o.client.invokeRpc(r,t,n);t!==i&&this._extensions[i]&&o.client.invokeRpc(r,i,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()},n})();s=__decorate([f.Class(),__metadata("design:paramtypes",[e.ExtensionManager,o.Client])],s);t.SharingTelemetryProcessor=s}));
define("MsPortalImpl/Services/Services.Util",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function c(n,t){var i="./Services.UtilHandlers";f(e.pinParts,i,"pinPartsRpcHandler",n,{desktop:t});f(e.getClientIp,i,"getClientIpHandler",n);f(e.getHmacSha256,i,"hmacShaRpcHandler",n);f(s,i,"x509CertificateRpcHandler",n);f(h,i,"getPublishingProfileRpcHandler",n,null,[""+o.ClassicResources,"fx"])}function f(t,r,u,f,e,o){return f.registerRpcEndPoint(t,{allowedOrigin:o,handler:function(t,f,o){return i.require(n.normalize(r)).then((function(n){var i=n[u];return i(t,f,o,e)}))}})}u.defineProperty(t,"__esModule",{value:!0});var e=r.Constants.RpcMethods,o=i.Base.Constants.ExtensionNames,s="MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",h="MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile";t.registerEndpoints=c}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","f","a","ko","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){var o=i.Base.Diagnostics,e=o.createLog(n),s;(function(n){function h(){var n=function(n){var t=n.propertyChanges||[],i=t.length===1&&t[0].propertyValue,r=(i||{}).hasOwnProperty("detailBladeInputs");return i&&!r&&e.error(o.invalidNewValue.format(n.sourceModelId,JSON.stringify(n))),r};return function(t){if(n(t)){var i=t.propertyChanges[0],r=i.propertyValue;i.propertyValue=r.detailBladeInputs}}}function c(){return function(n){var t,r,u=n.propertyChanges||[];if(u.length===1&&i.isPlainObject(u[0].propertyValue)){t=n.propertyChanges[0].propertyValue;n.propertyChanges=[];for(r in t)t.hasOwnProperty(r)&&n.propertyChanges.push(f.ObservableChangeArgs.forObject(r,t[r]))}}}function l(){var n=function(n,t){var i=!0;return r.isArray(t)?t.length!==1&&(i=!1):(e.error(s.invalidNewValue.format(n.sourceModelId,JSON.stringify(t))),i=!1),i};return function(t){var r=u.unwrap(f.getModelValue(t.sourceModel,t.sourceProperty).value)||[],i;n(t,r)?(i=t.propertyChanges[0],i.kind=0,i.propertyValue=r[0],i.propertyArrayEdits=null):t.cancel=!0}}function a(){var n=null,o=function(n,i){var u=!0;return!i||!i.propertyChanges||i.propertyChanges.length<1?(e.error(t.invalidPropertyChange.format(i.sourceModelId,JSON.stringify(i))),u=!1):r.isArray(i.propertyChanges[0].propertyValue)||i.propertyChanges[0].propertyArrayEdits&&i.propertyChanges[0].propertyArrayEdits.length>0?(e.error(t.invalidNewValue.format(i.sourceModelId,JSON.stringify(i))),u=!1):r.isArray(n)||(e.error(t.invalidCurrentValue.format(i.sourceModelId,n)),u=!1),u};return function(t){var s=u.unwrap(f.getModelValue(t.targetModel,t.targetProperty).value),r,h,e,c=function(n,t){return n.firstIndex((function(n){return i.deepEquals(n,t)}))};o(s,t)&&(h=n===undefined?-1:c(s,n),r=t.propertyChanges[0],e=u.unwrap(r.propertyValue),r.propertyArrayEdits=[],r.kind=1,h>=0&&n!==e&&r.propertyArrayEdits.push({status:"deleted",index:h,moved:null,value:n}),e!==undefined&&c(s,e)===-1&&r.propertyArrayEdits.push({status:"added",index:0,moved:null,value:e}),n=e);t.cancel=!r||!r.propertyArrayEdits||!r.propertyArrayEdits.length}}var o={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},s={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},t={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};n.getDynamicSelectionMapper=h;n.getModelToPropertyMapper=c;n.getManyToOne=l;n.getOneToManyMerge=a})(s=t.PropertyTransformers||(t.PropertyTransformers={}))})(e||(e={})),e}));
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","f","o","a","ko","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function tt(n){var t=Q();return{getStateAsyncSequenced:function(){return t=t.then(n,n)}}}var it;r.defineProperty(t,"__esModule",{value:!0});var w=FxImpl,b=w.TelemetryContext,k=i.Base,d=k.Diagnostics,c=e.ReferenceScope;t.onInputsSetTimeout=5e3;var v=window,y=i.trace,g=y.inputsset,nt=y.shellinputsset,l=d.createLog(n),p=e.extractTraceOptions,a=e.ReferenceCardinality;(function(n){function ut(n,t,i,r){var u=function(i,r){var u=t.mapProperty(i.source.property,i.targetProperty);u.transformers=ei(i);u.compositionBindingDefinition=i;r?u.bind(r.sourceModelName,r.sourceModel):at(n,u)};i&&i.forEach((function(n){var i=r&&r(n),o=n.source.constantValue,c,s,h;i&&i.overridesConstantBindings?u(n,i):o!==undefined?(c="[Constant: {0}]".format(f.toJSON(o)),s={},e.setModelValue(s,n.source.property,o),h=t.mapProperty(n.source.property,n.targetProperty),h.compositionBindingDefinition=n,h.bind(c,s)):u(n,i)}))}function yt(n,t,i){var r=(t||[]).every((function(n){return i&&e.getModelValue(i,n).exists}));return r||l.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(f.toJS(i))||"<null>")),r}function pt(n,t,i){var r=(t||[]).every((function(n){var t=i&&e.getModelValue(i,n);return t&&t.exists&&f.unwrap(t.value)!==undefined}));return r||l.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(f.toJS(i))||"<null>")),r}function wt(n){var r={},t,i;for(t in n)n.hasOwnProperty(t)&&(i=f.toJS(n[t]),r[t]=u.isArray(i)?f.observableArray(i):f.observable(i));return r}function ft(n,t,r){return i.mapMany(n||[],(function(n){return(n.valuesFrom||[]).map((function(i){var u={property:i.property,modelType:i.referenceType,constantValue:i.constantValue,scope:c.CurrentContainer,cardinality:n.valuesFrom.length>1?a.OneToMany:a.OneToOne},e={targetProperty:n.property,source:u,optional:!!n.optional,isIdentityInput:!!n.isIdentityInput},f=i.part,s=t.locator.name;return(i.referenceType===0||i.partCommand)&&(u.partLocator=t.locator.getExtensionLocator().withPartInstance(f||s),o.isPartComposition(t)&&(!f||f===s)&&(u.id=t.id)),i.referenceType===4&&(u.modelId=i.bladeCommand||i.partCommand),r&&r(e,i),e}))}))}function bt(n,t){return(t||[]).forEach((function(t){var i=t.source,r=i&&i.partLocator;r&&(i.partLocator=s.Locator.fromJSON(n,r))})),t}function kt(n){return(n||[]).map((function(n){var t={targetProperty:n.targetProperty};return n.source&&(t.sourceProperty=n.source.property,t.sourcePartLocator=n.source.partLocator&&n.source.partLocator.toString(),t.sourceType=o.referenceTypeMap[n.source.modelType]||n.source.modelType,t.sourceScope=c[n.source.scope],t.sourceCardinality=a[n.source.cardinality]),t}))}function et(n,t){var i=!1;return o.isPartComposition(n)&&!n.isDisposed()&&(i=t.id?n.id===t.id:n.eligibleForBinding&&n.locator.getExtensionLocator().withPartInstance(n.locator.name).equals(t.partLocator)),i}function dt(n){var t=ot(n);return t.inputsWatcherConfig&&k(t.inputsWatcherConfig),t}function ot(n){var i=[],t={allInputsSet:f.observable(!1),calledOnInputsSet:f.observable(!1),failedOnInputsSet:f.observable(!1),definitionBindings:[],propertyBindings:new e.PropertyBindings(n.bindableTarget.viewModelName,{},!1)};return st(n.referenceComposition,n.inputs,i,n.customInputBindingValidator)?(t.definitionBindings=ft(n.inputs,n.referenceComposition),ut(n.referenceComposition,t.propertyBindings,t.definitionBindings,n.customBindHandler),t.inputsWatcherConfig=w({bindableTarget:n.bindableTarget,allInputsSet:t.allInputsSet,calledOnInputsSet:t.calledOnInputsSet,failedOnInputsSet:t.failedOnInputsSet,propertyBindings:t.propertyBindings,referenceComposition:n.referenceComposition,referenceCompositionIsContainer:n.referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:n.beforeViewModelPropertyUpdate,inputsSetCalled:n.inputsSetCalled})):l.error("{0} Reference: {1}.".format(JSON.stringify(i),n.bindableTarget.viewModelName)),t}function gt(n){k(w(n))}function w(n){return i.extend2(n,{propertyBindingsState:undefined,inputsSetTrace:g,shellInputsSetTrace:nt,stateReader:!!n.getStateAsync&&tt(n.getStateAsync)})}function k(n){var t,i;if(y(n,null,n.calledOnInputsSet()),!n.allInputsSet()){t=fi(n.propertyBindings);n.referenceComposition.onDispose((function(){it(t)}))}i=n;i.onInputsSetDiagnosticsHandle=t;n.propertyBindings.addPropertyChangedHandler((function(){i.onInputsSetCallsSuppressed||y(n,t)}))}function st(n,t,i,r){var u,f=o.isPartComposition(n);return(t&&t.some((function(n){return n.property?n.valuesFrom&&n.valuesFrom.length===1?f||n.valuesFrom[0].referenceType!==0||n.valuesFrom[0].part?n.valuesFrom[0].referenceType===5&&n.valuesFrom[0].constantValue===undefined?u="'constantValue' must be defined if using 'Constant' reference type.":n.valuesFrom[0].constantValue!==undefined&&n.valuesFrom[0].referenceType!==5?u="'constantValue' can only be be defined when using 'Constant' reference type.":r&&(u=r(n)):u="Input binding that reference a Part must specify the source part name.":u="Input binding must define one and only one source valueFrom property.":u="Input binding must define a target property.",u||n.valuesFrom[0].referenceType!==4||(n.valuesFrom[0].bladeCommand||n.valuesFrom[0].partCommand?n.valuesFrom[0].bladeCommand&&n.valuesFrom[0].partCommand?u="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":n.valuesFrom[0].part&&(u="'part' is not allowed when using 'Command' reference type."):u="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!u})),u)?(i.push(u),!1):!0}function r(n,t){var r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"| "+t.map((function(n){return(n.toString()+"                    ").slice(0,15)})).join("")},i=["┌-----------",r("Optional","isBound","hasValue","Input: Value"),],u=t.properties.map((function(n){return"{0}{1}: {2}".format(r(d(n),n.isBound,n.targetHasValue),n.targetProperty,f.toJSON(n.targetHasValue?e.getModelValue(t.targetModel,n.targetProperty).value:undefined))}));i=i.concat(u);i.push("└-----------");l.verbose("{0} Target Model: {1}\n{2}".format(n,t.targetModelName,i.join("\n")))}function y(n,t,i,r,u,f){function o(t){var i;return t&&(t.dontCallViewModelOnInputsSet=u,b.usingState((function(){i=ii(n,t)}),n.referenceComposition.getCreationState())),f?i:undefined}var e=ht(n,t,i,!0,r);return e.then(o)}function ni(n){var t=n;t.onInputsSetCallsSuppressed=!0}function ti(n,t,i){var r;t===void 0&&(t=1);i===void 0&&(i=!1);r=n;r.onInputsSetCallsSuppressed=!1;var u=r.onInputsSetDiagnosticsHandle,f=!!(t&1),e=!!(t&2),o=!!(t&4);return y(n,u,f,e,o,i)}function ht(n,t,u,e,o){var a=!n.propertyBindings.properties.some(ui),h=p(n.bindableTarget.viewModelName,n.inputsSetTrace),c=h&&h.verbose,s,l;return a?(s=f.toJS(n.propertyBindings.targetModel),!e&&!i.canSendThroughPostMessage(s))?(n.propertyBindingsState=undefined,Q(null)):(it(t),!u&&n.notifyWhenInputsChangeWithSameValues||o||!i.deepEquals(s,n.propertyBindingsState)?(n.allInputsSet(!0),n.propertyBindingsState=s,l=void 0,l=n.beforeViewModelPropertyUpdate?n.beforeViewModelPropertyUpdate(s).then((function(t){if(t)return ct(n,h);c&&r("onInputsSet not called, RBAC check failed.",n.propertyBindings)})):ct(n,h),Q.all([l,n.getInputsMetadata&&n.getInputsMetadata()]).spread((function(t,i){var r={inputs:s,settings:t,traceOptions:h,viewModelName:n.bindableTarget.viewModelName,inputsMetadata:i,dontCallViewModelOnInputsSet:undefined,dashboardFilters:n.getDashboardFilters&&n.getDashboardFilters(),partFilters:n.getPartFilters&&n.getPartFilters()};return ri(n,r)?r:null}))):(c&&r("onInputsSet not called, new values are the same as current values.",n.propertyBindings),Q(null))):(c&&r("onInputsSet not called, missing required properties.",n.propertyBindings),n.propertyBindingsState=undefined,Q(null))}function ct(n,t){var f=n.referenceComposition,i,u;return(!f||!f.isDisposed())&&(i=n.bindableTarget,!i.viewModel||i.viewModel.updatePartInputValues)?(u=n.stateReader,u?u.getStateAsyncSequenced().then((function(n){return n||{}}),(function(){t&&t.verbose&&r("onInputsSet not called, failed to retrieve part settings.",n.propertyBindings);n.failedOnInputsSet(!0)})):Q({})):Q(null)}function ii(n,t){var u=n.bindableTarget.viewModel,f=t.inputs,e=t.settings,o=t.traceOptions,s=t.viewModelName,h=t.inputsMetadata,c=t.dontCallViewModelOnInputsSet,l=t.dashboardFilters,a=t.partFilters,v=i.extend2(l||{},a),r=u.updatePartInputValues(f,e,o,s,h,c,v);return lt(n,t,r),r}function ri(n,t){var s=t.inputs,e=t.settings,o=t.traceOptions,i,u;return e&&(!n.referenceComposition||!n.referenceComposition.isDisposed())?(i=n.bindableTarget.viewModelName,u=p(i,n.shellInputsSetTrace),o&&o.verbose&&r("onInputsSet will be called, all required properties are set.",n.propertyBindings),u&&(l.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(i,f.toJSON(s),f.toJSON(e))),!!u.breakOnInputsSet),!0):!1}function lt(n,t,i){n.calledOnInputsSet(!0);n.inputsSetCalled&&n.inputsSetCalled(t.inputs,i||Q({}))}function ui(n){return n.targetHasValue?!1:!d(n)}function d(n){var t=n.compositionBindingDefinition,r=t&&t.optional,i=t&&t.source,u=i&&i.scope===c.DetailsContainer,f=r||u;return!!f}function fi(n){var i={handle:v.setTimeout((function(){var t,r,u;it(i);t=[];r=[];n.properties.forEach((function(n){var i=d(n),u="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nOptional: {3}".format(n.targetProperty,n.isBound?n.sourceModelName():"<UNBOUND>",n.isBound?n.sourceProperty:"<UNBOUND>",i);n.targetHasValue||i?r.push(u):t.push(u)}));u="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";l.warning(u.format(n.targetModelName,t.join("\n\n"),r.join("\n\n")))}),t.onInputsSetTimeout)};return i}function it(n){n&&n.handle&&(v.clearTimeout(n.handle),n.handle=null)}function ei(n){var t=[];return n.source.cardinality===a.OneToMany?t.push(h.PropertyTransformers.getOneToManyMerge()):n.source.cardinality===a.ManyToOne&&t.push(h.PropertyTransformers.getManyToOne()),n.opensDynamicBlades&&t.push(h.PropertyTransformers.getDynamicSelectionMapper()),n.targetProperty||t.push(h.PropertyTransformers.getModelToPropertyMapper()),t}function at(n,t){if(!n.isDisposed()){var i=oi(n,t.compositionBindingDefinition.source),r=vt(n,i,t,t.compositionBindingDefinition.source);r(n,i,t,t.compositionBindingDefinition.source)}}function oi(n,t){var u=n.getPartsContainer(),i,r;switch(t.scope){case c.MasterContainer:i=u.masterContainer;break;case c.DetailsContainer:r=u.detailContainers.filter((function(n){return n&&!(n.flags&2)}));r.length>1?l.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(n.toString(),r.map((function(n){return n.toString()})).join(","))):i=r.first();break;default:i=u}return i}function vt(n,t,i,r){return t?r.partLocator?r.modelType===4&&i.compositionBindingDefinition.source.scope!==c.MasterContainer?ci:hi:li:si}function si(n,t,i){n.getPartsContainer().awaitContainer(n,(function(t){return ai(n.getPartsContainer(),t,i.compositionBindingDefinition.source)})).done((function(t){var r=vt(n,t,i,i.compositionBindingDefinition.source);r(n,t,i,i.compositionBindingDefinition.source)}))}function hi(n,t,i,r){t.awaitComposedPart(n,(function(n){return et(n,r)})).done((function(t){rt(n,t,i)}))}function ci(n,t,i){rt(n,n,i)}function li(n,t,i){rt(n,t.getBindableContainer(),i)}function ai(n,t,i){var r=t.masterContainer;return t.isDisposed()?!1:t.locator.type!==1?!1:i.scope===c.MasterContainer?n.masterContainer&&n.masterContainer.id===t.id:i.scope===c.DetailsContainer?r&&r.id===n.id&&n.detailContainers.length===1:r&&r.id===n.id}function rt(n,t,r){var h=r.compositionBindingDefinition.source,u=h.modelType,f=h.modelId,c="[Composition: {0}, ModelType:{1}, ModelId:{2}]".format(t.toString(),u,f||"<null>"),a,e,s;u===1||u===8?(a=t.getViewModel(u,f),r.bind(c,a)):i.tryImmediateResolve(t.getViewModelAsync(u,f),(function(n){t.isDisposed()||r.bind(c,n)}),(function(){n.isDisposed()||l.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(o.referenceTypeMap[u]||u,f||"<none>",t.toString(),r.sourceProperty))}));e=function(){r.unbind();t.offDispose(s)};s=function(){r.unbind();r.compositionBindingDefinition.autoRebindWhenSourceDisposes&&at(n,r);n.offDispose(e)};t.onDispose(s);n.onDispose(e)}n.setupPropertyBindings=ut;n.modelHasProperties=yt;n.modelHasPropertiesWithValue=pt;n.createObservableModel=wt;n.mapInputBindingDefinitions=ft;n.bindingsFromJSON=bt;n.mapBindingsToFriendlyObjects=kt;n.isSourcePart=et;n.bindViewModelInputs=dt;n.createBindViewModelResult=ot;n.setupAllInputsSetWatcher=gt;n.createAllInputsSetWatcherConfigExtended=w;n.setupAllInputsSetWatcherFromExtendedConfig=k;n.validateInputBindings=st;n.callOnInputsSetIfNeeded=y;n.turnOnInputsSetSuppressionOn=ni;n.turnOnInputsSetSuppressionOff=ti;n.loadOnInputsSetParameters=ht;n.notifyOnInputsSetCalled=lt})(it=t.CompositionBinder||(t.CompositionBinder={}))}));
define("MsPortalImpl/Parts/Parts.Error",["require","exports","f","o","MsPortalImpl/Parts/Parts","MsPortalImpl/Widgets/Widgets.PartError"],(function(n,t,i,r,u,f){"use strict";r.defineProperty(t,"__esModule",{value:!0});var e=i.Parts,o=e.PartKind,h=i.ViewModels,s=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return i.container.contentState(3),i.internal.allowUiBlocking(!1),f}return __extends(t,n),t.prototype._bindContent=function(n){var t=new f.ViewModel,i=this._viewModel.content,r;t.title=i().title||t.title;t.subtitle=i().subtitle||t.subtitle;t.reason=i().reason||t.reason;r=i().clickable;t.clickable=typeof r!="undefined"?r:t.clickable;this._lifetime.registerForDispose(new f.Widget($(n),t))},t})(u.PartImpl);u.registerFactory(o[e.PartKind.Error],u.createPartFactory("",{partClass:s}))}));
define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","i","o","ko","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r,u,f,e){"use strict";function v(n,t){return"{0}-{1}-{2}".format("editScopes",n,t)}function h(n){var t=n.split("-"),i=t.slice(1,t.length-1).join("-"),r=t[t.length-1];return{editScopeId:i,extension:r}}var o;r.defineProperty(t,"__esModule",{value:!0});var c=i,s=c.Data,l=c.Extension,y=i.Rpc,a=(function(){function n(n,t){var i=this;this._editScopes={};this._extensionManager=n;this._rpcClient=t;n.onUnload((function(n){var t=l.getWindowId(n);return i._onExtensionUnloaded(t),!0}))}return n.prototype.onEditScopeCreated=function(n){this._ensureEditScope(n,!0)},n.prototype.onEditScopeDisposed=function(n){var t=this,i=this._getDirtyExtensionSettings(n);i.forEach((function(i){var u=h(i.key).extension,f=l.getDescriptor(u),r=t._extensionManager.getExtension(f.name);r&&r.whenInitialized().then((function(){s.onEditScopeDiscardedEndPoint.invoke(t._rpcClient,r.getWindowId(),n)}))}));this._deleteEditScope(n)},n.prototype.getStateObservable=function(n){var r=this,t=this._ensureEditScope(n),i;return t.stateObservable||(i=u.observable(),t.stateObservable=u.pureComputed((function(){i();var u=r._getDirtyExtensionSettings(n).length>0;return u?t.savingRefCount()>0?2:1:0})),this._loadEditScope(n).then((function(){i(!0)}))),t.stateObservable},n.prototype.logEditsToConsole=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings;t&&t.extensionSettings().forEach((function(n){var t=h(n.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(t.editScopeId,t.extension));s.logEditsToConsole(n.settings)}))},n.prototype.loadEditScopeForExtension=function(n,t){var i=this;return this._loadEditScope(n).then((function(){var f=i._editScopes[n],r,e,u;return f?(r=f.settings,r?(e=v(n,t),u=r.extensionSettings().first((function(n){return n.key===e})),u?u.settings:null):null):null}))},n.prototype.saveEditScopeForExtension=function(n,t,i){var r=this._editScopes[n],u,f,e;this._canEditScopeBeUpdated(r)&&(u=v(n,t),f=r.settings.extensionSettings().firstIndex((function(n){return n.key===u})),f<0?r.settings.extensionSettings.push({key:u,settings:i}):(e=r.settings.extensionSettings()[f],e.settings=i,r.settings.extensionSettings.splice(f,1,e)),r.settings.keys.indexOf(u)<0&&r.settings.keys.push(u))},n.prototype.updateEditScopeIsSavingStateForExtension=function(n,t,i){var r=this._editScopes[n],u;r&&(u=r.savingRefCount()||0,i?r.savingRefCount(u+1):u>0&&r.savingRefCount(u-1))},n.prototype.trackingEditScope=function(n){return!!this._editScopes[n]},n.prototype._canEditScopeBeUpdated=function(n){return n?!!n.loadPromise:!1},n.prototype._deleteEditScope=function(n){delete this._editScopes[n]},n.prototype._loadEditScope=function(n){var t=this._ensureEditScope(n);return t.justCreated&&(t.settings={keys:[],extensionSettings:u.observableArray()},t.loadPromise=Q(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(n)),t.loadPromise},n.prototype._getAndProcessSettings=function(n){return this._editScopes[n].settings={keys:[],extensionSettings:u.observableArray()},Q()},n.prototype._getDirtyExtensionSettings=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings,i=t&&t.extensionSettings().filter((function(n){var t=n.settings;return t&&t.edits.length>0}));return i||[]},n.prototype._onExtensionUnloaded=function(n){var i,t,r,u;for(i in this._editScopes)t=this._editScopes[i],r=t.savingRefCount()>0,r&&(u=t.settings&&t.settings.extensionSettings().some((function(t){return n===h(t.key).extension&&t.settings.edits.length>0})),u&&(this._clearEditScopeEdits(i),t.savingRefCount(0)))},n.prototype._clearEditScopeEdits=function(n){var i=this._editScopes[n],t;this._canEditScopeBeUpdated(i)&&(t=i.settings&&i.settings.extensionSettings,t().forEach((function(n){n.settings=null})),t(t()))},n.prototype._ensureEditScope=function(n,t){t===void 0&&(t=!1);var i=this._editScopes[n];return i||(i=this._editScopes[n]={savingRefCount:u.observable(0),justCreated:t}),i},n})();t.EditScopeManagerImpl=a;o=(function(){function n(){}return n.create=function(n,t){return new a(n,t)},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e.ExtensionManager,y.Client]),__metadata("design:returntype",o)],o,"create",null);t.EditScopeManager=o;t.loadSerializedEditScope=f.defineHandler(s.loadSerializedEditScopeEndPoint,(function(n){return n.diContainer.get(o).loadEditScopeForExtension(n.messageArg,n.messageContext.srcWindowId)}));t.saveSerializedEditScope=f.defineHandler(s.saveSerializedEditScopeEndPoint,(function(n){n.diContainer.get(o).saveEditScopeForExtension(n.messageArg.editScopeId,n.messageContext.srcWindowId,n.messageArg.edits)}));t.updateEditScopeIsSavingState=f.defineHandler(s.updateEditScopeIsSavingStateEndPoint,(function(n){n.diContainer.get(o).updateEditScopeIsSavingStateForExtension(n.messageArg.editScopeId,n.messageContext.srcWindowId,n.messageArg.isSaving)}))}));
define("MsPortalImpl/Interactions/Interactions.Command",["require","exports","f","o","ko","$"],(function(n,t,i,r,u,f){"use strict";var e,o,s;r.defineProperty(t,"__esModule",{value:!0});e=(function(){function n(n,t){this.target=n;this.getFormTarget=t}return n})();t.CommandContext=e;o=(function(){function n(n,t){this.accept=n;this.maxFiles=t;this.files=u.observable(null)}return n})();t.FileInputOptions=o;s=(function(){function n(n,t,r){var o=this,e;this._ariaLabel=u.observable();this._inheritIcon=u.observable();this.fxEnabled=u.observable(!0);this.hasPopup=u.observable(!1);this.ariaLabel=this._ariaLabel;this.enabled=u.observable(!0);this.visible=u.observable(!0);this.unauthorized=u.observable(!1);this.pressed=u.observable();this.fileInputOptions=u.observable(null);this.tooltip=u.observable();this.isShellCommand=!1;e=this._ltm=n.createChildLifetime();this.text=u.isObservable(t)?t:u.observable(t?t:"");this.enabled(r!==undefined?r:!0);this.icon=u.computed(e,{read:this._inheritIcon,write:function(n){return o._inheritIcon(n&&i.extend2(n,{options:f.extend({palette:99},n.options)}))}})}return r.defineProperty(n.prototype,"canRebind",{get:function(){return!0},enumerable:!0,configurable:!0}),n.prototype.activate=function(){},n.prototype.execute=function(){},n.prototype.bind=function(n){var t=n&&n.getFormTarget;n.getFormTarget=function(){return t().then((function(t){if(t&&typeof t.showForm!="function")throw new Error("invalid context"+JSON.stringify(n,(function(n,t){return""+n+typeof t})));return t}))};this._currentContext=n},n.prototype.dispose=function(){this._ltm.dispose()},n})();t.CommandImpl=s}));
define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports","i","o","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";function v(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null}function p(){var n={width:0,height:0,top:e.targetY,left:e.targetX};o.css(n);u.querySelectorAll("body").append(o);o.animate({width:s,height:s,top:"-="+(s/2+5),left:"-="+s/2},75)}function w(n){if(n){var t={opacity:.2},i={opacity:1};o.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}o.animate({width:0,height:0,top:"+="+s/2,left:"+="+s/2},75,(function(){o.detach()}))}function c(n,t){t.off(h);l.clearTimeout(a);w(n);e={startTime:0,target:null,targetX:0,targetY:0}}function b(n){c(!0,u(n.currentTarget))}function k(n){var i=v(n)||{clientX:0,clientY:0},r=Math.abs(e.targetX-i.clientX),f=Math.abs(e.targetY-i.clientY);(r>t.MoveTolerancePixels||f>t.MoveTolerancePixels)&&c(!0,u(n.currentTarget))}function d(n){var r=u(n.currentTarget),o,i;e.startTime&&(o=Math.abs(Date.now()-e.startTime),o>=t.ReactionDelayMillis&&(r.off(f.default.contextmenu+h),i=u.Event(f.default.contextmenu),i.clientX=e.targetX,i.clientY=e.targetY,u(e.target).trigger(i)));c(!1,r)}function y(n){var i=v(n),r=u(n.currentTarget);if(!i){c(!0,r);return}if(!e||e.startTime===0){e={startTime:Date.now(),target:n.target,targetX:i.clientX,targetY:i.clientY};a=l.setTimeout((function(){p()}),t.ReactionDelayMillis);r.on(f.default.contextmenu+h,(function(){return!1})).on(f.default.touchmove+h,k).on(f.default.touchcancel+h,b).on(f.default.touchend+h,d)}}function g(n){n.on(f.default.touchstart,y)}function nt(n){n.off(f.default.touchstart,y);c(!0,n)}var l;r.defineProperty(t,"__esModule",{value:!0});l=window;t.ReactionDelayMillis=550;t.MoveTolerancePixels=10;t.HintClassIdentifier="fxs-contextMenuTouchHint";var o=u(i.createElement("div",{"class":t.HintClassIdentifier})),s=110,h=".cmtevt",a,e={startTime:0,target:null,targetX:0,targetY:0};t.register=g;t.unregister=nt}));
define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","o","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(n){var t=n.currentTarget,r;t.offsetWidth<t.scrollWidth&&t.getBoundingClientRect().width===t.offsetWidth&&!t.title&&(r=$(t),r.attr("title",r.text()).addClass(i))}function f(n){var t=$(n.currentTarget);t.hasClass(i)&&t.removeAttr("title").removeClass(i)}function e(n){n.on(r.default.mouseover,t,u).on(r.default.mouseleave,t,f)}function o(n){n.off(r.default.mouseover,t,u).off(r.default.mouseleave,t,f)}var t=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",i="fxs-autotooltip";n.register=e;n.unregister=o})(u||(u={})),u}));
define("MsPortalImpl/Svg/Startup/Close.svg",[],(function(){"use strict";return{type:55,data:"<svg viewBox='0 0 15.8 15.8' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.7 7.9l7.1 7.1-.8.8-7.1-7.1-7.1 7.1L0 15l7.1-7.1L0 .8.8 0l7.1 7.1L15 0l.8.8z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DoubleChevron.svg",[],(function(){"use strict";return{type:345,data:"<svg viewBox='0 0 8 8.4' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4 3.7l-4 4 .7.7L4 5l3.3 3.4.7-.7-4-4z'/><path d='M4 0L0 4l.7.7L4 1.4l3.3 3.3L8 4 4 0z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","ko","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r){"use strict";var u;return (function(n){var t="Not implemented in base class.",f=(function(n){function r(t){var r=n.call(this)||this;return r.locked=i.observable(!0),r.id=t,r}return __extends(r,n),r.prototype.getViewSettings=function(){throw new Error(t);},r.prototype.applyViewSettings=function(){throw new Error(t);},r})(r.ViewModel),u;n.ViewModel=f;u=(function(n){function i(t,r){var u=n.call(this,t,r)||this;if(!r.id||typeof r.id!="string")throw new Error("An unique identifier is required and it must be a string.");return i.attachId(t,r.id),u}return __extends(i,n),i.prototype.dispose=function(){i.detachId(this.element);n.prototype.dispose.call(this)},i.attachId=function(n,t){n.data(i._fxsIdKey,t)},i.detachId=function(n){n.removeData(i._fxsIdKey)},i.getId=function(n){return n.data(i._fxsIdKey)},i.prototype.addChild=function(){throw new Error(t);},i.prototype.insertChild=function(){throw new Error(t);},i.prototype.removeChild=function(){throw new Error(t);},i.prototype.moveChild=function(){throw new Error(t);},i.prototype.saveViewSettings=function(){throw new Error(t);},i.prototype.setSize=function(){throw new Error(t);},i.prototype.discardStateOfUnusedChildren=function(){return{stateDiscarded:!1}},i})(r.Widget);u.viewSettingsChanged="viewSettingsChanged";u.errorEvent="widgetError";u._fxsIdKey="fxsId";n.Widget=u})(u||(u={})),u}));
define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Svg/Startup/DoubleChevron.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var it;u.defineProperty(t,"__esModule",{value:!0});var w=o.findByClassName,et=i.Base,b=c.ContextPane,d="fxs-contextpane",rt="fxs-contextpane-title",y="fxs-contextpane-close",p="fxs-contextpane-expand",k="fxs-contextpane-loadindicator",ut="fxs-contextpane-button-inner",g="fxs-contextpane-content",nt="fxs-portal-bg-txt-br",tt="fxsContextPaneTitle",ft=(function(n){function t(){var t=n.call(this,"fxs-contextpane-identifier")||this;return t.opened=f.observable(!1),t.loading=f.observable(!1),t}return __extends(t,n),t})(a.ViewModel);t.ViewModel=ft;it=(function(n){function t(t,i){var u=n.call(this,t,i)||this;return t.addClass(d).addClass(nt).attr("role","complementary").attr("aria-labelledby",tt).append(r.createElement("button",{"class":p+" fxs-display-none",type:"button"},r.createElement("div",{"class":ut+" fxs-portal-svg"},e.getSvgReferenceOrFallBackToData(h,{palette:99}))),r.createElement("button",{"class":y+" fxs-display-none fxs-portal-svg",type:"button",title:b.close},e.getSvgReferenceOrFallBackToData(s,{palette:99})),r.createElement("div",{"class":k},r.createElement("fxs-progress"))),u._$closeButton=w(t,y),u._$expandButton=w(t,p),u._$progress=w(t,k),u._init(),u._attachEventHandlers(i),f.applyBindingsToDescendants({},w(t,k)[0]),u}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(d,nt);this.element.removeAttr("role");n.prototype.dispose.call(this)},t.prototype.hasContent=function(){return!!this._$content},t.prototype.addChild=function(n){var t,i;if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);t=this._$content=n.element?n.element:n;t.addClass(g).insertBefore(this._$progress);l.waitForBindings(t[0]).then((function(){var n=t.find("."+rt+", .fxs-blade-title-titleText");n.attr("id",tt)}));i=!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container");o.toggle(this._$closeButton,i);o.toggle(this._$expandButton,t.hasClass("fxs-partgallery-container"))},t.prototype.insertChild=function(n){this.addChild(n)},t.prototype.removeChild=function(n,t){var i=this._$content;return i?(t?i.detach():i.remove(),i.removeClass(g),this._$content=null,!0):!0},t.prototype.clear=function(){return this.removeChild(null)},t.prototype.setFocus=function(){var t=this,n;i.isFeatureEnabled("skipautofocus")||(n=this._$content,n&&l.waitForBindings(this.element[0]).then((function(){var i=n.findFirstTabbable();i.length===0&&(i=t.element.find("."+y));i.focus()})))},t.prototype._init=function(){var n=this.ltm,t=this.element,i=this.options;f.reactor(n,(function(){t.toggleClass("fxs-contextpane-visible",i.opened())}));f.reactor(n,(function(){t.toggleClass("fxs-contextpane-loading",i.loading())}))},t.prototype._attachEventHandlers=function(n){var t=this,i,r;this.element.findByClassName(y).on(v.default.click,i=function(){t.element.trigger(v.default.fxcontextpaneclosing)});this.element.findByClassName(p).on(v.default.click,r=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribeAndRun(this.ltm,(function(n){t.element.findByClassName(p).attr({title:n?b.expand:b.collapse,"aria-expanded":!n})}));this.ltm.registerForDispose((function(){t.element.findByClassName(y).off(v.default.click,i);t.element.findByClassName(p).off(v.default.click,r)}))},t})(a.Widget);t.Widget=it}));
define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","$","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function f(n,f,e){function l(){n.removeClass(t);var i=f();i&&i.forEach((function(n){n.dispose()}));o&&(n.off(u.default.fxcontextmenurequest,o),o=null);s&&(n.off(u.default.keydown,s),s=null);h&&(n.off(u.default.remove,h),h=null)}function a(n){var t=f();t&&t.length>0&&(n.preventDefault(),n.stopPropagation(),v(n.clientX,n.clientY))}function v(t,r){var e=i.Event(u.default.fxcontextmenu);e.clientX=t;e.clientY=r;c||(c=n.hasClass("fxs-bladecontent")?n:null);n.trigger(e,{commands:f(),formTarget:c,srcElement:n[0]})}var c=e&&e.formTarget,o,s,h;n.addClass(t);n.on(u.default.fxcontextmenurequest,o=function(n){a(n)});n.on(u.default.keydown,s=function(n){if(n.which===121&&r.getModifierKeys(n)===4){var t=n.target.getClientRects()[0];n.clientX=t&&t.left;n.clientY=t&&t.top;a(n)}});n.on(u.default.remove,h=l);return{dispose:l}}var t="fx-rightClick";n.setup=f})(f||(f={})),f}));
define("MsPortalImpl/Svg/Startup/Add.svg",[],(function(){"use strict";return{type:325,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M16 7.5v1H8.5V16h-1V8.5H0v-1h7.5V0h1v7.5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/CaretDown.svg",[],(function(){"use strict";return{type:286,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M11 3.9l-.7-.8L6 7.4 1.7 3.1l-.7.8 5 5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Clone.svg",[],(function(){"use strict";return{type:76,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M15 6.3V16H5v-3H1V0h6.7l3 3h1zM5 3h4.3l-2-2H2v11h3zm9 4h-3V4H6v11h8zm-2-1h1.3L12 4.7z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Customize.svg",[],(function(){"use strict";return{type:314,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M16 2.6a3 3 0 0 1-.2 1 2.4 2.4 0 0 1-.6.9L4.9 14.8 0 16l1.2-4.9L11.5.8a2.4 2.4 0 0 1 .9-.6l1-.2 1 .2a1.6 1.6 0 0 1 .8.6 1.6 1.6 0 0 1 .6.8 3.6 3.6 0 0 1 .2 1zm-14.6 12l2.5-.6a1.4 1.4 0 0 0-.2-.7l-.4-.6-.6-.4-.7-.2zm1.1-3.4A2.8 2.8 0 0 1 4 12a2.8 2.8 0 0 1 .8 1.5L13.3 5 11 2.7zM14 4.3l.4-.4.3-.3c.1-.2.2-.3.2-.5a.7.7 0 0 0 .1-.5 1.3 1.3 0 0 0-.1-.6 1 1 0 0 0-.4-.5 1 1 0 0 0-.5-.4h-1.1l-.5.2-.3.3-.4.4z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Download.svg",[],(function(){"use strict";return{type:174,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12.9 8.4L8 13.2 3.1 8.4l.8-.8 3.6 3.7V0h1v11.3l3.6-3.7zM3.5 16v-1h9v1z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Filter.svg",[],(function(){"use strict";return{type:326,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M0 1h16v1.711l-6 6V15H6V8.711l-6-6V1zm15 1.289V2H1v.289l6 6V14h2V8.289l6-6z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Fullscreen.svg",[],(function(){"use strict";return{type:323,data:"<svg viewBox='0 0 14 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 0v5h-1V1.71L1.71 13H5v1H0V9h1v3.29L12.29 1H9V0z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Share.svg",[],(function(){"use strict";return{type:324,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.9 10.4l.4.4.4.5a1.4 1.4 0 0 1 .2.6 1.3 1.3 0 0 1 .1.6 3.6 3.6 0 0 1-.2 1 3.5 3.5 0 0 1-.5.8l-.8.5-1 .2a2 2 0 0 1-1.3-.4 5.4 5.4 0 0 1-2 1A5.4 5.4 0 0 1 8 16a5.7 5.7 0 0 1-2.2-.4 5.4 5.4 0 0 1-2-1 2 2 0 0 1-1.3.4l-1-.2-.8-.5a3.5 3.5 0 0 1-.5-.8 3.6 3.6 0 0 1-.2-1 1.3 1.3 0 0 1 .1-.6 1.4 1.4 0 0 1 .2-.6l.4-.5c.1-.2.3-.3.4-.4a1.7 1.7 0 0 0-.1-.7V9a7.6 7.6 0 0 1 .3-2.1A6.6 6.6 0 0 1 2.2 5l1.5-1.5a5.2 5.2 0 0 1 1.8-1 3 3 0 0 1 .2-1 2.2 2.2 0 0 1 .5-.8L7 .2 8 0l1 .2.8.5a2.2 2.2 0 0 1 .5.8 3 3 0 0 1 .2 1 5.2 5.2 0 0 1 1.8 1L13.8 5a6.6 6.6 0 0 1 .9 1.9A7.6 7.6 0 0 1 15 9v.7a1.7 1.7 0 0 0-.1.7zM1 12.5a1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3H1.9l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6zM8 15a5.7 5.7 0 0 0 1.8-.3 4.8 4.8 0 0 0 1.6-.8l-.3-.7a1.5 1.5 0 0 1-.1-.7 3.6 3.6 0 0 1 .2-1 3.5 3.5 0 0 1 .5-.8l.8-.5 1-.2h.4a3.4 3.4 0 0 0 .1-1 5.7 5.7 0 0 0-.3-1.8 4.1 4.1 0 0 0-.7-1.5 4.9 4.9 0 0 0-1.2-1.3 3.8 3.8 0 0 0-1.5-.9l-.4.6c-.1.2-.3.3-.5.5l-.7.3H7.3l-.7-.3-.5-.5-.4-.6a3.8 3.8 0 0 0-1.5.9A4.9 4.9 0 0 0 3 5.7a5.1 5.1 0 0 0-.7 1.5A5.7 5.7 0 0 0 2 9a3.4 3.4 0 0 0 .1 1h1.1l.9.5a2.7 2.7 0 0 1 .7.8 4.3 4.3 0 0 1 .2 1.2 1.5 1.5 0 0 1-.1.7l-.3.7a4.8 4.8 0 0 0 1.6.8A5.7 5.7 0 0 0 8 15zM8 1h-.6l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3h1.2l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3zm5.5 13h.6l.5-.3.3-.5a1.3 1.3 0 0 0 .1-.6 1.3 1.3 0 0 0-.1-.6l-.3-.5-.5-.3h-1.2l-.5.3-.3.5a1.3 1.3 0 0 0-.1.6 1.3 1.3 0 0 0 .1.6l.3.5.5.3z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/TrashOutline.svg",[],(function(){"use strict";return{type:327,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.5 3h-1v11.5a1.3 1.3 0 0 1-.1.6l-.3.5-.5.3H3.4l-.5-.3-.3-.5a1.3 1.3 0 0 1-.1-.6V3h-1V2h4V1a.6.6 0 0 1 .1-.4l.2-.3.3-.2h3.8l.3.2.2.3a.6.6 0 0 1 .1.4v1h4zm-2 0h-9v11.5a.6.6 0 0 0 .1.4h8.8a.6.6 0 0 0 .1-.4zm-6 10h-1V5h1zm0-11h3V1h-3zm2 11h-1V5h1zm2 0h-1V5h1z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Upload.svg",[],(function(){"use strict";return{type:121,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12.9 7.6l-.8.8-3.6-3.7V16h-1V4.7L3.9 8.4l-.8-.8L8 2.8zM12.5 0v1h-9V0z'/><\/g><\/svg>"}}));
define("_generated/Templates/WidgetsDropMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-dropmenu" role="presentation"> <button class="fxs-dropmenu-button" aria-haspopup="true" aria-expanded="false"><\/button> <div class="fxs-dropmenu-content fxs-text-link" role="menu"><\/div> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","f","i","o","ko","$","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsDropMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","Fx/Telemetry","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var k;u.defineProperty(t,"__esModule",{value:!0});var v="fxs-dropmenu-button",y="fxs-dropmenu-hidden",p="fxs-dropmenu-is-open",w="fxs-dropmenu-invisible",d="fxs-popup-button",g="fxs-popup",nt="fxs-portal-bg-txt-br",b="aria-label",tt=(function(n){function t(t,i,r,u,e){var o=n.call(this)||this;return o.isMenuOpen=f.observable(!1),o.buttonLabel=f.observable(),o.buttonTooltip=f.observable(),o.menuLabel=f.observable(),o.buttonTemplate=t,o.menuTemplate=i,o.togglesVisibility=!!u,o.itemSelector=r,o.telemetrySource=e,o}return __extends(t,n),t.prototype.open=function(){this.isMenuOpen(!0)},t.prototype.close=function(){this.isMenuOpen(!1)},t.prototype.toggle=function(){this.isMenuOpen(!this.isMenuOpen.peek())},t})(s.ViewModel);t.ViewModel=tt;k=(function(n){function t(t,u){var o=n.call(this,t,u)||this,p=o.ltm,k=i.getUniqueId(),l=o._dropMenu=e(r.createElement("div",{trustedInnerHTML:h()}).children[0]),ut=o._dropMenuButton=l.findByClassName(v).addClass(u.buttonClass).addClass(d).html(u.buttonTemplate).attr("aria-controls",k),y=o._dropMenuContent=l.findByClassName("fxs-dropmenu-content").html(u.menuTemplate).attr("id",k).addClass(g).addClass(nt),tt,it,s,w,rt;y.addClass(u.alignMenu===0?"fxs-dropmenu-right":"fxs-dropmenu-left");t.append(o._dropMenu);f.reactor(p,u.isMenuOpen,(function(n){n?(!u.telemetrySource||a.trace({source:u.telemetrySource,action:"DropMenuOpened"}),o._show()):o._hide()}));f.reactor(p,(function(){ut.attr("title",u.buttonTooltip()).attr(b,u.buttonLabel());y.attr(b,u.menuLabel())}));s=c.default.click;w=c.default.contextmenu;l.on(s,"."+v,tt=function(n){n.preventDefault();u.toggle()});y.on(s,"a",it=function(){u.close()});t.on(w,rt=function(){if(u.isMenuOpen())return!1});return p.registerForDispose((function(){l.off(s,"."+v,tt);y.off(s,"a",it);t.off(w,rt)})),o}return __extends(t,n),t.prototype._show=function(){var n=this,t,i,u,r;this._dropMenuButton.attr("aria-expanded",!0);this._dropMenuContent.removeClass(w+" "+y).addClass(p).attr("aria-hidden",!1);this._dismissHandle||(t=function(t){return e.contains(n._dropMenu[0],t)?0:2},this._dismissHandle={dismissFn:function(){n.options.close()},shouldDismissOnFocusOutFn:function(){return e.contains(n._dropMenu[0],document.activeElement)?0:1},shouldDismissOnMouseDownFn:t,shouldDismissOnMouseWheelFn:t,restoreFocus:function(){n._dropMenuButton[0].focus()},logName:"dropMenu"});i=this.element.find(".fxs-dropmenu-content");(!this._dismissLifetime||this._dismissLifetime.isDisposed())&&(u=this._dismissLifetime=this.ltm.createChildLifetime(),r=this._dismissHandle,o.register(r),new l.KeyboardNavigation(this._dismissLifetime,{element:i,tabTriggers:12,itemSelector:this.options.itemSelector}),u.registerForDispose([function(){o.unregister(r)},]));this.options.setItemFocusWhenOpen&&i.focus()},t.prototype._hide=function(){this._dropMenuButton.attr("aria-expanded",!1);this._dropMenuContent.addClass(this.options.togglesVisibility?w:y).removeClass(p).attr("aria-hidden",!0);this._dismissLifetime&&this._dismissLifetime.dispose()},t.prototype.setFocus=function(){this._dropMenuButton.focus()},t})(s.Widget);t.Widget=k}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSize",["require","exports","f","o","$"],(function(n,t,i,r,u){"use strict";function h(n,t,i){return n<0?-1:n===0?0:Math.max(0,n*t+(n-1)*i)}function c(n,t){return{width:h(n,f.CellWidth,f.CellSpacingWidth),height:h(t,f.CellHeight,f.CellSpacingHeight)}}function l(n,t,i){return Math.ceil(n/(t+i))}function p(n,t){return{colSpan:l(n,f.CellWidth,f.CellSpacingWidth),rowSpan:l(t,f.CellHeight,f.CellSpacingHeight)}}function w(n,t){var i=function(n){return Math.ceil(Math.min(Math.max(n,1),25))};return c(i(n),i(t))}function b(n,r){var f=i.find(t.AllSizes,(function(t){var i=t&&t.size;return t&&i.width===n&&i.height===r}));return f||(f=e(99),f.size={width:n,height:r},f.span=p(n,r)),u.extend(!0,{},f)}function k(){return e(2)}function e(n){return u.extend(!0,{},i.find(t.AllSizes,(function(t){return t&&t.name===n})))}function o(n){return function(t){return t===n}}function d(n){var t=o(n);return a.some(t)}function g(n){var t=o(n);return v.some(t)}function nt(n){var t=o(n);return y.some(t)}var s,f,a,v,y;r.defineProperty(t,"__esModule",{value:!0});s=i.Parts;f=i.Widgets.AzureGrid;t.AllSizes=(function(){var t=[],n=function(n,i,r){t[n]={name:n,css:"fxs-tilesize-"+s.InternalPartSize[n].toLowerCase(),size:c(i,r),span:{colSpan:i,rowSpan:r}}};return n(0,1,1),n(1,2,1),n(2,2,2),n(3,4,2),n(4,2,4),n(5,6,4),n(6,4,6),n(7,6,0),n(8,-1,0),n(9,-1,-1),n(10,4,4),n(11,6,6),n(99,0,0),t})();t.AllCssClasses=t.AllSizes.map((function(n){return n.css}));t.getGridPixelSize=w;t.getCorrespondingStandardSize=b;t.getDefaultSize=k;t.getSize=e;a=[0,1,2,3,4,10,5,6,11,99,];t.isFixedSize=d;v=[7,8,9,];t.isVariableSize=g;y=[8,9,];t.isAdaptiveWidth=nt}));
define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports","o","ko","MsPortalImpl/Widgets/Widgets.UIElementBase"],(function(n,t,i,r,u){"use strict";var o,e,f;i.defineProperty(t,"__esModule",{value:!0}),(function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical"})(o=t.Orientation||(t.Orientation={}));e=(function(n){function t(t){var i=n.call(this,t)||this;return i.positionUpdatedSignal=r.observable(0),i.positions=[],i}return __extends(t,n),i.defineProperty(t.prototype,"positions",{get:function(){return this._positions},set:function(n){this._positions=n?n:[]},enumerable:!0,configurable:!0}),t})(u.ViewModel);t.ViewModel=e;f=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(u.Widget);f.layoutUpdatedEventName="layoutUpdated";t.Widget=f}));
define("_generated/Templates/WidgetsContextMenu",["require","exports"],(function(){"use strict";return function(){return'<ul role="menu" class="fxs-contextMenu-itemList" data-bind="foreach: { data: commands, afterRender: afterRender }, attr: { \'aria-label\': ariaLabel }"> <li role="menuitem" class="fxs-contextMenu-item fxs-command-like-button" data-bind="css: { \'fxs-portal-hover\': enabled, \'fxs-contextMenu-itemDisabled fxs-command-like-button-disabled\': !enabled(), \'fxs-contextMenu-extensioncommand\': !!$data._extension }, attr: { title: $data.tooltip(), \'aria-disabled\': !enabled(), \'aria-label\': ariaLabel, \'aria-posinset\': $index() + 1, \'aria-setsize\': $parent.commands().length }" tabindex="0"> <div class="fxs-contextMenu-text msportalfx-text-ellipsis" data-bind="text: text"><\/div> <div class="fxs-contextMenu-icon" data-bind="image: icon"><\/div> <\/li> <\/ul>'}}));
define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsContextMenu","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function y(n,t){return t||ft.error("ContextMenuViewModel."+n+" is not accessible. Please call registerForCleanup first."),t}function tt(n){return n.isShellCommand}var rt=i.Base,ut=rt.Diagnostics,w=window,ft=ut.createLog(n),b="fxs-contextMenu",k="fxs-contextMenu-active",d="fxs-contextMenu-item",et="fxs-contextMenu-itemDisabled",g="fxs-popup",nt="fxs-portal-bg-txt-br",p=(function(n){function t(){var t=n.call(this)||this;return t.visible=u.observable(!1),t.menuItems=u.observableArray(),t.topOffsetCorrection=0,t}return __extends(t,n),t.prototype.getOrderedMenuItemsCommandsComputed=function(){return y("orderedMenuItemsCommands",this._orderedMenuItemsCommands)},t.prototype.getOrderedMenuItemsComputed=function(){return y("orderedMenuItems",this._orderedMenuItems)},r.defineProperty(t.prototype,"hasVisibleCommands",{get:function(){return y("hasVisibleCommands",this._hasVisibleCommands)},enumerable:!0,configurable:!0}),t.prototype.registerForCleanup=function(n){var t=this,r=this.menuItems,i=this._ltm=n.createChildLifetime(),f=this._orderedMenuItemsCommands=r.filter(i,(function(n){return n.visible()&&!tt(n)&&!n.hasPopup()})),e=this._orderedMenuItems=r.filter(i,(function(n){return n.visible()&&tt(n)&&n.enabled()}));this._hasVisibleCommands=u.computed(i,(function(){return f().length+e().length>0}));i.registerForDispose((function(){t._ltm=t._orderedMenuItemsCommands=t._orderedMenuItems=t._hasVisibleCommands=null}))},t})(l.ViewModel),it;t.ViewModel=p;it=(function(n){function t(t,i){var r=n.call(this,t,i&&i instanceof p?i:new p)||this;r._lastShowArgs=u.observable(null);i=r.options;var h=r.ltm,c=function(n){var t=r.element[0];return!(t===n)&&!f.contains(t,n)?2:0},e={dismissFn:function(){r.hide()},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,logName:"contextmenu"};return i.registerForCleanup(h),t.html(a()).addClass(b+" "+g+" "+nt),r._bindDescendants({ariaLabel:o.ContextMenu.ariaLabel,commands:u.explicitComputed(h,[i.getOrderedMenuItemsComputed(),i.getOrderedMenuItemsCommandsComputed()],(function(n,t){return n.concat(t)})),afterRender:function(){r.updateRenderedPositionFromLastShow()}}),r._initializeHandlers(),i.visible.subscribeAndRun(h,(function(n){var t=r.element,i;n?(i=document.activeElement,e.restoreFocus=function(){s.validatePreviousFocusedElement(e,i)&&i.focus()},t.css(r._ensureInViewPort(r._lastShowArgs())).addClass(k),r.setFocus(),s.register(e,!0)):(r._lastShowArgs(null),t[0].contains(document.activeElement)&&e.restoreFocus&&e.restoreFocus(),t.removeClass(k),s.unregister(e))})),r}return __extends(t,n),t.prototype.dispose=function(){this.hide();this._cleanElement(b,g,nt);n.prototype.dispose.call(this)},t.prototype.hide=function(){this.options.visible(!1)},t.prototype.show=function(n,t,i){if(n===void 0&&(n=0),t===void 0&&(t=0),i===void 0&&(i=!1),e.isFullscreen()){this.hide();return}this._lastShowArgs({xCoord:n,yCoord:t,forceLeft:i});this.options.visible(!0)},t.prototype.updateRenderedPositionFromLastShow=function(){var n=this._lastShowArgs();n&&this.element.css(this._ensureInViewPort(n))},t.prototype.setFocus=function(){var n=this;Q.fcall((function(){n.element.find("[tabindex=0]:first-of-type").focus()}))},t.prototype._initializeHandlers=function(){var t=this,n=this.element,i=this.ltm,r=function(n){if(n.stopPropagation(),n.preventDefault(),!f(n.currentTarget).hasClass(et)){t.hide();var i=u.dataFor(n.target);i&&i.enabled()&&i.execute(!0)}};new h.KeyboardNavigation(this.ltm,{element:n});c.register(n);u.computed(i,(function(){t._lastShowArgs()&&(t.options.menuItems().forEach((function(n){n.enabled()})),t.updateRenderedPositionFromLastShow())}));i.registerForDispose([function(){c.unregister(n)},n.setEvents([v.default.contextmenu,function(){return!1},]),n.find("ul").setEvents([v.default.click,"."+d,r,],[v.default.keydown,"."+d,function(n){n.which===13&&r(n)},]),])},t.prototype._ensureInViewPort=function(n){var o=n.xCoord,c=n.yCoord,s=n.forceLeft,t=c,r="auto",h=this.element,u=h.outerHeight(),f=h.outerWidth(),e;return this._isRtl()?(r=o-f,(s||r-f<0)&&(r+=f,t+=this.options.topOffsetCorrection)):(r=o,(s||r+f>w.innerWidth)&&(r-=f,t+=this.options.topOffsetCorrection)),e=w.innerHeight,t+u>e&&(t-u>=0?t-=u:t=u<e?i.truncate((e-u)/2):0,t+=this.options.topOffsetCorrection),{top:t,left:r}},t})(l.Widget);t.Widget=it})(y||(y={})),y}));
define("_generated/Templates/WidgetsTileActionBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-tile-actionbar-actionlist fxs-portal-background" role="menubar" data-bind="foreach: func._actionsForUi"> <!-- ko if: command.enabled() --> <button type="button" class="fxs-tile-actionbar-action fxs-portal-svg" role="menuitem" data-bind="css: className, image: command.icon, attr: { title: command.text, \'aria-label\': command.text }"><\/button> <!-- /ko --> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","f","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextMenu","_generated/Templates/WidgetsTileActionBar","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){var b=i.Base,k=b.Diagnostics.Telemetry,d=k.trace,y="fxs-tile-actionbar-actionlist",t="fxs-tile-actionbar",g=i.isFeatureEnabled("skipautofocus"),l=[],a,p,v,w;n.widgetClassName=t;n.actionClassName="fxs-tile-actionbar-action";a=(function(){function n(){}return n})();n.TileActionViewModel=a;p=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.actions=r.observableArray(),t.visible=r.observable(!1),t}return __extends(t,n),t.prototype.update=function(){var t=this.visible(),n;t&&(n=this.actions(),n.forEach((function(n){n.command.activate();n.bindCommand()})))},t})(o.ViewModel);n.ViewModel=p;v=(function(n){function i(i,o,v,p){var w=n.call(this,i,v)||this,rt=w.options,b=w.ltm,g,nt,k,tt,it;l.push(w);nt=r.observable(g);w._actionsForUi=r.computed(b,nt,(function(n){return r.unwrap(n)||[]}));i.addClass(t).html(h());k=new s.ViewModel;k.topOffsetCorrection=25;tt=w.contextMenuWidget=new s.Widget(o,k);b.registerForDispose(i.setEvents(["click","."+y,function(n){var t=n.target;u(t).hasClass(y)&&(p(t),n.preventDefault(),n.stopPropagation())}]));rt.visible.subscribeAndRun(b,(function(n){if(!n){var t=document.activeElement;w.has(t)&&p(t)}n?(w.options.update(),nt(g||(g=rt.actions.filter(b,(function(n){return n.command.enabled()}))))):tt.hide();f.toggle(i,n);n&&l.forEach((function(t){t!==w&&t.options.visible(!n)}))}));it=function(n){n.stopPropagation();var t=r.dataFor(n.target);t&&t instanceof a&&t.command&&(d({source:e.Source.TileAction,action:e.Action.TileActionClicked,name:t.command.commandName}),t.command.execute(!1))};i.on(c.default.click,it);return b.registerForDispose((function(){i.off(c.default.click,it);tt.dispose();k.menuItems.removeAll();w.contextMenuWidget=null;l.remove(w)})),w._bindDescendants(),w}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(t);n.prototype.dispose.call(this)},i.prototype.showTileManagementContextMenu=function(){this.options.actions().forEach((function(n){var t=n.command;typeof t._getActionClassIdentifier=="function"&&t._getActionClassIdentifier()==="opencontextmenu"&&t.execute(!1)}))},i.prototype.setFocus=function(){!g&&this.options.visible()&&this.element.findFirstTabbable().focus()},i.prototype.has=function(n){return!!(this.element.has(n).length||this.contextMenuWidget.element.has(n).length)},i})(o.Widget);n.Widget=v;w=(function(){function n(n){this._getActions=n}return n.prototype.create=function(n){var t;return u.isFunction(this._getActions)&&(t=this._getActions(),r.utils.arrayPushAll(n.options.actions,t)),new v(n.element,n.contextElement,n.options,n.focusBackCallback)},n})();n.FactoryImpl=w})(l||(l={})),l}));
define("_generated/Templates/WidgetsTile",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-tile-actionbarcontainer" data-bind="stopBindings: true"> <div class="fxs-tile-actions"><\/div> <div class="fxs-tile-actions-contextmenu"><\/div> <\/div> <div class="fxs-tile-overlay"><\/div> <div class="fxs-tile-progress-transparent fxs-loading5dots-container" data-bind="visible: func._showTransparentSpinner"> <div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div> <\/div> <fxs-progress class="fxs-tile-progress fxs-portal-background" data-bind="visible: func._showOpaqueSpinner"><\/fxs-progress> '}}));
define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","f","o","ko","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.TileActionBar","_generated/Templates/WidgetsTile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function d(n,t,i){return new a(n,t,new o.FactoryImpl(i))}var p,a;r.defineProperty(t,"__esModule",{value:!0});var w=i.Base,b=w.Diagnostics,k=b.createLog(n),l="fxs-tile",v="fxs-tile-overlay",y="fxs-portal-bg-txt-br";t.widgetClassName=l;t.overlayClassName=v;t.actionBarContainerClassName="fxs-tile-actionbarcontainer";p=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.isInBlockingLoadingState=u.observable(!1),r.hasOngoingOperation=u.observable(!1),r.size=u.observable(),r.gridHeight=u.observable(),r.gridWidth=u.observable(),r.supportedSizes=u.observableArray(),r.commands=[],r.actionBarViewModel=new o.ViewModel,r.selected=u.observable(!1),r.selectedFromHover=u.observable(!1),r.userResizable=u.observable(!1),r.inLockedContext=!1,r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{size:this.size()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.size!==undefined&&(this.size=u.observable(n.NormalState.size))},t})(h.ViewModel);t.ViewModel=p;t.createTileWidget=d;a=(function(n){function t(t,i,r){var o=n.call(this,t,i)||this,h,c,b,a,v,p,w,d;return o._showTransparentSpinner=u.observable(!1),o._showOpaqueSpinner=u.observable(!1),c=o.ltm,i.size&&i.size()!==undefined||(k.warning("No initial size was set on the Tile view model."),i.size=u.observable(e.getDefaultSize().name)),o._actionBarWidgetFactory=r,h=e.getSize(i.size()),u.computed(c,(function(){var n=0;i.isInBlockingLoadingState()?n=2:i.hasOngoingOperation()&&(n=1);o._showTransparentSpinner(n===1);o._showOpaqueSpinner(n===2)})),b=s(),t.addClass(l).addClass(y).addClass(h&&h.css).html(b),99===h.name?(a=e.getGridPixelSize(i.gridWidth(),i.gridHeight()),t.css({width:a.width,height:a.height})):e.isFixedSize(i.size())&&(i.gridWidth(h.span.colSpan),i.gridHeight(h.span.rowSpan)),v={func:o,data:i},p=t.findByClassName("fxs-tile-progress")[0],u.applyBindingsToNode(p,null,v),w=t.findByClassName("fxs-tile-progress-transparent")[0],u.applyBindingsToNode(w,null,v),o._attachEventHandlers(),d=f.setup(t,u.observableArray(i.commands)),c.registerForDispose((function(){o._cleanNode(p);o._cleanNode(w);d.dispose()})),o}return __extends(t,n),t.prototype.dispose=function(){this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null);this._cleanElement(e.AllCssClasses.join(" "),l,y);n.prototype.dispose.call(this)},t.prototype._cleanNode=function(n){n&&u.cleanNode(n)},t.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");var t=n.element||n;t.insertBefore($(this.element).findByClassName(v))},t.prototype.removeChild=function(){return!1},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.setSize=function(n,t){var i=e.getCorrespondingStandardSize(n,t),s;i||(i=e.getDefaultSize());var u=i.size,f=this.options,o=f.size(),r=this.element;if(o&&o===i.name){if(o!==99)return;if(parseInt(r.css("height"))===u.height&&parseInt(r.css("width"))===u.width)return}f.size(i.name);f.gridHeight(i.span.rowSpan);f.gridWidth(i.span.colSpan);r.css({height:"",width:""}).removeClass(e.AllCssClasses.join(" ")).addClass(i.css);i.name===99&&r.css({height:u.height,width:u.width});s=300;r.handleTransitionEndOnce("height",s,(function(){r.trigger(c.default.fxsizechanged,[i.name])}))},r.defineProperty(t.prototype,"actionBarWidget",{get:function(){return this._actionBarWidget},enumerable:!0,configurable:!0}),t.prototype.setFocus=function(n){var t=this._actionBarWidget,i;!n&&t&&t.options.visible()?t.setFocus():(i=this.element.find(".fxs-part"),i&&i.focus())},t.prototype.showTileManagementContextMenu=function(){var n=this.options,t=this.actionBarWidget;!n.locked()&&n.selected()&&t&&t.showTileManagementContextMenu()},t.prototype._createActionBarWidget=function(){var i=this,n,t;!this._actionBarWidget&&this._actionBarWidgetFactory&&(n=this.element,t=this.options,this._actionBarWidget=this._actionBarWidgetFactory.create({element:n.findByClassName("fxs-tile-actions"),contextElement:n.findByClassName("fxs-tile-actions-contextmenu"),options:t.actionBarViewModel,focusBackCallback:function(t){n[0].contains(t)&&i.setFocus(!0)}}))},t.prototype._attachEventHandlers=function(){var r=this,t=this.element,n=this.options,f=this.ltm;if(n.size.subscribe(f,(function(){t.trigger(h.Widget.viewSettingsChanged,r.saveViewSettings())})),n.userResizable.subscribeAndRun(f,(function(n){n&&i.tryImmediateResolve(i.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"),(function(n){n.addUserResizeBehavior(r)}))})),u.computed(f,n.locked,(function(){t.trigger(c.default.fxsizechanged)})).extend({deferred:!0}),u.computed(f,(function(){var i=n.selected(),e=n.selectedFromHover(),f=i||e;u.ignoreDependencies((function(){f&&r._createActionBarWidget()}));n.actionBarViewModel.visible(f);t.toggleClass("fxs-tile-selected",i)})),!n.inLockedContext){var o=function(){n.selectedFromHover()||n.selectedFromHover(!0)},s=function(){!n.selectedFromHover()||r.actionBarWidget&&r.actionBarWidget.has(document.activeElement)||n.selectedFromHover(!1)},l=function(n){var i=t[0];return i.contains(n.target)&&i.contains(n.relatedTarget)},a=function(n){l(n)||o(n)},v=function(n){l(n)||s(n)},e=t[0],y=function(n){n.keyCode===27&&n.target&&e.contains(n.target)&&r.setFocus(!0)};t.on(c.default.mouseenter,o).on(c.default.mouseleave,s).on(c.default.keydown,".fxs-tile-actionbar-action",y);e.addEventListener(c.default.focus,a,!0);e.addEventListener(c.default.blur,v,!0);f.registerForDispose((function(){t.off(c.default.mouseenter,o).off(c.default.mouseleave,s).off(c.default.keydown,y);e.removeEventListener(c.default.focus,a,!0);e.removeEventListener(c.default.blur,v,!0)}))}},t})(h.Widget);t.Widget=a}));
define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";function at(n){for(var r,u,f,e=new ft,i,c=!0,o=0;o<n.length;o++){var t=n[o],l=t.position,s=l.row,h=l.col,a=t.rowSpan,v=t.colSpan;if(e.isRectangleFree(h,s,a,v))e.markOccupancy(t);else{for(c=!1,i={misplacedPart:t.id,overlappedParts:[]},r=h;r<h+v;r++)for(u=s;u<s+a;u++)f=e.getItemAt(r,u),f&&i.overlappedParts.indexOf(f.id)===-1&&i.overlappedParts.push(f.id);break}}return{success:c,result:i}}var k,ht,ct,y,rt;u.defineProperty(t,"__esModule",{value:!0});var lt=i.Base.Diagnostics,ut=i.Widgets.AzureGrid,tt=h.Orientation,et=lt.createLog(n),p=l.Widget.getId,it=s.Widget.getWidget,ot="fxs-flowlayout",st="fxs-flowlayout-childcontainer",g="fxs-flowlayout-element",b=function(n,t,i){return Math.min(25,Math.ceil((n+i)/(t+i)))},w=function(n,t,i){return n*t+(n-1)*i};t.validateGrid=at;k={};k[38]=1;k[39]=2;k[40]=3;k[37]=4;ht=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.minColumns=f.observable(1),r.minRows=f.observable(1),r.maxColumns=f.observable(999),r.maxRows=f.observable(999),r.columnSize=ut.CellWidth,r.rowSize=ut.CellHeight,r.gutterSize=ut.CellSpacingWidth,r.orientation=tt.Horizontal,r.allowReorder=!1,r.allowOverflow=!1,r.allowGaps=!1,r.resolutionGuides=!1,r.resolutionGuidesOffset={x:0,y:0},r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{positions:this.positions}},t.prototype.applyViewSettings=function(n){n&&n.positions&&(this.positions=n.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1))},t})(h.ViewModel);t.ViewModel=ht;ct=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._dropPlaceholder=null,r._childContainer=null,r._engine=new d(i),r._engine.positions=i.positions,t.addClass(ot).html("<div class='"+st+"'><\/div>"),i.resolutionGuides&&r._addResolutionGuides(),r._childContainer=r.element.findByClassName(st),r._initializeComputed(),r._setContainerSize(),r._relayoutPositions(),r._attachEventHandlers(),r}return __extends(t,n),t.prototype.dispose=function(){this._childElements.forEach((function(n){n.removeClass(g);f.cleanNode(n[0]);n.remove()}));f.cleanNode(this._childContainer[0]);this._childContainer.remove();this.element.removeClass(ot);n.prototype.dispose.call(this)},u.defineProperty(t.prototype,"_childElements",{get:function(){var t=this._childContainer.children("."+g),n=[];return e.each(t,(function(t,i){n.push(e(i))})),n},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"dropPlaceholder",{get:function(){return this._dropPlaceholder},enumerable:!0,configurable:!0}),t.prototype.addChild=function(n){var r=this.options,t,i;if(!n)throw new Error("Cannot add a null child.");t=n.element?n.element:n;t.css("visibility","hidden");this._childContainer.append(t);t.addClass(g);i=this._getChildDimensions(t);try{r.positions=this._engine.append(p(t),i.rowSpan,i.colSpan)}catch(u){et.warning("New element could not be appended to the grid. {0}".format(u.toString()));t.removeClass(g);t.remove();return}r.positions=this._engine.positions;this._refreshElementSize(t);this._setContainerSize();this._relayoutPositions();this.element.trigger(h.Widget.layoutUpdatedEventName);t.css("visibility","")},t.prototype.removeChild=function(n,t){var u=this._childElements.firstIndex((function(t){return p(t)===n})),i=this._childElements[u],r;return i?(r=this.options,r.positions=this._engine.remove(n),this.element.trigger(h.Widget.layoutUpdatedEventName),o.hide(i).removeClass(g),t?i.detach():i.remove(),this._setContainerSize(),this._relayoutPositions(),!0):!1},t.prototype.resizeChild=function(n,t,i,r){var u=this.options,o=u.rowSize,s=u.columnSize,f=u.gutterSize,c=this._childElements.first((function(t){return p(t)===n})),a,y;if(c){a=this._engine.positions.first((function(t){return t.id===n}));t=Math.max(t,s);i=Math.max(i,o);var k=b(i,o,f),d=b(t,s,f),v=this._engine.resize(n,d,k,r);u.positions=v;var e=v.first((function(t){return t.id===n})),g=w(e.rowSpan,o,f),nt=w(e.colSpan,s,f);this._setContainerSize(!0);this._relayoutPositions();r&&((a.rowSpan!==e.rowSpan||a.colSpan!==e.colSpan)&&this.element.trigger(h.Widget.layoutUpdatedEventName),y=it(c,l.Widget),this._setElementSize(y,c,nt,g))}},t.prototype.moveChild=function(n,t,i,r){var f=p(n),u=this._getChildDimensions(n),e=this._engine.move(f,{col:t,row:i},u.colSpan,u.rowSpan,r);this.options.positions=e;this._setContainerSize(!0);this._relayoutPositions();r&&this.element.trigger(h.Widget.layoutUpdatedEventName)},t.prototype.refreshLayout=function(){this.options.positions=this._engine.positions;this._setContainerSize();this._relayoutPositions();this._refreshSizes()},t.prototype.saveViewSettings=function(){var n=this.options;return n.positions=this._engine.positions,n.getViewSettings()},t.prototype.createDropPlaceholder=function(n,t){this._dropPlaceholder&&this.disposeDropPlaceholder();this._dropPlaceholder=e(r.createElement("div",{"class":"fxs-flowlayout-drop-placeholder"})).css({width:n,height:t});this._childContainer.append(this._dropPlaceholder)},t.prototype.disposeDropPlaceholder=function(){this._dropPlaceholder&&this._dropPlaceholder.remove();this._dropPlaceholder=null},t.prototype.moveDropPlaceholder=function(n){this._setElementPositioningCss(this.dropPlaceholder,n)},t.prototype.resizeDropPlaceholder=function(n,t){var r=this.options,u=r.rowSize,f=r.columnSize,i=r.gutterSize,e=b(t,u,i),o=b(n,f,i),s=w(e,u,i),h=w(o,f,i);this._dropPlaceholder.css({width:h,height:s})},t.prototype.getDomOrderedChildren=function(){return this._engine.getNaturalDomElementOrder()},t.prototype.discardStateOfUnusedChildren=function(){var n=[],t={stateDiscarded:!1};return this._engine&&(n=n.concat(this._engine.discardUnusedPositions())),n.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(n)),t},t.prototype._initializeComputed=function(){var t=this,n=this.options,i=this.ltm;f.computed(i,(function(){n.minRows();n.maxRows();n.minColumns();n.maxColumns();t._setContainerSize()}));n.positionUpdatedSignal.subscribe(i,(function(){t._engine.positions=n.positions}))},t.prototype._getChildDimensions=function(n){var t=this.options,f=it(n,c.Widget),i=f&&f.options,u=i&&i.size(),e,r,o,s;return a.isFixedSize(u)?(e=a.getSize(u),r=u===99?a.getGridPixelSize(i.gridWidth(),i.gridHeight()):e.size):r=this._getChildAccurateDimensions(n),o=b(r.height,t.rowSize,t.gutterSize),s=b(r.width,t.columnSize,t.gutterSize),{rowSpan:o,colSpan:s}},t.prototype._getChildAccurateDimensions=function(n){if(!n[0])return et.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};var t=n[0].getBoundingClientRect(),i=Math.round(t.height),r=Math.round(t.width);return{height:i,width:r}},t.prototype._setContainerSize=function(n){var t=this.options,i=this._engine.getMaxOccupiedPositions(n?t.positions:null),r=Math.max(t.minRows(),i.row),u=Math.max(t.minColumns(),i.col),f=w(r,t.rowSize,t.gutterSize),e=w(u,t.columnSize,t.gutterSize);this._childContainer.css({height:f,width:e})},t.prototype._relayoutPositions=function(){for(var r,n,t,u,i=0;i<this._childElements.length;i++)n=this._childElements[i],r=p(n),t=this.options.positions.first((function(n){return n.id===r})),u=t?t.position:{row:0,col:0},this._setElementPositioningCss(n,u)},t.prototype._setElementPositioningCss=function(n,t){var i=this.options,r=t.col*(i.columnSize+i.gutterSize),u=t.row*(i.rowSize+i.gutterSize),f;f=this._isRtl()?{right:r,top:u}:{left:r,top:u};n.css(f)},t.prototype._refreshSizes=function(){this._childElements.forEach(this._refreshElementSize,this)},t.prototype._refreshElementSize=function(n){var t=this.options,i=it(n,l.Widget);if(i){var u=p(n),r=t.positions.first((function(n){return n.id===u})),f=w(r.rowSpan,t.rowSize,t.gutterSize),e=w(r.colSpan,t.columnSize,t.gutterSize);this._setElementSize(i,n,e,f)}},t.prototype._setElementSize=function(n,t,i,r){n?n.setSize(i,r):t.css({width:i,height:r})},t.prototype._moveFocusInDirection=function(n){var f=e(document.activeElement).closest("."+c.widgetClassName),r=p(f),u,t,i;r&&(u=this._engine.getAdjacentElement(r,n),t=this._childElements.first((function(n){return u===p(n)})),t)&&(i=it(t,c.Widget),i&&i.setFocus())},t.prototype._attachEventHandlers=function(){var t=this,n=this.element,i=function(n,i,r,u,f){t.resizeChild(i,r,u,f===undefined?!0:f);n.stopPropagation()},r=function(n){var r=e(n.target),u,i;r.is("input[type=text], textarea, select")||r.closest(".fxs-contextMenu").length||(u=n.which,i=k[u]||0,i!==0&&(n.preventDefault(),n.stopPropagation(),t._moveFocusInDirection(i)))};n.on(v.default.fxsizechange,i);n.on(v.default.keydown,r);this.ltm.registerForDispose((function(){n.off(v.default.fxsizechange,i);n.off(v.default.keydown,r)}))},t.prototype._addResolutionGuides=function(){var t=this,n=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160},].forEach((function(i){var u=e(r.createElement("div",{"class":"fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-"+i.x+"x"+i.y+" fxs-hide-in-normal"}));(n.x||n.y)&&u.css({top:n.y+"px",left:n.x+"px"});t.element.prepend(u)}))},t})(h.Widget);t.Widget=ct,(function(n){function t(n){return n.position.row}function i(n){return n.position.row+n.rowSpan}function r(n){return n.position.col}function u(n){return n.position.col+n.colSpan}n.top=t;n.bottom=i;n.left=r;n.right=u})(y||(y={}));var ft=(function(){function n(){this._occupancyGrid=[]}return n.prototype.reset=function(n){var t=this;this._occupancyGrid.length=0;n&&n.forEach((function(n){t.markOccupancy(n)}))},n.prototype.isRectangleFree=function(n,t,i,r){for(var u,e=n+r,o=t+i,f=n;f<e;f++)for(u=t;u<o;u++)if(this.isPositionOccupied(f,u))return!1;return!0},n.prototype.isPositionOccupied=function(n,t){return!!this._occupancyGrid[n]&&!!this._occupancyGrid[n][t]},n.prototype.getItemAt=function(n,t){var i=this._occupancyGrid[n];return i?i[t]:null},n.prototype.markOccupancy=function(n,t){for(var r,f=y.top(n),e=y.bottom(n),o=y.left(n),s=y.right(n),u=this._occupancyGrid,i=o;i<s;i++)for(r=f;r<e;r++)u[i]||(u[i]=[]),u[i][r]||(u[i][r]=null),u[i][r]=t?null:n},n})(),nt={},d=(function(){function n(n){this._occupancyGrid=new ft;this._items=[];this._filledPositions={};this._gridOptions=n}return n.prototype.append=function(n,t,i){var r=this._getExistingItem(n),u,f,e;if(this._filledPositions[n]=!0,!!r)return this._items;if(u=this._maxRows(),f=this._maxCols(),!this._gridOptions.allowOverflow&&(t>u||i>f))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,i,u,f));if(e=this._findNextAvailablePositionForRectangle(t,i),!e)throw new Error("The element cannot fit in the remaining space available in the grid.");return r={id:n,position:e,rowSpan:t,colSpan:i},this._items.push(r),this._occupancyGrid.markOccupancy(r),this._items},n.prototype.move=function(n,t,i,r,u){var o={id:n,position:t,colSpan:i,rowSpan:r},e,f,s;return this._applyGridConstraints(o),f=new rt(this._items,o,this._gridOptions),e=f.resolved?f.getItems():this._items,u&&(f.resolved&&(this._items.length=0,(s=this._items).push.apply(s,e)),this._occupancyGrid.reset(this._items),this.collapseGaps()),e},n.prototype.resize=function(n,t,i,r){var e=this._getExistingItem(n),o=e.position,y={id:e.id,position:{col:o.col,row:o.row},colSpan:t,rowSpan:i},f=y.position,u,l,s,h,p,c,w;if(this._applyGridConstraints(y),f.row<0||f.col<0)return this._items;var b=Math.max(0,t-e.colSpan),k=Math.max(0,i-e.rowSpan),a=f.col,v=f.row;for(this._gridOptions.allowGaps||(a=Math.min(a,Math.max(0,o.col-b)),v=Math.min(v,Math.max(0,o.row-k))),s=a;s<=f.col;s++){for(h=v;h<=f.row;h++)if((p={id:n,position:{col:s,row:h},colSpan:t,rowSpan:i},c=new rt(this._items,p,this._gridOptions),c.resolved)&&((!u||c.shiftCost<u.shiftCost)&&(u=c),u&&u.shiftCost===0))break;if(u&&u.shiftCost===0)break}return l=u?u.getItems():this._items,r&&(u&&(this._items.length=0,(w=this._items).push.apply(w,l)),this._occupancyGrid.reset(this._items),this.collapseGaps()),l},n.prototype.remove=function(n){var i=this._getExistingItem(n),t;return(this._filledPositions[n]=!1,t=this._items.indexOf(i),t===-1)?this._items:(this._items.splice(t,1),this._occupancyGrid.markOccupancy(i,!0),this.collapseGaps(),this._items)},n.prototype.collapseGaps=function(){if(!this._gridOptions.allowGaps){var n={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(n,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(n,t)},shiftItem:function(n,t){n.position.col-=t}},t={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(t,n)},getMaxPositions:function(){var n=this.grid.getMaxOccupiedPositions();return{col:n.row,row:n.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(t,n)},shiftItem:function(n,t){n.position.row-=t}};this._orientation()===tt.Horizontal?(this._collapseGapsWithGridVisitor(n),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(n))}},n.prototype.getNaturalDomElementOrder=function(){for(var n,t,u,i=[],f=this.getMaxOccupiedPositions(),r=0;r<f.row;r++)for(n=0;n<f.col;n++)t=this._occupancyGrid.getItemAt(n,r),t&&(u=t.id,i.indexOf(u)===-1&&i.push(u),n+=t.colSpan-1);return i},n.prototype.getAdjacentElement=function(n,t){var i=this._getExistingItem(n),r,u;return i?(r=nt[t],u=r?r(this,i):i,u.id):n},u.defineProperty(n.prototype,"positions",{get:function(){return this._items},set:function(n){this._items.length=0;this._items=n?n:[];this._occupancyGrid.reset(this._items)},enumerable:!0,configurable:!0}),n.prototype.discardUnusedPositions=function(){var n=this,t=[];return this._items.slice(0).forEach((function(i){n._filledPositions[i.id]||(t.push(i),n.remove(i.id))})),t},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._minRows=function(){return this._gridOptions.minRows()},n.prototype._maxRows=function(){return this._gridOptions.maxRows()},n.prototype._minCols=function(){return this._gridOptions.minColumns()},n.prototype._maxCols=function(){return this._gridOptions.maxColumns()},n.prototype.getMaxOccupiedPositions=function(n){for(var e=n||this._items,r=0,u=0,i,f,t=0;t<e.length;t++)i=e[t],f=i.position,r=Math.max(r,f.col+i.colSpan),u=Math.max(u,f.row+i.rowSpan);return{col:r,row:u}},n.prototype._getExistingItem=function(n){return this._items.first((function(t){return t.id===n}))},n.prototype._applyGridConstraints=function(n){var t,i;this._gridOptions.allowOverflow||(i=n.position,t=y.bottom(n)-this._maxRows(),t>0&&(i.row-=t),t=y.right(n)-this._maxCols(),t>0&&(i.col-=t))},n.prototype._findNextAvailablePositionForRectangle=function(n,t){var f=this._maxCols()-t+1,e=this._maxRows()-n+1,i,r,u;if(this._orientation()===tt.Horizontal){for(r=0;r<f;r++)for(i=0;i<e;i++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:0,row:u.row}}else{for(i=0;i<e;i++)for(r=0;r<f;r++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:u.col,row:0}}},n.prototype._isRectangleFree=function(n,t,i,r){var u=n+r,f=t+i;return!this._gridOptions.allowOverflow&&(f>this._maxRows()||u>this._maxCols())?!1:this._occupancyGrid.isRectangleFree(n,t,i,r)},n.prototype._collapseGapsWithGridVisitor=function(n){var i=n.getMaxPositions(),r=i.col,a=i.row,u=[],v=!1,p,f,s,t,h,o,c,l;if(!(r<=n.getMinSize().col))for(s=0;s<r;s++){for(f=null,t=0;t<a;t++){if(v=!1,u[t]=this._findGap(t,s,r,n),h=u[t].colSpan,h===0)return;if((!f||h<f)&&(f=h),t>0&&!this._gapsAreContiguous(u[t-1],u[t]))break;v=!0}if(v){for(p={},o=0;o<a;o++)for(c=y.right(u[o]);c<r;c++)l=n.getItemAt(c,o),l&&(p[l.id]=l);e.each(p,(function(t,i){n.shiftItem(i,f)}));this._occupancyGrid.reset(this._items);i=n.getMaxPositions();r=i.col;a=i.row}}},n.prototype._gapsAreContiguous=function(n,t){var i=y.left(t),r=y.right(t),u=y.left(n),f=y.right(n);return f>=i&&u<=r},n.prototype._findGap=function(n,t,i,r){for(var u=t,f={id:"",position:{row:n,col:0},rowSpan:1,colSpan:0};u<i;){if(!r.isPositionOccupied(u,n))break;u++}for(f.position.col=u;u<i;){if(r.isPositionOccupied(u,n))break;f.colSpan++;u++}return f},n._scanAdjacentUp=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row-1,s=r.col+t.colSpan,u=o;u>=0;u--)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentRight=function(n,t){for(var i,f,r=t.position,e=r.col+t.colSpan,o=r.row,s=n.getMaxOccupiedPositions().col,h=r.row+t.rowSpan,u=e;u<s;u++)for(i=o;i<h;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n._scanAdjacentDown=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row+t.rowSpan,s=r.col+t.colSpan,h=n.getMaxOccupiedPositions().row,u=o;u<h;u++)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentLeft=function(n,t){for(var i,f,r=t.position,e=r.col-1,o=r.row,s=r.row+t.rowSpan,u=e;u>=0;u--)for(i=o;i<s;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n})();t.FlowLayoutPositioningEngine=d;nt[1]=d._scanAdjacentUp;nt[2]=d._scanAdjacentRight;nt[3]=d._scanAdjacentDown;nt[4]=d._scanAdjacentLeft;rt=(function(){function n(n,t,i){var u=this,r;this.shiftCost=0;this.resolved=!1;this._resolvedItems=[];this._occupancyGrid=new ft;this._gridOptions=i;n.forEach((function(n){var i;t.id!==n.id&&(i=e.extend(!0,{},n),u._resolvedItems.push(i),u._occupancyGrid.markOccupancy(i))}));this.resolved=this._resolveConflict(t);r=e.extend(!0,{},t);this._resolvedItems.push(r);this._occupancyGrid.markOccupancy(r)}return n.prototype.getItems=function(){return this._resolvedItems},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._maxRows=function(){return this._gridOptions.maxRows()||999},n.prototype._maxCols=function(){return this._gridOptions.maxColumns()||999},n.prototype._resolveConflict=function(n){var t=!1;return this._orientation()===tt.Horizontal?(t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t):(t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t),t},n.prototype._tryMoveConflictsUp=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=y.left(n);u<y.right(n);u++)for(r=y.top(n);r<y.bottom(n);r++)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=y.bottom(i),e=y.top(n)-y.bottom(i),f=this._getConflictArea(i,0,e),y.bottom(f)>this._maxRows()||y.top(f)<0)||!this._tryMoveConflictsUp(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsDown=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=y.left(n);u<y.right(n);u++)for(r=y.bottom(n)-1;r>=y.top(n);r--)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=y.top(i),e=y.bottom(n)-y.top(i),f=this._getConflictArea(i,0,e),y.bottom(f)>this._maxRows()||y.top(f)<0)||!this._tryMoveConflictsDown(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsLeft=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=y.top(n);u<y.bottom(n);u++)for(r=y.left(n);r<y.right(n);r++)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=y.right(i),e=y.left(n)-y.right(i),f=this._getConflictArea(i,e,0),y.right(f)>this._maxCols()||y.left(f)<0)||!this._tryMoveConflictsLeft(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsRight=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=y.top(n);u<y.bottom(n);u++)for(r=y.right(n)-1;r>=y.left(n);r--)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=y.left(i),e=y.right(n)-y.left(i),f=this._getConflictArea(i,e,0),y.right(f)>this._maxCols()||y.left(f)<0)||!this._tryMoveConflictsRight(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._getConflictArea=function(n,t,i){var u=i<0,f=t<0,r=n.position;return{id:n.id,position:{row:u?r.row+i:r.row,col:f?r.col+t:r.col},rowSpan:n.rowSpan+Math.abs(i),colSpan:n.colSpan+Math.abs(t)}},n.prototype._moveItem=function(n,t,i){this._occupancyGrid.markOccupancy(n,!0);var r=n.position;r.col+=t;r.row+=i;this._occupancyGrid.markOccupancy(n);this.shiftCost+=n.colSpan*n.rowSpan},n})();t.FlowLayoutPositionConflictResolver=rt}));
define("_generated/Templates/WidgetsStartboard",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-landingpage"><\/div> <div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container fxs-loading5dots-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-header-item fxs-startboard-title fxs-startboard-title-next fxs-portal-border" id="startboard-title"><\/div> <div class="fxs-startboard-header-item fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-header-item fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-header-item fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <div class="fxs-startboard-button fxs-startboard-button-upload" tabindex="-1"><\/div> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-download" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter" tabindex="-1"><\/button> <\/div> <\/div> <div class="fxs-startboard-filter" data-bind="stopBindings: true"><\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Svg/Startup/Add.svg","MsPortalImpl/Svg/Startup/CaretDown.svg","MsPortalImpl/Svg/Startup/Clone.svg","MsPortalImpl/Svg/Startup/Customize.svg","MsPortalImpl/Svg/Startup/Download.svg","MsPortalImpl/Svg/Startup/Filter.svg","MsPortalImpl/Svg/Startup/Fullscreen.svg","MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Svg/Startup/TrashOutline.svg","MsPortalImpl/Svg/Startup/Upload.svg","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","_generated/Templates/WidgetsStartboard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Base/Base.Timers","MsPortalImpl/AsyncLoader","MsPortalImpl/Services/Services.GeneralSettings","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at){"use strict";var ci,li;u.defineProperty(t,"__esModule",{value:!0});var ai=i.Base,gt=ai.Diagnostics,ni=gt.Telemetry,ti=tt.Source,ii=tt.Action,vi=window,yi=gt.createLog(n),vt=s.Dashboard;t.widgetClass="fxs-startboard";t.headerButtonClass="fxs-startboard-button";var ri="fxs-theme-context-start",ui="fxs-startboard-title-edit",yt="fxs-startboard-button-text",pt="fxs-startboard-button-icon",fi="fxs-startboard-button-filter",bt="fxs-startboard-button-browse",kt="fxs-startboard-header-normal",dt="fxs-startboard-header-migration",wt="fxs-startboard-dropdown-item",ei="fxs-startboard-dropdown-dashboard",oi="."+ei+", ."+bt,si=vi.fx.environment,hi="aria-label";t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard";ci=(function(n){function t(t,i,r,u){var e=n.call(this,t)||this,o;return e.diContainer=u,e.commands=[],e.filterButtonText=f.observable(""),e.title=f.observable(s.NavBar.home),e.dashboardList=f.observableArray(),e.loading=f.observable(!1),e.notFound=f.observable(!1),e.isShared=f.observable(!1),e.notFoundMessage=f.observable(""),e.subscriptionsInfo=f.observable(""),e.locked(!1),o=e.flowLayoutOptions=new rt.ViewModel("fxs-flowlayout-instanceid"),o.allowReorder=!0,o.allowOverflow=!0,o.allowGaps=!0,o.resolutionGuides=!0,o.resolutionGuidesOffset.y=-88,o.orientation=ut.Orientation.Horizontal,o.minColumns(4),o.minRows(4),o.maxRows(4),o.locked(!1),e.headerMode=f.observable(0),e.filtersWidgetViewModel=r,e.applyViewSettings(i),e}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t})(et.ViewModel);t.ViewModel=ci;li=(function(n){function u(u,o){var l=n.call(this,u,o)||this,a,v;return l._layout=null,l._setFocusOnAnimationFrame=ct.throttleByAnimationFrame((function(){var i,n,t;l._$lastFocused&&e.contains(l.element[0],l._$lastFocused[0])&&c.isVisible(l._$lastFocused)&&(l._$lastFocused.focus(),i=!0);i||(n=l._layout.element.findFirstTabbable(),n.length===1?n.focus():(t=l._selectorMenu,t&&t.setFocus()))})),a=l.ltm,l._isSharedToArm=o.isShared,l._features=o.diContainer.get(r.Features),u.addClass(ri).addClass(t.widgetClass).html(ft()),f.reactor(a,(function(){var n=o.title();u.findByClassName("fxs-startboard-title").text(n);u.findByClassName(ui).val(n)})),f.reactor(a,(function(){var t=o.headerMode(),n=u.findByClassName("fxs-startboard-header");switch(t){case 1:n.addClass(kt).removeClass(dt);break;case 2:n.removeClass(kt).addClass(dt);break;case 0:default:n.removeClass(kt).removeClass(dt)}})),f.reactor(a,(function(){u.toggleClass("fxs-startboard-notfound",o.notFound())})),f.reactor(a,(function(){u.toggleClass("fxs-startboard-loading",o.loading())})),f.reactor(a,(function(){document.title=s.Portal.windowTitleFormat.format(o.title(),si.branding.title)})),l._layout=new rt.Widget(u.findByClassName("fxs-startboard-layout"),o.flowLayoutOptions),l._initializeCommands(a,u),v=u.findByClassName("fxs-startboard-message-container"),v.html('<div class="fxs-startboard-message-title">'+i.encodeHtml(vt.NotFound.title)+'<\/div><div class="fxs-startboard-message-body" data-bind="text: data.notFoundMessage"><\/div>'),f.applyBindings({data:o},v[0]),l._attachEventHandlers(u),new ht.KeyboardNavigation(a,{element:u.find(".fxs-startboard-actions"),tabTriggers:12,itemSelector:"> .fxs-startboard-button:not(.fxs-startboard-button-upload), .fxs-startboard-button-upload input[type=file]"}),a.registerForDispose([h.setup(u,f.observableArray(o.commands)),]),l._features.isEnabled("dashboardfilters")&&o.filtersWidgetViewModel&&o.filtersWidgetViewModel.showDashboardFilteringUi.subscribeAndRun(a,(function(n){n&&!l._dashboardFiltersWidget&&lt.get("MsPortalImpl/Widgets/Widgets.DashboardFilters","Widget").then((function(n){a.registerForDispose(l._dashboardFiltersWidget=new n(l.element,o.filtersWidgetViewModel))}))})),l._features.isEnabled("azurehome")&&o.diContainer.get(at.GeneralSettings).landingPage()===4&&i.require("MsPortalImpl/Widgets/Widgets.LandingPageSelector").then((function(n){a.registerForDispose(new n.Widget(u.findByClassName("fxs-startboard-landingpage"),new n.ViewModel(2),o.diContainer))})),l}return __extends(u,n),u.prototype.dispose=function(){this._layout.dispose();this._cleanElement(t.widgetClass,ri);n.prototype.dispose.call(this)},u.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},u.prototype.removeChild=function(n){return this._layout.removeChild(n)},u.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},u.prototype.setFocus=function(){this._features.isEnabled("skipautofocus")||this._setFocusOnAnimationFrame()},u.prototype.saveViewSettings=function(){return this.options.getViewSettings()},u.prototype.discardStateOfUnusedChildren=function(){return yi.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},u.prototype.getDomOrderedChildren=function(){return this._layout.getDomOrderedChildren()},u.prototype._attachEventHandlers=function(n){var i=this;this.ltm.registerForDispose(n.setEvents([ut.Widget.layoutUpdatedEventName,function(t){n.trigger(et.Widget.viewSettingsChanged,i.saveViewSettings());t.stopPropagation()},],[st.default.focusout,function(n){i._$lastFocused=e(n.target)},],[st.default.change,".fxs-startboard-fileUpload-overlay",function(n){var t,r;n.stopPropagation();t=n.target.files;t.length>0&&(r=e.extend(!0,{},t),i._handleUploadItemClick(r),n.currentTarget.value=null)},],[st.default.focus,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();e(n.target).closest("."+t.headerButtonClass).addClass("fxs-startboard-item-focused")},],[st.default.blur,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();e(n.target).closest("."+t.headerButtonClass).removeClass("fxs-startboard-item-focused")},]))},u.prototype._initializeCommands=function(n,r){var ft="aria-disabled",vi=vt.create,yi=vt.delete,pi=s.ShellCommands.downloadDashboard,et=s.ShellCommands.uploadDashboard,wi=vt.edit,bi=vt.filter,ki=this._isSharedToArm?vt.unshare:vt.share,lt=vt.fullscreen,di=vt.clone,u=this.options,ht=function(n,t){n.attr("title",t).findByClassName(yt).html(t)},gi="<div class='"+pt+"' aria-hidden='true'><\/div>"+("<div class='"+yt+"'><\/div>"),nr="<div class='"+pt+'\' aria-hidden="true"><\/div>'+("<div class='"+yt+'\' id="uploadlabel" aria-hidden="true"><\/div>')+('<input type="file" class="fxs-startboard-fileUpload-overlay" accept=".json" tabindex=\'-1\' role="menuitem" aria-labelledby="uploadlabel" title="'+et+'"/>'),h=function(n,t,i,u,f,o){f===void 0&&(f=!1);var s=r.findByClassName(n).html(t===et?nr:gi);ht(s,t);s.findByClassName(pt).empty().append(ot.getSvgReferenceOrFallBackToData(i,{palette:99}));o=o||function(){u.execute(!1)};s.on(st.default.click,(function(n){n.stopPropagation();e(n.currentTarget).attr(ft)!=="true"&&o(n)}));return s.data("commandVM",u),f&&c.hide(s),s},at=h("fxs-startboard-button-edit",wi,p,u.addPartsCommand,!1,(function(){ni.trace({source:ti.Dashboard,action:ii.CustomizeModeEntered});ni.trace({source:ti.Dashboard,action:ii.DashboardEditCommandClicked});u.addPartsCommand.execute(!1)})),rt,kt,dt,gt,ri;f.computed(n,(function(){var n=u.addPartsCommand,t=n&&n.enabled();t?at.removeAttr(ft):at.attr(ft,"true")}));this._features.isEnabled("filterdashboard")||r.findByClassName(fi).remove();rt=r.findByClassName(ui);rt.attr(hi,vt.titleLabel);rt.on(st.default.change,(function(){u.title(rt.val());r.trigger(t.fxstartboardtitlechanged)}));var tr='<div class="fxs-startboard-title" data-bind="text: data.title, attr: { title: data.title }"><\/div>'+('<div class="'+pt+'">'+ot.getSvgReferenceOrFallBackToData(v,{palette:99}).outerHTML+"<\/div>"),ir="<div class='fx-dropmenu-dropdown'>"+('<ul class="fxs-dropmenu-list-system" role="menu" aria-label="'+i.encodeAttribute(vt.recentMenuLabel)+'">')+"<!-- ko ifnot: data.dashboardList -->"+("<li class='"+wt+'\' role="menuitem" tabindex="0">')+'<div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li><!-- /ko --><!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->'+("<li class='"+wt+'\' role="menuitem" tabindex="0">')+("<div class='fxs-dropmenu-list-content'>"+i.encodeHtml(vt.emptynext)+"<\/div>")+"<\/li><!-- /ko --><!-- ko foreach: data.dashboardList -->"+("<li class='"+wt+" "+ei+' fxs-portal-hover msportalfx-tooltip-overflow\' role="menuitem" data-bind="attr: { \'aria-label\': $parent.func.altText(title, id) }, event: { click: $parent.func.clickHandler, keydown: $parent.func.clickHandler }">')+'<div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon fxs-portal-svg"><!-- ko if: id.indexOf("private") === -1 -->'+ot.getSvgReferenceOrFallBackToData(d).outerHTML+"<!-- /ko --><\/div><div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div><\/div><\/li><!-- /ko --><!-- /ko -->"+('<li class="'+wt+' fxs-startboard-dropdown-browseall fxs-portal-hover" role="menuitem">')+'<div class="fxs-startboard-dropdown-subscriptions" data-bind="text: data.subscriptionsInfo"><\/div>'+('<a tabindex=\'-1\' href="#" class="'+bt+' fxs-portal-text-primary">'+i.encodeHtml(vt.browseAll)+"<\/a>")+"<\/li><\/ul><\/div>",ut=new it.ViewModel(tr,ir,oi),tt=r.findByClassName("fxs-startboard-dropdown");ut.alignMenu=0;kt=this._selectorMenu=new it.Widget(tt,ut);ut.isMenuOpen.subscribe(n,(function(n){n&&u.refreshDashboardList&&(u.dashboardList(undefined),u.refreshDashboardList((function(n){u.dashboardList(n);tt.find(".fxs-dropmenu-button")[0]===document.activeElement&&Q.fcall((function(){ct.requestAnimationFrame((function(){tt.find(oi).filter("[tabindex='0']").focus()}))}))})))}));f.reactor(this.ltm,u.title,(function(n){tt.find(".fxs-dropmenu-button").attr(hi,vt.switcherLabel.format(n))}));dt=function(n,t){if(t.type===st.default.keydown&&!((t.keyCode===13||t.keyCode===32)&&l.getModifierKeys(t)===0))return!0;t.preventDefault();t.stopPropagation();r.findByClassName("fxs-startboard-title-next").text(n.title);u.switchDashboard&&u.switchDashboard(n).then((function(){var n=Math.min(Math.max(tt.outerWidth()+50,400),560);tt.find(".fxs-dropmenu-content").css({minWidth:n})}));ut.close()};f.applyBindings({data:u,func:{clickHandler:dt,altText:function(n,t){return n+" "+(t.indexOf("private")===-1?vt.sharedStatusLabel:"")}}},kt.element[0]);h("fxs-startboard-button-new",vi,a,u.newCommand);u.filterButtonText(bi);gt=h(fi,u.filterButtonText(),b,u.filterCommand);u.filterButtonText.subscribe(n,(function(n){gt.findByClassName(yt).html(n)}));h("fxs-startboard-button-clone",di,y,u.cloneCommand);ri=h("fxs-startboard-button-share",ki,d,u.shareCommand,si.chrome.hideDashboardShare);f.reactor(n,this._isSharedToArm,(function(n){var t=n?vt.unshare:vt.share;ht(ri,t)}));h("fxs-startboard-button-delete",yi,g,u.deleteCommand);var rr=h("fxs-startboard-button-fullscreen",lt,k,u.fullscreenCommand),ci=function(){var n=o.isFullscreen(),t=n?vt.exitFullscreen:lt;e(document.body).toggleClass("fxs-portal-fullscreen",n);ht(rr,t)},li=e(document),ai=o.fullscreen;li.on(ai,ci);n.registerForDispose([function(){li.off(ai,ci)}]);h("fxs-startboard-button-migrate",vt.migrate,y,null,!1,(function(){r.trigger(t.fxmigratestartboard)}));h("fxs-startboard-button-upload",et,nt,u.uploadCommand,!1,i.noop);h("fxs-startboard-button-download",pi,w,u.downloadCommand,!1);r.findByClassName(bt).click((function(n){n.preventDefault();u.browseCommand.execute(!1)}))},u.prototype._handleUploadItemClick=function(n){var t=this.options.uploadCommand.fileInputOptions;t&&t()&&t().files(n);this.trigger("itemSelected",null,{item:this.options.uploadCommand.execute(!1)})},u})(et.Widget);t.Widget=li}));
define("_generated/Templates/WidgetsPanorama",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-home-target"><\/div> <div class="fxs-journey-target"><\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsPanorama","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var v;r.defineProperty(t,"__esModule",{value:!0});var y=window,c="fxs-panorama",l=i.encodeHtml(u.Portal.preview),a="Can't add null child.",p=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.rotateThemeEvent=null,r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t})(s.ViewModel);t.ViewModel=p;v=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return t.addClass(c).html(e()),t.findByClassName("fxs-panorama-previewbadge").attr("title",l).findByClassName("fxs-panorama-previewbadge-text").text(l),r.ltm.registerForDispose(t.setEvents([h.default.doubleclick,function(n){var t=$(n.target),i=t.hasClass(c),u=t.hasClass("fxs-startboard-layout"),f=t.hasClass("fxs-flowlayout-childcontainer"),e=t.hasClass("fxs-journey-layout"),o=t.hasClass("fxs-journey-placeholder");(i||u||f||e||o)&&(n.preventDefault(),n.stopPropagation(),y.getSelection().removeAllRanges(),r.trigger(h.default.fxrotatetheme))},])),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(c);n.prototype.dispose.call(this)},t.prototype.addChild=function(n){if(!n)throw new Error(a);this.getJourneyWidget().addChild(n)},t.prototype.insertChild=function(n,t){if(!n)throw new Error(a);this.getJourneyWidget().insertChild(n,t)},t.prototype.removeChild=function(n){var t=this.getJourneyWidget();return t&&t.removeChild(n)},t.prototype.getStartBoardArea=function(){return this.element.findByClassName("fxs-startboard-target")},t.prototype.getJourneyArea=function(){return this.element.findByClassName("fxs-journey-target")},t.prototype.getStartBoardWidget=function(){return f.Widget.getWidget(this.getStartBoardArea(),o.Widget)},t.prototype.getJourneyWidget=function(){var n=f.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t})(s.Widget);t.Widget=v}));
define("MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg",[],(function(){"use strict";return{type:350,data:"<svg viewBox='0 0 17 14' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M17 0v14H0V0h17z' class='msportalfx-svg-c16'/><path d='M2 2h3v8H2zm4 0h7v4H6zm0 5h3v3H6zm4 0h3v3h-3z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/AllServices.svg",[],(function(){"use strict";return{type:344,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.432 22.112h27.119v6.307H19.432zm0 13.875h27.119v6.307H19.432zm0-27.75h27.119v6.307H19.432z' class='msportalfx-svg-c04'/><circle opacity='.6' cx='6.818' cy='39.152' r='3.784' class='msportalfx-svg-c15'/><circle opacity='.6' cx='6.818' cy='11.907' r='3.784' class='msportalfx-svg-c15'/><circle cx='6.818' cy='25.53' r='3.784' class='msportalfx-svg-c16'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/CaretUp.svg",[],(function(){"use strict";return{type:287,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1 8.1l.7.8L6 4.6l4.3 4.3.7-.8-5-5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Ellipsis.svg",[],(function(){"use strict";return{type:176,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='14.4' cy='7.6' r='1.6'/><circle cx='8' cy='7.6' r='1.6'/><circle cx='1.6' cy='7.6' r='1.6'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Home.svg",[],(function(){"use strict";return{type:335,data:"<svg viewBox='0 0 22.7 22.7' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><polygon points='11.2,2.1 0,13 4.1,13 4.1,20.3 9.1,20.3 9.1,15.5 13.4,15.5 13.4,20.3 17.7,20.3 17.7,13 22.7,13' class='msportalfx-svg-c16'/><polygon points='10.1,15.5 11.9,2.8 11.2,2.1 0,13 4.1,13 4.1,20.3 9.1,20.3 9.1,15.5' class='msportalfx-svg-c24'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Hyperlink.svg",[],(function(){"use strict";return{type:31,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.992 9.819l8.018-7.991v4.005H14V0H8.167v1h4.038L4.232 8.987l.76.833z'/><path d='M12.993 13.03H1.01V1.028h4.823V0H0v14h14V8.167h-1.007v4.863z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Plus.svg",[],(function(){"use strict";return{type:297,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8 18h2v-8h8V8h-8V0H8v8H0v2h8z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Star.svg",[],(function(){"use strict";return{type:283,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6 .3l1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/><\/g><\/svg>"}}));
define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r,u,f,e,o){"use strict";function a(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}var h;u.defineProperty(t,"__esModule",{value:!0});var c=i.Base,v=c.Constants,y=v.ResourceTypes.ResourceGroups,p=c.Diagnostics,l=i.ViewModels.Services,w=l.Browse,b=l.GridColumns,k=i.getUniqueId,s=p.createLog(n),d=y.toLowerCase(),g=i.forEachKey,nt=0,tt=r.getErrorMap({badCriteria:""});t.compareAssetTypeForSort=a;h=(function(){function n(n,t){var u=this,i;this._browsePackages={};this._extensionManager=n;this._assetTypeService=t;i=this._ltm=new r.TriggerableLifetimeManager;i.registerForDispose((function(){g(u._browsePackages,(function(n,t){t.cancel();t.dispose()}))}))}return n.prototype.dispose=function(){this._ltm.dispose()},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.initiateBrowse=function(n){var t=this,u;return n||tt.badCriteria(),u=new w.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then((function(i){var h="All browse operations returned.",c="browse-"+k(),f=new i.BrowsePackage(u),v=f.ltm;t._browsePackages[c]=f;var e=0,o=0,l=!1,a=[];return t._assetTypeService.assetTypes.forEach((function(i){var y,c;if(!f.canceled&&t._assetTypeSupportsCriteria(i,n)&&(y=i.assetTypeManifest,y.browseType===nt)){var u=function(){++o;l&&o===e&&(s.verbose(h),f.allOperationsReturned())},p=y.browseServiceViewModel,w=r.Extension.getWindowId({name:i.extension})+"."+y.name+"."+p;s.verbose("Browse provider "+w+" using optimized browse.");c="browse operation from "+w+" browse provider";a.push(t._extensionManager.getExtensionByName(i.extension).then((function(i){return i.getViewModel(y.browseServiceViewModelLocator||p,11).then((function(r){var e=r.content(),o,l,h;e?(o=!1,v.registerForDispose((function(){o=!0;t._releaseViewModel(i,r)})),o?(s.verbose("The "+c+" was already disposed."),u()):(l=function(n,t){f.canceled||(s.verbose("Got "+c+"."),f.addOperation(n,t));u()},h=void 0,typeof e.onInputsSet=="function"&&(h=e.onInputsSet({criteria:n})),(h||Q()).then((function(){l(w,e)})).catch((function(n){s.verbose("The "+c+" rejected the load promise: "+n);u()})))):(s.verbose("$Failed to get the "+c+"."),u())})).catch((function(n){s.verbose("Failed to get browse operation "+p+": "+n+".");u()}))})).catch((function(n){s.error("Failed to get extension for browse operation "+p+": "+n);u()})));s.verbose("Getting "+c+".");++e}})),l=!0,o===e&&(s.verbose(h),f.allOperationsReturned()),Q.all(a).then((function(){return c}))}))},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.getFilteredAssetTypes=function(){var r=this,n=[],t=[];return this._assetTypeService.assetTypes.forEach((function(t){var i=t.assetTypeManifest;r._assetTypeMeetsRequirements(i)&&(i.privateBrowse||n.push(t))})),n.length&&i.stableSort(n,(function(n,t){return a(n.compositeDisplayName.service,t.compositeDisplayName.service)})).forEach((function(n){t.push(n)})),t},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var u=this,i=n.assetTypeManifest,r=i.gridColumnsServiceViewModelLocator||i.gridColumnsServiceViewModel;return r?this._extensionManager.getExtensionByName(n.extension).then((function(n){return n.getViewModel(r,11).then((function(i){var e=!1,r,f;return(t.registerForDispose((function(){e=!0;u._releaseViewModel(n,i)})),!e)?(r=i.content(),f=void 0,typeof r.onInputsSet=="function"&&(f=r.onInputsSet({usage:b.Usage.Default})),f)?f.then((function(){return r})):r:Q.reject("The grid columns service view model was already disposed.")}))})):Q.reject("The asset type does not have a grid columns service view model.")},n.prototype.getDynamicBladePromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModelLocator||n.assetTypeManifest.dynamicBladeServiceViewModel;return i?this._extensionManager.getExtensionByName(n.extension).then((function(n){return n.getViewModel(i,11).then((function(i){var u=!1;return(t.registerForDispose((function(){u=!0;r._releaseViewModel(n,i)})),!u)?i.content():Q.reject("The dynamic blade service view model was already disposed.")}))})):Q.reject("The asset type does not have a dynamic blade service view model.")},n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType},n.prototype._releaseViewModel=function(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var r,t,i,u,f;return n?(r=n.browseType,r===undefined)?!1:(t=n.resourceType,!t)?!0:(i=t.resourceTypeName,u=i.toLowerCase(),u===d)?!0:(f=i.split("/"),f.length<2)?!1:!0:!1},n})();h=__decorate([f.Class(),__metadata("design:paramtypes",[e.ExtensionManager,o.AssetTypeService])],h);t.BrowseManager=h}));
define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function kt(n,t,r,u){var e=f.computed(n,t,i.identity),o;e.extend(et);o=e.subscribe(n,r);u&&o.callback(e())}function b(n,t){return t&&n.kindMap&&n.kindMap[(t||"").toLowerCase()]}function y(n,t,i){t===tt.BrowseResourceGroupBlade&&(t=tt.ResourceGroups);var r=lt.getWindowId({name:n});return at.getAssetTypeOrResourceTypeIdByWindowId(r,t)+(i?"."+i.toLowerCase():"")}function k(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||it.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function ot(n,t){return t&&t.icon||n.icon}function st(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function dt(n,t){return n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function d(n,t,i){var e,r,u,f;return t?(u=t.indexOf("."),u>0&&(r=t,t=r.substring(0,u),e=r.substring(u+1)),f=n.first((function(n){return n.id===t})),f&&g(f,e,i,[],r)):null}function gt(n,t,i){var e=[],r=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],],u;if(i&&n.version()<r.length-1){var f=n.favorites,s=f().toLowerCase(),o=a(f());for(u=(n.version()||0)+1;u<r.length;u++)r[u].forEach((function(n){var t=n.toLowerCase();s.indexOf(t)<0&&(o.push(n),e.push(n))}));f(v(o))}t(e);n.version(r.length-1)}function g(n,t,i,r,u){var s=n.assetTypeManifest,e=b(n,t),o=k(n,e),h=n.id.toLowerCase(),c=!!w(r,(function(n){return n.toLowerCase()===h}));return{id:u||n.id,image:ot(n,e),isFavorite:f.observable(!1),isFilteredOut:f.observable(!1),isHidden:f.observable(c),label:o,labelId:o.replace(ut,""),keywords:st(n,e),matches:f.observable(),uri:i.getAssetTypeDeepLink(n,t),opensExternal:s.browseType===3,isPreview:n.isPreview,assetType:n,kind:t}}function ni(n){var t=[];return n.forEach((function(n){t=i.union(t,(n.associated||[]).map((function(n){return y(n.extensionName,n.assetType,n.kind)})))})),t}var et,ht,p;u.defineProperty(t,"__esModule",{value:!0});var nt=i.Base,ct=nt.Constants,tt=ct.AssetNames,lt=r.Extension,at=r.Assets,vt=i.Hubs.Notifications.NotificationStatus,yt=nt.Diagnostics,pt=i.tryImmediateResolve,it=o.Favorites,rt=it.Notification,ti=yt.createLog(n),a=JSON.parse,v=JSON.stringify,wt="uncurated",ut=/\s+/g,w=i.find,ft=i.stableSort,bt={};r.getAssetTypeMappingData=function(){return bt};et={deferred:!0};t.connectDebouncedObservable=kt;t.getAssetTypeKind=b;t.getAssetTypeDisplayText=k;t.findFavoriteItem=d;t.calculateHiddenAssetTypes=ni;ht=(function(){function n(n,t){var i=this;this._assetTypeService=n;this._browseManager=t;this.categories=f.observableArray();this.categoriesLookup={};this.showCategories=f.observable(!1);this.possibleFavorites=f.observableArray();this.possibleFavoritesLookup={};this.favorites=f.observableArray();this._notificationsForItems=f.observable();this._ltm=new r.TriggerableLifetimeManager;this._extensionToDefaultCategoryMap={};this._missingFavoritesWithIndex={};this._hiddenAssetTypes=[];this._assetTypes=f.observable();this._initialFavorites=[];this._categoriesInitialized=!1;this.remove=function(n){var t=i._savedFavorites().length&&a(i._savedFavorites())||[],r=t.indexOf(n);r!==-1&&(t.splice(r,1),i._savedFavorites(v(t)))};this.add=function(n){var t=a(i._savedFavorites())||[];t.includes(n)||(t.push(n),i._savedFavorites(v(t)))};this.move=function(n){var t=a(i._savedFavorites())||[],r=i.favorites()[n],u=t.indexOf(r.id);t.splice(n,0,t.splice(u,1)[0]);i._savedFavorites(v(t))};this._savedFavorites=f.observable("")}return n.prototype.initializeFavorites=function(n){var t=this._savedFavorites=n.favorites,r=!!(t&&t());return r&&(i.isFeatureEnabled("skipfavoritesupgrade")||gt(n,this._notificationsForItems,r),this._initialFavorites=a(t())),this._registerDependency(),this.loadFavorites()},n.prototype.initializeCategories=function(){var n=this,t=this._curationPromise||h.getBrowseCuration();return this._categoriesInitialized=!0,t.then((function(t){var h,u;n._discoveryPolicy=t.discoveryPolicy||0;var e=function(n,t){var i={id:n,showLabel:f.observable(!0),isFilteredOut:f.observable(!1),isHidden:f.pureComputed((function(){return!i.possibleFavorites().some((function(n){return!n.isHidden()&&!n.isFilteredOut()}))})),label:s.provideCategoryName(n),count:f.observable(0),possibleFavorites:f.observableArray(),sourceCategory:t};return i},o=t.categories||[],r=o.map((function(n){return e(n.id,n)}));r&&r.length&&(h=n._uncuratedCategory=e(wt),r.push(h));n.categories(r);n.possibleFavorites().forEach((function(t){var r=b(t.assetType,t.kind),u=t.assetType,f=k(u,r);t.label=f;t.labelId=f.replace(ut,"");t.image=ot(u,r);t.keywords=st(u,r);t.isHidden(t.isHidden()&&!!i.find(n._hiddenAssetTypes,(function(n){return n===t.id})))}));u={};o.forEach((function(t){(t.discoveryExtensions||[]).forEach((function(i){u[i]=w(r,(function(n){return n.id===t.id}))||n._uncuratedCategory}))}));n._extensionToDefaultCategoryMap=u;n._loadFlyoutMenu()}))},n.prototype.loadFavorites=function(){var n=this,f=function(t){var i=[];return t.forEach((function(n){switch(typeof n){case"string":if(n.startsWith("{"))try{var t=a(n);typeof t.typeId=="string"&&t.typeId&&i.push(t.typeId)}catch(r){}else i.push(n);break;case"object":n&&typeof n.typeId=="string"&&i.push(n.typeId)}})),n._savedFavorites(v(i)),i},i=this._savedFavorites&&this._savedFavorites().length&&f(a(this._savedFavorites()))||[],t=[],e=Q.isFulfilled(this._assetTypeService.assetTypesComplete),r=function(i,r){var u=d(n._assetTypes(),i,n._assetTypeService);u?(u.isFavorite(!0),t.push(u)):n._missingFavoritesWithIndex[i]=r},u=function(){var i=n._notificationsForItems()||[],r=i.slice(0);i.forEach((function(n){var i=w(t,(function(t){return n===t.id})),u,f;i&&(u=rt.titleFmt.format(i.label),f=i.assetType.assetTypeManifest||{},l.getNotificationManager().addClientNotification({title:u,description:rt.Description[(f.name||"").toLowerCase()]||u,status:vt.Information,timestamp:new Date,uri:i.uri}),r.remove(n))}));n._notificationsForItems(r);n.favorites(t)};return i.length?(i.forEach((function(n,t){n&&r(n,t)})),u(),Q()):(this._curationPromise=h.getBrowseCuration()).then((function(t){var i=n._initialFavorites;t.favorites.forEach((function(n){var t=y(n.extensionName,n.assetType,n.kind);i.push(t)}));n._initialFavorites.forEach((function(n,t){r(n,t)}));n._savedFavorites(v(i));u()}))},n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._registerDependency=function(){var n=this;this._assetTypes([]);pt(this._assetTypeService.assetTypesComplete,(function(){var t=n._browseManager.getFilteredAssetTypes()||[];t.length&&n._assetTypes(t);i.forEachKey(n._missingFavoritesWithIndex,(function(i,r){if(r!==-1){var u=d(t,i,n._assetTypeService);u&&(u.isFavorite(!0),n.favorites.splice(r,0,u),n._missingFavoritesWithIndex[i]=-1)}}));n._categoriesInitialized&&n._loadFlyoutMenu()}))},n.prototype._addBrowseMenuItem=function(n,t){var u=y(n.extension,n.assetTypeManifest.name,t),i=g(n,t,this._assetTypeService,this._hiddenAssetTypes,u),r;this.possibleFavoritesLookup[u]||(this.possibleFavorites().push(i),r=this.favorites().first((function(n){return n.id===i.id})),r&&(i.isFavorite=r.isFavorite),this.possibleFavoritesLookup[i.id]=i)},n.prototype._addBrowseMenuItemToCategory=function(n,t,i,r,u){var s=y(n.extension,n.assetTypeManifest.name,i),e=g(n,i,this._assetTypeService,this._hiddenAssetTypes,s),o,f;u.some((function(n){return n.id===s}))||(f=this.possibleFavoritesLookup[e.id],f&&(e.isFavorite=f.isFavorite,o=e.isHidden=f.isHidden,o(o()||r)),u.splice(t,0,e));r&&(f=this.possibleFavorites().filter((function(n){return n.id===e.id}))[0],f&&f.isHidden(r))},n.prototype._loadFlyoutMenu=function(){var n=this,f=this.possibleFavoritesLookup,t,i,r,e,o;this._assetTypes().forEach((function(t){n._addBrowseMenuItem(t,undefined)}));t=this.categories();this.showCategories(!!t.length);i=u.keys(f).slice(0);t.forEach((function(t){var u=t.possibleFavorites;u();var f=t.sourceCategory,e=f&&f.items||[],r=[];e.length&&(e.forEach((function(t,u){var f=-1,e,o;n._assetTypes().some((function(n){if(dt(t,n)){var i=(t.kind||"").toLowerCase();o=i&&n.kindMap&&n.kindMap[i]&&t.kind;f=u;e=n}return f>-1}));f>-1&&(o&&n._addBrowseMenuItem(e,o),i.remove(e.id),n._addBrowseMenuItemToCategory(e,f,o,!!t.isHidden,r))})),u(r),t.count(r.filter((function(n){return!n.isHidden()})).length))}));r=this._uncuratedCategory;e=[];r&&(o=ft(i.map((function(n){return f[n]})),(function(n,t){return c.compareAssetTypeForSort(n.label,t.label)})),o.forEach((function(t){var o=t.assetType,u=n._extensionToDefaultCategoryMap[o.extension],s=u||r,h=!u&&n._discoveryPolicy===1,f,i;n.possibleFavorites().filter((function(n){return n.id===t.id}))[0].isHidden(h);f=s.possibleFavorites;i=[];i=u?f():e;n._addBrowseMenuItemToCategory(o,i.length,undefined,h,i);f(i);s.count(i.length)})));this.possibleFavorites(ft(this.possibleFavorites(),(function(n,t){return c.compareAssetTypeForSort(n.label,t.label)})))},n})();p=(function(){function n(){}return n.create=function(n,t){return new ht(n,t)},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[s.AssetTypeService,c.BrowseManager]),__metadata("design:returntype",p)],p,"create",null);t.FavoritesManager=p}));
define("_generated/Templates/WidgetsSideBar",["require","exports"],(function(){"use strict";return function(){return'<nav class="fxs-sidebar-bar" data-bind="attr: { \'aria-label\': data.svcNavLabel }"> <div class="fxs-sidebar-top"> <button class="fxs-sidebar-collapse-button fxs-sidebar-button" data-bind="image: data.icons.doubleChevron"><\/button> <!-- ko foreach: topSectionLinks --> <a class="fxs-sidebar-item-link" data-bind="css: classes, attr: { href: href, title: title, \'aria-label\': title }"> <div class="fxs-sidebar-icon" data-bind="image: icon"><\/div> <div class="fxs-sidebar-label" data-bind="text: text"><\/div> <\/a> <!-- /ko --> <button class="fxs-sidebar-item-link fxs-sidebar-browse fxs-sidebar-button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"> <div class="fxs-sidebar-icon" data-bind="image: data.icons.allServices"><\/div> <div class="fxs-sidebar-label" data-bind="text: data.browseText"><\/div> <\/button> <div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div> <\/div> <div class="fxs-sidebar-favorites-section"> <div class="fxs-sidebar-divider"><\/div> <div class="fxs-sidebar-fav-icon" data-bind="image: data.icons.star"><\/div> <span class="fxs-sidebar-myfavorites" data-bind="text: data.myFavoritesText"><\/span> <div class="fxs-sidebar-divider"><\/div> <\/div> <div class="fxs-sidebar-middle"> <ul class="fxs-sidebar-favorites fxs-sidebar-list" data-bind="attr: { \'aria-label\': data.svcListText }"> <!-- ko foreach: func._favorites --> <li class="fxs-sidebar-item fxs-sidebar-draggable fxs-sidebar-droppable" draggable="true" role="presentation"> <a tabindex=\'-1\' class=\'fxs-sidebar-item-link\' data-bind="attr: { href: uri, title: label, \'aria-label\': label }"> <div class="fxs-sidebar-icon" data-bind="image: image"><\/div> <div class="fxs-sidebar-label" data-bind="text: label"><\/div> <div class="fxs-sidebar-external" data-bind="visible: $data.opensExternal, image: $root.data.icons.hyperlink"><\/div> <div class="fxs-sidebar-handle" data-bind="image: $root.data.icons.ellipsis"><\/div> <\/a> <\/li> <!-- /ko --> <\/ul> <\/div> <div class=\'fxs-sidebar-shadow\'><\/div> <\/nav>'}}));
define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","i","o","ko","$","FxInternal/Di","MsPortalImpl/Base/Base.Router","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Svg/Startup/AllServices.svg","MsPortalImpl/Svg/Startup/Home.svg","MsPortalImpl/Svg/Startup/CaretUp.svg","MsPortalImpl/Svg/Startup/DoubleChevron.svg","MsPortalImpl/Svg/Startup/Ellipsis.svg","MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Svg/Startup/Plus.svg","MsPortalImpl/Svg/Startup/Star.svg","MsPortalImpl/Svg/Library/Polychromatic/Dashboard.svg","MsPortalImpl/Services/Services.GeneralSettings","FxHubs/RpcEndPoints","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","_generated/Templates/WidgetsSideBar","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){"use strict";function ri(n){return i.isFeatureEnabled("artbrowse")&&n.get(ut.GeneralSettings).optIntoNewBrowse()}function lt(n,t,i){kt.Diagnostics.Telemetry.trace({source:a.Source.SideBar,name:t,action:n,data:i})}function si(n){var i=n.isCollapsed,u=i(),t=!u,r=n.saveCollapseState;r&&r(t);i(t);lt(ct.SideBarViewChanged,"",t?"collapsed":"expanded")}function ui(n,t,i){var f;if(t){var r=i.favorites,u=r.indexOf(n),e=r.indexOf(t);if(u||!t.opensExternal)return lt(ct.SideBarFavoriteMoved,t.id,{oldIndex:e,newIndex:u}),r.valueWillMutate(),f=r(),f.splice(u,0,f.splice(e,1)[0]),i.favoritesManager().move(u),r.valueHasMutated(),u}return-1}function hi(n,t,i){var u=e(document.activeElement).parent(),o=i===40?u.next(ii)[0]:u.prev(ii)[0],s,r;o&&(s=f.dataFor(o),r=ui(s,n,t),r>=0&&Q.fcall((function(){var i=t.favorites()[r].uri,n=e.querySelectorAll("."+ti+" [href|='"+i+"']")[0];n&&n.focus()})))}var pt,fi;u.defineProperty(t,"__esModule",{value:!0});var kt=i.Base,ht=kt.Images,ei=window,dt=ei.fx.environment,at=y.default.click,wt=".fxs-sidebar-droppable",oi=r.Extension.getHubsWindowId()+"_BrowseAllResources",vt="fxs-sidebar-entered",yt=".fxs-sidebar-entered",gt="fxs-sidebar-flyout",ni=y.default.keydown,ti="fxs-sidebar-bar",ii="li.fxs-sidebar-item",st=h.SideBar,ct=a.Action,bt=".fxs-sidebar-item-link";t.isArtBrowseEnabled=o.defineHandler(ft.ArtBrowse.isArtBrowseEnabledEndpoint,(function(n){return ri(n.diContainer)}));pt=(function(n){function t(t){var r=n.call(this)||this;return r.diContainer=t,r.browseText=i.isFeatureEnabled("brandingsidebar")?dt.branding.browseLabel:st.allServices,r.svcListText=st.svcList,r.svcNavLabel=st.svcNavLabel,r.closeText=st.close,r.myFavoritesText=st.myFavorites,r.browseTooltip=r.browseText,r.newResourceAriaLabel=st.newResourceAriaLabel,r.favorites=f.observableArray(),r.isCollapsed=f.observable(!0),r.onFavoritesChanged=f.observableArray([]),r.openFavorite=function(n,t,i){var u,f,o,e;if(typeof n=="number"?(f=r.favoritesManager(),o=f&&f.favorites||r.favorites,u=o()[n]):u=n,u){if(u.opensExternal)return r.openExternal(u.uri),!0;if(!t&&!i)return e=u.uri,u.id===oi&&ri(r.diContainer)&&(e="#blade/HubsExtension/BrowseAll"),r.launchBlade(e,u),!0}},r.possibleFavorites=f.observableArray(),r.previewText=st.preview,r.icons={allServices:w,doubleChevron:ht.CustomImageWithOptions(d,{isLogo:!0}),star:ht.CustomImageWithOptions(it,{isLogo:!0,customClass:"msportalfx-svg-c11"}),hyperlink:ht.CustomImageWithOptions(nt,{isLogo:!0}),ellipsis:ht.CustomImageWithOptions(g,{isLogo:!0}),caretUp:ht.CustomImageWithOptions(k,{isLogo:!0})},r.favoritesManager=f.observable(),r}return __extends(t,n),t.prototype.openExternal=function(n){window.open(n,"_blank")},t.prototype.attachFavoritesManager=function(n){this.favoritesManager(n)},t.prototype.initLifetime=function(n){var t=this;this.favoritesManager.subscribeAndRun(n,(function(i){i&&l.connectDebouncedObservable(n,i.favorites,t.favorites)}))},t})(v.ViewModel);pt=__decorate([o.Class(),__metadata("design:paramtypes",[o.Container])],pt);t.ViewModel=pt;fi=(function(n){function t(t,r,u){var e=n.call(this,t,r)||this,k,o,l,a,v,w;return t.attr("role","presentation").html(ot()),k=t.findByClassName("fxs-sidebar-collapse-button"),o=e.ltm,r.initLifetime(o),l=e._favorites=r.favorites.filter(o,(function(n){return!!n})).map(o,(function(n,t){return t.image=t.image&&i.Base.Images.CustomImageWithOptions(t.image,{isLogo:!0}),t})),l.extend({deferred:!0}),a=t.find(".fxs-sidebar-favorites"),l.subscribeAndRun(o,(function(){p.requestAnimationFrame((function(){var n=a.find(bt+'[tabindex="0"]:eq(0)');n.length||a.find(bt+":eq(0)").attr("tabindex","0")}))})),v=t.find(".fxs-sidebar-middle"),w=p.throttleByAnimationFrame((function(){var n="",t;r.isCollapsed()&&(t=Math.min(30,v.scrollTop()),n="linear-gradient(transparent,#000 "+t+"px,#000 calc(100% - 20px),transparent)");v.css({"-webkit-mask-image":n,"mask-image":n})})),new et.KeyboardNavigation(o,{element:a,tabTriggers:12,itemSelector:bt}),o.registerForDispose([v.setEvents([y.default.scroll,w,]),]),e._bindDescendants({topSectionLinks:[!dt.chrome.hideCreateButton&&{classes:"fxs-sidebar-create",title:st.createTooltip,text:st.createResource,icon:ht.CustomImageWithOptions(tt,{customClass:"msportalfx-fill-success"}),href:s.getGalleryDeepLink("hub","")},i.isFeatureEnabled("azurehome")&&{classes:"fxs-sidebar-home",title:h.AzureHome.azureHome,text:h.AzureHome.home,icon:ht.CustomImageWithOptions(b,{}),href:"#home"},{classes:"fxs-sidebar-dashboard",title:h.NavBar.home,text:h.NavBar.home,icon:ht.CustomImageWithOptions(rt,{}),href:"#dashboard"},].filter(i.identity)}),e._flyout=t.findByClassName(gt),e._attachEventHandlers(),f.computed(o,r.onFavoritesChanged,(function(n){if(n.length){l();var i=c.findByClassName(t,"fxs-sidebar-favorites:first .fxs-sidebar-item");n.slice().forEach((function(n){n(i)}))}})),e._getSidebarFlyout=i.memoizeQ((function(){return i.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout").then((function(n){var i=new n.ViewModel,t=new n.Widget(e.element.findByClassName(gt),i,u);return t.options.launchBlade=e.options.launchBlade,t.options.openFavorite=e.options.openFavorite,t}))})),r.isCollapsed.subscribeAndRun(o,(function(n){t.toggleClass("fxs-sidebar-is-collapsed",n);k.attr({title:n?st.expand:st.collapse,"aria-expanded":!n});w()})),e}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement()},t.prototype.toggleFlyout=function(){var n=this._flyout.hasClass("fxs-sidebar-flyout-is-hidden");i.tryImmediateResolve(this._getSidebarFlyout(),(function(t){t.toggle(n)}))},t.prototype.openCreate=function(){lt(ct.SideBarNewMenuOpened);this.options.launchBlade(s.getGalleryDeepLink("hub",""))},t.prototype.reorderFavorites=function(n){var t=f.dataFor(document.activeElement);hi(t,this.options,n)},t.prototype._attachEventHandlers=function(){var n=this;this.ltm.registerForDispose(this.element.setEvents([at,".fxs-sidebar-create",function(){lt(ct.SideBarNewMenuOpened)},],[at,".fxs-sidebar-browse",function(t){n.toggleFlyout();t.stopPropagation()},],[at,".fxs-sidebar-item a",function(t){var i=f.dataFor(t.target);lt(ct.SideBarItemOpened,i.id,{isFavorite:i.isFavorite()});n.options.openFavorite(i)&&t.preventDefault()},],[at,".fxs-sidebar-collapse-button",function(){si(n.options)},],[ni,"."+ti,function(n){if(n.type===ni&&n.keyCode===32){var t=e(n.target);t.trigger(y.default.click);t.hasClass("fxs-sidebar-filter-input")||n.preventDefault();n.stopPropagation()}},],[y.default.dragstart,".fxs-sidebar-draggable",function(t){var i=t.originalEvent.dataTransfer;i.setData("text","fxs-draganddrop");i.effectAllowed="move";n._dragItem=f.dataFor(t.target)},],[y.default.dragover,function(n){n.preventDefault()},],[y.default.dragenter,function(n){var t=e(n.target),i=t.closest(wt),r=t.closest(yt);r.length===0&&(e.querySelectorAll(yt).removeClass(vt),i.length&&i.addClass(vt))},],[y.default.dragleave,function(n){var t=e(n.target).closest(wt).length===0?!0:!1;t&&e.querySelectorAll(yt).removeClass(vt)},],[y.default.drop,function(t){var i=t.target,r=e(i).closest(wt),u=f.dataFor(i);t.preventDefault();e.querySelectorAll(yt).removeClass(vt);r.length&&ui(u,n._dragItem,n.options)},],[at,".fxs-sidebar-home",function(){lt(ct.AzureHomeLinkClicked)},],[at,".fxs-sidebar-dashboard",function(){lt(ct.DashboardNavigation)}]))},t})(v.Widget);t.Widget=fi}));
define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","o","a","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f,e){"use strict";function o(n){var t=u.unwrap(n&&n.timeoutID);t&&s.clearTimeout(t)}var h;i.defineProperty(t,"__esModule",{value:!0});var s=window,c=5e3,l=3e4;t.clearItemTimeout=o;h=(function(n){function t(t){t===void 0&&(t={});var i=n.call(this)||this;return i.displayCount=4,i.shouldShowToasts=u.observable(!0),i._items=u.observableArray(),i.eventHandlers=u.observableArray(),i.closeTitle=f.NotificationMenu.dismissToast,i.displayCount=t.displayCount||i.displayCount,i.shouldShowToasts=t.shouldShowToasts||i.shouldShowToasts,i}return __extends(t,n),t.prototype.addToasts=function(n){var t=this,i=r.isArray(n)?n:[n];i.length&&i.forEach((function(n){var l=t._items(),a=n.icon,v=n.title,y=n.description,p=n.uri,w=n.time,r=n.ids||[],h=n.data||null,e=n.duration||0,b=n.htmlContent||"",k=n.clickable!==!1,d=n.descriptiveText||f.Toast.description.format(n.title),i,s;if(e!==3)if(r.length>0&&(i=l.first((function(n){var t=n.ids();return r.some((function(n){return t.indexOf(n)>-1}))}))),i)i.icon(a),i.title(v),i.description(y),i.uri(p),i.time(w),i.ids(r),i.data(h),i.clickable(k),i.htmlContent(b),i.descriptiveText(d),i.duration(e),i.formSection(n.formSection),o(i),t.startRemoveTimer(i);else{s={icon:u.observable(a),title:u.observable(v),description:u.observable(y),uri:u.observable(p),time:u.observable(w),ids:u.observableArray(r),data:u.observable(h),htmlContent:u.observable(b),timeoutID:u.observable(null),clickable:u.observable(k),onDismissFn:n.onDismissFn,descriptiveText:u.observable(d),duration:u.observable(e),formSection:u.observable(n.formSection)};(l.length<t.displayCount||t._canDeque(e))&&t._items.unshift(s);var tt=(h||{}).inlineForm,g=n.formSection,nt=g&&g.children()||[],c=nt.length>1&&nt[1].children();c&&tt.buttons.forEach((function(n,i){if(!n.endpoint){var r=c[i].onClick;c[i].onClick=function(){r();t.removeToast(s)}}}));t.startRemoveTimer(s)}}))},t.prototype._canDeque=function(n){for(var t,r,u=this._items(),i=0;i<=n+0;i++)for(t=u.length-1;t>=0;t--)if(r=u[t],r.duration()===i)return this.removeToast(r),!0;return!1},t.prototype.removeToast=function(n){o(n);this._items.remove(n)},t.prototype.removeAllToasts=function(){this._items().forEach((function(n){o(n)}));this._items.removeAll()},t.prototype.startRemoveTimer=function(n){var i=this,t=u.unwrap(n.duration)||0;t!==2&&n.timeoutID(s.setTimeout((function(){i._items.remove(n)}),t===1?l:c))},t})(e.ViewModel);t.ViewModel=h}));
define("_generated/Templates/WidgetsToast",["require","exports","f"],(function(){"use strict";return function(){return'<ul role="presentation" class="fxs-toast" data-bind="visible: data.shouldShowToasts, foreach: func._uiItems"> <li class="fxs-toast-item fxs-popup fxs-portal-bg-txt-br" role="alert" aria-live="polite" aria-atomic="true" data-bind="attr: { \'aria-label\': descriptiveText }"> <!-- ko ifnot: htmlContent --> <div class="fxs-toast-wrapper"> <div class="fxs-toast-header"> <div class="fxs-toast-icon" data-bind="image: icon"><\/div> <!--ko if: clickable--> <a href="#" class="fxs-toast-title fxs-toast-link" data-bind="text: title"><\/a> <!-- /ko --> <!--ko ifnot: clickable--> <div class="fxs-toast-title fxs-portal-text" data-bind="text: title"><\/div> <!-- /ko --> <div class="fxs-toast-time fxs-portal-title" data-bind="attr: { datetime: time }, text: time"><\/div> <\/div> <div class="fxs-toast-description fxs-portal-title" data-bind="sanitizedHtml: description"><\/div> <!-- ko if: formSection --> <div class="msportalfx-form fxs-notification-inlineform" data-bind="pcControl: formSection"><\/div> <!-- /ko --> <\/div> <!-- /ko --> <!-- ko if: htmlContent --> <div class="fxs-toast-content" aria-hidden="true" data-bind="unsanitizedHtml: htmlContent"><\/div> <!-- /ko --> <button class="fxs-toast-close fxs-portal-svg" aria-hidden="true" data-bind="image: MsPortalFx.Base.Images.Shell.Close(), title: closeTitle"><\/button> <\/li> <\/ul>'}}));
define("MsPortalImpl/Widgets/Widgets.Toast",["require","exports","f","ko","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsToast","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var t=".fxs-toast-item",h=".fxs-toast-link",c=".fxs-toast-close",l=(function(n){function f(t,u){var f=n.call(this,t,u)||this;return f._uiItems=r.computed(f.ltm,u._items,i.identity).extend({deferred:!0}),f.element.html(e()),f._attachEventHandlers(),f._bindDescendants(),f}return __extends(f,n),f.prototype._attachEventHandlers=function(){var n=this.element,f=this.options,e=this.ltm,l,a,v=function(n){var t=r.dataFor(n.currentTarget);o.clearItemTimeout(t)},y=function(n){var t=r.dataFor(n.currentTarget);t.duration&&f.startRemoveTimer(t)};n.on(s.default.focusin,t,v);n.on(s.default.focusout,t,y);n.on(s.default.mouseenter,t,v);n.on(s.default.mouseleave,t,y);n.on(s.default.click,h,l=function(t){var e=r.dataFor(t.currentTarget);e.clickable()&&(t.preventDefault(),i.Base.Diagnostics.Telemetry.trace({source:u.Source.ToastTray,action:u.Action.ToastClicked}),n.trigger(s.default.fxtoastclick,e.data()),f.removeToast(e))});n.on(s.default.click,c,a=function(n){n.preventDefault();var t=r.dataFor(n.currentTarget);t.onDismissFn&&t.onDismissFn();f.removeToast(t)});f.eventHandlers.map(e,(function(t,i){n.on(i.events,i.selector,i.data,i.handler);t.registerForDispose((function(){n.off(i.events,i.selector,i.handler)}))}));e.registerForDispose((function(){n.off(s.default.focusin,t);n.off(s.default.focusout,t);n.off(s.default.mouseenter,t);n.off(s.default.mouseleave,t);n.off(s.default.click,h,l);n.off(s.default.click,c,a)}))},f})(f.Widget);n.Widget=l})(h||(h={})),h}));
define("MsPortalImpl/Svg/Startup/Console.svg",[],(function(){"use strict";return{type:333,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M.9.3L8.5 8 .8 15.7l-.7-.6 7-7.1-7-7m8.8 13.7h7v1h-7z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DirectoryFilter.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755l-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 19.723 20' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.514 8.63H8.826v1.894l.061.061 3.454 4.442V20h3.867v-4.973l3.454-4.442.061-.061V8.63zm-4.637 5.755l-.061.061v4.164h-1.085v-4.168l-.061-.061-3.376-4.364h7.961z'/><path fill='#8a2da5' d='M13.67 14.381l.061.061v4.168h1.086v-4.164l.06-.061 3.378-4.369h-7.962l3.377 4.365z'/><path d='M3.578 0a1.766 1.766 0 0 0-.744.166A2.153 2.153 0 0 0 2.217.6a2.13 2.13 0 0 0-.433.621 1.762 1.762 0 0 0-.165.739V4H0v1.418h1.619v6.589H0v1.415h1.619v2.044a1.893 1.893 0 0 0 .154.762 1.969 1.969 0 0 0 .42.623 1.944 1.944 0 0 0 .625.421 1.91 1.91 0 0 0 .75.152h7.459v-1.415H6.485V1.416h9.13v6h1.415V0zm1.5 16.009H3.7a.645.645 0 0 1-.26-.051.686.686 0 0 1-.212-.144.711.711 0 0 1-.145-.214 1.861 1.861 0 0 1-.047-.387v-1.791h.7v-1.415h-.7V5.418h.7V4h-.7V2.084a.493.493 0 0 1 .054-.22.88.88 0 0 1 .39-.391.5.5 0 0 1 .22-.057h1.382z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Help.svg",[],(function(){"use strict";return{type:130,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8 0l1.2.2 1.1.4.9.7.7.9a3.6 3.6 0 0 1 .4 1.1 5 5 0 0 1 .2 1.2 5 5 0 0 1-.2 1.2 4.2 4.2 0 0 1-.4 1l-.7.8a2.3 2.3 0 0 1-.7.7l-.7.7-.7.7a3.6 3.6 0 0 0-.4.9 3.6 3.6 0 0 0-.2 1V13h-1v-1.5a5 5 0 0 1 .2-1.2 4.2 4.2 0 0 1 .4-1l.7-.8.7-.7.7-.7a2.3 2.3 0 0 0 .7-.7 3.6 3.6 0 0 0 .4-.9 3.6 3.6 0 0 0 .2-1 3.2 3.2 0 0 0-.3-1.4 4.1 4.1 0 0 0-.7-1.1 4.1 4.1 0 0 0-1.1-.7A3.2 3.2 0 0 0 8 1a3.2 3.2 0 0 0-1.4.3 4.1 4.1 0 0 0-1.1.7 4.1 4.1 0 0 0-.7 1.1 3.2 3.2 0 0 0-.3 1.4h-1a5 5 0 0 1 .2-1.2 3.6 3.6 0 0 1 .4-1.1l.7-.9.9-.7L6.8.2zm-.5 15h1v1h-1z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Notifications.svg",[],(function(){"use strict";return{type:342,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 12v1h-4a2.4 2.4 0 0 1-.2.8l-.4.6-.6.4-.8.2-.8-.2-.6-.4-.4-.6A2.4 2.4 0 0 1 6 13H2v-1h1V6a5.9 5.9 0 0 1 .2-1.3 6.1 6.1 0 0 1 .5-1.2 3.9 3.9 0 0 1 .8-1 3.9 3.9 0 0 1 1-.8l1.2-.5L8 1l1.3.2 1.2.5a3.9 3.9 0 0 1 1 .8 3.9 3.9 0 0 1 .8 1 6.1 6.1 0 0 1 .5 1.2A5.9 5.9 0 0 1 13 6v6zm-2 0V6a4.5 4.5 0 0 0-.3-1.6 2.7 2.7 0 0 0-.9-1.2 2.7 2.7 0 0 0-1.2-.9 4.4 4.4 0 0 0-3.2 0 2.7 2.7 0 0 0-1.2.9 2.7 2.7 0 0 0-.9 1.2A4.5 4.5 0 0 0 4 6v6zm-4 2h.4l.3-.2.2-.3A.7.7 0 0 0 9 13H7a.6.6 0 0 0 .1.4l.2.3.3.2z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Settings.svg",[],(function(){"use strict";return{type:341,data:"<svg viewBox='0 0 15.9 15.9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M13.9 7.7V8l2 1.3-1.2 3-2.4-.3-.3.3.5 2.4-3 1.2-1.3-2h-.5l-1.3 2-3-1.2.6-2.4-.4-.3-2.4.5-1.2-3 2-1.3v-.4L0 6.4l1.2-3 2.4.6a.8.8 0 0 1 .4-.4l-.6-2.4 3-1.2 1.3 2h.5l1.3-2 3 1.2-.5 2.4.3.4 2.4-.6 1.2 3zm-.9 1V7.2l1.8-1.1-.7-1.7-2.1.5a1.2 1.2 0 0 0-.5-.5 1.2 1.2 0 0 0-.5-.5l.5-2.1-1.7-.7-1.1 1.8H7.2L6.1 1.1l-1.7.7.5 2.1a1.2 1.2 0 0 0-.5.5 1.2 1.2 0 0 0-.5.5l-2.1-.5-.7 1.7 1.8 1.1v1.5L1.1 9.8l.7 1.7 2.1-.5.5.5.5.5-.5 2.1 1.7.7L7.2 13h1.5l1.1 1.8 1.7-.7L11 12l.5-.5.5-.5 2.1.5.7-1.7zM8 5l1.1.2a2.2 2.2 0 0 1 .9.7 3.1 3.1 0 0 1 .7.9 4.3 4.3 0 0 1 .2 1.2 4.3 4.3 0 0 1-.2 1.1 2.2 2.2 0 0 1-.7.9 2.2 2.2 0 0 1-.9.7l-1.1.2-1.2-.2a3.1 3.1 0 0 1-.9-.7 2.2 2.2 0 0 1-.7-.9A4.3 4.3 0 0 1 5 8a4.3 4.3 0 0 1 .2-1.2 3.1 3.1 0 0 1 .7-.9 3.1 3.1 0 0 1 .9-.7zm0 5h.8l.6-.5.5-.6A2.5 2.5 0 0 0 10 8a2.8 2.8 0 0 0-.1-.9l-.5-.6-.6-.4a1.3 1.3 0 0 0-.8-.2 1.5 1.5 0 0 0-.9.2l-.6.4-.4.6a1.5 1.5 0 0 0-.2.9 1.3 1.3 0 0 0 .2.8l.4.6.6.5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/SmileyHappy.svg",[],(function(){"use strict";return{type:319,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8 0a7.6 7.6 0 0 1 2.1.3 6.4 6.4 0 0 1 1.9.8 10.4 10.4 0 0 1 1.7 1.2A10.4 10.4 0 0 1 14.9 4a6.4 6.4 0 0 1 .8 1.9 7.5 7.5 0 0 1 0 4.2 6.4 6.4 0 0 1-.8 1.9 10.4 10.4 0 0 1-1.2 1.7 10.4 10.4 0 0 1-1.7 1.2 6.4 6.4 0 0 1-1.9.8 7.5 7.5 0 0 1-4.2 0 6.4 6.4 0 0 1-1.9-.8 10.4 10.4 0 0 1-1.7-1.2A10.4 10.4 0 0 1 1.1 12a6.4 6.4 0 0 1-.8-1.9 7.5 7.5 0 0 1 0-4.2A6.4 6.4 0 0 1 1.1 4a10.4 10.4 0 0 1 1.2-1.7A10.4 10.4 0 0 1 4 1.1 6.4 6.4 0 0 1 5.9.3 7.6 7.6 0 0 1 8 0zm0 15l1.9-.2 1.6-.8a4.9 4.9 0 0 0 1.4-1.1 4.9 4.9 0 0 0 1.1-1.4 8 8 0 0 0 .8-1.6A12.3 12.3 0 0 0 15 8a12.3 12.3 0 0 0-.2-1.9 8 8 0 0 0-.8-1.6 4.9 4.9 0 0 0-1.1-1.4A4.9 4.9 0 0 0 11.5 2a4.6 4.6 0 0 0-1.6-.7 6.2 6.2 0 0 0-3.8 0 4.6 4.6 0 0 0-1.6.7 4.9 4.9 0 0 0-1.4 1.1A4.9 4.9 0 0 0 2 4.5a4.6 4.6 0 0 0-.7 1.6 6.2 6.2 0 0 0 0 3.8 4.6 4.6 0 0 0 .7 1.6 4.9 4.9 0 0 0 1.1 1.4A4.9 4.9 0 0 0 4.5 14l1.6.8zm0-3l1.1-.2 1-.4a2.7 2.7 0 0 0 .8-.7l.7-.9.9.4-.8 1.2-1.1.9-1.2.5L8 13l-1.4-.2-1.2-.5-1.1-.9-.8-1.2.9-.4.7.9a2.7 2.7 0 0 0 .8.7l1 .4zM5 7h-.4l-.3-.2-.2-.3A.6.6 0 0 1 4 6a.6.6 0 0 1 .1-.4l.2-.3.3-.2h.8l.3.2.2.3A.6.6 0 0 1 6 6a.6.6 0 0 1-.1.4l-.2.3-.3.2zm6 0h-.4l-.3-.2-.2-.3A.6.6 0 0 1 10 6a.6.6 0 0 1 .1-.4l.2-.3.3-.2h.8l.3.2.2.3a.6.6 0 0 1 .1.4.6.6 0 0 1-.1.4l-.2.3-.3.2z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Feedback.svg",[],(function(){"use strict";return{type:228,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M13.903 2.152a2.626 2.626 0 0 0-.936-.651c-1.62-.674-3.959.165-5.425 2.246C5.289 1.028 2.594.517 1.094 2.152c-2.997 3.264.756 7.552 3.717 9.987 1.167.96 2.211 1.632 2.67 1.84V14l.016-.008s.016.007.022.008v-.021c1.62-.735 10.561-7.277 6.384-11.827z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/LaunchCurrent.svg",[],(function(){"use strict";return{type:227,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.883.942v1.586h3.118L6.314 8.214a.792.792 0 1 0 1.121 1.122l5.545-5.545v2.833h1.586V.942H8.883z'/><path d='M12.01 6.064a.316.316 0 0 0-.344.068l-.946.946a.316.316 0 0 0-.092.223v3.746c0 .601-.489 1.09-1.09 1.09H3.272c-.601 0-1.09-.489-1.09-1.09V6.07c0-.601.489-1.09 1.09-1.09h4.762a.315.315 0 0 0 .223-.092l.946-.946a.316.316 0 0 0-.223-.539H3.272A2.67 2.67 0 0 0 .605 6.07v4.977a2.67 2.67 0 0 0 2.667 2.667h6.266a2.67 2.67 0 0 0 2.667-2.667V6.355a.319.319 0 0 0-.195-.291z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Mail.svg",[],(function(){"use strict";return{type:267,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M7.9 9.3c-.2 0-.3-.1-.5-.2l-7-5.8 1-1L8 7.7 14.7 2l1 1-7.4 6c0 .2-.1.3-.4.3z'/><path d='M15.2 1.1H.8c-.5 0-.8.4-.8.9v11c0 .5.3.9.8.9h14.4c.5 0 .8-.4.8-.9V2c0-.5-.3-.9-.8-.9zm-.8 11.2H1.6V2.7h12.8v9.6z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Person.svg",[],(function(){"use strict";return{type:44,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M35.859 10.269c0 5.671-4.638 10.269-10.359 10.269S15.142 15.94 15.142 10.269 19.779 0 25.5 0c5.721 0 10.359 4.598 10.359 10.269m-2.785 13.789L25.5 34.578l-7.574-10.52H7.001V50H44V24.058z' class='msportalfx-svg-c15'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Signout.svg",[],(function(){"use strict";return{type:226,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12.133 3.033a.995.995 0 1 0-1.408 1.408 4.543 4.543 0 0 1 1.336 3.225 4.544 4.544 0 0 1-1.336 3.225A4.547 4.547 0 0 1 7.5 12.227a4.54 4.54 0 0 1-3.224-1.336A4.544 4.544 0 0 1 2.94 7.666a4.543 4.543 0 0 1 1.336-3.225.995.995 0 1 0-1.408-1.408 6.537 6.537 0 0 0-1.92 4.633 6.535 6.535 0 0 0 1.92 4.633A6.537 6.537 0 0 0 7.5 14.218h.004a6.53 6.53 0 0 0 4.628-1.919 6.534 6.534 0 0 0 1.919-4.633 6.534 6.534 0 0 0-1.918-4.633zM7.5 8.662c.55 0 .996-.446.996-.996V1.655a.996.996 0 0 0-1.992 0v6.011c0 .55.446.996.996.996z'/><\/g><\/svg>"}}));
define("MsPortalImpl/ViewModels/AvatarMenuCommon",["require","exports","f","o","ko","MsPortalImpl/Svg/Startup/DirectoryFilter.svg","MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Svg/Library/LaunchCurrent.svg","MsPortalImpl/Svg/Library/Mail.svg","MsPortalImpl/Svg/Library/Person.svg","MsPortalImpl/Svg/Library/Signout.svg","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";r.defineProperty(t,"__esModule",{value:!0});var y=i.Base,v=y.Images,p=window,w=p.fx,b=w.environment,k=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.avatarImage=u.observable(),t.contactInfoEnabled=u.observable(!1),t.hideTenant=u.observable(),t.icons={contactInfo:v.CustomImageWithOptions(h,{isLogo:!0}),feedback:e,launchCurrent:s,person:v.CustomImageWithOptions(c,{palette:99}),signout:v.CustomImageWithOptions(l,{isLogo:!0}),switchDirectory:v.CustomImageWithOptions(f,{isLogo:!0})},t.links=b.links,t.listOfTenants=u.observableArray(),t.showDiagnosticsDelay=3e3,t.text=o.AvatarMenu,t.userIdentity=u.observable(),t.userInfo=u.observable(),t}return __extends(t,n),t})(a.ViewModel);t.ViewModel=k}));
define("_generated/Templates/WidgetsAvatarMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-dropdown"> <ul class="fxs-avatarmenu-list-system fxs-portal-border fxs-dropmenu-line-separator" role="presentation"> <li class="fxs-portal-hover" role="presentation"> <a href="" class="fxs-avatarmenu-signout fxs-avatarmenu-dropdown-item" role="menuitem" data-bind=\'attr: { title: data.text.signOutLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-error" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul role="presentation"> <li class="fxs-portal-hover" data-bind="visible: changePasswordLink" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-changepassword fxs-avatarmenu-dropdown-item" role="menuitem" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: data.text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.contactInfoEnabled" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-contactinfo fxs-avatarmenu-dropdown-item" role="menuitem" href=""> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.contactInfo"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.contactInfo"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-myaccess fxs-avatarmenu-dropdown-item" role="menuitem" href=""> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.person"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.submitAnIdea" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-feedback fxs-avatarmenu-dropdown-item" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.submitAnIdea, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.links.accountPortal" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-billing fxs-avatarmenu-dropdown-item" role="menuitem" href="" rel="noopener noreferrer"> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.accountPortal && data.links.accountPortal.startsWith(\'#\')"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-switchdirectory fxs-avatarmenu-dropdown-item" role="menuitem" href=""> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.switchDirectoryLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.switchDirectory"><\/div> <\/a> <\/li> <\/ul> <\/div> <\/div> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout",["require","exports","o","ko","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsAvatarMenu"],(function(n,t,i,r,u,f,e){"use strict";i.defineProperty(t,"__esModule",{value:!0});var o="fxs-avatarmenu-dropdown",s=(function(n){function t(t,i){var u=n.call(this,t,i)||this,o=u.ltm,f;return t.html(e()),f=r.observable(),i.userIdentity.subscribeAndRun(o,(function(n){n&&f(n.changePasswordUri)})),u._bindDescendants({changePasswordLink:f}),u._attachEventHandlers(),u}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(o);n.prototype.dispose.call(this)},t.prototype._attachEventHandlers=function(){var n=this.options,i=n.links,r=this.element,t=u.default.click;this.ltm.registerForDispose(r.setEvents([t,".fxs-avatarmenu-signout",function(t){n.signedOut();t.preventDefault()}],[t,".fxs-avatarmenu-billing",function(t){n.openAccountPortal();i.accountPortal.startsWith("#")&&t.preventDefault()}],[t,".fxs-avatarmenu-switchdirectory",function(t){t.preventDefault();n.switchDirectory()}],[t,".fxs-avatarmenu-myaccess",function(t){t.preventDefault();n.showMyAccessBlade()}],[t,".fxs-avatarmenu-contactinfo",function(t){t.preventDefault();n.showContactInfoBlade()}]))},t})(f.Widget);t.Widget=s}));
define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header" data-bind="attr: { title: tooltip }, css: { \'fxs-avatarmenu-open\': isMenuOpen }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <div class="fxs-avatarmenu-tenant-image-container"> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","_generated/Templates/WidgetsAvatarMenuButton","MsPortalImpl/Widgets/Widgets.SimpleAvatarMenuFlyout","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Languages","MsPortalImpl/Resources/Resources.Images","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl.Controls/Controls/IFrame","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function yt(n){return(n||"").toLowerCase()}function ii(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i||ot.test(t)&&ot.test(i)?"":f.AvatarMenu.displayNameFormat.format(t,i)}function pt(n,t){return{type:n.isOrgId?"aad":"msaFed",authenticatedState:"signedIn",memberName:n.emailAddress||"",firstName:n.givenName||"",lastName:n.lastName||"",displayName:n.rawName||"",orgName:t||""}}function ri(n){var e=n.user||{},o=n.themeMode||{},s=o.mode||0,f=[{type:"link",id:"mypermissions",text:w.myAccessLabel,ariaLabel:w.myAccessLabel},{type:"link",id:"feedback",text:w.feedbackLabel,ariaLabel:w.feedbackLabel},{type:"link",id:"billing",text:w.billingLabel,ariaLabel:w.billingLabel},{type:"link",id:"contactinfo",text:w.contactInfo,ariaLabel:w.contactInfo},],t;i.isFeatureEnabled("hidedirectorypanebutton")||f.unshift({type:"link",id:"switchdirectory",text:w.switchDirectoryLabel,ariaLabel:w.switchDirectoryLabel});var h={apiGeneration:"GEN2",containerId:"meControlContainer",authProviderConfig:{type:"webAadWithMsaFed",aad:{signOutUrl:k.aadAuthority+"uxlogout?shouldForgetUser=false",signOutAndForgetUrl:k.aadAuthority+"uxlogout?shouldForgetUser=true",rememberedAccountsUrl:k.aadAuthority+"savedusers",forgetUrl:k.aadAuthority+"forgetuser"},appSignInUrl:"/Account/SignIn",appSignInToUrl:"/Account/SignInTo",appSwitchUrl:"/Account/Switch",appSwitchToUrl:"/Account/SwitchTo",appSignOutUrl:"/Account/SignOut"},primaryUXConfig:{theme:{type:nt.get(g(n.diContainer.get(y.GeneralSettings).highContrastKey(),s))||"light"}},currentAccount:pt(e),registeredEvents:["afterGetRememberedAccounts","beforeSignOutFromApp","beforeSwitch","beforeSwitchTo",],appContextConfig:{commands:f}},r=a.currentLocaleContext.selectedDisplayLanguage,u=i.find(a.currentLocaleContext.selectableDisplayLanguages,(function(n){return n.locale===r}));return u&&(r=u.specificCulture||u.locale),t=new ft.UriBuilder(n.meControlBaseUri),t.query.setParameters({market:r,wreply:i.portalUri}),t.fragment=encodeURIComponent(JSON.stringify(h)),t.toString()}function ui(n,t){return u.pureComputed((function(){var i=n.userIdentity(),s,u,e,o,h;if(!i)return"";var f=n.text.Tooltip,c=f.tenant,r=[];return(i.firstName||i.lastName)&&r.push(f.name.format(i.firstName||"",i.lastName||"")),s=i.emailAddress,s&&r.push(f.email.format(s)),u=n.listOfTenants().first((function(n){return i.tenantId===n.id})),u&&!n.hideTenant()&&(r.push(c.format(u.displayName,u.id)),e=u.domainName||"",o=i.tenantDomain,r.push(o&&yt(e)!==yt(o)?c.format(e,o):f.domain.format(e))),h=r.join("\n"),t(h),h}))}var vt,ot,wt;r.defineProperty(t,"__esModule",{value:!0});var ft=i.Base,st=ft.Diagnostics,bt=i.ViewModels.Controls.Internal.IFrame,kt=ft.Images,tt=st.Telemetry,ht=window,dt=ht.fx,gt=dt.environment,k=gt.meControl,w=f.AvatarMenu,b=st.createLog(n),d=e.Source.TopBar,it=tt.start,et=tt.endTrace,rt=tt.completeTrace,ct="fxs-avatarmenu",ni=".fxs-avatarmenu-signout",lt=".fxs-avatarmenu-dropdown-item",at="fxs-flyout",ti='<div class="'+at+'" data-bind="stopBindings: true"><\/div>',ut="fxs-mecontrol-flyout",g=function(n,t){return 1<<n^t},nt=new i.Map;nt.set(g(0,0),"light");nt.set(g(1,1),"azure_hclight");nt.set(g(2,0),"azure_hcdark");nt.set(g(0,1),"dark");nt.set(g(1,0),"azure_hclight");nt.set(g(2,1),"azure_hcdark");vt=["aftergetrememberedaccounts",];ot=/^(f(irst)?|l(ast)?)\s?name$/i;wt=(function(n){function t(t,r,e){var s=n.call(this,t,r)||this,w,a,ot,g,dt,nt,st;s.postMessageObservable=u.observable();s.receiveMessageObservable=u.observable();s.meControlState=0;var h=s.ltm,gt=r.userIdentity.fxAwaitAndRun(h),ni=r.avatarImage.fxAwaitAndRun(h),yt="",wt="",ft=0;return s.element.addClass(ct),!i.isFeatureEnabled("usesimpleavatarmenu")&&k.baseUri&&k.aadAuthority&&(s.meControlState=1),s.meControlState===1&&s.receiveMessageObservable.subscribe(h,(function(n){var t,i,o,u;if(tt.trace({source:d,action:"MeControlReceiveMessage",data:n}),!n){b.warning("Failed to get message data from the mecontrol.");return}if(t=(n.method||"").toLowerCase(),!t){b.warning("Failed to get event information from the mecontrol.");return}switch(t){case"beforesignoutfromapp":r.signedOut();break;case"beforeswitch":r.switchAccount();break;case"beforeswitchto":var h=n.args||{},f=h.nextAccount,e=f&&f.memberName;e?r.switchAccount(e):(tt.trace({source:d,action:"MeControlSwitchAccount",data:"Switch account failed due to empty account info."}),b.warning("Failed to get information of the account to switch to from the mecontrol."));break;case"customcommandclick":i=(n.args||"").toLowerCase();switch(i){case"switchdirectory":r.switchDirectory();break;case"mypermissions":r.showMyAccessBlade();break;case"billing":r.openAccountPortal();break;case"contactinfo":r.showContactInfoBlade();break;case"feedback":r.submitAnIdea();break;default:i?b.warning("Received message for unhandled custom link click event. Method: "+t+", args: "+i):b.warning("Failed to get click action information from the mecontrol.")}s.getDropMenuOpenObservable()(!1);break;case"fullyrendered":rt(yt);break;case"interactive":rt(wt);break;case"resizeiframe":o=n.args||{};u=o.flyoutHeight;u?(ft=Math.min(u,ht.innerHeight-30),s.element.findByClassName(ut).height(ft)):b.warning("MeControl's resize event triggered with invalid height value: "+u);break;default:vt.includes(t)||b.warning("Received message for unhandled event type. Method: "+t)}})),w=new c.ViewModel(o(),ti,lt),w.buttonClass="fxs-menu-account",s._dropMenuWidget=new c.Widget(t,w),w.isMenuOpen.subscribe(h,(function(n){var t=s.element.findByClassName(at),u,f;s.meControlState===1?n?(u=it({source:d,action:"MeControlOpen_Ready"}),wt=it({source:d,action:"MeControlOpen_Interactive"}),yt=it({source:d,action:"MeControlOpen_Fullyrendered"}),t.addClass(ut),gt.then((function(n){var o=new bt.ViewModel(h,{src:ri({diContainer:e,user:n,meControlBaseUri:k.baseUri,themeMode:e.get(y.GeneralSettings)["fxs-theme"]()}),receiveMessage:s.receiveMessageObservable,postMessage:s.postMessageObservable,loadTimeoutInMilliseconds:4e3}),i,u,f;return a&&a.dispose(),a=h.createChildLifetime(),i=new p.Widget(t,o),a.registerForDispose(i),ft&&t.height(ft),u="setAccountPicture",f=function(n,t){tt.trace({source:d,action:"SendMessageToMeControl",data:{method:t,args:t!==u?n:""}});s.postMessageObservable({mcrpc:"1.0",id:"1",headers:{},method:t,args:[n]})},ni.then((function(n){f(n,u)})),r.userInfo.fxAwaitAndRun(h).then((function(t){var i=n.isOrgId?t.directoryName:"";f(pt(n,i),"setActiveAccount")})),i.isReadyPromise})).then((function(){rt(u)})).catch((function(n){var r=function(t){et(u,t,{message:n.message,stack:n.stack});et(wt,t);et(yt,t)};n instanceof i.Errors.DisposedCanceledError?r("UserCancelled"):(r("Failed"),b.warning(n),s.meControlState=2,a&&a.dispose(),s._loadSimpleAvatarMenu(t))}))):(t.removeClass(ut),a&&a.dispose()):(f=s.element.findByClassName("fxs-avatarmenu-dropdown"),n&&!f.length?s._loadSimpleAvatarMenu(t):f.toggleClass("fxs-display-none",!n))})),ot=u.pureComputed((function(){var n=r.userIdentity();return n&&(n.emailAddress||ii(n))||r.text.defaultDisplayName})),g=u.pureComputed((function(){var n=r.userInfo();return r.hideTenant()||!n?"":n.uniqueDirectoryName})),u.computed(h,[ot,g],(function(){s.trigger(l.default.fxavatartextchange)})),u.computed(h,(function(){var n=f.AvatarMenu.label+" ";n+=g()?r.text.userWithTenantLabel.format(g()):r.text.userLabel.format(ot());w.buttonLabel(n)})),dt=u.observable(v.getAvatarMenu().defaultAvatarSmall),u.reactor(h,(function(){var n=r.userIdentity(),t;n&&!n.isAnonymous&&(t=r.avatarImage()||n.defaultAvatarUri,dt(t))})),nt=0,st=!0,h.registerForDispose(t.find(".fxs-avatarmenu-header").setEvents([[l.default.touchstart,l.default.mousedown].join(" "),function(){nt=Date.now()},],[[l.default.touchend,l.default.mouseup].join(" "),function(){nt&&Date.now()-nt>r.showDiagnosticsDelay&&(st?r.showDiagnostics():r.showDebugTools(),st=!st);nt=0},])),u.applyBindingsToDescendants({data:r,displayName:ot,text:r.text,currentTenantDisplayName:g,tooltip:ui(r,w.buttonTooltip),avatarUri:dt,ellipsis:kt.Ellipsis({palette:99}),isMenuOpen:w.isMenuOpen},s.element[0]),s}return __extends(t,n),t.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(ct);n.prototype.dispose.call(this)},t.prototype.getDropMenuOpenObservable=function(){return this._dropMenuWidget.options.isMenuOpen},t.prototype._loadSimpleAvatarMenu=function(n){var i=it({source:d,action:"SimpleAvatarMenuOpen"}),t;n.removeClass(ut);this.ltm.registerForDispose(new s.Widget(n,this.options));t=this.element;t.find(lt).attr("tabindex","-1");t.find(ni).attr("tabindex","0").focus();rt(i)},t})(h.Widget);t.Widget=wt}));
define("MsPortalImpl/Svg/Startup/Chevron.svg",[],(function(){"use strict";return{type:158,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.2 6l-5.5 5.5.6.5 6-6-6-6-.6.5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Search.svg",[],(function(){"use strict";return{type:248,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M21.8.6c1.5.4 2.8 1 4.1 1.7 1.2.8 2.4 1.7 3.4 2.7 1 1.1 1.9 2.2 2.7 3.5.7 1.3 1.3 2.6 1.7 4.1.4 1.5.6 3 .6 4.6 0 2-.3 4-1 5.8s-1.7 3.6-3 5.1l19.1 19.2c.3.3.5.7.5 1.1 0 .4-.2.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5l-19-19.1c-1.6 1.3-3.3 2.3-5.1 3-1.9.7-3.8 1-5.8 1-1.6 0-3.1-.2-4.6-.6-1.5-.4-2.8-1-4.1-1.7-1.3-.7-2.4-1.6-3.5-2.7-1-1.1-1.9-2.2-2.7-3.5-.7-1.3-1.3-2.6-1.7-4.1-.4-1.5-.6-3-.6-4.6 0-1.6.2-3.1.6-4.6.4-1.5 1-2.8 1.7-4.1C3.1 7.3 4 6.1 5 5c1-1 2.2-1.9 3.5-2.7C9.8 1.6 11.1 1 12.6.6c1.5-.4 3-.6 4.6-.6s3.1.2 4.6.6zm.9 29.5c1.7-.7 3.2-1.7 4.5-3s2.3-2.8 3-4.5c.7-1.7 1.1-3.5 1.1-5.5 0-1.9-.4-3.8-1.1-5.5-.7-1.7-1.7-3.2-3-4.5s-2.8-2.3-4.5-3C21 3.4 19.2 3 17.2 3s-3.8.4-5.5 1.1C10 5 8.5 6 7.3 7.3S5 10 4.2 11.7c-.7 1.7-1.1 3.5-1.1 5.5 0 1.9.4 3.8 1.1 5.5.7 1.7 1.7 3.2 3 4.5s2.8 2.3 4.5 3c1.7.7 3.5 1.1 5.5 1.1s3.7-.4 5.5-1.2z'/><\/g><\/svg>"}}));
define("_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"body>div[data-popup=true].azc-control{z-index:250}.azc-before-color-index-76::before,.azc-color-index-76,div.azc-before-color-k0t2::before,div.azc-color-k0t2,div.msportalfx-bgcolor-k0t2{background-color:#63707e!important}.azc-before-color-index-75::before,.azc-color-index-75,div.azc-before-color-j0t2::before,div.azc-color-j0t2,div.msportalfx-bgcolor-j0t2{background-color:#f0f7b2!important}.azc-before-color-index-74::before,.azc-color-index-74,div.azc-before-color-i0t2::before,div.azc-color-i0t2,div.msportalfx-bgcolor-i0t2{background-color:#ccecdb!important}.azc-before-color-index-73::before,.azc-color-index-73,div.azc-before-color-h0t2::before,div.azc-color-h0t2,div.msportalfx-bgcolor-h0t2{background-color:#ccf0ea!important}.azc-before-color-index-72::before,.azc-color-index-72,div.azc-before-color-g0t2::before,div.azc-color-g0t2,div.msportalfx-bgcolor-g0t2{background-color:#ccf2fc!important}.azc-before-color-index-71::before,.azc-color-index-71,div.azc-before-color-f0t2::before,div.azc-color-f0t2,div.msportalfx-bgcolor-f0t2{background-color:#ccd1e9!important}.azc-before-color-index-70::before,.azc-color-index-70,div.azc-before-color-e0t2::before,div.azc-color-e0t2,div.msportalfx-bgcolor-e0t2{background-color:#e1d3e4!important}.azc-before-color-index-69::before,.azc-color-index-69,div.azc-before-color-d0t2::before,div.azc-color-d0t2,div.msportalfx-bgcolor-d0t2{background-color:#fbcce8!important}.azc-before-color-index-68::before,.azc-color-index-68,div.azc-before-color-c0t2::before,div.azc-color-c0t2,div.msportalfx-bgcolor-c0t2{background-color:#facfd3!important}.azc-before-color-index-67::before,.azc-color-index-67,div.azc-before-color-b0t2::before,div.azc-color-b0t2,div.msportalfx-bgcolor-b0t2{background-color:#ffe8cc!important}.azc-before-color-index-66::before,.azc-color-index-66,div.azc-before-color-a0t2::before,div.azc-color-a0t2,div.msportalfx-bgcolor-a0t2{background-color:#fffccc!important}.azc-before-color-index-65::before,.azc-color-index-65,div.azc-before-color-k0t1::before,div.azc-color-k0t1,div.msportalfx-bgcolor-k0t1{background-color:#8f9ca8!important}.azc-before-color-index-64::before,.azc-color-index-64,div.azc-before-color-j0t1::before,div.azc-color-j0t1,div.msportalfx-bgcolor-j0t1{background-color:#d6e86c!important}.azc-before-color-index-63::before,.azc-color-index-63,div.azc-before-color-i0t1::before,div.azc-color-i0t1,div.msportalfx-bgcolor-i0t1{background-color:#66c592!important}.azc-before-color-index-62::before,.azc-color-index-62,div.azc-before-color-h0t1::before,div.azc-color-h0t1,div.msportalfx-bgcolor-h0t1{background-color:#66d1bf!important}.azc-before-color-index-61::before,.azc-color-index-61,div.azc-before-color-g0t1::before,div.azc-color-g0t1,div.msportalfx-bgcolor-g0t1{background-color:#66d7f7!important}.azc-before-color-index-60::before,.azc-color-index-60,div.azc-before-color-f0t1::before,div.azc-color-f0t1,div.msportalfx-bgcolor-f0t1{background-color:#6674bc!important}.azc-before-color-index-59::before,.azc-color-index-59,div.azc-before-color-e0t1::before,div.azc-color-e0t1,div.msportalfx-bgcolor-e0t1{background-color:#a47aaf!important}.azc-before-color-index-58::before,.azc-color-index-58,div.azc-before-color-d0t1::before,div.azc-color-d0t1,div.msportalfx-bgcolor-d0t1{background-color:#f466ba!important}.azc-before-color-index-57::before,.azc-color-index-57,div.azc-before-color-c0t1::before,div.azc-color-c0t1,div.msportalfx-bgcolor-c0t1{background-color:#f1707b!important}.azc-before-color-index-56::before,.azc-color-index-56,div.azc-before-color-b0t1::before,div.azc-color-b0t1,div.msportalfx-bgcolor-b0t1{background-color:#ffba66!important}.azc-before-color-index-55::before,.azc-color-index-55,div.azc-before-color-a0t1::before,div.azc-color-a0t1,div.msportalfx-bgcolor-a0t1{background-color:#fcf37e!important}.azc-before-color-index-54::before,.azc-color-index-54,div.azc-before-color-k0s1::before,div.azc-color-k0s1,div.msportalfx-bgcolor-k0s1{background-color:#464f59!important}.azc-before-color-index-53::before,.azc-color-index-53,div.azc-before-color-j0s1::before,div.azc-color-j0s1,div.msportalfx-bgcolor-j0s1{background-color:#8ba208!important}.azc-before-color-index-52::before,.azc-color-index-52,div.azc-before-color-i0s1::before,div.azc-color-i0s1,div.msportalfx-bgcolor-i0s1{background-color:#0f5b2f!important}.azc-before-color-index-51::before,.azc-color-index-51,div.azc-before-color-h0s1::before,div.azc-color-h0s1,div.msportalfx-bgcolor-h0s1{background-color:#00856f!important}.azc-before-color-index-50::before,.azc-color-index-50,div.azc-before-color-g0s1::before,div.azc-color-g0s1,div.msportalfx-bgcolor-g0s1{background-color:#008db5!important}.azc-before-color-index-49::before,.azc-color-index-49,div.azc-before-color-f0s1::before,div.azc-color-f0s1,div.msportalfx-bgcolor-f0s1{background-color:#00126b!important}.azc-before-color-index-48::before,.azc-color-index-48,div.azc-before-color-e0s1::before,div.azc-color-e0s1,div.msportalfx-bgcolor-e0s1{background-color:#4e195c!important}.azc-before-color-index-47::before,.azc-color-index-47,div.azc-before-color-d0s1::before,div.azc-color-d0s1,div.msportalfx-bgcolor-d0s1{background-color:#b10069!important}.azc-before-color-index-46::before,.azc-color-index-46,div.azc-before-color-c0s1::before,div.azc-color-c0s1,div.msportalfx-bgcolor-c0s1{background-color:#ae0d1a!important}.azc-before-color-index-45::before,.azc-color-index-45,div.azc-before-color-b0s1::before,div.azc-color-b0s1,div.msportalfx-bgcolor-b0s1{background-color:#bf6900!important}.azc-before-color-index-44::before,.azc-color-index-44,div.azc-before-color-a0s1::before,div.azc-color-a0s1,div.msportalfx-bgcolor-a0s1{background-color:#bfb500!important}.azc-before-color-index-43::before,.azc-color-index-43,div.azc-before-color-k0s2::before,div.azc-color-k0s2,div.msportalfx-bgcolor-k0s2{background-color:#32383f!important}.azc-before-color-index-42::before,.azc-color-index-42,div.azc-before-color-j0s2::before,div.azc-color-j0s2,div.msportalfx-bgcolor-j0s2{background-color:#3d460a!important}.azc-before-color-index-41::before,.azc-color-index-41,div.azc-before-color-i0s2::before,div.azc-color-i0s2,div.msportalfx-bgcolor-i0s2{background-color:#063d20!important}.azc-before-color-index-40::before,.azc-color-index-40,div.azc-before-color-h0s2::before,div.azc-color-h0s2,div.msportalfx-bgcolor-h0s2{background-color:#084c41!important}.azc-before-color-index-39::before,.azc-color-index-39,div.azc-before-color-g0s2::before,div.azc-color-g0s2,div.msportalfx-bgcolor-g0s2{background-color:#005e79!important}.azc-before-color-index-38::before,.azc-color-index-38,div.azc-before-color-f0s2::before,div.azc-color-f0s2,div.msportalfx-bgcolor-f0s2{background-color:#000c48!important}.azc-before-color-index-37::before,.azc-color-index-37,div.azc-before-color-e0s2::before,div.azc-color-e0s2,div.msportalfx-bgcolor-e0s2{background-color:#34113d!important}.azc-before-color-index-36::before,.azc-color-index-36,div.azc-before-color-d0s2::before,div.azc-color-d0s2,div.msportalfx-bgcolor-d0s2{background-color:#760046!important}.azc-before-color-index-35::before,.azc-color-index-35,div.azc-before-color-c0s2::before,div.azc-color-c0s2,div.msportalfx-bgcolor-c0s2{background-color:#740912!important}.azc-before-color-index-34::before,.azc-color-index-34,div.azc-before-color-b0s2::before,div.azc-color-b0s2,div.msportalfx-bgcolor-b0s2{background-color:#804600!important}.azc-before-color-index-33::before,.azc-color-index-33,div.azc-before-color-a0s2::before,div.azc-color-a0s2,div.msportalfx-bgcolor-a0s2{background-color:#807900!important}.azc-before-color-index-32::before,.azc-color-index-32,div.azc-before-color-k2::before,div.azc-color-k2,div.msportalfx-bgcolor-k2{background-color:#d6d7d8!important}.azc-before-color-index-31::before,.azc-color-index-31,div.azc-before-color-j2::before,div.azc-color-j2,div.msportalfx-bgcolor-j2{background-color:#e2e584!important}.azc-before-color-index-30::before,.azc-color-index-30,div.azc-before-color-i2::before,div.azc-color-i2,div.msportalfx-bgcolor-i2{background-color:#55d455!important}.azc-before-color-index-29::before,.azc-color-index-29,div.azc-before-color-h2::before,div.azc-color-h2,div.msportalfx-bgcolor-h2{background-color:#00d8cc!important}.azc-before-color-index-28::before,.azc-color-index-28,div.azc-before-color-g2::before,div.azc-color-g2,div.msportalfx-bgcolor-g2{background-color:#6dc2e9!important}.azc-before-color-index-27::before,.azc-color-index-27,div.azc-before-color-f2::before,div.azc-color-f2,div.msportalfx-bgcolor-f2{background-color:#4668c5!important}.azc-before-color-index-26::before,.azc-color-index-26,div.azc-before-color-e2::before,div.azc-color-e2,div.msportalfx-bgcolor-e2{background-color:#9b4f96!important}.azc-before-color-index-25::before,.azc-color-index-25,div.azc-before-color-d2::before,div.azc-color-d2,div.msportalfx-bgcolor-d2{background-color:#f472d0!important}.azc-before-color-index-24::before,.azc-color-index-24,div.azc-before-color-c2::before,div.azc-color-c2,div.msportalfx-bgcolor-c2{background-color:#dd5900!important}.azc-before-color-index-23::before,.azc-color-index-23,div.azc-before-color-b2::before,div.azc-color-b2,div.msportalfx-bgcolor-b2{background-color:#ffb900!important}.azc-before-color-index-22::before,.azc-color-index-22,div.azc-before-color-a2::before,div.azc-color-a2,div.msportalfx-bgcolor-a2{background-color:#fffc9e!important}.azc-before-color-index-21::before,.azc-color-index-21,div.azc-before-color-k0::before,div.azc-color-k0,div.msportalfx-bgcolor-k0{background-color:#bbc2ca!important}.azc-before-color-index-20::before,.azc-color-index-20,div.azc-before-color-j0::before,div.azc-color-j0,div.msportalfx-bgcolor-j0{background-color:#bad80a!important}.azc-before-color-index-19::before,.azc-color-index-19,div.azc-before-color-i0::before,div.azc-color-i0,div.msportalfx-bgcolor-i0{background-color:#009e49!important}.azc-before-color-index-18::before,.azc-color-index-18,div.azc-before-color-h0::before,div.azc-color-h0,div.msportalfx-bgcolor-h0{background-color:#00b294!important}.azc-before-color-index-17::before,.azc-color-index-17,div.azc-before-color-g0::before,div.azc-color-g0,div.msportalfx-bgcolor-g0{background-color:#00bcf2!important}.azc-before-color-index-16::before,.azc-color-index-16,div.azc-before-color-f0::before,div.azc-color-f0,div.msportalfx-bgcolor-f0{background-color:#00188f!important}.azc-before-color-index-15::before,.azc-color-index-15,div.azc-before-color-e0::before,div.azc-color-e0,div.msportalfx-bgcolor-e0{background-color:#68217a!important}.azc-before-color-index-14::before,.azc-color-index-14,div.azc-before-color-d0::before,div.azc-color-d0,div.msportalfx-bgcolor-d0{background-color:#ec008c!important}.azc-before-color-index-13::before,.azc-color-index-13,div.azc-before-color-c0::before,div.azc-color-c0,div.msportalfx-bgcolor-c0{background-color:#e81123!important}.azc-before-color-index-12::before,.azc-color-index-12,div.azc-before-color-b0::before,div.azc-color-b0,div.msportalfx-bgcolor-b0{background-color:#ff8c00!important}.azc-before-color-index-11::before,.azc-color-index-11,div.azc-before-color-a0::before,div.azc-color-a0,div.msportalfx-bgcolor-a0{background-color:#fff100!important}.azc-before-color-index-10::before,.azc-color-index-10,div.azc-before-color-k1::before,div.azc-color-k1,div.msportalfx-bgcolor-k1{background-color:#a0a5a8!important}.azc-before-color-index-9::before,.azc-color-index-9,div.azc-before-color-j1::before,div.azc-color-j1,div.msportalfx-bgcolor-j1{background-color:#7fba00!important}.azc-before-color-index-8::before,.azc-color-index-8,div.azc-before-color-i1::before,div.azc-color-i1,div.msportalfx-bgcolor-i1{background-color:#007233!important}.azc-before-color-index-7::before,.azc-color-index-7,div.azc-before-color-h1::before,div.azc-color-h1,div.msportalfx-bgcolor-h1{background-color:#008272!important}.azc-before-color-index-6::before,.azc-color-index-6,div.azc-before-color-g1::before,div.azc-color-g1,div.msportalfx-bgcolor-g1{background-color:#0072c6!important}.azc-before-color-index-5::before,.azc-color-index-5,div.azc-before-color-f1::before,div.azc-color-f1,div.msportalfx-bgcolor-f1{background-color:#002050!important}.azc-before-color-index-4::before,.azc-color-index-4,div.azc-before-color-e1::before,div.azc-color-e1,div.msportalfx-bgcolor-e1{background-color:#442359!important}.azc-before-color-index-3::before,.azc-color-index-3,div.azc-before-color-d1::before,div.azc-color-d1,div.msportalfx-bgcolor-d1{background-color:#b4009e!important}.azc-before-color-index-2::before,.azc-color-index-2,div.azc-before-color-c1::before,div.azc-color-c1,div.msportalfx-bgcolor-c1{background-color:#ba141a!important}.azc-before-color-index-1::before,.azc-color-index-1,div.azc-before-color-b1::before,div.azc-color-b1,div.msportalfx-bgcolor-b1{background-color:#eb3c00!important}.azc-before-color-index-0::before,.azc-color-index-0,div.azc-before-color-a1::before,div.azc-color-a1,div.msportalfx-bgcolor-a1{background-color:#fcd116!important}")}));
define("Viva.Controls/Controls/Base/Viva.Base",["require","exports","f","i","o","a","ko","$","MsPortalImpl/Base/JQueryHelper","Viva.Controls/Util/Viva.Util","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function w(n){return n=n||{},n.viewModelType=n.viewModelType||p,n}function b(n,t,i){i=w(i);var r=t;return r&&r instanceof i.viewModelType||(r=new i.viewModelType({ltm:n()}),r.populateFromObject(t)),r}var l=i.initObservable,a=i.isNullOrUndefined,v="azc-control",y="azc-control-disabled",p=(function(n){function t(t){var i=n.call(this,t.ltm)||this;return i.disabled=l(t.disabled,!1),i.loading=l(t.loading,!1),i}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this)},t.prototype.populateFromObject=function(n){t.copyObject(n,this)},t.copyObject=function(n,i){t._copyObject(n,i,[],[])},t._copyObject=function(n,i,r,u){var h=n,s=i,c,o,e;r.push(n);u.push(i);for(e in h)!h.hasOwnProperty(e)||e.startsWith("#")||e.startsWith("_")&&!e.startsWith("_msPortalFx")||(o=h[e],o!==undefined&&(f.isArray(o)?s[e]=o:o instanceof Date?s[e]=o:typeof o=="object"&&o!==null?(c=r.indexOf(o),c>=0?s[e]=u[c]:(s[e]||(s[e]={}),t._copyObject(o,s[e],r,u))):s[e]=o))},t})(i.ViewModels.Controls.Base.ViewModel),t;n.ViewModel=p;t=(function(n){function t(i,u,f){var s=this,k,d=function(){return k=new r.TriggerableLifetimeManager},c,l,p;if(s=n.call(this,i,b(d,u,f),w(f))||this,s._dataFocusableCallback=e.observable(),s._markFocusFirstElements=e.observable(),s._supportsFocus=e.observable(!1),c=h.Constants,!i||i.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");return l=s.ltm,k&&l.registerForDispose(k),s._disposablesLifetimeManager=l.createChildLifetime(),t.setupCleanData(),p=s.element,p.addClass(v).attr(c.dataControlAttribute,"true"),e.computed(l,(function(){s.widget().toggleClass(y,s.$disabled())})),e.computed(l,(function(){var n=s._dataFocusableCallback();a(n)?(p.removeAttr(c.dataCanFocusAttribute),delete p[0][c.dataCanFocusAttribute]):(p.attr(c.dataCanFocusAttribute,"true"),p[0][c.dataCanFocusAttribute]=function(){return n.apply(s,[p,s])})})),e.computed(l,(function(){var t=s._supportsFocus(),n=s._dataFocusableCallback.peek();t?n!==s._setFocus&&s._dataFocusableCallback(s._setFocus):a(n)||s._dataFocusableCallback(null)})),e.computed(l,(function(){var t=s._markFocusFirstElements(),n=t?t():null;s._prevElement&&o(s._prevElement).removeAttr(c.dataFocusFirstAttribute);n&&o(n).attr(c.dataFocusFirstAttribute,"true");s._prevElement=n})),s._initializeSubscriptions(s.options),s}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._supportsFocus(!1),this._disposeSubscriptions(),this.element.removeClass(v).removeClass(y).removeAttr(h.Constants.dataControlAttribute).removeAttr("role"),n.prototype.dispose.call(this))},u.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"subLifetime",{get:function(){return this._subLifetimeManager},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"_disposables",{get:function(){return this._disposablesLifetimeManager},enumerable:!0,configurable:!0}),t.prototype._canSetFocus=function(){var n=this.element;return n.attr(h.Constants.dataCanFocusAttribute)&&!this.$disabled.peek()&&s.isVisible(n)&&!n.is(":disabled")},t.prototype._getElementToFocus=function(){return this.widget()[0]},t.prototype._setFocus=function(){if(this._canSetFocus()){var n=this._getElementToFocus();if(n)return n.focus(),!0}return!1},t.prototype._disposeSubscriptions=function(){this._subLifetimeManager&&this._subLifetimeManager.dispose()},t.prototype._initializeSubscriptions=function(){this._disposeSubscriptions();this._subLifetimeManager=this.ltm.createChildLifetime()},t.prototype._afterCreate=function(){},t.setupCleanData=function(){t._cleanData||(t._cleanData=o.cleanData,o.cleanData=function(n){for(var r,u=0,i=void 0;(i=n[u])!==null&&i!==undefined;u++)o.hasData(i)&&(o(i).triggerHandler(t._widgetRemoveEvent),r=!0);r&&t._cleanData.call(o,n)})},t})(c.Widget);t._widgetEventNamespace=".azcWidget";t._widgetRemoveEvent="remove"+t._widgetEventNamespace;n.Widget=t})(l||(l={})),l}));
define("Viva.Controls/Controls/Base/Viva.EditableControl",["require","exports","o","ko","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Base/Viva.Base"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var t="azc-editableControl",e="azc-is-edited",h="",o=(function(n){function t(t){var i=n.call(this,t)||this;return i.name=null,i.value=r.observable(),i.dirty=r.observable(!1),i.focused=r.observable(!1),i}return __extends(t,n),t})(f.ViewModel),s;n.ViewModel=o;s=(function(n){function f(i,f,e){var s=this,c,l,a;return e=e||{},e.viewModelType=e.viewModelType||o,s=n.call(this,i,f,e)||this,s._ready=!0,s.element.addClass(t).attr(u.Constants.dataEditableAttribute,"true").html(h),c=s.options,l=c.dirty,l||(a=c.value()||"",c.dirty=r.observable(!1),r.reactor(s.ltm,(function(){var n=c.value()||"";c.dirty(!s._isSameValue(n,a))}))),s._initializeSubscriptions(c),s._supportsFocus(!0),s}return __extends(f,n),f.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.element.removeClass(t).removeClass(e).removeAttr(u.Constants.dataEditableAttribute),n.prototype.dispose.call(this))},i.defineProperty(f.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),f.prototype._isSameValue=function(n,t){return n==t},f.prototype._initializeSubscriptions=function(t){var i=this,r,u;n.prototype._initializeSubscriptions.call(this,t);this._ready&&(r=function(n){i.element.toggleClass(e,n)},r(t.dirty()),u=this.subLifetime,t.dirty.subscribe(u,r),this.options.focused.subscribe(u,(function(n){n||i.element.trigger("editableControl-blur",{widget:i,model:i.options})})))},f})(f.Widget);n.Widget=s})(e||(e={})),e}));
define("Viva.Controls/Util/Viva.DateUtil",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function p(n,t,i){return i=i?i:"0",t+1>=n.length&&(n=Array(t+1-n.length).join(i)+n),n}function f(n,t,i){return p(n+"",t,i)}function h(n,t){return n.substr(Math.max(n.length-t,0))}function r(n,t){return h(n+"",t)}function u(n,t){return h(f(n,t,"0"),t)}function c(n){return n=n%12,n===0?12:n}function o(n){return n&&n.split("").reverse().join("")}function e(n){return n&&"\\"+n.split("").join("\\")}function w(i){var o=i.length,h,l,a,v,s=n.getLocaleValues();switch(i[0]){case"y":switch(o){case 3:return f(t.getFullYear(),o);case 1:return parseInt(r(t.getFullYear(),2),10)+"";default:return u(t.getFullYear(),o)}case"M":switch(o){case 4:return e(s.months[t.getMonth()]);case 3:return e(s.monthsAbbr[t.getMonth()]);case 2:return u(t.getMonth()+1,2);default:return r(t.getMonth()+1,2)}case"d":switch(o){case 4:return e(s.days[t.getDay()]);case 3:return e(s.daysAbbr[t.getDay()]);case 2:return u(t.getDate(),2);default:return r(t.getDate(),2)}case"h":return o===2?u(c(t.getHours()),2):r(c(t.getHours()),2);case"H":return o===2?u(t.getHours(),2):r(t.getHours(),2);case"m":return o===2?u(t.getMinutes(),2):r(t.getMinutes(),2);case"s":switch(o){case 4:return u(t.getMilliseconds(),3);case 3:return r(t.getMilliseconds(),3);case 2:return u(t.getSeconds(),2)}return r(t.getSeconds(),2);case"t":return o===2?s.ampm[t.getHours()<12?0:1]:s.ampmAbbr[t.getHours()<12?0:1];case"z":return(h=-t.getTimezoneOffset()/60,l=h<0,l&&(h=-h),a=parseInt(h+"",10),v=(h-a)*60,o===3)?(l?"-":"+")+f(a,2)+":"+f(v,2):(l?"-":"+")+f(a,o);case"/":return s.dateSeparator;case":":return s.timeSeparator}return""}function b(n){return o(w(n))}function k(i){for(var r,s,f=[],u=1;u<arguments.length;u++)f[u-1]=arguments[u];return f.length?(r=f[0],s=n.getLocaleValues(),r=s.standard[r]||r,r=r.replace(/'([^']*)'/g,(function(n,t){return e(t)})),t=i,o(o(r).replace(/(y{1,5}|M{1,4}|d{1,4}|h{1,2}|H{1,2}|m{1,2}|s{1,4}|t{1,2}|z{1,3}|\/|:)(?!\\)/g,b).replace(/\\(?!\\)/g,""))):v.apply(i,arguments)}function d(n,t){return n&&t?n.getFullYear()===t.getFullYear()?n.getMonth()===t.getMonth()?n.getDate()===t.getDate()?0:n.getDate()<t.getDate()?-1:1:n.getMonth()<t.getMonth()?-1:1:n.getFullYear()<t.getFullYear()?-1:1:-1}function g(n,t){return n&&t?n.getHours()===t.getHours()?n.getMinutes()===t.getMinutes()?n.getSeconds()===t.getSeconds()?0:n.getSeconds()<t.getSeconds()?-1:1:n.getMinutes()<t.getMinutes()?-1:1:n.getHours()<t.getHours()?-1:1:-1}function nt(n,t){return n instanceof Date&&t instanceof Date&&s(n)===s(t)}var l=i,a=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(i.DateUtil.DateTimeRange),t;n.DateTimeRange=a;var v=Date.prototype.toString,y=i.uncurryThis,s=l.toSeconds;n.getLocaleValues=i.getLocaleValues;n.setLocaleValues=i.setLocaleValues;n.toRelativeString=y(i.dateToRelativeString);n.toString=k;n.parse=i.dateParse;n.compareDatePartOnly=d;n.compareTimePartOnly=g;n.areDatesEqualBySeconds=nt})(r||(r={})),r}));
define("Viva.Controls/Controls/Base/Viva.Validators",["require","exports","f","i","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Util/Viva.DateUtil"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){return(n||"").toLowerCase()}function ut(n){return(n||"").toLocaleLowerCase()}function si(n){return n().map((function(n){var i=n.validationState(),t=i!==1,r=t?n.passMessage&&n.passMessage():n.message();return t&&n.type===21&&(r=n.message()),{valid:t,message:r,state:i,type:n.type}})).filter((function(n){return n}))}var v,y,d,ft,et,tt,ot,st,ht,ct,lt,at,p,vt,yt,pt,g,it,wt,bt,kt,nt,dt,gt,ni,ti,ii,ri,ui;u.defineProperty(t,"__esModule",{value:!0});var w=i,fi=w.Base,ei=w.ViewModels,a=w.isNullOrUndefined,l=o.Viva.Validators,b=l.DateTimeRange,oi=fi.Diagnostics.createLog(n),k=i.regexEscape;t.DateFormatForMoment="YYYY-MM-DD";t.DateFormatForJS="yyyy-MM-dd";t.TimeFormatForJS="hh:mm:ss tt";v=(function(){function n(n,t,i,r){var u=this,s=this._ltm=n.createChildLifetime(),e,o;this.fxViewModel=t;e=i;t&&t.message&&(e=t.message);o=r;o=t&&t.successMessage?t.successMessage:r&&r.length?r:null;this.message=f.observable(e);this.passMessage=f.observable(o);this.validationState=f.observable(0);this.validate=f.observable();this.isEmptyValid=f.observable(!1);this.type=t&&t.type;this.valid=f.computed(s,(function(){return u.validationState()===2}));this.validate.subscribe(s,(function(n){u.validationState(u._validate(n))}))}return n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._validate=function(){return 0},n})();t.Validator=v;y=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===2&&(r=i.pattern,u=undefined),o=n.call(this,t,i,f||l.match.format(i.pattern),e||"Match found.")||this,o._expression=new RegExp(r,u),o}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:this._expression.test(n||"")?2:1},t})(v);t.Match=y;d=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===3&&(r=i.pattern,u=undefined),o=n.call(this,t,i,f||l.notMatch.format(i.pattern),e||l.Success.notMatch)||this,o._expression=new RegExp(r,u),o}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:this._expression.test(n||"")?1:2},t})(v);t.NotMatch=d;ft=(function(n){function t(t,i){return n.call(this,t,i,k(i.searchString),"i",l.contains.format(i.message),l.Success.contains.format(i.searchString))||this}return __extends(t,n),t})(y);t.Contains=ft;et=(function(n){function t(t,i){return n.call(this,t,i,k(i.searchString),"i",l.notContains.format(i.searchString),l.Success.notMatch.format(i.searchString))||this}return __extends(t,n),t})(d);t.NotContains=et;tt=(function(n){function t(t,i,r,u,f){var e=this;return i&&i.type===6&&(r=i.characters),n.call(this,t,i,"["+k(r)+"]","",u||l.containsCharacters.format(r),f||l.Success.containsCharacters.format(r))||this}return __extends(t,n),t})(y);t.ContainsCharacters=tt;ot=(function(n){function t(t,i){return n.call(this,t,i,"["+k(i.characters)+"]","",l.notContainsCharacters.format(i.characters),l.Success.notContainsCharacters.format(i.characters))||this}return __extends(t,n),t})(d);t.NotContainsCharacters=ot;st=(function(n){function t(t,i){return n.call(this,t,i,"[0-9]",undefined,l.hasDigit,l.Success.hasDigit)||this}return __extends(t,n),t})(y);t.HasDigit=st;ht=(function(n){function t(t,i){return n.call(this,t,i,"[A-Za-z]",undefined,l.hasLetter,l.Success.hasLetter)||this}return __extends(t,n),t})(y);t.HasLetter=ht;ct=(function(n){function t(t,i){return n.call(this,t,i,"[A-Z]",undefined,l.hasUpperCaseLetter,l.Success.hasUpperCaseLetter)||this}return __extends(t,n),t})(y);t.HasUpperCaseLetter=ct;lt=(function(n){function t(t,i){return n.call(this,t,i,"[a-z]",undefined,l.hasLowerCaseLetter,l.Success.hasLowerCaseLetter)||this}return __extends(t,n),t})(y);t.HasLowerCaseLetter=lt;at=(function(n){function t(t,i){return n.call(this,t,i,"!@#$%^&*()_+-={}|[]\\:\";'<>,.?/~`",l.hasPunctuation,l.Success.hasPunctuation)||this}return __extends(t,n),t})(tt);t.HasPunctuation=at;p=(function(n){function t(t,i,r){var u=n.call(this,t,i,r,l.Success.equals.format(f.unwrap(i.compareTo)))||this;return u._compareTo=f.isObservable(i.compareTo)?i.compareTo:function(){return i.compareTo},u}return __extends(t,n),t.prototype._validate=function(n){return this._compare(n,this._compareTo())?2:1},t.prototype._compare=function(){return!1},t})(v);t.Compare=p;vt=(function(n){function t(t,i){return n.call(this,t,i,l.equals.format(f.unwrap(i.compareTo)))||this}return __extends(t,n),t.prototype._compare=function(n,t){return n===t},t})(p);t.Equals=vt;yt=(function(n){function t(t,i){return n.call(this,t,i,l.caseInsensitiveComparison)||this}return __extends(t,n),t.prototype._compare=function(n,t){return rt(n)===rt(t)},t})(p);t.CaseInsensitiveComparison=yt;pt=(function(n){function t(t,i){return n.call(this,t,i,l.localeAwareCaseInsensitiveComparison)||this}return __extends(t,n),t.prototype._compare=function(n,t){return ut(n)===ut(t)},t})(p);t.LocaleAwareCaseInsensitiveComparison=pt;g=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===14&&(r=i.min,u=i.max),o=n.call(this,t,i,f||l.lengthRange.format(r,u),e||l.Success.lengthRange.format(r,u))||this,o._min=r,o._max=u,o}return __extends(t,n),t.prototype._validate=function(n){var t,i;return(n=e.trim(n),(a(n)||e.trim(n)==="")&&this.isEmptyValid())?2:(t=0,a(n)||(t=n.length),i=0,a(this._min)||(i=this._min),t>=i&&(a(this._max)||t<=this._max))?2:1},t})(v);t.LengthRange=g;it=(function(n){function t(t,i,r,u){var f=this;return i&&i.type===15&&(r=i.min),n.call(this,t,i,r,null,u||l.minLength.format(r),l.Success.minLength.format(r))||this}return __extends(t,n),t})(g);t.MinLength=it;wt=(function(n){function t(t,i){return n.call(this,t,i,0,i.max,l.maxLength.format(i.max),l.Success.maxLength.format(i.max))||this}return __extends(t,n),t})(g);t.MaxLength=wt;bt=(function(n){function t(t,i){return n.call(this,t,i,1,l.required)||this}return __extends(t,n),t})(it);t.Required=bt;kt=(function(n){function t(t,i){return n.call(this,t,i,l.numeric,l.Success.numeric)||this}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:!a(n)&&n!==""?isNaN(+n)?1:2:1},t})(v);t.Numeric=kt;nt=(function(n){function t(t,i,r,u,e,o){var c=this,s,h;return i&&i.type===18&&(r=i.min,u=i.max),s=r,f.isObservable(s)||(s=function(){return r}),h=u,f.isObservable(h)||(h=function(){return u}),c=n.call(this,t,i,e||l.valueRange.format(s(),h()),o||l.Success.valueRange.format(s(),h()))||this,c.min=s,c.max=h,c}return __extends(t,n),t.prototype._validate=function(n){var t;return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:(a(n)||n==="")&&a(this.min())&&a(this.max())?2:!a(n)&&(typeof n=="string"||typeof n=="number")&&n!==""&&(t=+n,!isNaN(t))?!a(this.min())&&t<this.min()?1:!a(this.max())&&t>this.max()?1:2:1},t})(v);t.ValueRange=nt;dt=(function(n){function t(t,i,r){var u=this;return i&&i.type===19&&(r=i.min),n.call(this,t,i,r,null,l.minValue.format(r),l.Success.minValue.format(r))||this}return __extends(t,n),t})(nt);t.MinValue=dt;gt=(function(n){function t(t,i,r){var u=this;return i&&i.type===20&&(r=i.max),n.call(this,t,i,null,r,l.maxValue.format(r),l.Success.maxValue.format(r))||this}return __extends(t,n),t})(nt);t.MaxValue=gt;ni=(function(n){function i(i,r,u,f){var e=this,s,o=t.DateFormatForJS+" "+t.TimeFormatForJS;return s=f?f:r&&u?b.minMax.format(c.toString(r,o),c.toString(u,o)):r?b.min.format(c.toString(r,o)):u?b.max.format(c.toString(u,o)):b.correctFormat,e=n.call(this,i,null,s)||this,e.minDateTime=r,e.maxDateTime=u,e}return __extends(i,n),i.prototype._validate=function(n){if(a(n))return this.isEmptyValid()?2:1;var t=n.getTime();return!a(this.minDateTime)&&Math.floor(t/1e3)<Math.floor(this.minDateTime.getTime()/1e3)?1:!a(this.maxDateTime)&&Math.floor(t/1e3)>Math.floor(this.maxDateTime.getTime()/1e3)?1:2},i})(v);t.DateTimeRange=ni;ti=(function(){function n(n,t){this.promise=n;this.asyncRequestId=t}return n})();ii=(function(n){function t(t,i,r){var u=n.call(this,t,i,"")||this,f;return i&&i.type?(f=function(n){return i.validate(n)},u._validationHandler=u._convertValidateFunction(f,r)):u._validationHandler=i,u._pendingAsyncRequests=[],u._latestValidationAsyncRequestId=null,u}return __extends(t,n),t.prototype._validate=function(n){var i=this,r=!1,t;return this._validationHandler?(this._latestValidationAsyncRequestId=w.getUniqueId(),t=this._validationHandler(n),this._pendingAsyncRequests.push(new ti(t,this._latestValidationAsyncRequestId)),t.then((function(n){i._updateValidationResult(t,n,2)})).catch((function(n){i._updateValidationResult(t,n&&n.message||"",1)})).finally((function(){r=!0})),r)?(this._removePendingAsyncRequest(t),this.validationState()):3:2},t.prototype._convertValidateFunction=function(n,t){return function(u){var e=n(u),f;return e?Q(e).then((function(n){if(n){if(n.valid)return n.message;throw r.createError(n.message);}else{var u=r.createError(h.Field.invalidValidationResult,{data:{message:"CustomValidation function '"+t+"' was resolved with invalid ValidationResult: "+n+". ValidationResult.message is required to inform customer why customer's input is invalid."}}),f=-1,e=void 0;t&&(f=t.indexOf("-"))>0&&(e=t.substr(0,f));r.Rpc.client.log(e||"fx",{level:2,code:0,area:"Viva.Validators",message:i.getLogFriendlyMessage(u)});throw u;}})):(f=r.createError("Extension validation handler did not return a promise. Proxied observable id is: '{0}'".format(t)),oi.error(f),Q.reject(f))}},t.prototype._updateResult=function(n,t){n&&this.message(n);this.validationState(t)},t.prototype._updateValidationResult=function(n,t,i){var r;r=this._pendingAsyncRequests.length<=1?this._pendingAsyncRequests.pop():this._removePendingAsyncRequest(n);r&&r.asyncRequestId===this._latestValidationAsyncRequestId&&this._updateResult(t,i)},t.prototype._removePendingAsyncRequest=function(n){for(var t=0,i=-1,r=null,t=0;t<this._pendingAsyncRequests.length;t++)if(this._pendingAsyncRequests[t].promise===n){i=t;break}return i>=0?(r=this._pendingAsyncRequests[i],this._pendingAsyncRequests.splice(i,1),r):null},t})(v);t.CustomAsyncValidator=ii;ri=(function(n){function t(t,i){var r=this;return i instanceof ei.InvalidValidation?n.call(this,t,i,l.invalid)||this:n.call(this,t,null,i||l.invalid)||this}return __extends(t,n),t.prototype._validate=function(){return 1},t})(v);t.Invalid=ri;ui=(function(n){function t(t,i){var r=n.call(this,t,i,"",l.Success.uri)||this;return r._options=i.options,r}return __extends(t,n),t.prototype._validate=function(n){var t=s.validateAbsoluteHttpUri(n,this._options);return t?2:1},t})(v);t.Uri=ui;t.getValidationResults=si}));
define("Viva.Controls/Controls/Base/Viva.ValidatableControl",["require","exports","f","o","ko","Viva.Controls/Controls/Base/Viva.EditableControl","Viva.Controls/Controls/Base/Viva.Validators"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var t="azc-validatableControl",o=(function(n){function t(t){var i=n.call(this,t)||this;i.enableValidation=u.observable(!0);i.validationState=u.observable(0);i.validators=u.observableArray();i.validationPlacements=u.observableArray();i.validationResults=u.observableArray();var r=i.validationState(),f=i.validators().length,e=!i.enableValidation()||f===0||i.enableValidation()&&f>0&&(r===0||r===2);return i.valid=u.observable(e),i}return __extends(t,n),t})(f.ViewModel),s;n.ViewModel=o;s=(function(n){function f(i,r,u){var f=this;return u=u||{},u.viewModelType=u.viewModelType||o,f=n.call(this,i,r,u)||this,f._validationStateInternal=null,f.element.addClass(t),f._initializeValidation(),f._initializeSubscriptions(f.options),f._initialized=!0,f.options.dirty()&&f.validate(!0),f._validationState.notifySubscribers(f._validationState()),f}return __extends(f,n),f.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(n.prototype.dispose.call(this),this.element.removeClass(t),i.disposeDisposable([].concat(this.options.validators.removeAll(),this.options.validationPlacements.removeAll())))},r.defineProperty(f.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),f.prototype.validate=function(n){var u=this,t,i,f=!!n,r;this._shouldValidate()&&(r=this.options,t=r.validators(),t&&t.length>0&&(i=r.value(),t.forEach((function(n){var r=n&&n.fxViewModel&&n.fxViewModel.map,t,e=function(i){i===null&&(i=undefined);i!==n.validate()?n.validate(i):i===undefined&&i===n.validate()||f?n.validate.notifySubscribers(i):t!==undefined&&n.validationState(t)};r?n.validationState.fxOnceAndRun(u._validationLifetimeManager,(function(u){t=u;n.validationState(3);Q(r(i)).then(e).catch((function(){return n.validationState()===3&&n.validationState(t)}))}),(function(n){return n!==3})):e(i)}))))},f.prototype._initializeSubscriptions=function(t){var i=this,r,f,e,o;n.prototype._initializeSubscriptions.call(this,t);r=this.options;f=this.ltm;r.value.subscribe(f,(function(n){i._onValueChanged(n)}));e=this._validationState;e||(e=this._validationState=u.observable(0));e.subscribe(f,(function(n){r.validationState(n)}));this._validationStateInternal&&(o=function(n){var t=i._validationLifetimeManager;t&&t.dispose();n&&(t=i._validationLifetimeManager=f.createChildLifetime(),i._validationStateInternal.subscribe(t,(function(n){e(n)})),r.dirty()&&i.validate(!0))},r.enableValidation.subscribe(f,o),o(r.enableValidation()));t.validators.subscribeArrayChanges(f,(function(){i._onValidatorsChanged()}),(function(){i._onValidatorsChanged()}))},f.prototype._afterCreate=function(){n.prototype._afterCreate.call(this);this._initializeValidationPlacements()},f.prototype._onValueChanged=function(){this._hasValidators()&&this._valueChangeValidation()},f.prototype._valueChangeValidation=function(){this.validate()},f.prototype._initializeValidationPlacements=function(){var n=this,t=this.options.validationPlacements.removeAll();this.options.validationPlacements.subscribeArrayChanges(this.ltm,(function(t){t.initialize(n.element,n.options)}),(function(n){n.dispose()}));this.options.validationPlacements(t)},f.prototype._hasValidators=function(){var n=this.options.validators();return this.options.enableValidation()&&!this.$disabled()&&n&&n.length>0},f.prototype._initializeValidation=function(){var i=this,n=this.options,t=this.ltm;u.reactor(t,(function(){var t=!n.enableValidation()||n.validators().length===0||n.enableValidation()&&n.validators().length>0&&(n.validationState()===0||n.validationState()===2);t!==n.valid.peek()&&n.valid(t)}));this._validationStateInternal=u.computed(t,(function(){var t=0;if(i._shouldValidate()&&(n.validators().some((function(n){return t=n.validationState(),t===1||t===3||t===0})),t===1)){var r=0,u=0,f=!0;n.validators().forEach((function(n){var t=n.validationState();n.maxDateTime?(r++,t===2&&u++):t!==2&&(f=!1)}));f&&r>0&&u>0&&(t=2)}return t}));u.reactor(t,(function(){n.validationResults(e.getValidationResults(n.validators))}))},f.prototype._onValidatorsChanged=function(){this._initialized&&this.validate(!0)},f.prototype._shouldValidate=function(){var n=this.options.validators();return this.options.enableValidation()&&!this.$disabled()&&n&&n.length>0?!0:!1},f})(f.Widget);n.Widget=s})(o||(o={})),o}));
define("Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger",["require","exports"],(function(){"use strict";var n;return (function(n){n.DefaultDelayValidationTimeout=500;var t;(function(n){n[n.Default=0]="Default";n[n.AfterKeyDown=1]="AfterKeyDown";n[n.KeyPress=2]="KeyPress";n[n.Blur=3]="Blur";n[n.Input=4]="Input"})(t=n.ValueUpdateTrigger||(n.ValueUpdateTrigger={}))})(n||(n={})),n}));
define("Viva.Controls/Controls/Base/Viva.TypableControl",["require","exports","o","ko","$","Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger","Viva.Controls/Controls/Base/Viva.ValidatableControl"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function o(n){s.clearTimeout(n)}var t=f.ValueUpdateTrigger,s=window,l=r.observable,h=(function(n){function i(i){var r=n.call(this,i)||this;return r.delayValidationTimeout=l(500),r.valueUpdateTrigger=t.Default,r.onEnterPressed=u.noop,r}return __extends(i,n),i})(e.ViewModel),c;n.ViewModel=h;c=(function(n){function r(t,i,r){var u=this;return r=r||{},r.viewModelType=r.viewModelType||h,u=n.call(this,t,i,r)||this,u.ltm.registerForDispose(u.element.setEvents(["keyup",function(n){n.which===13&&u.element.trigger("typableControl-commit",{widget:u,model:u.options})},])),u}return __extends(r,n),r.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._timer=o(this._timer),n.prototype.dispose.call(this))},i.defineProperty(r.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),r.prototype.validate=function(t){this._timer=o(this._timer);n.prototype.validate.call(this,t)},r.prototype._valueChangeValidation=function(){var t=this,i=this.options.delayValidationTimeout();if(i>0&&this._shouldDelayValidation()){o(this._timer);this._timer=s.setTimeout((function(){t._timer=o(t._timer);t.validate()}),i);return}n.prototype._valueChangeValidation.call(this)},r.prototype._getValueUpdateTrigger=function(){var n;switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.KeyPress:case t.Input:n="input";break;case t.Blur:case t.Default:n=""}return n},r.prototype._shouldDelayValidation=function(){switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.KeyPress:case t.Input:return!0}return!1},r})(e.Widget);n.Widget=c})(o||(o={})),o}));
define("_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".azc-textBox{height:23px}.azc-textBox .fxc-search-icon{top:5px;left:7px;height:12px;width:12px;opacity:.8;position:absolute;z-index:1}.azc-textBox-wrapper{width:100%}.azc-textBox-wrapper .azc-input{border-style:solid;border-width:1px;box-sizing:border-box;font-size:12px;height:23px;outline:0;padding:2px 8px 4px;width:100%}.azc-textBox-wrapper .azc-input::-moz-placeholder{font-style:italic}.azc-textBox-wrapper .azc-input:-ms-input-placeholder{font-style:italic}.azc-textBox-wrapper .azc-input::-webkit-input-placeholder{font-style:italic}.azc-textBox-wrapper [placeholder]{text-overflow:ellipsis}.fxc-inputhasvalue ::placeholder{color:transparent!important}.fxc-has-search-icon input{padding-left:24px!important;position:relative}")}));
define("Viva.Controls/Controls/Forms/Viva.TextBox",["require","exports","f","o","ko","Viva.Controls/Controls/Base/Viva.TypableControl","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler","MsPortalImpl/Base/Base.EventTypes","_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var l=i.Base,a=l.Images,s="azc-inputbox azc-textBox",h="azc-has-focus",v="__azc-textBox",y="<div class='azc-inputbox-wrapper azc-textBox-wrapper' data-bind='css: {\"fxc-has-search-icon\": data.showSearchIcon}' tabindex='-1'><!-- ko if: data.showSearchIcon --><div class='msportalfx-svg-flip-horizontal fxc-search-icon fxs-portal-svg-secondary' data-bind='image: $ctl._icon'><\/div><!-- /ko --><input class='azc-input azc-formControl azc-validation-border' type='text' aria-multiline='false' data-bind='value: $ctl._value, css: { \"fxs-br-error\": data.validationState() === 1, \"fxs-br-dirty\": data.dirty(), \"azc-disabled\": $disabled, \"azc-br-focused\": data.focused() }, valueUpdate: $ctl._getValueUpdateTrigger(), attr: { name: $ctl._name, placeholder: data.placeholder, readonly: data.readOnly, spellcheck: data.spellcheck().toString(), disabled: $disabled, tabindex: $tabIndex, \"aria-required\":$ctl._required, \"aria-readonly\": data.readOnly, \"aria-disabled\": $disabled }' /><\/div>",p=0,c=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.placeholder=u.observable(null),t.showSearchIcon=u.observable(!1),t.readOnly=u.observable(!1),t.spellcheck=u.observable(!1),t}return __extends(t,n),t})(f.ViewModel),t;n.ViewModel=c;t=(function(n){function t(t,i,r){var f=this,e;return r=r||{},r.viewModelType=r.viewModelType||c,f=n.call(this,t,i,r)||this,e=f.options,t.addClass(s).html(y),f._icon=a.Search({isLogo:!0}),f._name=e.name||v+p++,f._input=t.find("input"),f._required=u.computed(f.ltm,(function(){return 0!==e.validators.filter(f.ltm,(function(n){return 1===n.type}))().length})),f._value=u.computed(f.ltm,{read:function(){return e.value()},write:function(n){(n||e.value())&&e.value(n)}}),f._attachEvents(),f._bindDescendants(),f._afterCreate(),f._supportsFocus(!0),f}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._cleanElement(s),n.prototype.dispose.call(this))},r.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t.prototype._getElementToFocus=function(){return this._input[0]},t.prototype._attachEvents=function(){var i=this,t=this.options,n=t.events;this.ltm.registerForDispose(this.element.setEvents([o.default.keydown,function(n){n.which===13&&t.value(i._input.val())},],[o.default.keyup,function(r){if(r.which===13){r.preventDefault();var u=i._input.val();if(n&&n.enterPressed)n.enterPressed(u);else if(t.onEnterPressed)t.onEnterPressed(u)}else r.which===40&&n&&n.downPressed&&n.downPressed()},]));this.ltm.registerForDispose(this._input.setEvents([o.default.focus,function(){t.focused(!0);i.element.toggleClass(h,!0);n&&n.focus&&n.focus()},],[o.default.blur,function(){t.focused(!1);i.element.toggleClass(h,!1);n&&n.blur&&n.blur()},]))},t})(f.Widget);n.Widget=t;u.bindingHandlers.azcTextBox=e.getBindingHandler(t)})(s||(s={})),s}));
define("_generated/Templates/WidgetsSearch",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-search-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching }"> <div class="fxs-search-icon-mini msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search, attr: { title: searchLabel }"><\/div> <div class="fxs-search-box fxs-topbar-input"><\/div> <div class="fxs-search-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" class="fxs-search-clear" data-bind="image: data.icons.close, visible: data.filter"><\/div> <\/div> <a href="#" class="fxs-search-icon fxs-topbar-button msportalfx-svg-flip-horizontal" role="button" data-bind="attr: { title: searchLabel, \'aria-label\': searchLabel }, image: data.icons.search" ><\/a> <div class=\'fxs-search-menu fxs-dropmenu-content fxs-portal-background\'><\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","o","ko","MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Forms/Viva.TextBox","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsSearch","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Search.svg","MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Svg/Startup/Chevron.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y,p,w,b;r.defineProperty(t,"__esModule",{value:!0});y=i.Base;t.searchClass="fxs-search";t.searchBoxClass="fxs-search-box";p=e.Search;w=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.isExpanded=u.observable(!1),t.showMenu=u.observable(!1),t.showResults=u.observable(!1),t.showSearching=u.observable(!1),t.showExternalColumn=u.observable(!1),t.showAllSubscriptionsSearch=u.observable(!1),t.showChangeSubscriptions=u.observable(!1),t.icons={search:y.Images.CustomImageWithOptions(l,{isLogo:!0}),close:y.Images.CustomImageWithOptions(a,{isLogo:!0}),chevron:y.Images.CustomImageWithOptions(v,{isLogo:!0}),hyperlink:y.Images.CustomImageWithOptions(f,{isLogo:!0})},t.text=p,t.filter=u.observable(),t.searchInFilterText=u.observable(),t.subscriptionSummary=u.observable(),t.mruItems=u.observableArray(),t.results=u.observableArray(),t}return __extends(t,n),t})(s.ViewModel);t.ViewModel=w;b=(function(n){function r(r,f){var s=n.call(this,r,f)||this,a,l,v,y;return s._initialized=Q.defer(),r.addClass(t.searchClass).html(h()).attr({role:"search","aria-label":e.KeyboardShortcuts.search}),f.isExpanded.subscribeAndRun(s.ltm,(function(n){r.toggleClass("fxs-search-activated",n)})),f.showMenu.subscribeAndRun(s.ltm,(function(n){r.toggleClass("fxs-search-showmenu",n)})),window.fx.environment.chrome.hideSearchBox&&r.addClass("fxs-display-none"),s._bindDescendants({text:f.text,searchLabel:e.KeyboardShortcuts.search}),a=i.isFeatureEnabled("globalsearch")?p.globalPlaceholder:p.placeholder,l=new o.Widget(r.findByClassName(t.searchBoxClass),{placeholder:u.observable(a)}),l.element.find(".azc-input").attr("aria-label",a),s._textField=$(l._getElementToFocus()),v=function(){r.off(c.default.focusin,v);f.showMenu(!0);var n=s._initOptions;(n&&n()||Q(!0)).then((function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){s._initialized.resolve();n.initialize(s,s._textField)}))}))},y=function(n){n.preventDefault();s.setFocus()},s.ltm.registerForDispose([l,r.setEvents([c.default.focusin,v]),r.findByClassName("fxs-search-icon").setEvents([c.default.focusin,y],[c.default.mousedown,y]),]),s}return __extends(r,n),r.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},r.prototype.initOptions=function(n){this._initOptions=n},r.prototype.isDropdownInitialized=function(){return this._initialized.promise},r})(s.Widget);t.Widget=b}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-topbaractions-item{display:-webkit-flex;display:flex}.fxs-topbaractions-item .fxs-dropmenu-image{padding-left:10px}")}));
define("MsPortalImpl/Widgets/Widgets.TopbarActionsMenu",["require","exports","f","o","ko","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Svg/Startup/Ellipsis.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.TopbarActionsMenu.css"],(function(n,t,i,r,u,f,e,o){"use strict";var h;r.defineProperty(t,"__esModule",{value:!0});var c=i.Base,l=c.Images,a='<div class="fxs-topbaractions-dropmenu"><\/div>',v='<div class="fxs-topbaractions-button fxs-topbar-button" data-bind="image: ellipsis, css: { \'fxs-topbar-active\': isMenuOpen }"><\/div>',y='<div class="fxs-topbaractions-flyout"><ul class="fxs-topbaractions-list-commands" role="presentation" data-bind="foreach: topbarActions"><li class="fxs-portal-hover" role="presentation"><a href="#" class="fxs-topbaractions-item" role="menuitem" data-bind="attr: { \'aria-label\': name, title: name }, click: clickHandler"><div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: name"><\/div><div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: icon"><\/div><\/a><\/li><\/ul><\/div>',p=".fxs-topbaractions-dropdown-item",s="fxs-topbaractions-dropmenu",w=(function(n){function t(t){var i=n.call(this)||this;return i.topbarActions=t||[],i}return __extends(t,n),t})(f.ViewModel);t.ViewModel=w;h=(function(n){function t(t,i){var r=n.call(this,t,i)||this,h=r.element,f;return h.html(a),f=new e.ViewModel(v,y,p),r.isDropdownOpen=f.isMenuOpen,r._dropMenuWidget=new e.Widget(t.findByClassName(s),f),u.applyBindingsToDescendants({topbarActions:i.topbarActions,ellipsis:l.CustomImageWithOptions(o,{isLogo:!0}),isMenuOpen:r.isDropdownOpen},h[0]),r}return __extends(t,n),t.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(s);n.prototype.dispose.call(this)},t})(f.Widget);t.Widget=h}));
define("_generated/Templates/WidgetsTopBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: text.exitCustomizeText"><\/div> <button type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-portal-button-primary" data-bind="text: text.exitCustomizeButton"><\/button> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner" aria-labelledby="bannerlabel"> <!-- ko if: data.showPreview --> <div class="fxs-topbar-internal fxs-bg-warning fxs-topbar-search-activated-hidden" data-bind="text: text.internalText"><\/div> <!-- /ko --> <h1 class="fxs-topbar-brand fxs-topbar-search-activated-hidden" id="bannerlabel"> <a class="fxs-topbar-home" data-bind="text: productName, attr: { title: landingPageTooltip, href: landingPageHash }"><\/a> <\/h1> <div class="fxs-topbar-placeholder fxs-topbar-search-activated-hidden"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-topbar-debug-button fxs-topbar-search-activated-hidden" href="#" role="button" data-bind="text: text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-topbar-debug-button fxs-topbar-search-activated-hidden" role="button" data-bind="text: text.reportBug, click: func._reportBug, attr: { title: text.reportBugTitle, \'aria-label\': text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true" role="presentation"><\/div> <div class="fxs-topbar-buttons-container fxs-topbar-search-activated-hidden"> <!-- ko template: { name: getActionTemplateName, foreach: actions } --> <!-- /ko --> <div class="fxs-topbar-toast" role="presentation"><\/div> <\/div> <div class="fxs-topbar-actionsmenu fxs-topbar-search-activated-hidden" data-bind="stopBindings: true"><\/div> <div class="fxs-topbar-avatarmenu fxs-topbar-search-activated-hidden" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: text.exitCustomizeButton"><\/button> <a href="#dashboard" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: text.viewDashboardButton"><\/a> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: text.discardDashboardButton"><\/button> <\/div> <div class="fxs-loading5dots-container fxs-blade-progress-translucent" data-bind="visible: loading"> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","o","ko","$","MsPortalImpl/ViewModels/AvatarMenuCommon","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsTopBar","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.TopbarActionsMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Settings.svg","MsPortalImpl/Svg/Startup/Console.svg","MsPortalImpl/Svg/Startup/DirectoryFilter.svg","MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg","MsPortalImpl/Svg/Startup/SmileyHappy.svg","MsPortalImpl/Svg/Startup/Help.svg","MsPortalImpl/Svg/Startup/Notifications.svg","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.GeneralSettings","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){"use strict";function li(n){var t=n.topbarWidth,o=n.commandIconsWidth,u=n.searchBarWidth,f=u.min,i=u.max,l=u.collapsed,r=u.margin,a=n.avatarMenuWidth,s=a.normal,it=a.imageOnly,v=n.others,y=v.debugModeWidth,p=v.reportBugWidth,w=0,b=n.logoWidth+n.others.previewWidth+y+p+r,rt=r+o+s,h=b+i+rt,e=h-i+f,k=e-f+l-r,d=k-s+it,g=d-o+48,nt=g-p,ut=nt-y,c,tt;return t>=h&&(c=(t-i)/2,tt=c+i,w=c<b?t-h:Math.max(0,t-tt-o-s-r)),{searchBar:{expanded:t>=e,width:t>=e?Math.min(i,Math.max(f,t-e+f)):l,rightToCommands:w+r},commandIconsVisible:t>=d,avatarMenuExpanded:t>=k,others:{reportABugVisible:t>=g,debugModeVisible:t>=nt,previewVisible:t>=ut}}}function ct(n,t){var i=(t?n.findByClassName(t):n)[0];return i?i.offsetWidth:0}function vt(n,t){kt.Diagnostics.Telemetry.trace({source:h.Source.TopBar,action:n,data:t})}function ai(n,t,r,u){var f=[ri&&{name:st.console,icon:ht.CustomImageWithOptions(k,{isLogo:!0}),classNames:"fxs-topbar-console",clickHandler:r},ui&&{name:st.directory,icon:n.directoryFilterIcon,classNames:"fxs-topbar-directory fxs-menu-directory",clickHandler:function(){n.directoryButtonClick&&n.directoryButtonClick()}},{name:st.notifications,icon:ht.CustomImageWithOptions(it,{isLogo:!0}),classNames:"fxs-topbar-notifications",clickHandler:function(){n.notificationButtonClick&&n.notificationButtonClick()},template:bt.name},{name:st.settings,icon:ht.CustomImageWithOptions(b,{isLogo:!0}),classNames:"fxs-topbar-settings fxs-menu-settings",clickHandler:function(){t.trigger(w.default.fxsettingsbuttonclick)}},{name:st.help,icon:ht.CustomImageWithOptions(tt,{isLogo:!0}),classNames:"fxs-topbar-helpmenu",clickHandler:function(){n.helpButtonClick&&n.helpButtonClick()}},ci&&{name:st.feedback,icon:ht.CustomImageWithOptions(nt,{isLogo:!0}),classNames:"fxs-topbar-feedback fxs-menu-feedback",clickHandler:function(){n.feedbackButtonClick&&n.feedbackButtonClick()}},hi&&{name:st.peek,icon:u,classNames:"fxs-topbar-peekmode",clickHandler:function(){t.trigger(w.default.fxpeekmode)}},];return f.filter(i.identity)}function vi(n,i){function u(n,t){i.trigger(n,t&&{action:t}||undefined)}function r(n,t){i.on(w.default.click,n,t)}function f(n,t,r){return function(u){u.preventDefault();t&&vt(t,r);i.trigger(n)}}r(".fxs-topbar-exit-customize-button, ."+ni,f(pt,h.Action.CustomizeModeExited,{dashboardChanged:!!n.dashboardChanged(),onDashboard:!!n.dashboardVisible()}));r(".fxs-topbar-home",(function(){vt(h.Action.BannerButtonClicked)}));r(".fxs-topbar-dashboard-save",(function(){var i=n.dashboardWritable(),r=i?1:2,f=i?h.Action.DashboardPublish:h.Action.DashboardSaveACopy;vt(f);u(t.fxfinishdashboardedit,r);r===1&&u(pt)}));r(".fxs-topbar-dashboard-discard",(function(){vt(h.Action.DashboardDiscard);u(t.fxfinishdashboardedit,3);u(pt)}));r(".fxs-topbar-dashboard-view",(function(){vt(h.Action.DashboardView)}))}var fi,ei;r.defineProperty(t,"__esModule",{value:!0});var kt=i.Base,ht=kt.Images,dt=s.findByClassName,yt=window,oi=yt.fx.environment,gt="fxs-topbar",ni="fxs-topbar-dashboard-done-customize",ti="fxs-topbar-avatarmenu",ii="fxs-avatarmenu-imageonly",lt="fxs-display-none",pt=w.default.fxexitorganizemode,at=i.isFeatureEnabled,st=o.TopBar,si="fxs-topbar-actionsmenu",hi=!at("reservehozscroll")&&at("peekblades"),ri=at("azureconsole"),ui=!at("hidedirectorypanebutton"),ci=at("feedback"),wt={name:"actionTemplate",template:'<a href="#" class="fxs-topbar-button" role="button" data-bind="attr: { title: name, \'aria-label\': name }, image: icon, css: classNames, click: clickHandler"><\/a>'},bt={name:"notificationActionTemplate",template:'<div data-bind="css: classNames, click: clickHandler"><a href="#" class="fxs-topbar-button" role="button" data-bind="attr: { title: name, \'aria-label\': name }, image: icon"><\/a><div class=\'fxs-notificationspane-progressbar fxs-display-none\'><div><\/div><\/div><\/div>'};v.registerKoTemplate(wt.name,wt.template);v.registerKoTemplate(bt.name,bt.template);t.fxfinishdashboardedit="fxfinishdashboardedit";fi=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.showPreview=i.getFeatureValue("internalonly")!=="false",t.canReportBug=u.observable(!1),t.reportBug=f.noop,t.inDevMode=u.observable(!1),t.exitDevMode=f.noop,t.directoryFilterIcon=u.observable(ht.CustomImageWithOptions(d,{isLogo:!0})),t.dashboardMessage=u.observable(""),t.dashboardSaveButtonText=u.observable(""),t.dashboardChanged=u.observable(!1),t.dashboardWritable=u.observable(!1),t.dashboardVisible=u.observable(!1),t.isInOrganizeMode=u.observable(!1),t.peekMode=u.observable(!1),t}return __extends(t,n),t})(l.ViewModel);t.ViewModel=fi;ei=(function(n){function t(t,r,h,l){var v=n.call(this,t,r)||this,p,k,w,b;v._loadingIdList=u.observableArray([]);v._reactiveLayoutInitialized=!1;p=v.ltm;t.addClass(gt).attr("role","presentation").html(a());r.inDevMode.subscribeAndRun(p,(function(n){t.toggleClass("fxs-topbar-devmode fxs-bg-warning",n)}));r.dashboardWritable.subscribeAndRun(p,(function(n){r.dashboardSaveButtonText(n?st.saveDashboardButton:st.saveDashboardCopyButton);r.dashboardMessage(n?st.saveMessage:st.saveCopyMessage)}));u.reactor(p,(function(){f.querySelectorAll(".fxs-portal-main").add(t).toggleClass("fxs-topbar-dashboard-changed",!!r.dashboardChanged());t.toggleClass("fxs-topbar-dashboard-visible",!!r.dashboardVisible());s.toggle(dt(t,ni),!!r.isInOrganizeMode());var i="fxs-portal-button-primary",u="fxs-button-default",n=dt(t,"fxs-topbar-dashboard").findByClassName("fxs-button").filter(s.getUnhideSelector());n&&n.length&&(n.slice(1).removeClass(i).addClass(u),n.first().removeClass(u).addClass(i))}));vi(r,t);v.toggleConsole=i.noop;ri&&(k=i.memoizeQ((function(){return Q.all([i.require("MsPortalImpl/Widgets/Widgets.Console"),r.getConsoleViewModel(),]).then((function(n){var u=n[0],i=n[1],r=function(n){return n.returnValue="*",""};return i.isVisible.subscribeAndRun(p,(function(n){t.findByClassName("fxs-topbar-console").attr("aria-expanded",n);n?yt.addEventListener("beforeunload",r):yt.removeEventListener("beforeunload",r)})),new u.Widget(l,i)}))})),v.toggleConsole=function(){k().then((function(n){return n.toggle()}))});ui&&rt.allSubscriptionsSelected.subscribeAndRun(p,(function(n){r.directoryFilterIcon(ht.CustomImageWithOptions(n?d:g,{isLogo:!0}))}));w=u.observable();r.peekMode.subscribeAndRun(p,(function(n){w((n?ht.Shell.ExitPeekMode:ht.Shell.PeekMode)({isLogo:!0}))}));var it=v._topbarActions=ai(r,t,v.toggleConsole,w),nt=u.observable(),tt=u.observable();return h.get(ot.GeneralSettings).landingPage.subscribeAndRun(v.ltm,(function(){var n=et.isLandingPageDashboard(h);nt(n?o.NavBar.home:o.AzureHome.home);tt(n?"#dashboard":"#home")})),v._bindDescendants({loading:u.computed(v.ltm,(function(){return v._loadingIdList().length>0})),actions:it,getActionTemplateName:function(n){return n.template||wt.name},text:st,productName:oi.branding.productName,landingPageHash:tt,landingPageTooltip:nt}),t.findByClassName("fxs-topbar-console").attr({"aria-controls":l.attr("id"),"aria-expanded":"false"}),v.avatarMenuVM=new e.ViewModel,b=new c.Widget(t.findByClassName(ti),v.avatarMenuVM,h),v.avatarMenuOpen=b.getDropMenuOpenObservable(),p.registerForDispose([b,v.searchWidget=new y.Widget(t.findByClassName("fxs-topbar-search"),new y.ViewModel),]),v.searchWidget.options.isExpanded.subscribeAndRun(p,(function(n){t.toggleClass("fxs-topbar-search-activated",n)})),v}return __extends(t,n),t.prototype.initReactiveLayout=function(){var n=this;if(!this._reactiveLayoutInitialized){this._reactiveLayoutInitialized=!0;var e=!0,t,o,i,s,h,c,l,d=this.element.findByClassName("fxs-topbar-search"),a=this.element.findByClassName("fxs-topbar-buttons-container"),r=this.element.findByClassName(ti),v=this.element.findByClassName("fxs-topbar-internal"),y=this.element.findByClassName("fxs-topbar-exitdevmode"),b=this.element.findByClassName("fxs-topbar-reportbug"),k=function(){var f,u,w;e&&(e=!1,i=ct(n.element,"fxs-avatarmenu-tenant-image-container"),o=ct(a),s=ct(n.element,"fxs-topbar-brand"),h=ct(v),c=ct(y),l=ct(b));t?f=t:r.hasClass(ii)?f=166+i:(f=r.width(),n.element.findByClassName("fxs-avatarmenu-tenant").text()&&n.element.findByClassName("fxs-avatarmenu-username").text()&&(t=f));u=li({topbarWidth:n.element.width(),logoWidth:s,searchBarWidth:{min:250,max:468,collapsed:48,margin:15},commandIconsWidth:o,avatarMenuWidth:{normal:f,imageOnly:i},others:{previewWidth:h,debugModeWidth:c,reportBugWidth:l}});n.element.toggleClass("fxs-topbar-state-searchcollapsed",!u.searchBar.expanded);d.css("margin-right",u.searchBar.expanded?u.searchBar.rightToCommands:"");r.toggleClass(ii,!u.avatarMenuExpanded);a.toggleClass(lt,!u.commandIconsVisible);b.toggleClass(lt,!u.others.reportABugVisible);v.toggleClass(lt,!u.others.previewVisible);y.toggleClass(lt,!u.others.debugModeVisible);w=n.element.findByClassName("fxs-topbaractions-dropmenu");u.commandIconsVisible||w.length?(w.toggleClass(lt,u.commandIconsVisible),n._topbarActionsWidget&&n._topbarActionsWidget.isDropdownOpen(!1)):(n._topbarActionsWidget=new p.Widget(n.element.findByClassName(si),new p.ViewModel(n._topbarActions)),n.ltm.registerForDispose(n._topbarActionsWidget))},u=ut.throttleByAnimationFrame(k);this.ltm.registerForDispose([this.element.setEvents([w.default.fxavatartextchange,u]),f(window).setEvents([w.default.resize,u]),f(document).setEvents([ft.fullscreen,u]),]);k()}},t.prototype.loadingHint=function(n,t){t?this._loadingIdList.push(n):this._loadingIdList(this._loadingIdList().filter((function(t){return t!==n})))},t.prototype.dispose=function(){this._cleanElement(gt);n.prototype.dispose.call(this)},t.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},t.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},t})(l.Widget);t.Widget=ei}));
define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.Panorama","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/Widgets/Widgets.Toast","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";var it,rt;u.defineProperty(t,"__esModule",{value:!0});var ut=window,st=i.Base.Diagnostics.createLog(n),ft="fxs-blade-position-feature2",ht="fxs-portal-peekmode",ct="HomeScriptLoad",et="HomeScriptLoadStart",ot="HomeScriptLoadEnd";f.components.register("fxs-progress",{template:"<div class='fxs-progress-dots'><div class='fxs-progress-dots-dot'><\/div><div class='fxs-progress-dots-dot'><\/div><div class='fxs-progress-dots-dot'><\/div><\/div>"});it=(function(n){function t(t,i,r){var u=n.call(this)||this;return u.features=t,u.sideBarViewModel=i,u.settings=r,u.topBarViewModel=new b.ViewModel,u}return __extends(t,n),t})(l.ViewModel);it=__decorate([e.Class(),__metadata("design:paramtypes",[r.Features,y.ViewModel,c.GeneralSettings])],it);t.ViewModel=it;rt=(function(n){function t(t,r,u){var e=n.call(this,t,r)||this,lt,vt,yt,pt,gt,wt,at,nt,bt,it;e._displayMode=f.observable(0);e._rootPageDisplayType=e._displayMode();e.hasActiveJourney=!1;e._diContainer=u;var kt=r.features.getValue("rapidtoasts"),c=e.ltm,l=r.sideBarViewModel,dt=r.topBarViewModel,rt=r.settings,d=r.features.isEnabled("nativeperf")&&ut.performance,ni=t.findByClassName("fxs-topbar"),o=new b.Widget(ni,dt,u,t.findByClassName("fxs-portal-console"));return e.getTopBarWidget=function(){return o},lt=new v.Widget(t.findByClassName("fxs-portal-content"),new v.ViewModel("fxs-panorama-instanceid")),e.getPanorama=function(){return lt},vt=new a.ViewModel,vt.collapsed=l.isCollapsed,yt=new a.Widget(t.findByClassName("fxs-portal-contextpane-left"),vt),e.getLeftContextPane=function(){return yt},pt=new a.Widget(t.findByClassName("fxs-portal-contextpane-right"),new a.ViewModel),e.getRightContextPane=function(){return pt},f.computed(c,[o.searchWidget.options.showMenu,o.avatarMenuOpen],(function(n,i){t.toggleClass("fxs-portal-topbar-menu-open",n||i)})),s.register(t),h.register(t),gt=f.computed(c,(function(){return rt.notificationToastEnabledKey()&&kt!=="0"&&kt!=="true"})),wt=new p.ViewModel({shouldShowToasts:gt}),e.getToastVM=function(){return wt},c.registerForDispose(new w.Widget(t.findByClassName("fxs-topbar-toast"),wt)),l.getStartboardVisible=function(){return e._displayMode()===1},at=new y.Widget(t.findByClassName("fxs-sidebar"),l,u),e.getSideBarWidget=function(){return at},e._displayMode.subscribe(c,(function(n){n!==3&&(e._rootPageDisplayType=n);e.element.toggleClass("fxs-show-journey",n===3);e.element.toggleClass("fxs-show-startboard",n===1);e.element.toggleClass("fxs-show-home",n===2);dt.dashboardVisible(n===1);g.FocusHandler.Instance.journey(n===3)})),bt=function(){var n=Date.now();d&&d.mark(et);i.require("MsPortalImpl/Widgets/Widgets.AzureHome").then((function(r){d&&d.mark(ot);d&&d.measure(ct,et,ot);var f=Date.now()-n;c.registerForDispose(nt=new r.Widget(t.findByClassName("fxs-home-target"),new r.ViewModel(e.options.sideBarViewModel.launchBlade),u));nt.setFocus();nt.getFirstLoadPerfIndicators().then((function(n){i.Base.Diagnostics.Telemetry.trace({source:tt.Source.Shell,action:tt.Action.AzureHomeLoad,data:{assets:n.assets,recents:n.recents,scripts:f}})}))})).catch((function(n){st.error("failed to load and initialize azure-home",null,i.getLogFriendlyMessage(n))}));bt=i.noop},r.features.isEnabled("reservehozscroll")&&e.element.addClass(ft),it=f.observable(!1),e.ltm.registerForDispose([o,lt,yt,pt,at,function(){s.unregister(t);h.unregister(t)},e.element.setEvents([k.default.fxloadingontopbar,function(n,t){o.loadingHint(t.id,!t.cancel);var i=lt.getJourneyWidget();i&&i.loadingHint(t.id,!t.cancel)},],[k.default.fxshowstartboard,function(n,t){var r,i;e._displayMode()!==1&&(e._displayMode(1),l.isCollapsed(rt.sideBarCollapsedKey()),r=t&&t.skipFocus,r||(i=e.getPanorama().getStartBoardWidget(),i&&i.setFocus()))},],[k.default.fxshowjourney,function(){e._displayMode()!==3&&(e._displayMode(3),l.isCollapsed(rt.sideBarCollapsedKey()))},],[k.default.fxshowhomepage,function(n,t){e._displayMode()!==2&&(e._displayMode(2),l.isCollapsed(rt.sideBarCollapsedKey()),bt(),nt&&(nt.reloadRecentUsage(),t&&t.skipFocus||nt.setFocus()))},],[k.default.fxtoggleallservices,function(){at.toggleFlyout()},],[k.default.fxpeekmode,function(n,t){it(t&&t.enter!==undefined?!!t.enter:!it())},],[k.default.fxtoggleconsole,function(){o.toggleConsole()},]),$(ut).setEvents([k.default.keyup,function(n){n.which===27&&it(!1)},]),]),it.subscribe(c,(function(n){e.element.toggleClass(ht,n);var t=e.getPanorama().getJourneyWidget();t&&t.peekMode(n);o.options.peekMode(n)})),e}return __extends(t,n),t.create=function(n,i,r){return new t(n.portal,i,r)},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement(ft)},t.prototype.getDisplayMode=function(){return this._displayMode()},t.prototype.getRootPageDisplayType=function(){var n=this._rootPageDisplayType;return n!==2&&n!==1&&(n=nt.isLandingPageDashboard(this._diContainer)?1:2),n},t})(l.Widget);__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.RootElements,it,e.Container]),__metadata("design:returntype",rt)],rt,"create",null);t.Widget=rt}));
define("MsPortalImpl/UI/UI.ContextPane",["require","exports","o","ko","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l,a,v,y;i.defineProperty(t,"__esModule",{value:!0});l=(function(){function n(){}return n})();t.ContextPane=l;a=(function(){function n(n){var f=this,i,t,u;this._widget=n;i=this._viewModel=n.options;t=this._containerLifetime=n.ltm;this._contentLifetime=t.createChildLifetime();this.collapsed=i.collapsed;u={dismissFn:function(){f.close()},logName:"contextPane"};r.reactor(t,(function(){i.opened()?e.register(u):e.unregister(u)}));t.registerForDispose(n.element.setEvents([c.default.fxcontextpaneclosing,function(n){n.stopPropagation();f.close()},]))}return i.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},i.defineProperty(n.prototype,"contentLifetime",{get:function(){return this._contentLifetime},enumerable:!0,configurable:!0}),n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===n?(this._widget.setFocus(),Q(!0)):(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),o.read(f.Shell.Reader.contextPaneLoading,0),n.onAddingContent(this._widget).finally((function(){return s.waitForBindings(r._widget.element[0]).finally((function(){i.loading(!1);o.read(f.Shell.Reader.contextPaneReady.format(r._widget.element.find(".fxs-contextpane-title").text()),1)}))})).then((function(){return r._widget.setFocus(),t}))):Q(t)},n.prototype.close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),o.read(f.Shell.Reader.contextPaneClosed,0),this._restoreFocus()),t},n.prototype._clearContent=function(){var t=this._contentProvider,n;t&&t.onRemovingContent(this._widget);this._contentProvider=null;n=this._contentLifetime;n&&(n.dispose(),this._contentLifetime=this._containerLifetime.createChildLifetime())},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n})();t.ContextPaneImpl=a;v=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.create=function(n){return new a(n.getRightContextPane())},t})(l);__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h.Widget]),__metadata("design:returntype",v)],v,"create",null);t.RightContextPane=v;y=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.create=function(n){return new a(n.getLeftContextPane())},t})(l);__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h.Widget]),__metadata("design:returntype",y)],y,"create",null);t.LeftContextPane=y}));
define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",["require","exports","f","o","a","ko","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";function kt(n,t,i,r){var u;return t.lc2?u=new oi(n,i,r):t.viewModel?u=new ei(n,i,r):t.execute?u=new gt(n,i,r):t.navigateUriCallback?u=new ii(n,i,r):t.navigateUri?u=new ni(n,i,r):t.listItems?u=new ri(n,i,r):t.targetUri&&t.httpMethod?u=new fi(n,i,r):(r.commandItem.commandDefinition.details||t.bladeName)&&(u=new pt(n,i,r)),u}function lt(n){var t=n,i=null;if(!(n instanceof at))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");return t.compositionInstance&&t.compositionInstance.locator&&(i=t.compositionInstance.locator.toFriendlyString()),i}function vt(n){n&&n.hideForm()}function ot(n){var t=n&&n.title,i=n&&n.description;l&&l.getNotificationManager()&&l.getNotificationManager().addClientNotification({title:t||it.uriCallbackCommandError,description:i||it.error,status:hi.Error,timestamp:new Date})}function ti(n,t){o.sanitizeUri(n)?st.open(n,t):(nt.error(it.invalidUri.format(n)),ot())}function bi(n,t){var i=n;ft(["text","icon","enabled"],(function(n){ui(i[n],n,t)}));ui(i.onInputsSet,"onInputSet",t,!0)}function ui(n,t,i,r){ht(n)||typeof n!="function"||!r&&ht(n())||ki(t,i)}function ki(n,t){nt.warning("The '"+n+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+t+"' dynamic command viewModel.")}function di(n){var t;return n.name?n.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&nt.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,n.name,JSON.stringify(n))),!t}function gi(n){ct=Q(n)}var at,dt,tt,gt,ni,yt,ii,ri,fi,ei,pt,oi;r.defineProperty(t,"__esModule",{value:!0});var rt=i.Base,wt=rt.Diagnostics,ut=wt.Telemetry,si=rt.Resources,hi=i.Hubs.Notifications.NotificationStatus,ci=i.ViewModels,li=ci.Dialogs,ai=v.CompositionType,vi=p.CompositionBinder,yi=w.ReferenceScope,pi=rt.Net2,st=window,nt=wt.createLog(n),bt=function(){return i.require("MsPortalImpl/UI/UI.DialogManager")},ht=i.isNullOrUndefined,ft=i.uncurryThis(u.prototype.forEach),ct=null,wi={invocationInputArguments:[{valuesFrom:[{referenceType:4,property:"container.selectable"}]}]},g=h.FileDownloadCommand,it=h.UriCallbackCommand,et=412;t.createExtensionCommand=kt;t.getCommandSourceTelemetryName=lt;at=(function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.compositionInstance=r,u}return __extends(t,n),t})(c.CommandContext);t.CompositionInstanceCommandContext=at;dt=(function(){function n(){}return n})();t.ExtensionCommandImplOptions=dt;tt=(function(){function n(n,t,r){var u=this,f;this._extension=r.extension;this._viewModelName=r.viewModelName;this.viewModel=t;this.commandItem=r.commandItem;this._commandContainer=r.container;f=this._ltm=n.createChildLifetime();this._propertyBindings=r.propertyBindings;this._services=r.services;f.registerForDispose((function(){u.viewModel&&(i.disposeViewModelProperties(u.viewModel),u._extension.releaseViewModel(u.viewModel),u.viewModel=null);u._propertyBindings&&(u._propertyBindings.unbind(),u._propertyBindings=null)}))}return n.prototype.init=function(){},n.prototype.execute=function(n){var t=this._services&&this._services.desktop.getActiveJourney();ut.trace({extension:this._extension.name,source:lt(this._context()),action:a.Action.CommandExecuted,name:this._viewModelName,data:n,journeyId:t&&t.id})},n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._context=function(){return this.commandItem.getCommandContext()},n.prototype._getFormTarget=function(){var n=this._context();return n.getFormTarget()},n.prototype._target=function(){var n=this._context();return n&&n.target},n})();gt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content(),u._services.diContainer.get(k.DesktopManagerMode).value.subscribe(u._ltm,(function(n){u._getFormTarget().then((function(t){n===1&&t&&t.hideForm()}))})),u}return __extends(t,n),t.prototype.execute=function(t,i){var u=this,r;n.prototype.execute.call(this,t,i);r=this._viewModel;r.status()===1?Q.all([this._services.diContainer.getAsync(d.DialogManager),this._getFormTarget()]).spread((function(n,t){u._loadDialog(t,n,f.unwrap(r.dialog))})):r.status(1);r.execute(i)},t.prototype.init=function(){var n=this,t=this._viewModel,i=this._ltm,r=function(t,i,r){r===0?vt(t):r===1&&n._loadDialog(t,i,f.unwrap(n._viewModel.dialog))},u=function(t,i,r){n._viewModel.status()===1&&n._loadDialog(t,i,r)};this._services.diContainer.getAsync(d.DialogManager).then((function(e){t.status.subscribe(i,(function(t){n._context()&&n._getFormTarget().then((function(n){r(n,e,t)}))}));f.isObservable(t.dialog)&&t.dialog.subscribe(i,(function(t){n._getFormTarget().then((function(n){u(n,e,t)}))}))}))},t.prototype._loadDialog=function(n,t,r){var u=this;if(n&&(!i.deepEquals(this._currentDialogOptions,r)||!t.hasOpenDialog))if(this._currentDialogOptions=r,ht(r))vt(n);else{if(!this._target())return;var o=$(n.getForm()),f=this._commandContainer.locator,s=f&&f.withCommand(this.commandItem.commandName);this.commandItem.pressed(!0);t.showDialog(o,r,s).then((function(t){u.commandItem.pressed(!1);var i=u._viewModel,r=i&&i.dialogClick;typeof r=="function"&&r.call(i,t);vt(n)}));n.showForm(e.getBox(this._target()))}},t})(tt);ni=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content(),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var i=this._viewModel,r=i.navigateTarget?i.navigateTarget():"_blank";n.prototype.execute.call(this,t);st.open(i.navigateUri(),r)},t})(tt);yt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype._getDlgElem=function(n){var t=n&&n.getForm();return t&&$(t)},t.prototype._getLocator=function(){var n=this._commandContainer.locator;return n&&n.withCommand(this.commandItem.commandName)},t.prototype._showUriCbProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._uriCbProgressTitle,this._uriCbProgressText,i)},t.prototype._showDownloadProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._progressTitle,this._progressText,i)},t.prototype._showProgressDlg=function(n,t,i,r,u){var f=new li.ProgressBox(i,r);t.showDialog(this._getDlgElem(n),f,this._getLocator());this._showForm(n,u)},t.prototype._showForm=function(n,t){t&&n&&n.showForm(e.getBox(this._target()))},t.prototype._hideForm=function(n,t){t&&n&&n.hideForm()},t.prototype._getResources=function(n){var t=n.uriCallbackConfirmationDialogOptions||{},i=n.downloadProgressDialogOptions||{};this._uriCbProgressTitle=t.uriCallbackProgressTitle||g.uriCallbackProgressTitle;this._uriCbProgressText=t.uriCallbackProgressText||g.uriCallbackProgressText;this._dnldTitle=t.downloadTitle||g.downloadTitle;this._dnldText=t.downloadText||g.downloadText;this._defaultBtnText=t.defaultButtonText||g.defaultButtonText;this._cancelBtnText=t.cancelButtonText||g.cancelButtonText;this._progressTitle=i.downloadProgressTitle||g.downloadProgressTitle;this._progressText=i.downloadProgressText||g.downloadProgressText},t})(tt);ii=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content(),u._getResources(u._viewModel),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);var e=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",r=this._viewModel,s=r.navigateUriCallback&&r.navigateUriCallback(),l=this.commandItem,h=l.fxEnabled,a=r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog(),c=function(n){i._hideForm(n,t);h(!0)},u,f=!0;s&&a?(h(!1),Q.all([this._services.diContainer.getAsync(d.DialogManager),this._getFormTarget()]).spread((function(n,o){return i._dlgMgr=n,i._showUriCbProgressDlg(o,n,t),Q(r.navigateUriCallback()()).then((function(t){return f=!1,bt().then((function(r){var u=new r.MessageBox(i._dnldTitle,i._dnldText,2);u.defaultButtonText=i._defaultBtnText;u.cancelButtonText=i._cancelBtnText;n.showDialogWithCallback(i._getDlgElem(o),u,(function(n){n===4&&ti(t,e);c(o)}),i._getLocator())}))}),(function(n){ot(n)})).finally((function(){f&&(nt.error(it.callbackError.format("navigateUriCallback failed.")),u&&u.close(),i._dlgMgr&&i._dlgMgr.dismissOpenDialog(),c(o))}))})).catch((function(n){nt.error(n)}))):s?(h(!1),u=st.open("about:blank",e),Q(s()).then((function(n){f=!1;o.sanitizeUri(n)?u.location.href=n:(nt.error(it.invalidUri.format(n)),ot(),u.close())}),(function(n){ot(n)})).finally((function(){f&&(nt.error(it.callbackError.format("navigateUriCallback failed.")),u.close());i._getFormTarget().then((function(n){c(n)}))}))):ti(r.navigateUri(),e)},t})(yt);ri=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this,s=u._ltm,h=u.commandItem,e=i.content(),c=h.widgetViewModel,o=c.dialogOptions;return f.reactor(s,(function(){o.listItems(e.listItems())})),e.selectedItem.subscribe(s,(function(n){o.selectedItem(n)})),o.selectedItem(e.selectedItem()),h.hasPopup(!0),o.selectedItem.subscribe(s,(function(n){e.selectedItem(n)})),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(tt);fi=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content(),u._getResources(u._viewModel),s.isSafari&&s.webKitVersion<s.safari_11_webKitVersion&&(u.commandItem.fxEnabled(!1),u.commandItem.tooltip(h.FileDownloadCommand.safariDownload)),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var r=this;n.prototype.execute.call(this,t);var u=null,e=this.commandItem,f=e.fxEnabled;f()&&rt.Promises.cancelOnDispose(this._ltm,i.require("MsPortalImpl/Commands/FileDownloadUtil")).then((function(n){var i=r._viewModel,o=n.getHttpMethod(i),s=function(n){r._hideForm(n,t);f(!0)};if(!o){n.notifyError(i,et,g.typeError);r._getFormTarget().then((function(n){s(n)}));return}f(!1);i.downloadStatus(null);var h=r._services.diContainer.getAsync(d.DialogManager),e=r._getFormTarget(),c=Q.all([h,e]).spread((function(n,i){return r._getUri(i,n,t)}));return Q.all([h,c,e]).spread((function(f,e,s){var h=e&&e.startsWith("data:");if(!si.isUriAbsolute(e)&&!h){n.notifyError(i,et,g.absoluteUriError);return}if(i.showDownloadProgressDialog&&i.showDownloadProgressDialog()&&r._showDownloadProgressDlg(s,f,t),u=ut.startTrace({extension:r._extension.name,source:lt(r._context()),action:a.Action.StartFileDownload,name:r._viewModelName,data:t}),h)n.dataUriHandler(i,f,e);else return pi.ajaxExtended(n.getAjaxOptions(i,e,o)).then((function(t){if(r.viewModel){var e=t.content,o=e&&e.length?e.length:0;return n.onSuccess(i,f,e,t.textStatus,t.jqXHR).then((function(){ut.completeTrace(u,o)}))}}),(function(t){n.onError(i,f,t.textStatus,t.jqXHR.status,t.errorThrown);return ut.cancelTrace(u),Q.reject(t.errorThrown)}))})).catch((function(n){n&&nt.error(n);ut.cancelTrace(u)})).finally((function(){e.then((function(n){s(n)}))}))})).catch((function(n){n&&nt.error(n)}))},t.prototype._getUri=function(n,t,r){var f=this,u=this._viewModel,e=u.targetUriCallback&&u.targetUriCallback(),o=u.showUriCallbackConfirmationDialog&&u.showUriCallbackConfirmationDialog();return rt.Promises.cancelOnDispose(this._ltm,i.require("MsPortalImpl/Commands/FileDownloadUtil")).then((function(i){if(e)return o&&f._showUriCbProgressDlg(n,t,r),Q(e()).then((function(r){return r?o?bt().then((function(i){var r=new i.MessageBox(f._dnldTitle,f._dnldText,2);return r.defaultButtonText=f._defaultBtnText,r.cancelButtonText=f._cancelBtnText,t.showDialog(f._getDlgElem(n),r,f._getLocator())})).then((function(n){return n===4?Q(r):Q.reject()})):(i.dismissDialog(t,u),Q(r)):Q.reject(g.uriError)})).catch((function(n){i.dismissDialog(t,u);var r=null;return n&&(r=u.errorMessage()||"{0} {1}".format(g.downloadTargetUriCallbackFailed,n),i.notifyError(u,et,r)),Q.reject(r)}));var s=u.targetUri&&u.targetUri();return s?Q(s):(i.notifyError(u,et,g.uriError),Q.reject(g.uriError))}))},t})(yt);ei=(function(n){function t(t,r,u){var e=n.call(this,t,r,u)||this,s,o;return e._container=u.container,e._viewModel=r.content(),e._selectionInList=u.selectionInList,s=e._ltm,e._viewModel.viewModel.subscribeAndRun(s,(function(n){var t,h,c,r,u;o&&o.dispose();o=s.createChildLifetime();t=e._nestedCommand;t&&(t.dispose(),e._nestedCommand=undefined);n&&(h=e.viewModel,c={container:e._container,extension:e._extension,viewModelName:e._viewModelName,commandItem:e.commandItem,propertyBindings:null,services:e._services,selectionInList:e._selectionInList},e.commandItem.commandDefinition.details=wi,bi(n,e._viewModelName),r=i.clone(h),r.content=f.observable(n),u=n,u.bladeName&&r.container.selectable.selectedValue({detailBlade:u.bladeName,detailBladeInputs:u.bladeInputs}),t=e._nestedCommand=kt(o,n,r,c),t.init(),e.canSkipBladeValidation=t.canSkipBladeValidation)})),e}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t);this._nestedCommand?this._nestedCommand.execute(t):nt.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))},t.prototype.dispose=function(){this._nestedCommand&&this._nestedCommand.dispose()},t})(tt);pt=(function(n){function t(t,r,u){var f=n.call(this,t,r,u)||this,o,e;f._addedOutputPropertyBindings=[];f._outputBindingDefinitions=[];f._viewModel=r;f._containerViewModel=r.container;f._options=u;o=f.commandItem;e=o.commandDefinition;f._commandInstanceId=u.selectionInList?i.newGuid():undefined;var h=di(e),s=e.details,c=f._validateDetailsDefinition(s);return h&&c?(f._outputBindingDefinitions=vi.mapInputBindingDefinitions(s.outputArguments||[],u.container,(function(n){n.source.scope=yi.DetailsContainer})),f.getBladeOpener()):u.commandItem.setEnabled(!1),f.canSkipBladeValidation=!0,f}return __extends(t,n),t.prototype.getBladeOpener=function(){var n=this,t;return this._ltm?(t=this._ltm,this._bladeOpenerPromise||(this._bladeOpenerPromise=i.tryImmediateResolve(ct||(ct=i.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener")),(function(i){var u=n._options,r=i.create(n._getBladeOpenerConfig(u.container,u.extension));return r.registerInvocationProperty(n.commandItem.commandDefinition.details),t.registerForDispose(r),r})))):Q.reject(new i.Errors.DisposedCanceledError)},t.prototype.execute=function(t){var r=this;n.prototype.execute.call(this,t);i.tryImmediateResolve(this.getBladeOpener(),(function(n){if(!n||r._ltm&&!r._ltm.isDisposed()){var t=r._containerViewModel,i=t&&t.selectable;i?i.isSelected(!0):nt.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(r.commandItem.commandDefinition.name,r._extension.name))}}))},t.prototype._getBladeOpenerConfig=function(n,t){var r=this,o=this.commandItem.commandDefinition.details,s=o?!!o.parameterCollector:!1,e=this._services;return{services:e,masterModelId:"{0}-[{1}-{2}]".format(n.toString(),"OpenBladeCommand",this.commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:n,referenceExtension:t,isBladeOpenedByMaster:function(t){return t.masterCommandName===r.commandItem.commandDefinition.name&&t.masterPartId===n.id&&t.masterCommandId===r._commandInstanceId},configureBindings:function(t){ft(t,(function(t){var i=t.source,u=i&&i.modelType;u===4&&(i.modelId=r.commandItem.commandDefinition.name,v.isPartComposition(n)&&(i.partLocator=n.locator,i.id=n.id))}))},configureBladeDescriptor:function(t){var i,e,h;if(t.masterCommandName=r.commandItem.commandDefinition.name,t.masterCommandId=r._commandInstanceId,t.masterCommandExtension=r._extension,t.masterPartId=n.id,i=t.bindings,u.isArray(i))for(e=i.length-1;e>=0;e--){var c=i[e],o=c.source,l=o&&o.modelType;l===4&&(t.model[c.targetProperty]=f.toJS(w.getModelValue(r._viewModel,o.property).value),h=r.commandItem.sourceBindableContainer,!s&&h&&h.isPartListItem&&i.splice(e,1))}},onBladeOpened:function(n){r._setCmdActivated(!0);n.onDispose((function(){r._bladeOpenerPromise&&i.tryImmediateResolve(r._bladeOpenerPromise,(function(t){t.notifyDetailBladeClosed(n)}));r._disposeOutputBindings();r._setCmdActivated(!1)}));n.awaitComposed().then((function(){r._createOutputBindings(n)}))},getCloseOtherDetailBladesHandler:function(t,i){if(i.openInContextPane){if(n.getCompositionType()===ai.StartboardPart){var r=e.desktop.getActiveJourney();return!r||r.isStartedWithContextBlade()?null:function(){return e.desktop.tryDeactivateJourney()}}if(!e.diContainer.get(b.RightContextPane).opened.peek())return function(){return!0}}return null}}},t.prototype._createOutputBindings=function(n){var t=this;ft(this._outputBindingDefinitions,(function(i){var u=t._propertyBindings,r;u&&(r=u.mapProperty(i.source.property,i.targetProperty).bind(n.toString()+"LaunchCommandOutputBinding",n.getViewModel()),r.compositionBindingDefinition=i,t._addedOutputPropertyBindings.push(r))}))},t.prototype._disposeOutputBindings=function(){var n=this;this._propertyBindings&&ft(this._addedOutputPropertyBindings,(function(t){n._propertyBindings.removeProperty(t)}));this._addedOutputPropertyBindings.length=0},t.prototype._validateDetailsDefinition=function(n){var t=[],i=function(n){var t,i=n.invocationInputArguments;return n.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":i&&i[0].valuesFrom[0].referenceType!==4&&(t="Command invocation argument reference type can only be of type Command."),t},r=y.validateDetailsDefinition(n,t,i);return t.length&&nt.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this.commandItem.commandDefinition.name,JSON.stringify(n))),r},t.prototype._setCmdActivated=function(n){var t=this._commandContainer.getViewModel(),i=t&&t.container,r=i&&i.selectable;r&&r.isCommandSelected(n);this.commandItem.pressed(n)},t})(tt);oi=(function(n){function t(t,i,r){var o=n.call(this,t,i,r)||this,s=o._ltm,h=o.commandItem,u=i.content(),c=h.widgetViewModel,e=c.dialogOptions;return f.reactor(s,(function(){e.listItems(u.listItems())})),u.selectedItem.subscribe(s,(function(n){e.selectedItem(n)})),e.selectedItem(u.selectedItem()),h.hasPopup(!0),e.selectedItem.subscribe(s,(function(n){u.selectedItem(n)})),o}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(pt);t.setBladeOpenerModule=gi}));
define("MsPortalImpl/Services/Services.Permissions",["require","exports","i","o","Fx/ResourceManagement","FxInternal/Di","FxHubs/Permissions"],(function(n,t,i,r,u,f,e){"use strict";function a(n,t){return e.Rpc.hasPermissionsToHubs.invoke(s.client,h,{entityId:n,requestedActions:t,providedActions:null})}function v(n){return Q(e.Rpc.getPermissionsToHubs.invoke(s.client,h,{entityId:n}))}function y(){return e.Rpc.isCoAdminEndpoint.invoke(s.client,h,{})}var l,o;r.defineProperty(t,"__esModule",{value:!0});var c=i.Extension,s=i.Rpc,h=c.getHubsWindowId();t.Internal={};l=(function(){function n(){var n=e.createCachedPermissionsGetter(v);this._cachedPermissionsGetter=n;this._getPermissionsCallback=function(t){return n.getPermissions(t)}}return n.prototype.isCoAdmin=function(){return y()},n.prototype.hasPermission=function(n,i){if(t.Internal.hasPermissionOverride)return Q(t.Internal.hasPermissionOverride(n,i));if(e.PermissionChecker.isRDFEAction(i))return a(n,i);var r=u.ArmId.parse(n);return r.kind===0?Q("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID"):e.PermissionChecker.hasPermission(n,i,null,this._getPermissionsCallback)},n.prototype.getCachedPermissions=function(){return this._cachedPermissionsGetter.getCachedPermissions()},n})();o=(function(){function n(){}return n.create=function(){return new l},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",o)],o,"create",null);t.PermissionsManager=o;t.hasPermissionsToShell=f.defineHandler(c.hasPermissionsToShell,(function(n){return n.diContainer.get(o).hasPermission(n.messageArg.entityId,n.messageArg.requestedActions)}))}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","f","i","ko","$","Fx/ResourceManagement","MsPortalImpl/AsyncLoader","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(n){function l(n,t,i,u,f,e,o){if(n&&n.length){if(c[t]===undefined)return r.QReject("checkPermission: unexpect requirement: "+t);var h=t===c.All;return n.reduce((function(n,t){return n.then((function(r){var c,y,v;if(g(h,r))return n;if(c=void 0,t.permissionType===0)y=t,c=a(y,i,u,f,e,o);else if(t.permissionType===1)v=t,c=l(v.permissions,v.requirement,i,u,f,e,o);else throw new Error("unexpected permission.permissionType: "+t.permissionType);return c.catch((function(n){var t=s.warning;return t.call(s,n,1,["Failed check permissions:","compositionInfo:"+o,"reason: "+n].join("\n")),Q(!0)}))}))}),Q(h))}return Q(!0)}function a(n,t,i,r,f,c){if(!n)return Q(!1);var a=function(t){return f.diContainer.get(h.PermissionsManager).hasPermission(t,[n.action])},l;switch(n.assetId.sourceType){case 0:l=Q(t[n.assetId.property]);break;case 1:l=v(n,t,i,r,f);break;case 2:l=v(n,t,n.assetType||i,n.extensionName||r,f)}return l.then((function(t){t=u.unwrap(t);var h=n.extensionName||r,l=n.assetType||i;return nt(e.ArmId.parse(t))?a(t):d(f.assetTypeService.assetTypesComplete,(function(){var n=f.assetTypeService.getAssetType(h,l,2),i,r;return n?(i=s.warning,r="",i.call(s,["Performance Warning: assetId is not in the form of resourceID. This result in slow code path to perform the conversion. Please contact the extension below to improve performance","assetTypeExtension: "+h+", assetType: "+l,"composition: "+(c||""),r,].join("\n")),f.diContainer.getAsync(o.get("MsPortalImpl/UI/Hubs/UI.ResourceMapManager","ResourceMapManager")).then((function(i){return i.mapAssetIdToResourceId({extensionName:n.extension,assetType:n.assetTypeManifest.name,assetId:t})})).then((function(n){return a(n)}))):Q(!1)}))}))}function v(n,t,r,u,e){var o="[getAssetIdFromPropertyProvider]:";return e.extensionManager.getExtensionByName(u).then((function(u){var e=u.getManifest("assetTypes").assetTypes.first((function(n){return n.name===r}));if(!e)throw new Error(o+"Unknown extension Asset Type : "+r);return u.getViewModel(e.propertyProviderServiceViewModelLocator||e.propertyProviderServiceViewModel,11).then((function(r){var e=new p;return e.registerForDispose((function(){i.disposeViewModelProperties(r);u.releaseViewModel(r)})),Q.fcall((function(){var i=r.content(),u=i&&i.onInputsSet,e,s;if(typeof u=="function")return e=f.extend({providerKey:n.assetId.providerKey},t),s=u.call(i,e)||Q(),s.then((function(){var u=i.properties(),t=n.assetId.property,r=u.first((function(n){return n.property===t}));if(r)return r.value;throw new Error(o+"Can not find propertyDefinition for assetIdProperty: "+t);}));throw new Error(o+"ViewModel.content.onInputsSet is not a function.");})).finally((function(){e.dispose()}))}))}))}function nt(n){return n&&y[n.kind]}var p=r.TriggerableLifetimeManager,w=i.Base,b=w.Diagnostics,k=i.Extension,c=k.SetRequirement,d=i.tryImmediateResolve,s=new b.Log("UI/Composition/Security"),g=i.xor,y,t;n.checkPermissions=l;n.checkPermission=a;y=(t={},t[4]=!0,t[6]=!0,t[8]=!0,t[3]=!0,t[1]=!0,t)})(c||(c={})),c}));
define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function l(n){return typeof n=="string"}var c=i.Base.Diagnostics.Telemetry,a=i.ViewModels.Dialogs,t=(function(n){function t(t,r,e,o){var s=this,c=o&&o.commandName,h;return s=n.call(this,t,r.label)||this,h=s._ltm,s._executeLifetime=o&&o.executeLifetime||h,s._model=r,s._locator=e,s.icon=u.computed(h,{read:function(){var n=u.unwrap(s._model.icon);return n&&i.extend2(n,{options:f.extend({palette:99},n.options)})},write:s._model.icon}),s.commandName=c||i.getUniqueId(),s.enabled=u.computed(s._executeLifetime,(function(){var n=r,t=!r.disabled(),i=!n.command||n.command.canExecute();return t&&i})),u.computed(h,(function(){s.unauthorized(!!u.unwrap(r.unauthorizedMessage))})),u.computed(h,(function(){var n=u.unwrap(r.unauthorizedMessage),t;n||(t=u.unwrap(r.disabled),n=l(t)?t:null);n=n||u.unwrap(r.tooltip);s.tooltip(n)})),s.isSeparator=u.observable(r.type===12),s}return __extends(t,n),r.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),r.defineProperty(t.prototype,"type",{get:function(){return this._model&&this._model.type},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){c.trace({source:this._locator&&this._locator.toFriendlyString(),action:o.Action.CommandExecuted,name:this.model.name||"Toolbar name not specified",extension:this._locator&&this._locator.getExtensionLocator().name});n.prototype.execute.call(this,t)},t})(e.CommandImpl),h;n.ItemViewModel=t;h=(function(n){function t(t,i,r,f,e){var o=n.call(this,t,i,r,e)||this,s;return o.hasOpenDialog=u.observable(!1),o._diContainer=f,s=i.dialogOptions,o.hasPopup(!!s&&s.type===4),o}return __extends(t,n),r.defineProperty(t.prototype,"dialogOptions",{get:function(){return this._model.dialogOptions},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){var r=this;i.Base.Promises.cancelOnDispose(this._executeLifetime,Q.all([this._diContainer.getAsync(s.DialogManager),this._currentContext.getFormTarget()]).spread((function(u,e){if(r.hasOpenDialog())u.dismissOpenDialog(),r.hasOpenDialog(!1);else{var o=r._currentContext,s=o&&o.target,c=e&&e.getForm(),h=r._model;r.hasOpenDialog(!0);i.Base.Promises.cancelOnDispose(r._executeLifetime,u.showDialog(f(c),r.dialogOptions,r._locator)).then((function(n){r.hasOpenDialog(!1);h.command&&h.command.execute(n);e&&e.getDismissHandler&&e.getDismissHandler()&&(e.hideForm(),e.getDismissHandler().restoreFocus())}),(function(){r.hasOpenDialog(!1)}));e&&s&&i.Base.Promises.cancelOnDispose(r._executeLifetime,i.require("Viva.Controls/Controls/Viva.Balloon")).then((function(n){e.showForm(n.getBox(s))}))}n.prototype.execute.call(r,t)})))},t})(t);n.DialogButton=h})(h||(h={})),h}));
define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","f","i","o","a","ko","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";function dt(n){return k.getCommandSourceTelemetryName(n)}function gt(n){var t=d.Widget.getWidget(n,null);if(n.hasClass("fxs-bladecontent"))return t}function ni(n){var t=d.Widget.getWidget(n,null);if(n.hasClass("fxs-blade"))return t}function ti(n,t,i){var r=i.commandGroupReference,u=r?r.name:i.commandGroup;return u?n.locate(ut.forExtension(t).withCommandGroup(u)):null}function ct(n,t,i,r,u){var f=new bt.DialogButton;return f.dialogOptions=new wt.ListPopup,f.dialogOptions.type=u?4:0,new g.DialogButton(n,f,r.locator.withCommand(t.name),i,{commandName:t.name})}function ii(n,t,i,r,u,f){var e={name:f,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:4}]}]}};return at(n,t,i,(function(n){return new nt.OpenBladeCommand(n)}),e,r,u,f)}function ri(n,t,i,r,u,f,e){return at(n,t,i,(function(){var n=new nt.UriCommand;return n.navigateUri=e.uri,n.navigateTarget=e.target,n}),{name:f},r,u,f)}function at(n,i,r,u,f,e,s,h){var v="__{0}ViewModel__".format(h),c=o.composeViewModel(u,!0),l=new it(n,s,r,f,e,i),y={container:r,extension:s,viewModelName:v,commandItem:l,propertyBindings:null,services:i,selectionInList:!1},a=k.createExtensionCommand(n,c.content(),c,y);return l.bind(new t.CompositionInstanceCommandContext(null,null,r)),n.registerForDispose([c.container,l,a]),a}var tt,ht,it,lt;u.defineProperty(t,"__esModule",{value:!0});var ut=c.Locator,ft=i.Base,vt=ft.Diagnostics,et=ft.Images,yt=i.Extension,pt=yt.SetRequirement,nt=i.ViewModels,wt=nt.Dialogs,bt=nt.Toolbars,kt=y.CompositionBinder,ot=vt.createLog(n),st=a.Commands,rt=i.uncurryThis(f.prototype.forEach);t.CompositionInstanceCommandContext=k.CompositionInstanceCommandContext;t.getCommandSourceTelemetryName=dt;t.getBladeContentWidget=gt;t.getBladeContainerWidget=ni;t.getCommandGroupForDefinitionItem=ti;tt=(function(n){function t(t,i,r,u,f){var o=this,s=e.observable(!1);return o=n.call(this,t,r)||this,o.commandName=i,o._services=f,o._compositionContainer=u,o.enabled=s.extend({allowOverride:u}),o._init(f.desktop),o}return __extends(t,n),u.defineProperty(t.prototype,"services",{get:function(){return this._services},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"container",{get:function(){return this._compositionContainer},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"sourceBindableContainer",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype._init=function(n){var t=this;e.reactor(this._ltm,(function(){var i=t.enabled,r=n.commandsEnabled();r&&t._services.diContainer.get(w.DesktopManagerMode).value()!==1?i.restoreLastWrittenValue():i.override(!1)}))},t})(v.CommandImpl);t.ExtensionCommandMenuItemBase=tt;ht=(function(n){function t(t,i,r,u,f,o,h){var c=this,l=u.name;c=n.call(this,t,l,u.text,r,o)||this;var a=c._ltm,v=r+"[Command: "+l||u.text+"]",y=s.getSelectedItems(h);return c._subcommands=y.map((function(n){var t={viewModel:n.data,viewModelName:v,isPartListItem:!0};return new it(a,i,r,u,f,o,t)})),e.reactor(a,(function(){var n=c._subcommands.reduce((function(n,t){return t.enabled()&&n}),!0);c.enabled(n)})),c}return __extends(t,n),t.prototype.bind=function(n){rt(this._subcommands,(function(t){t.bind(n)}))},t.prototype.activate=function(){rt(this._subcommands,(function(n){n.activate()}))},t.prototype.execute=function(n){rt(this._subcommands,(function(t){t.execute(n)}))},t})(tt);t.ExtensionMultiselectCommandMenuItemImpl=ht;it=(function(t){function o(n,i,r,u,f,e,o,s){var h=t.call(this,n,u.name,u.text,r,e)||this;return h._extension=i,h._commandDefinition=u,h._commandContainerDefinition=f,h._sourceBindableContainer=o,h._selectionInList=s,h}return __extends(o,t),o.prototype.extensionName=function(){return this._extension&&this._extension.name},u.defineProperty(o.prototype,"commandDefinition",{get:function(){return ot.assert(!this._commandDefinition.reference,"External CommandDefinition not resolved."),this._commandDefinition},enumerable:!0,configurable:!0}),o.prototype.getInputBindingsFromDefinition=function(n){var i,t=this._getCommandReference(n);return t&&f.isArray(t.bindings)&&t.bindings.length>0?i=t.bindings:n&&(i=n.bindings),i||[]},u.defineProperty(o.prototype,"widgetViewModel",{get:function(){return this._widgetViewModel},enumerable:!0,configurable:!0}),u.defineProperty(o.prototype,"sourceBindableContainer",{get:function(){return this._sourceBindableContainer},enumerable:!0,configurable:!0}),o.prototype.activate=function(){this._loadViewModel()},o.prototype.execute=function(n){var t=this,i=this.widgetViewModel,r=i&&i.dialogOptions;r&&r.type&&i.type===5?this._getFormTarget().then((function(i){var f=i&&i.getForm(),u=t.container.locator,e=u&&u.withCommand(t.commandName);t._services.diContainer.getAsync(b.DialogManager).then((function(n){return n.showDialog($(f),r,e)})).then((function(){t._execute(n)}))})):this._execute(n)},o.prototype.getCommandContext=function(){return this._currentContext},o.prototype._getFormTarget=function(){return this._currentContext&&this._currentContext.getFormTarget()},o.prototype._target=function(){return this._currentContext&&this._currentContext.target},o.prototype._getCommandReference=function(n){var t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference,i=null;return t&&t.commands&&n.name&&(i=t.commands.first((function(t){return t.name===n.name}))),i},o.prototype._execute=function(n){var i=this,u=this._currentContext.compositionInstance,r;if(!this._extensionCommand){this._loadViewModel();return}r=u&&u.widget;r&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),l.ensureFormFieldValidation(r.element).then((function(r){t.prototype.execute.call(i,n);i._extensionCommand.execute(n,r)})).finally((function(){i._clearEnabledPropertyOverride()}))):(t.prototype.execute.call(this,n),this._extensionCommand.execute(n))},o.prototype.dispose=function(){var r=this,n=this._viewModelLoadedPromise,i=function(){t.prototype.dispose.call(r)};n&&(n.done(i),this._viewModelLoadedPromise=null);i()},o.prototype.setEnabled=function(n){this._extensionEnabledProperty=n;this._overrideEnabledProperty||this.enabled(n)},o.prototype.getViewModel=function(){var n=this._extensionCommand;return n&&n.viewModel},o.prototype.getViewModelAsync=function(){return this._loadViewModel(),this._viewModelLoadedPromise},u.defineProperty(o.prototype,"canRebind",{get:function(){var n=this._getContentViewModel(),t=n&&e.unwrap(n.status);return t!==1},enumerable:!0,configurable:!0}),o.prototype._getContentViewModel=function(){var n=this.getViewModel();return n&&n.content()},o.prototype._overrideEnabledPropertyWith=function(n){this._overrideEnabledProperty=!0;this.enabled(n)},o.prototype._clearEnabledPropertyOverride=function(){this._overrideEnabledProperty&&(this._overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))},o.prototype._resolveCommandDefinition=function(){var n=this,r,t=this._commandDefinition,u,f;return t.reference?(u=ut.forExtension(t.reference.extension||this._extension.name),f=u.withCommandType(t.reference.commandType),this.icon(et.Loading.EllipsisSquare()),this.text(st.loading),r=this.services.finder.locateAsync(f).then((function(r){n._extension=n.services.finder.locate(u,n._extension.name);var f=n.getInputBindingsFromDefinition(t);n._commandDefinition=i.extend2(r,{name:t.name});f.length>0&&(n._commandDefinition.bindings=f);n.text(r.text)}))):r=Q(),r},o.prototype._logError=function(t){r.Rpc.client.log(this._extension.name,{level:2,code:0,area:n.normalize("."),message:i.getLogFriendlyMessage(t)+" \nCommand name: "+this._commandDefinition.name+" \nView model name: "+this._commandDefinition.viewModel})},o.prototype._createExtensionCommandHandler=function(n){var e=this,o=this._ltm,u;if(!o.isDisposed()){var h=n.content,t=o.createChildLifetime(),f={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,propertyBindings:null,services:this._services,selectionInList:this._selectionInList},s=new lt(t,n,f);s.init();f.propertyBindings=s.propertyBindings;u=this._extensionCommand=k.createExtensionCommand(t,h(),n,f);u?(t.registerForDispose([u]),u.init()):this._logError(r.createError("Error loading command view model. Unknown view model type."));n.container.unauthorizedMessage.subscribeAndRun(t,(function(t){e.unauthorized(!i.isNullOrUndefined(t));e.tooltip(t||n.content().tooltip&&n.content().tooltip())}))}},o.prototype._loadViewModel=function(){var n=this,t;if(!this._viewModelLoadedPromise){if(t=this._ltm,!t)return;this._viewModelLoadedPromise=this._resolveCommandDefinition().then((function(){if(t=n._ltm,t){var u=n._extension,i=n._commandDefinition,r=i.commandKind===4;return(!i.commandKind||r)&&(n._widgetViewModel=ct(n._ltm,i,n._services.diContainer,n.container,r)),u.getViewModel(i.viewModelLocator||i.viewModel,7,{createSelectable:!0})}}));this._viewModelLoadedPromise.then((function(i){(t=n._ltm,t)&&(i.content().lc2&&(n._widgetViewModel=ct(t,n._commandDefinition,n._services.diContainer,n.container,!0)),n._createExtensionCommandHandler(i))})).catch((function(t){var u=i.getLogFriendlyMessage(t);n.icon(et.Blank());n.text(st.failedToLoad);n._logError(r.createError("Error loading command view model.\nReason: {0}".format(u)))}))}},o})(tt);t.ExtensionCommandMenuItemImpl=it;lt=(function(){function n(n,t,i){var u=this,r;this._onInputsSetPending=e.observable(!1);this._hasPermissions=e.observable(!0);this._extension=i.extension;this._viewModelName=i.viewModelName;this._composedViewModel=t;this._commandViewModel=t.content();this._commandItem=i.commandItem;this._services=i.services;r=this._ltm=n.createChildLifetime();this._initializeInputBindings(i.container,i.commandItem);r.registerForDispose((function(){u._commandViewModel=null}))}return n.prototype.init=function(){var n=this._commandViewModel,t=this._commandItem;e.isObservable(n.icon)&&n.icon.subscribeAndRun(this._ltm,t.icon);e.isObservable(n.text)&&n.text.subscribeAndRun(this._ltm,(function(n){return n!==undefined&&t.text(n)}));e.isObservable(n.ariaLabel)&&n.ariaLabel.subscribeAndRun(this._ltm,t.ariaLabel);e.isObservable(n.tooltip)&&n.tooltip.subscribeAndRun(this._ltm,t.tooltip);e.computed(this._ltm,[n.enabled,this._hasPermissions,this._onInputsSetPending,],(function(n,i,r){return t.setEnabled(n&&i&&!r)}))},u.defineProperty(n.prototype,"propertyBindings",{get:function(){return this._propertyBindings},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._initializeInputBindings=function(n,t){var i=this,o=this._ltm,s,r,h,u;o&&(s=t.getInputBindingsFromDefinition(t.commandDefinition),r={bindableTarget:{viewModelName:n.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:s,referenceComposition:n,referenceCompositionIsContainer:!0,customBindHandler:function(n){var i=t.sourceBindableContainer;if(i&&i.viewModel&&n.source.modelType!==0)return{sourceModelName:i.viewModelName,sourceModel:i.viewModel}},beforeViewModelPropertyUpdate:function(r){var u=t.commandDefinition,f;return u&&u.permissions?(i._hasPermissions(!1),f=n&&n.locator&&n.locator.toString()+"-",f=(f||"")+u.name,p.checkPermissions(u.permissions,pt.All,r,u.assetType,i._extension.name,i._services,f).then((function(n){return i._updateForHasPermissions(n),n}))):(i._updateForHasPermissions(!0),Q(!0))}},r.inputs&&f.isArray(r.inputs)&&r.inputs.length>0&&(this._onInputsSetPending(!0),r.inputsSetCalled=function(r,u){i._onInputsSetPending(!0);i._currentOnInputsSetPromise=u;u.then((function(){i._currentOnInputsSetPromise===u&&i._onInputsSetPending(!1)}),(function(u){ot.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise.\nView Model Name: {2}\nInputs Provided: {3}\nReason: {4}".format(t.commandName,n.toString(),i._viewModelName,e.toJSON(r),u||"N/A"))}))}),h=kt.bindViewModelInputs(r),u=this._propertyBindings=h.propertyBindings,o.registerForDispose((function(){u&&(u.unbind(),i._propertyBindings=null)})))},n.prototype._updateForHasPermissions=function(n){var t=this._composedViewModel&&this._composedViewModel.container;t&&(n?t.unauthorizedMessage(undefined):t.unauthorized());this._hasPermissions(n)},n})();t.createOpenBladeCommand=ii;t.createOpenLinkCommand=ri}));
define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","i","o","$","FxInternal/Di","MsPortalImpl/AsyncLoader","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function p(n){var r,i,t;if((d?n.metaKey:n.ctrlKey)||(r=b.getSelection(),r.rangeCount&&!r.getRangeAt(0).collapsed)||(i=u(n.target),i.filter("input,textarea").length)||i.add(u(n.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;n.preventDefault();n.stopPropagation();t=u.Event(a.default.fxcontextmenurequest);t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;i.trigger(t)}var v;r.defineProperty(t,"__esModule",{value:!0});var w=i.TriggerableLifetimeManager,b=window,k="fxs-commands-contextMenu",d=navigator.platform.indexOf("Mac")!==-1,y=(function(){function n(){}return n.create=function(n){return n.getAsync(e.get("MsPortalImpl/UI/UI.PortalFormTarget","PortalFormTarget"))},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f.Container]),__metadata("design:returntype",r)],y,"create",null);t.AsyncPortalFormTarget=y;t.onContextMenu=p;v=(function(){function n(n,t,i,r){this._desktopManagerMode=n;this._previouslyFocusedElement=t;this._portalWidget=i;this._diContainer=r;this._ltm=new w;this._body=u.querySelectorAll("body");this._initializeContextMenu()}return n.prototype.dispose=function(){this.stopListeningForEvents();this._ltm.dispose()},n.prototype.startListeningForEvents=function(){var u=this,n=this._body;n.on(a.default.fxcontextmenu,this._fxMenuEventHandler=function(n,t){u._showContextMenu(n,t)}).on(a.default.contextmenu,this._browserMenuEventHandler=function(n){p(n)});var t=this._contextMenuElement,i=this._portalWidget,r=i&&i.element;return r?r.append(t):n.append(t),this},n.prototype.stopListeningForEvents=function(){var n=this._body;this._fxMenuEventHandler&&(n.off(a.default.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(a.default.contextmenu,this._browserMenuEventHandler),this._browserMenuEventHandler=null);this._contextMenu.hide();this._contextMenuElement.detach()},n.prototype.getFormTarget=function(){return this._diContainer.getAsync(y)},n.prototype._initializeContextMenu=function(){this._contextMenuElement=u(i.createElement("div",{"class":k}));this._contextMenu=new c.Widget(this._contextMenuElement);this._contextMenu.hide()},n.prototype._showContextMenu=function(n,t){var y=this,h=t.contextMenu?t.contextMenu:this._contextMenu,v=h.options.menuItems,r,f,p,c=n.clientX,l=n.clientY,a,i,e;if(t.commands&&t.commands.length!==0){if(t.srcElement){for(a=t.srcElement,i=a,u(a).hasClass("fxs-tile")&&(i=u(a).find(".fxs-part")[0]);i&&typeof i.focus!="function";)i=u(i).closest("[tabindex]")[0];this._previouslyFocusedElement.value(i)}p=t.formTarget&&t.formTarget.length>0?function(){return Q(o.getBladeContentWidget(t.formTarget))}:function(){return y.getFormTarget()};h.hide();v.splice(0,v().length);do f=f?f.parentNode:n.target,r=u(f).data(s.CompositionInstanceDataName);while(!r&&f.parentNode);(s.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((function(t){y._shouldShowCommand(t)&&(t.activate(),t.bind(new o.CompositionInstanceCommandContext(n.target,p,r)),v.push(t))})),h.options.hasVisibleCommands())&&(c||l||(e=n.target.getClientRects()[0],c=e&&e.left||c,l=e&&e.bottom||l),h.show(c,l,t&&t.forceLeft))}},n.prototype._shouldShowCommand=function(n){return this._desktopManagerMode.value()!==1||!this._isExtensionCommand(n)},n.prototype._isExtensionCommand=function(n){return!!n._extension},n})();v=__decorate([f.Class(),__metadata("design:paramtypes",[h.DesktopManagerMode,h.PreviouslyFocusedElement,l.Widget,f.Container])],v);t.PortalCommandManager=v}));
define("MsPortalImpl/UI/Dashboard/Common/DashboardHelperContainer",["require","exports","f","o","Fx/ResourceManagement","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ArmIdHelpers"],(function(n,t,i,r,u,f,e,o){"use strict";function k(n){var t=u.ArmId.parse(n);return o.isResourceAtAnyLevel(t)?t:null}function v(n){return{id:n.id,title:n.title}}function d(n){return s.NotFound.defaultMessageFormat.format(n.title)}function y(n,t){return""+n+i.trimStart(t,"/")}function p(n){var t=i.getUniqueId();return""+n+t}function w(n,t){return i.startsWith(t,n)}function g(n){var e=n.tags&&n.tags[t.dashboardTitleTagKey]||n.name,r=n.properties,u=r&&r.metadata,o=u&&u.model||{},f=r&&r.lenses||{},s=f["0"]&&f["0"].parts||{};return{title:e,model:o,parts:i.forEachKey(s,(function(n,t,i){return i.push(t)}),[])}}var s,h,c,l,a,b;r.defineProperty(t,"__esModule",{value:!0});s=e.Dashboard;t.getDashboardProperties=v;t.getNotFoundMessage=d;h=(function(){function n(){this._idPrefix="arm/"}return n.prototype.getArmDashboardId=function(n){var t=n.substr(this._idPrefix.length);return i.ensurePrefix(t,"/")},n.prototype.getDashboardProperties=function(n){var t=n.id,u=n.title,i=this.getArmDashboardId(t),r=k(i)||{subscription:"",resourceGroup:""};return{id:t,title:u,originalId:i,subscription:r.subscription,resourceGroup:r.resourceGroup}},n.prototype.getNotFoundMessage=function(n){var r=n.id,i=n.title,u=this.getArmDashboardId(r),t=k(u);return t?s.NotFound.armMessageFormat.format(i,t.resourceGroup,t.subscription):s.NotFound.defaultMessageFormat.format(i)},n.prototype.filterDashboards=function(n,t){var i=this;return(t&&t.length)?n.filter((function(n){if(!i.isOfType(n.id))return!0;var u=i.getArmDashboardId(n.id),r=k(u);return r?t.indexOf(r.subscription)>-1:!1})):n},n.prototype.buildDashboardId=function(n){return y(this._idPrefix,n)},n.prototype.newId=function(){return p(this._idPrefix)},n.prototype.isOfType=function(n){return w(this._idPrefix,n)},n})();h=__decorate([f.Class()],h);t.ArmHelper=h;c=(function(){function n(){this._idPrefix="private/";this.getDashboardProperties=v}return n.prototype.getNotFoundMessage=function(n){return s.NotFound.privateMessageFormat.format(n.title)},n.prototype.buildDashboardId=function(n){return y(this._idPrefix,n)},n.prototype.newId=function(){return p(this._idPrefix)},n.prototype.isOfType=function(n){return w(this._idPrefix,n)},n})();c=__decorate([f.Class()],c);t.PrivateHelper=c;l=(function(){function n(){this._idPrefix="session/";this.getDashboardProperties=v;this.getNotFoundMessage=d}return n.prototype.buildDashboardId=function(n){return y(this._idPrefix,n)},n.prototype.newId=function(){return p(this._idPrefix)},n.prototype.isOfType=function(n){return w(this._idPrefix,n)},n})();l=__decorate([f.Class()],l);t.SessionHelper=l;a=(function(){function n(){this._idPrefix="recommended/";this.getDashboardProperties=v;this.getNotFoundMessage=d}return n.prototype.parseDashboardId=function(n){var t=n.substr(this._idPrefix.length).split("/");return{dashboardParam:t.slice(1).join("/"),extensionName:t[0]}},n.prototype.buildDashboardId=function(n){return y(this._idPrefix,n)},n.prototype.newId=function(){return p(this._idPrefix)},n.prototype.isOfType=function(n){return w(this._idPrefix,n)},n})();a=__decorate([f.Class()],a);t.RecommendedHelper=a;b=(function(){function n(n,t,r,u){var f=new i.Map;f.set(1,n);f.set(2,t);f.set(3,u);f.set(4,r);this._enumList=[1,2,3,4,];this.helperMap=f}return n.prototype.FindOwningRepoKey=function(n){for(var i,r,t=0;t<this._enumList.length;t++)if(i=this._enumList[t],r=this.helperMap.get(i),r&&r.isOfType(n))return i;return null},n})();b=__decorate([f.Class(),__metadata("design:paramtypes",[h,c,l,a])],b);t.DashboardHelperContainer=b;t.dashboardTitleTagKey="hidden-title";t.normalizedDashboard=g}));
define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Dashboard/Common/DashboardHelperContainer","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";function st(n){return b.Widget.getWidget(n.closest(".fxs-tile"),k.Widget)}function gi(n,t){return ht||(ht=[{size:0,text:nt.partSizeMini},{size:1,text:nt.partSizeSmall},{size:2,text:nt.partSizeNormal},{size:3,text:nt.partSizeWide},{size:4,text:nt.partSizeTall},{size:10,text:nt.partSizeLarge},{size:5,text:nt.partSizeHeroWide},{size:6,text:nt.partSizeHeroTall},{size:11,text:nt.partSizeHero},],ht.forEach((function(n){n.icon=ft.Mini({customClass:"msportalfx-contextmenu-grid-"+at.InternalPartSize[n.size].toLowerCase()})}))),ht.map((function(i){return new ct(n,i.text,i.size,i.icon,t)}))}var it,pt,wt,bt,kt,dt,ct,ht,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi;r.defineProperty(t,"__esModule",{value:!0});var lt=i.Base,pi=lt.Diagnostics.Telemetry,ut=lt.Images,ft=ut.Shell,at=i.Parts,vt=i.ViewModels,wi=vt.FileDownload,bi=vt.Controls.FileDownloadButton,ki=i.ViewModels.Dialogs,di=l.CompositionInstanceCommandContext,rt=i.tryImmediateResolve,et=i.require,nt=s.ShellCommands,tt="MsPortalImpl.UI.Commands.",ot=1,yt=ut.Blank();t.CommandNames={BladeDisplayState:tt+"BladeDisplayState",CloneDashboard:tt+"CloneDashboard",CustomizeTileData:tt+"CustomizeTileData",DeleteDashboard:tt+"DeleteDashboard",DeleteListItem:tt+"DeleteListItem",DownloadDashboard:tt+"DownloadDashboard",EnterOrganizeMode:tt+"EnterOrganizeMode",ExitOrganizeMode:tt+"ExitOrganizeMode",FilterDashboard:tt+"FilterDashboard",FullscreenDashboard:tt+"FullscreenDashboard",NewDashboard:tt+"NewDashboard",OpenBrowseDashboardsPane:tt+"OpenBrowseDashboardsPane",PartSize:tt+"PartSize",PinBlade:tt+"PinBlade",PinListItem:tt+"PinListItem",PinToStartboard:tt+"PinToStartboard",ResetLayout:tt+"ResetLayout",ResetStartBoard:tt+"ResetStartBoard",ShareDashboard:tt+"ShareDashboard",UnpinFromStartboard:tt+"UnpinFromStartboard",UploadDashboard:tt+"UploadDashboard"};it=(function(n){function t(t,i,r,u){var f=n.call(this,t,r,u)||this;return f._services=i,f.isShellCommand=!0,f}return __extends(t,n),t.prototype.bind=function(t){var i=this;t.getFormTarget||(t.getFormTarget=function(){return i._services.diContainer.getAsync(a.AsyncPortalFormTarget)});n.prototype.bind.call(this,t)},t.prototype.execute=function(t){n.prototype.execute.call(this,t);var i=this._services&&this._services.desktop.getActiveJourney();pi.trace({source:l.getCommandSourceTelemetryName(this._currentContext),action:c.Action.CommandExecuted,name:this.commandName,data:{fromContextMenu:t,desktopMode:this._getDesktopMode()},journeyId:i&&i.id})},t.prototype.createAction=function(n){var i=this,t=new d.TileActionViewModel;return t.command=this,t.bindCommand=function(){var t=n.widget;t?i.bind(new di(t.element[0],null,n)):i.enabled(!1)},this._setActionClassName(t),t},t.prototype._getComposition=function(){return this._currentContext.compositionInstance},t.prototype._getDesktopMode=function(){return this._services?this._services.diContainer.get(w.DesktopManagerMode).value():null},t.prototype._setActionClassName=function(n){var t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t;n.className=this._actionClassName},t.prototype._getActionClassIdentifier=function(){throw new Error("Not implemented.");},t})(h.CommandImpl);t.ShellCommand=it;pt=(function(n){function t(t,i){var r=n.call(this,t,null,i.text)||this;return r._command=i,r}return __extends(t,n),t.prototype.execute=function(t){this._command.handler().execute();n.prototype.execute.call(this,t)},t})(it);t.ControlCommand=pt;wt=(function(n){function i(i,r){var u=n.call(this,i,r,nt.unpinFromStartboard,!0)||this;return u.commandName=t.CommandNames.UnpinFromStartboard,u.icon(ut.Delete({isLogo:!0})),u}return __extends(i,n),i.prototype.execute=function(t){var i=st(f(this._currentContext.target));i&&i.trigger(g.default.fxunpin,null,{tileId:i.options.id});n.prototype.execute.call(this,t)},i.prototype._getActionClassIdentifier=function(){return"unpinfromstartboard"},i})(it);t.UnpinFromStartboard=wt;bt=(function(n){function i(i,r){var u=n.call(this,i,r,nt.customizeTileData,!0)||this;return u.commandName=t.CommandNames.CustomizeTileData,u.icon(ut.GearAlternate({isLogo:!0})),u}return __extends(i,n),i.prototype.execute=function(){var n=this._getComposition();n.openPartSettingsBlade()},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()!==ot)},i.prototype._getActionClassIdentifier=function(){return"customizetiledata"},i})(it);t.CustomizeTileData=bt;kt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r,!0)||this;return u.icon(ut.Ellipsis({isLogo:!0})),u}return __extends(t,n),t.prototype.bind=function(t){var e=this,i,r;n.prototype.bind.call(this,t);i=this._partWidget=st(f(t.target));r=i.options.commands.filter((function(n){return n.bind(t),n.visible()&&n.enabled()}));this.enabled(r.length>0);u.computed(this._ltm,(function(){var n=i.actionBarWidget&&i.actionBarWidget.contextMenuWidget.options.visible(),t=i.element.findByClassName(e._actionClassName);t.toggleClass("fxs-tile-actionbar-action-pressed",n)}))},t.prototype.execute=function(t){var i=this._partWidget,r=i.element,u=f.Event(g.default.fxcontextmenu),e=r.offset();u.clientX=e.left+r.outerWidth(!1);u.clientY=e.top;r.trigger(u,{commands:i.options.commands,contextMenu:i.actionBarWidget.contextMenuWidget});n.prototype.execute.call(this,t)},t.prototype._getActionClassIdentifier=function(){return"opencontextmenu"},t})(it);t.OpenContextMenu=kt;dt=(function(n){function i(i,r){var u=n.call(this,i,r,nt.pinToStartboard,!1)||this;return u.commandName=t.CommandNames.PinToStartboard,u.icon(ut.Pin()),u}return __extends(i,n),i.prototype.bind=function(t){var e,i,r;if(n.prototype.bind.call(this,t),e=!1,this.baseInstance=this._getComposition(),e=this.baseInstance.allInputsSet(),i=st(f(t.target)),r=!1,i){var h=v.isVariableSize(i.options.size()),s=u.unwrap(i.options.supportedSizes),o=void 0,c=i.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0;c?r=!1:h?(o=s&&s.first((function(n){return v.isFixedSize(n)})),o!==null&&o>=0&&(r=!0)):r=!0}this.enabled(r&&e)},i.prototype.execute=function(t){var i=this;rt(et("MsPortalImpl/UI/UI.Desktop.Actions"),(function(n){return Q(n.pinPartToStartboard(i.baseInstance,i._services))})).finally((function(){n.prototype.execute.call(i,t)}))},i.prototype._getActionClassIdentifier=function(){return"pintostartboard"},i})(it);t.PinToStartboard=dt;ct=(function(n){function i(i,r,u,f,e){var o=n.call(this,i,e,r,!0)||this;return o.commandName=t.CommandNames.PartSize+at.InternalPartSize[u],o._sizeTarget=u,o.icon(f),o}return __extends(i,n),i.prototype.execute=function(t){var i=st(f(this._currentContext.target)),r;i&&(r=v.AllSizes[this._sizeTarget],i.element.trigger(g.default.fxsizechange,[i.options.id,r.size.width,r.size.height]),Q.fcall((function(){i.setFocus()})));n.prototype.execute.call(this,t)},i.prototype.bind=function(t){var i=st(f(t.target)),r=i&&i.options;if(!i||this._sizeTarget===r.size()||v.isVariableSize(r.size())||this._getDesktopMode()!==ot){this.enabled(!1);return}this.enabled(r.supportedSizes().indexOf(this._sizeTarget)!==-1);n.prototype.bind.call(this,t)},i})(it);t.PartSizeCommand=ct;t.CreatePartSizeCommandCollection=gi;gt=(function(n){function i(i,r){var u=n.call(this,i,r,nt.resetLayout,!0)||this;return u.commandName=t.CommandNames.ResetStartBoard,u.icon(yt),u}return __extends(i,n),i.prototype.execute=function(t){this._services.desktop.startBoard.resetLayout();n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===ot)},i})(it);t.ResetStartBoardCommand=gt;ni=(function(n){function i(i,r,f){var e=n.call(this,i,r,nt.enterOrganizeMode,!0)||this;return e.commandName=t.CommandNames.EnterOrganizeMode,e.icon(ut.Edit()),e._expandTileGallery=!!f,u.reactor(e._ltm,(function(){var n=r.diContainer.get(w.DesktopManagerMode).value()!==ot,t=!r.diContainer.get(y.LeftContextPane).opened();e.enabled(n&&t)})),e}return __extends(i,n),i.prototype.execute=function(t){var i=this._getComposition();i&&i.widget?i.widget.element.trigger(g.default.fxenterorganizemode,{trigger:1,expandTileGallery:this._expandTileGallery}):this._services.diContainer.get(w.DesktopManagerMode).value(ot);n.prototype.execute.call(this,t)},i})(it);t.EnterOrganizeMode=ni;ti=(function(n){function i(i,r){var u=n.call(this,i,r,nt.exitOrganizeMode,!0)||this;return u.commandName=t.CommandNames.ExitOrganizeMode,u.icon(yt),u}return __extends(i,n),i.prototype.execute=function(t){this._services.desktop.portalWidget.trigger(g.default.fxexitorganizemode);n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===ot)},i})(it);t.ExitOrganizeMode=ti;ii=(function(n){function i(i,r){var u=n.call(this,i,r,nt.shareDashboard,!0)||this;return u.commandName=t.CommandNames.ShareDashboard,u.icon(ft.Share()),u}return __extends(i,n),i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(!this._services.diContainer.get(y.RightContextPane).opened.peek())},i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;rt(et("MsPortalImpl/Widgets/Widgets.ShareDashboardPane"),(function(n){var u=i.diContainer.get(y.RightContextPane),t=r._ltm.createChildLifetime();u.tryOpen(new n.ShareDashboardPane(t,i)).then((function(n){n?u.contentLifetime.registerForDispose(t):t.dispose()})).catch((function(n){return t.dispose(),Q.reject(n)}))}))},i})(it);t.ShareDashboard=ii;ui=(function(n){function i(i,r){var u=n.call(this,i,r,nt.deleteDashboard,!0)||this;return u.commandName=t.CommandNames.DeleteDashboard,u.icon(ri||(ri=ft.TrashOutline())),u}return __extends(i,n),i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;i.desktop.getDashboardManager().then((function(n){var t=n.isCurrentDashboardShared(),u=i.desktop.startBoard.notFound()?Q(!0):n.isCurrentDashboardWritable();u.then((function(u){Q.all([i.diContainer.getAsync(p.DialogManager),r._currentContext.getFormTarget()]).spread((function(i,f){var e=new ki.MessageBox(nt.deleteDashboard,u?nt.deleteDashboardConfirm:nt.noPermissionToDeleteDashboard,u?2:1),o;e.confirmationRequired=u&&t;e.confirmationMessage=nt.deleteDashboardConfirmation;o=r._currentContext;i.showShellDialog(e,f,o.target).then((function(t){u&&t===4&&n.deleteCurrentDashboard(1)}))}))}))}))},i})(it);t.DeleteDashboard=ui;ei=(function(n){function i(i,r){var u=n.call(this,i,r,nt.newDashboard,!0)||this;return u.commandName=t.CommandNames.NewDashboard,u.icon(fi||(fi=ft.Add())),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);rt(this._services.desktop.getDashboardManager(),(function(n){n.startNewDashboard()}))},i})(it);t.NewDashboard=ei;si=(function(n){function i(i,r){var u=n.call(this,i,r,nt.cloneDashboard,!0)||this;return u.commandName=t.CommandNames.CloneDashboard,u.icon(oi||(oi=ut.Clone())),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);rt(this._services.desktop.getDashboardManager(),(function(n){n.cloneCurrentDashboard()}))},i})(it);t.CloneDashboard=si;ci=(function(n){function i(i,r,u){var f=n.call(this,i,r,nt.filterDashboard,!0)||this;return f.commandName=t.CommandNames.FilterDashboard,f._startboard=u,f.icon(hi||(hi=ft.Filter())),f}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);var i=this._services,r=this._startboard;rt(et("MsPortalImpl/Widgets/Widgets.FilterPane"),(function(n){var t=n.FilterPane.getSingleton(i.diContainer.get(y.RightContextPane),r);t.open()}))},i})(it);t.FilterDashboard=ci;li=(function(n){function i(i,r){var u=n.call(this,i,r,nt.fullscreenDashboard,!0)||this;return u.commandName=t.CommandNames.FullscreenDashboard,u.icon(ft.Fullscreen()),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);e.isFullscreen()?e.exitFullscreen():e.requestFullscreen()},i})(it);t.FullscreenDashboard=li;ai=(function(n){function i(i,r){var u=n.call(this,i,r,"",!0)||this;return u.commandName=t.CommandNames.OpenBrowseDashboardsPane,u}return __extends(i,n),i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;rt(et("MsPortalImpl/UI/Dashboard/BrowseDashboardsPane"),(function(n){return rt(i.desktop.getDashboardManager(),(function(t){var u=i.diContainer.get(y.RightContextPane),f=u.getContent(),e;if(f instanceof n.BrowseDashboardsPane){u.tryOpen(f);return}e=new n.BrowseDashboardsPane(t,{defaultDashboardType:r._dashboardType,dashboardTypeChanged:function(n){return r._dashboardType=n}});u.tryOpen(e)}))}))},i})(it);t.OpenBrowseDashboardsPane=ai;vi=(function(n){function r(i,r){var f=n.call(this,i,r,nt.uploadDashboard,!0)||this;return f._fileUploaderMap={},f._fileUploadModel={uploadContext:u.observable("")},f.commandName=t.CommandNames.UploadDashboard,f.fileInputOptions(new h.FileInputOptions(".json",1)),f}return __extends(r,n),r.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);this._fileUpload?this._execute(t):rt(et("MsPortalImpl/Services/Services.FileUpload"),(function(n){i._fileUpload=n;i._execute(t)}))},r.prototype._execute=function(){var f=this,t=this.fileInputOptions().files(),n,r,u;t&&t.length>0&&(n=t[0],r=new this._fileUpload.FileUploader(this._ltm,this._fileUploaderMap,n,this._fileUploadModel),this._fileUploaderMap[n.name]=r,[].push(r.uploadTask),u=new this._fileUpload.FileReaderHelper(n),u.readNextChunk().then((function(t){var r=new FileReader;r.onload=function(t){try{var r=o.normalizedDashboard(JSON.parse(t.target.result));f._services.desktop.getDashboardManager().then((function(t){r.title=r.title||n.name.replace(/\.json$/i,"");t.importDashboard(r)}))}catch(u){i.Hubs.Notifications.ClientNotification.publish({title:nt.uploadErrorTitle,description:nt.uploadErrorDescription,status:i.Hubs.Notifications.NotificationStatus.Error})}};r.readAsText(new Blob([t.content],{type:"application/octet-stream"}))})))},r})(it);t.UploadDashboard=vi;yi=(function(n){function i(i,r){var u=n.call(this,i,r,nt.downloadDashboard,!0)||this;return u.commandName=t.CommandNames.DownloadDashboard,u}return __extends(i,n),i.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);rt(et("MsPortalImpl/Commands/Commands.FileDownloadCommand"),(function(n){i._services.desktop.getDashboardManager().then((function(t){t.getArmDashboardJson().then((function(t){t.location.localeCompareIgnoreCase("INSERT LOCATION")===0&&delete t.id;var f=new wi.Context({targetUri:u.observable("data:,"+encodeURIComponent(JSON.stringify(t,null,2))),targetFileName:u.observable(t.tags["hidden-title"]+".json"),addDefaultAuthorizationToken:!1}),r=new bi.ViewModel(i._ltm,{context:u.observable(f),disabled:u.observable(!1)});i._instance=new n.FileDownloadCommand(r.context(),i._services.diContainer);i._instance.execute(r.context())}))}))}))},i})(it);t.DownloadDashboard=yi}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","f","i","o","ko","$","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function v(n,t,r){r=r||i.getUniqueId();var u=d[n];return u+=!t?"":"-"+t.name,u+("-"+r)}function g(n,t,r,u){return i.tryImmediateResolve(i.require(t,u),(function(t){if(!n||!n.isDisposed())try{return r(t)}catch(i){return Q.reject(i)}}))}function p(n,t){for(var i=n,r;i;)(i.hasOwnProperty(t)||typeof i[t]=="function")&&(r=i),i=i.parent;return r||l.error("Could not locate container with property or function '"+t+"' for composition '"+n+"'."),r}function nt(n){return r.isSerializedObject(n)?r.fromSerializableObject(n):{}}var y;u.defineProperty(t,"__esModule",{value:!0});var w=r.TriggerableLifetimeManager,b=i.Base,k=b.Diagnostics,d=o.CompositionType,l=k.createLog(n),a=o.getIdMatchFunc;t.createIdentifier=v;t.compositionRequire=g;y=(function(n){function t(t,i,r,u,o,s){var h=n.call(this)||this;if(h._childObjects=f.observableArray(),h._disposeCallbacks=e.Callbacks("memory once"),h._composedDeferred=Q.defer(),!i)throw new Error("CompositionServices are required.");return h.services=i,h.locator=r,h.id=s||h.createIdentifier(),h.widgetState=f.observable(o||{}),h._addChildrenInternal(u),h._toStringPrefix="{ Name: "+(t||"<NOT SPECIFIED>")+", Type: ",h}return __extends(t,n),u.defineProperty(t.prototype,"children",{get:function(){return this._childObjects()},enumerable:!0,configurable:!0}),t.prototype.subscribeChildren=function(n){return this._childObjects.subscribe(this,n)},u.defineProperty(t.prototype,"templateKey",{get:function(){return""+(this.locator||this.id)},enumerable:!0,configurable:!0}),t.prototype.getPerfData=function(){return{}},t.prototype.getCompositionType=function(){throw new Error("The getCompositionType method is not implemented.");},t.prototype.getCreationState=function(){return this._creationState},t.prototype.toString=function(){var n=this._toStringPrefix,t=this._toStringPostfix||(this._toStringPostfix=", Id: "+this.id+" }");return n+=this.locator||"<null>",n+t},t.prototype.compose=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];this._compose.apply(this,[n,this._composedDeferred].concat(i))},t.prototype._compose=function(){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];throw new Error("Not implemented.");},t.prototype.resetLayout=function(){var n=this.children;n&&n.forEach((function(n){n.resetLayout()}))},t.prototype._attachWidgetErrorEvent=function(){var n=this;if(!this.widget)throw new Error("Cannot attach to error event of undefined widget.");this.registerForDispose(e(this.widget).setEvents([s.Widget.errorEvent,function(t,i){l.error("[Widget Error] {0}\nCurent State: {1}".format(i,f.toJSON(n.getDiagnosticsData(),null,2)))}]))},t.prototype.dispose=function(t){this.isDisposed()||(n.prototype.dispose.call(this),this._disposeCallbacks.fire(),t||this._deleteSetting(),this.children.slice(0).forEach((function(n){n.dispose(t)})))},t.prototype._deleteSetting=function(){if(this._store!==undefined)this.services.sharedSettings.deleteSettings({store:this._store,keys:[this.id]});else if(this.parent){var n=this.parent.children,t=n.first(a(this.id));t&&n.remove(t);this.parent.save()}},t.prototype.save=function(n){var t,i;this._store!==undefined?(t=this.services.diContainer.get(h.SettingsManager),t&&(i=this.toJSON(),t.setSetting(this._store,this.id,JSON.parse(JSON.stringify(i))),n===1&&t.flushSettings())):this.parent&&this.parent.save(n)},u.defineProperty(t.prototype,"isComposed",{get:function(){return this.awaitComposed().isFulfilled()},enumerable:!0,configurable:!0}),t.prototype.getLoadDelayed=function(){return this._loadDelayed},t.prototype.await=function(n){switch(n){case 0:return Q(!1);case 3:return Q(null)}throw new i.Errors.Error("Await reason not supported");},t.prototype.awaitComposed=function(){return this._composedDeferred.promise},t.prototype.onDispose=function(n){this._disposeCallbacks.add(n)},t.prototype.offDispose=function(n){this._disposeCallbacks.remove(n)},t.prototype.addChild=function(n,t,i){i===void 0&&(i=!0);n&&this.addChildren([n],t,i)},t.prototype.addChildren=function(n,t,i){i===void 0&&(i=!0);this._addChildrenInternal(n,t);i&&this.save()},t.prototype._addChildrenInternal=function(n,t){var r=this,i;t===void 0&&(t=this.children.length);n&&n.length>0&&(i=this._childObjects(),n.forEach((function(n){i.splice(t,0,n);n.parent=r;t++;r.addChildWidget(n.widget)})),this._childObjects(i))},t.prototype.sortChildren=function(n){this._childObjects(this._childObjects().stableSort(n))},t.prototype.removeChildren=function(n){for(var t=this.children.length-1;t>=0;t--)this.removeChildAt(t,n,!1);this.save()},t.prototype.removeChildAt=function(n,t,i){if(i===void 0&&(i=!0),n>=0){var r=this._childObjects.splice(n,1)[0];this.removeChildWidget(r.id,t);t||r.dispose();i&&this.save()}},t.prototype.replaceChild=function(n,t){var i=this._childObjects,r;n&&t&&i&&(r=i.indexOf(n),r>=0&&(i.splice(r,1,t),t.parent=this,this.save()))},t.prototype.removeChild=function(n,t,i){if(i===void 0&&(i=!0),n&&this._childObjects){var r=this._childObjects.indexOf(n);this.removeChildAt(r,t,i)}},t.prototype.addChildWidget=function(n){this.widget&&n&&this.widget.addChild(n)},t.prototype.removeChildWidget=function(n,t){this.widget&&this.widget.removeChild(n,t)},t.prototype.getChildById=function(n){return this._childObjects?this._childObjects().first(a(n)):null},t.prototype.toJSON=function(n){var t={},i=this.children,r=n?i.filter(n):i;return this.id!==c.startBoardSettingsKey&&r.forEach((function(n){t[n.id]=n.toJSON()})),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:r.map((function(n){return n.id})),childSettings:t}},t.prototype.loadFromJson=function(n){this.unrecoverableErrorMessage=n.errorMessage},t.prototype.getPartsContainer=function(){return this._partsContainer||(this._partsContainer=p(this,"masterContainer")),this._partsContainer},t.prototype.getBindableContainer=function(){return this._bindableContainer||(this._bindableContainer=p(this,"getViewModel")),this._bindableContainer},t.prototype.getTemplate=function(){return{key:this.templateKey,locator:this.locator.toJSON(),widgetId:this.id,widgetState:f.toJS(this.widgetState),children:this.children.map((function(n){return n.getTemplate()}))}},t.prototype.getDiagnosticsData=function(){return e.extend(this.toJSON(),{id:this.id,name:this._name,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map((function(n){return n.getDiagnosticsData()}))})},t.prototype.definitionExists=function(n){var t=this.services.finder,i=this.locator;return t.tryLocate(i,{})?0:t.tryLocate(i.getExtensionLocator(),{})&&n?1:2},t.prototype.discardWidgetStateOfUnusedChildren=function(){if(this.widget){var n=this.widget.discardStateOfUnusedChildren();n&&n.stateDiscarded&&l.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".format(this,n.message,JSON.stringify((this.children||[]).map((function(n){return""+n}))),JSON.stringify(this.widgetState())))}},t.prototype._markAsComposed=function(){this._composedDeferred.resolve()},t.prototype.createIdentifier=function(){return v(this.getCompositionType(),this.locator)},t})(w);t.Instance=y;t.createContainerModel=nt}));
define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","f","a","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Commands/UI.ShellCommands"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function s(n,t,i,u,f){if(h(i,t,u),u){var e=c(n,t,f);r.prototype.push.apply(i,e)}}function h(n,i,r){n.filter((function(n){return i.getCompositionType()===t.StartboardPart&&r?n instanceof e.ShellCommand&&!(n instanceof e.CustomizeTileData):n instanceof e.ShellCommand})).forEach((function(t){n.remove(t);t.dispose()}))}function c(n,i,r){var u=[],o,f;return i.getCompositionType()===t.StartboardPart?(u.push(new e.EnterOrganizeMode(n,r)),u.push.apply(u,e.CreatePartSizeCommandCollection(n,r)),u.push(new e.UnpinFromStartboard(n,r),new e.ExitOrganizeMode(n,r))):(o=i.instanceDefinition,f=o&&o.reference,f&&f.extension==="HubsExtension"&&f.partTypeName==="MonitorChartPart"||u.push(new e.PinToStartboard(n,r))),u}function l(n,t){var i,r;return(n instanceof u.SelectableSet2?i=t:n._msPortalFxCreateSelectionAsync?(r=o.Deferred(),n._msPortalFxCreateSelectionAsync(t).then((function(n){r.resolve(n)}),(function(n){r.reject(n)})),i=r.promise()):i=n.createSelection(t),Q.isPromiseAlike(i))?i:o.Deferred().resolve(i).promise()}var t=f.CompositionType,o=i.Helpers;n.composeShellCommands=s;n.createSelection=l})(o||(o={})),o}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","f","i","o","ko","$","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function c(n,r,u){var e=""+t.partIdentityStatePrefix+n.toString(),s;return u&&(e+="-"+u),r&&(s=r.hasOwnProperty(o.PartContainerModelIdProperty)&&[o.PartContainerModelIdProperty],e+="-"+i.toSortedString(f.toJS(r),s)),e}function p(n){var t;try{t=JSON.parse(JSON.stringify(n))}catch(i){t=n}return t}function g(n){return n.some((function(n){var t=p(n.propertyValue),r=p(n.propertyOldValue);return!i.deepEquals(t,r)}))}var w;u.defineProperty(t,"__esModule",{value:!0});var b=i.Base,k=b.Diagnostics,l=o.CompositionType,a=s.PropertyBindings,v=k.createLog(n),y=u.keys(i.trace.partsettings||{}),d=y.length>0;t.partIdentityStatePrefix="[PartIdentityState]-";t.buildIdentitySettingKey=c;w=(function(){function t(){this._trace=!1}return t.prototype.configure=function(n){this._options=n;this._settingsStore=n.part.getCompositionType()===l.StartboardPart?13:2},t.prototype.configureInstanceProperties=function(n){this._options.instanceProperties=n},t.prototype.initialize=function(){var n=this;this.dispose();this._registerPartIdentityStateChangeHandler();this._registerPartSharedKeyChangeHandler();this._registerPartInstanceChangedHandler();d&&(this._trace=y.some((function(t){return n._options.partViewModelId.toLowerCase().indexOf(t)>=0})))},t.prototype.saveIdentityPartSettings=function(n,t){var f=this._options,e=f.part,o=f.services,s=o.sharedSettings,i=this.getKeyForIdentitySettings(n),u;e.getCompositionType()===l.StartboardPart&&(i=c(e.locator,n));i&&(this._identityState&&(u=r.toSerializableObject(this._identityState.targetModel),this._traceOperationWithSettings("Save identity part settings.",u,i),s.setSetting(t&&13||this._settingsStore,i,u)),this._options.part.notifySettingChanged())},t.prototype.clearIdentityPartSettings=function(){var t=this._options;if(t){var i=t.part,r=i.containerModel,n=[this.getKeyForIdentitySettings(r)];i.getCompositionType()===l.StartboardPart&&n.push(c(i.locator,r));n=n.filter((function(n){return!!n}));n.length>0&&t.services.sharedSettings.deleteSettings({store:this._settingsStore,keys:n})}},t.prototype.getPartSettingsAsync=function(){if(this._options.part.getCompositionType()===l.StartboardPart)return this.getStartboardPartIdentitySettings();var n=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Q.all([n,t]).spread((function(n,t){return e.extend(!0,{},n,t)}))},t.prototype.registerInstanceStateProperty=function(n,t,i){i===void 0&&(i=!0);var r=this._options.part,u=this._getOrCreateInstanceStatePropertyBindings(),f=u.targetModel,e=r.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,e,f,u,(function(){r.save()}),n);i&&r.save()},t.prototype.savePart=function(){var n=this._options;n&&n.part.save()},t.prototype.dispose=function(){var i=this._partInstanceState,n,t;i&&(i.unbind(),this._partInstanceState=null);n=this._identityState;n&&(n.unbind(),this._identityState=null);t=this._sharedKey;t&&(t.unbind(),this._sharedKey=null)},t.prototype.getKeyForIdentitySettings=function(n){var o=null,t=this._options,r=t.part,s=t.partStateDefinition,u=t.identityInputs,l=r.getInputPropertyBindings(),h=s&&s.inputIdentityProperties,e;return r.allInputsSet()&&h&&h.length>0&&(e="",u&&u.length>0&&(e=i.toSortedString(f.toJS(l.targetModel),u)),o=c(r.locator,n,e)),o},t.prototype._registerPartIdentityStateChangeHandler=function(){var u=this,t=this._options,i=t.part,r=t.partStateDefinition,n=r&&r.inputIdentityProperties;n&&n.length>0&&(this._identityState=new a(i.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(n,this._identityState,(function(n){var t=g(n);t&&u.saveIdentityPartSettings(i.containerModel)})))},t.prototype._registerPartSharedKeyChangeHandler=function(){var e=this,t=this._options,o=t.part,u=t.partStateDefinition,h=t.services,n=u&&u.sharedProperties,f,i;n&&n.length>0&&(f=n.map((function(n){return n.property})),i={},this._sharedKey=new a(o.toString()+"-[PartSharedSettings]",i),this._registerViewModelChangeHandler(f,this._sharedKey,(function(){var t={},u;n.forEach((function(n){var u=s.getModelValue(i,n.property).value;t[n.key]=r.toSerializableObject(u)}));u={store:5,settings:t};e._traceOperationWithSettings("Save shared part settings.",t);h.sharedSettings.setSettings(u)})))},t.prototype._registerPartInstanceChangedHandler=function(){var n=this._options,t=n.instanceProperties,r=function(n){return n.some((function(n){return n.propertyName==="content.pollingOptions"}))},i;t&&t.length>0&&(i=this._getOrCreateInstanceStatePropertyBindings(),this._registerViewModelChangeHandler(t,i,(function(t){n.part.save();r(t)&&n.part.notifySettingChanged()})))},t.prototype._registerViewModelChangeHandler=function(n,t,i){var r=this,u=t.targetModel,f=this._options.part.getSettingsModel();n.forEach((function(n){r._registerViewModelPropertyChangeHandler(n,f,u,t,i)}))},t.prototype._registerViewModelPropertyChangeHandler=function(t,i,r,u,e,o){var l=this,c;s.getModelValue(r,t).exists||s.setModelValue(r,t,f.toJS(s.getModelValue(i,t).value));c=u.addProperty(t).bind(this._options.partViewModelId,i,!1,e,(function(t){h.logToExtension(n,l._options.part.locator.getExtensionLocator().name,2,"[PartState] Failed to bind changes from viewmodel to part state. Error: "+t)}));o&&o.registerForDispose((function(){u.removeProperty(c)}))},t.prototype.getIdentityPartSettingsAsync=function(){var t=this,i=this._options,r=i.partStateDefinition,u=i.part.containerModel,f=r&&r.inputIdentityProperties,n,o;return(f&&f.length>0)?(n=this.getKeyForIdentitySettings(u),o={store:this._settingsStore,keys:[n]},this._getPartSettingsAsync("Get identity part settings.",o,undefined).then((function(i){if(n===t.getKeyForIdentitySettings(u)){var r=t._identityState;return r&&e.extend(!0,r.targetModel,i),i}}))):Q.resolve(null)},t.prototype.getStartboardPartIdentitySettings=function(){var i=this._options,n=i.part,r=i.partStateDefinition,u=r&&r.inputIdentityProperties,t;return(u&&u.length>0)?(t=!(n.flags&2)?[]:[c(n.previousLocator,n.containerModel)],t=t.concat([this.getKeyForIdentitySettings(n.containerModel),c(n.locator,n.containerModel),]),this._getPartSettingsAsync("Get identity part settings.",{store:this._settingsStore,keys:t},undefined)):Q.resolve(null)},t.prototype.getSharedPartSettingsAsync=function(){var f=this._options,r=f.partStateDefinition,n=r&&r.sharedProperties,t,i,u;return(n&&n.length>0)?(t=[],i={},n.forEach((function(n){t.push(n.key);i[n.key]=n.property})),u={store:5,keys:t},this._getPartSettingsAsync("Get shared part settings.",u,i)):Q.resolve(null)},t.prototype._traceOperationWithSettings=function(n,t,i){if(this._trace){if(i){var r={};r[i]=t;t=r}v.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(n,this._options.part.toString(),f.toJSON(t,null,2)))}},t.prototype._traceOperationWithKeys=function(n,t){this._trace&&v.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(n,this._options.part.toString(),f.toJSON(t,null,2)))},t.prototype._getPartSettingsAsync=function(n,t,i){var f=this,u;return this._traceOperationWithKeys("BEGIN - "+n,t.keys),u=[this._options.services.sharedSettings.querySettings(t)],Q.all(u).then((function(u){var h,o={};return h=u[0]||{},t.keys.forEach((function(n){var t=h[n],f=r.isSerializedObject(t),u=f?r.fromSerializableObject(t):t;i?h[n]!==undefined&&i[n]&&s.setModelValue(o,i[n],u):e.extend(!0,o,u)})),f._traceOperationWithSettings("END - "+n,o),o}))},t.prototype._getOrCreateInstanceStatePropertyBindings=function(){if(!this._partInstanceState){var n=this._options.part;this._partInstanceState=new a(n.toString()+"-[PartInstanceState]",n.partState)}return this._partInstanceState},t})();t.PartSettingsManager=w}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","f","i","o","ko","$","FxInternal/Composition/ViewModel","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Telemetry","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Parts/Parts","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Parts/Parts.Error"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni){"use strict";function er(n){return n&&n.toFriendlyString()}function su(n,t,i,r){var o;try{return i()}catch(u){var s="Error deserializing composition.",f=void 0,e=void 0;try{f=JSON.stringify(t)}catch(h){f="<Invalid> {0}".format(h.toString())}try{e=pi.fromJSON(n,t.locator)}catch(c){e=pi.forExtension(s+"-"+c)}return o="{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(s,f,u.message||"<N/A>",u.stack||u.toString()),ti.error(o),r(e,o)}}function hu(n,t,r,u){var f=function(){return r&&(t=i.extend2(t,r.getTelemetryInfo())),ir.completeTrace(n,t)};return u?ai.usingState(f,u):f()}function ei(n){var t=n.getPartsContainer();return t&&t.getCompositionType()===at.CompositionType.Blade&&t}function cu(n){var t=ei(n);return!!(t&&t.bladeDefinition&&t.bladeDefinition.locked)}function lu(n,t){return t.masterPartId===n.id&&ki(t.masterCommandName)}function af(n){var i=n.services.desktop,r=i.tryCloseBlade.bind(i),t=n.getPartsContainer();return function(i,u){var e,f,o;switch(i){case 1:case 2:return e=t.detailContainers.filter((function(t){var r=!!(t.flags&1);return lu(n,t)&&i===1?!r:r})),e.length===0?!1:!e.some((function(n){return!r(n.id)}));default:return f=t.masterContainer,o=f&&f.bladeDefinition,o&&o.menuBlade&&(t=f),t.returnValue=u,r(t.id,2)}}}function vf(t,r,u){var e=u&&u.children||[],o=e.indexOf(r,1),f;if(o>0&&(f=e[o-1],f.bladeDefinition&&f.bladeDefinition.menuBlade))return{switchItem:function(r){uf(t,i.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",n)).then((function(n){var i=f.widget.element.findByClassName("fxc-menu"),t=et.Widget.getWidget(i,n.Widget);t&&t.switchItem(r)}))}}}function or(n,t){t===void 0&&(t=!0);var r;return n&&(t&&!n.hasOwnProperty(at.PartContainerModelIdProperty)&&(n=f.toJS(n),n[at.PartContainerModelIdProperty]=i.getUniqueId()),r=ii.createObservableModel(n)),r}function ar(n,t){var i;return n&&t?(i={},eu(n,(function(n){i[n]=null}))):i=n,r.toSerializableObject(i)}function au(n,t,i,r,u){var f=new lr(n,t,null,i);return f.calculateInitialSize(),f.containerModel=or(r),f.overridesModel=or(u||{},!1),f}function vu(n){var t=kt.getGridPixelSize(n.gridWidth(),n.gridHeight()),i=t.height,r=t.width;return n.locked()||(i-=30,r-=30),{height:i,width:r}}function yf(n,t){var e,o;if(kt.isFixedSize(n.size()))return vu(n);var u=0,f=0,i=t.journeyWidget,r=t.blade;return t.partLocation===2&&r&&i&&(e=i.getBlades().length>1,u=iu.innerHeight-113-(e?ut.getBrowserScrollbarWidth():0),o=t.inMenuBlade?r.masterContainer.id:r.id,f=i.getBladeDisplayWidth(o)-(t.inMenuBlade?265:0)-1),{height:u,width:f}}function pf(n,t){return kt.isFixedSize(t.size())?vu(t):{height:n.height(),width:n.width()}}function vr(n,t,r,u,e){if(e===void 0&&(e=!0),e){var o="content.size",s=ri(n,o);s.exists&&f.isObservable(s.value)&&dt.setModelValue(n,o,u)}d.requestAnimationFrame((function(){var f=pf(t,r),e=n.container,o;e.width(f.width);e.height(f.height);o=e.size();(ki(o)||o.partSize!==u||!i.deepEquals(o.dimensions,f))&&e.size({partSize:u,dimensions:f})}))}function nr(n){var t=n.partDefinition,i=n.adapter,r=t&&t.viewModel?t.viewModel:"N/A",u=i?"AdapterPart. Extension: "+i.extension.name+", ViewModel: "+i.viewModelName+", Wrapped ViewModel: "+r:"ViewModel: "+r;return n+" ("+u+")"}function wf(n){var t=n.partDefinition;return t&&t.partKind===fi.Custom&&t.htmlTemplate&&!(t.htmlTemplate in n.extension.definition.htmlTemplates)}function bf(n,t,i){var r=n.getInputPropertyBindings();(i||[]).forEach((function(i){var u=r.properties.first((function(n){var r=n.compositionBindingDefinition;return n.sourceProperty===i.source.property&&r&&r.source&&r.source.id===t.id}));u||(rr(n,r,[i]),i.source.id=t.id,n.bindings.push(i),n.save())}))}function kf(n,t){var i=n.getInputPropertyBindings(),r=n.bindings||[],u=r.filter((function(n){return n.source.scope!==si.DetailsContainer}));u.length!==r.length&&(i.properties.filter((function(n){var i=n.compositionBindingDefinition;return i&&i.source&&i.source.id===t.id})).forEach((function(n){i.removeProperty(n)})),n.bindings=u,n.save())}function yu(n){var t=n.adapter,i=t.inputPropertyBindings,r=i.targetModel;rr(n,t.inputPropertyBindings,t.bindings,(function(t){return r[t.targetProperty]=f.observable(),n.bindAgainstOverridesOrContainerModel(t)}))}function df(n,t,i){var r=!!t;return t&&(t.assetType&&!t.assetIdInputProperty?(ti.error("'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'"+n.locator+"'."),r=!1):!i&&!!t.editScopeType&&n.bindings&&n.bindings.some((function(n){return n.targetProperty===vi}))&&(r=!1,ti.error("Declaring an 'editScopeType' and an input binding with '"+vi+"' as a target property is not supported. "+("A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '"+n+"'. Bindings: "+JSON.stringify(n.bindings)+".")))),r}function gf(n,t){var i=[],r=!0;return t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(r=yt.validateDetailsDefinition(t,i)),i.length&&ef.logDetailDefinitionError(i[0],n.toString(),t),r}function ne(n,t){var i=[],r=ii.validateInputBindings(n,t,i);return i.length&&ti.error(i[0]+" Part:'"+n+"'."),r}function te(n){var t=n.adapter,i=t?t.allInputsSet:n.allInputsSet;f.computed(n,(function(){if(i()){var t=pu(n);t&&t.exists&&n.assetId(f.unwrap(t.value))}}))}function pu(n){var i=n.adapter,r=i?i.inputPropertyBindings:n.getInputPropertyBindings(),t=r.properties.first((function(t){return t.targetProperty===n.assetInstanceDefinition.assetIdInputProperty}));return t?ri(t.sourceModel,t.sourceProperty):null}function ie(n){var f,i,t,r,u;return n.isComposed&&(i=n.getViewModel(),i&&(t=i.container,t&&(r=t.partTitle&&t.partTitle(),u=t.assetName&&t.assetName(),(r||u)&&(f={partTitle:r,assetName:u})))),f}function wu(n){typeof n=="object"&&eu(n,(function(t,i){sf[t]?delete n[t]:typeof i=="object"&&wu(i)}))}function bu(t){return bi(undefined,t,(function(n){return gi[t]=n}),n)}function re(n){var t=bu(cr);return t.then((function(){return n}))}function yr(){return bu(hr)}function pr(){return gi[hr]}function ue(){return gi[cr]}function fe(n){gi[cr]=n}function ee(n){gi[hr]=n}function oe(n){return{property:n,modelType:t.inferredReferenceType,scope:si.CurrentContainer,cardinality:dt.ReferenceCardinality.OneToOne}}function se(t,i){return bi(t,"./UI.Composition.Selectable2Registrar",i,n)}function ku(n){return n&&(n.partKind===fi.Frame||n.partKind===fi._Internal_Az)}function du(n){var t=n.getPartsContainer(),r,i;return t&&(r=t.getCompositionType(),r===hi.Blade)?t.locator.getExtensionLocator().name:(i=n.locator,i&&i.getExtensionLocator().name)}function he(n,t){var i=n.locator,r=n.extension,u=i&&i.getExtensionLocator().name,f=r&&r.name;return u!==t?u:f!==t?f:undefined}function ce(n,t){var r={},i;return(n&&t&&(t.forEach((function(n){n.isIdentityInput&&!!n.property&&(r[n.property]=!0)})),n.forEach((function(n){n.isIdentityInput=!!r[n.property]}))),n&&t)?(i=n.slice(0),t.forEach((function(t){var r=t.valuesFrom;r&&r.length&&r[0].referenceType===5&&(n.some((function(n){return n.property===t.property}))||i.push(t))})),i):n||t||[]}var ui,lr;u.defineProperty(t,"__esModule",{value:!0});var pi=nt.Locator,wr=r.Extension,ai=r.TelemetryContext,br=ai.ContextType,kr=r.ViewModels.Part,gu=i.Base,dr=gu.Diagnostics,nf=dr.Telemetry,tf=i.Extension,rf=tf.SetRequirement,tr=i.Parts,fi=tr.PartKind,le=i.ViewModels,hi=at.CompositionType,ii=pt.CompositionBinder,si=dt.ReferenceScope,gr=dt.PropertyBindings,wi=g.Action,bi=vt.compositionRequire,uf=i.Base.Promises.cancelOnDispose,nu=i.Errors,tu=nu.CanceledError,ci=nu.DisposedCanceledError,iu=window,ff=c.Asset,ki=i.isNullOrUndefined,oi=i.startTimer,ti=dr.createLog(n),ru="fxs-part",ef={logDetailDefinitionError:function(n,t,i){ti.error(n+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(i)))}},uu=yt.PartContainerSelectable_ViewModelPath,of=[uu+".isSelected",uu+".isCommandSelected",],ir=nf,fu=g.Source.Shell,li=7,di=9,vi=at.EditScopeIdPropertyName,rr=ii.setupPropertyBindings,yi=pi.forExtension,ri=dt.getModelValue,ur=ii.mapInputBindingDefinitions,fr=ii.createAllInputsSetWatcherConfigExtended,sr=dt.mapSourceModelToTargetModel,sf={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},hr="./UI.Composition.DynamicPartBinder",cr="./UI.Composition.BladeOpener",gi={};var hf=i.getFeatureValue("autosettings"),cf=i.isFeatureEnabled("partdelayloadbyviewport"),lf=0,eu=i.forEachKey,ou=i.disposeViewModelProperties;t.fxpartsettingchanged="fxpartsettingchanged";t.EmptyViewModel=kr.composePartViewModel(i.noop);t.fxpartinputchanged="fxpartinputchanged",(function(n){n[n.OldInputsNotHandled=1]="OldInputsNotHandled";n[n.UnrecoverableError=2]="UnrecoverableError";n[n.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate";n[n.PartDefinitionNotFound=4]="PartDefinitionNotFound";n[n.IncorrectPartType=5]="IncorrectPartType";n[n.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition";n[n.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel";n[n.ViewModelMissing=8]="ViewModelMissing";n[n.ErrorLoadingControl=9]="ErrorLoadingControl";n[n.ErrorCreatingWidget=10]="ErrorCreatingWidget";n[n.TransitionedToErrorState=11]="TransitionedToErrorState"})(ui||(ui={}));t.createCompositionFromJSON=su;lr=(function(y){function d(n,i,r,u,e,o){var s=y.call(this,o||"Part",n,i,[],r,u)||this;return s.bindings=[],s.editScopeId=f.observable(),s.invocationThrottleDuration=25,s.allInputsSet=f.observable(!1),s.calledOnInputsSet=f.observable(!1),s.failedOnInputsSet=f.observable(!1),s.assetId=f.observable(),s.triggeringLockedBladeSpinner=f.observable(!1),s._earlyVmDeferred=Q.defer(),s._viewStateProperties=[],s._partDefinitionDeferred=Q.defer(),s._registrationDeferred=Q.defer(),s._disabled=!1,s._restoredFromJson=!1,s._perfData={instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1},s._sequence=lf++,s._rebindCount=0,s._showShellCommands=!0,s._allInputPropertyBindingsBound=Q.defer(),s._frameInitialized=Q.defer(),s._frameRevealed=Q.defer(),s._frameBlockingUi=f.observable(!1),s._contentInitializing=f.observable(!0),s._setupPromises(),s._updateRebindSequenceNumber(),s._vm=e||t.EmptyViewModel,s.partState={},s.containerModel=null,s.overridesModel=or({},!1),s._registrationDeferred.promise.catch((function(n){s._allInputPropertyBindingsBound.reject(n)})),s.registerForDispose(s._partSettingsManager=new bt.PartSettingsManager),s}return __extends(d,y),d.prototype.shouldAlertOnClose=function(n){var t,r,i;return(n===void 0&&(n=!1),t=this._getContainer(),!t)?!1:(r=f.utils.peekObservable(t.suppressAlert),i=f.utils.peekObservable(t.configureAlert),r)?!1:i?i.showAlert:!!this.widget&&s.gatherFormFields(this.widget.element).some((function(t){var i=t.viewmodel;return(i._msPortalFxViewModelValueChangesAreClean||i._msPortalFxOldControl&&!n)&&i.dirty&&i.dirty()}))},d.prototype.getAlertMessage=function(){var t=this._getContainer(),n=f.utils.peekObservable(t.configureAlert);return n&&n.showAlert?n.message:""},d.prototype.suppressAlert=function(){var n=this._getContainer();return n?f.utils.peekObservable(n.suppressAlert):!0},d.prototype.notifySettingChanged=function(){var n=this.widget;n&&n.element.trigger(t.fxpartsettingchanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()})},d.prototype.getViewModel=function(n,i){var r=t.EmptyViewModel,u=this.adapter,f,e;if(n=n||0,n===0)r=this._vm;else if(n===4)if(f=this._contextMenuViewModels,f)r=f.getViewModel(n,i);else{var s=this._getCommands(),o=at.findCommand(s,i,""+this),h=o&&o.getViewModel();r=h||t.EmptyViewModel}else n===li?r=u&&u.viewModel:n===di?(e=u&&u.inputPropertyBindings,r=e&&e.targetModel):ti.error("Invalid model type '"+n+"' for part '"+this.locator.toString()+"'.");return r},d.prototype.getViewModelAsync=function(n,t){var i=this;return this._registrationDeferred.promise.then((function(){var r,f,u;return n===4?(r=i._contextMenuViewModels,r?r.getViewModelAsync(n,t):(f=i._getCommands(),u=at.findCommand(f,t,""+i),u&&u.getViewModelAsync())):i.getViewModel(n)}))},d.prototype.setViewModel=function(n){this._vm=n||t.EmptyViewModel},d.prototype.setBladeOpener=function(n){this.registerForDispose(this._bladeOpener=n)},d.prototype.getBladeOpener=function(){return this._bladeOpener},u.defineProperty(d.prototype,"isDisabled",{get:function(){return this._disabled},enumerable:!0,configurable:!0}),u.defineProperty(d.prototype,"canClone",{get:function(){var n=!this.awaitComposed().isPending(),t=this.getInputPropertyBindings().allBound,i=this.partDefinition.partKind===fi.ResourceSummary;return n&&t&&!i},enumerable:!0,configurable:!0}),u.defineProperty(d.prototype,"eligibleForBinding",{get:function(){return!this.containerModel},enumerable:!0,configurable:!0}),u.defineProperty(d.prototype,"templateKey",{get:function(){var n=this.locator.toString(),t=this.containerModel;return t&&(n+="-"+i.toSortedString(f.toJS(t))),n},enumerable:!0,configurable:!0}),u.defineProperty(d.prototype,"journeyPath",{get:function(){return this.getPartsContainer().journeyPath.concat(this.templateKey)},enumerable:!0,configurable:!0}),u.defineProperty(d.prototype,"dirtyAndNotSaving",{get:function(){return this.services.diContainer.get(rt.EditScopeManager).getStateObservable(this.editScopeId())()===1},enumerable:!0,configurable:!0}),u.defineProperty(d.prototype,"instanceDefinition",{get:function(){return this._partInstanceDefinition},enumerable:!0,configurable:!0}),d.prototype.getCompositionType=function(){return hi.Part},d.prototype.getPartSettingsManager=function(){return this._partSettingsManager},d.prototype.getPerfData=function(){return this._perfData},d.prototype.getSettingsModel=function(){var n=this._settingsModel,t;if(!n&&(t=this.getViewModel())){var u=o.isV2(t.content()),e=this.partDefinition,r=e&&e.partState,s=i.unique((r?(r.inputIdentityProperties||[]).concat((r.sharedProperties||[]).map((function(n){return n.property}))):[]).concat(!u&&this._viewStateProperties||[]));this._settingsModel=n=i.clone(t);n.content=f.observable({});s.forEach((function(i){if(i.startsWith("content.")){var r=u?f.observable():ri(t,i).value;dt.setModelValue(n,i,r)}}))}return n},d.prototype.hasUserInteractedRecently=function(){return!1},d.prototype.dispose=function(n){y.prototype.dispose.call(this,n);this._releaseResources(n);[this._loadedMarker,this._readyMarker,this._revealedMarker,this._onInputsSetResolvedMarker].forEach((function(n){n&&ir.cancelTrace(n)}))},d.prototype._setExtension=function(n){this.extension=n;this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)},d.prototype.resourceLTM=function(){return this._ltm||(this._ltm=this.widget.ltm.createChildLifetime())},d.prototype._releaseResources=function(n){var u,f,i,e,r,o;this._ltm&&this._ltm.dispose();this._clearLoadingReactor();u=this._inputBindings;u&&(u.unbind(),this._inputBindings=null);f=this._part;f&&(f.dispose(),this._part=null);i=this._vm;e=this.extension;e&&i&&i!==t.EmptyViewModel&&e.releaseViewModel(i);this._releaseAdapter();r=this._extenderVM;o=this._extenderVMExtn;r&&o&&(ou(r),o.releaseViewModel(r));n||this._disposeEditScope();this._journey=null;this._vm=t.EmptyViewModel},d.prototype._clearLoadingReactor=function(){var n=this._loadingReactorLifetime;n&&n.dispose()},d.prototype._releaseAdapter=function(){var n=this.adapter,t;n&&(n.inputPropertyBindings.unbind(),ou(n.viewModel),t=n.viewModel,t&&n.extension.releaseViewModel(t),this.adapter=null)},d.prototype._getContainer=function(){return r.shellInterface(this.isDisposed()||!this._vm?{}:this._vm.container)},d.prototype.getInputPropertyBindings=function(){if(!this._inputBindings)this._inputBindings=new gr(nr(this),{},!1);return this._inputBindings},d.prototype.getAssetId=function(){var e=this,t=this.assetInstanceDefinition,o=t&&t.assetIdInputProperty;if(!o)return Q.reject(0);var i=function(n){var t=pu(e);t&&t.exists?n.resolve(f.unwrap(t.value)):n.reject()},n=Q.defer(),r=this.adapter,u=r?r.allInputsSet:this.allInputsSet;return u()?i(n):u.subscribe(this,(function(t){t&&!n.promise.isFulfilled()&&i(n)})),n.promise},d.prototype.toJSON=function(){var n=y.prototype.toJSON.call(this),t,i;return n.assetInstanceDefinition=this.assetInstanceDefinition,n.partState=r.toSerializableObject(this.partState||{}),n.initialSize=this.initialSize,n.bindingsInitialized=this._bindingsInitialized,n.savedContainerState=ie(this),n.containerModel=ar(this.containerModel,this.modelContainsSensitiveData),n.overridesModel=ar(this.overridesModel,!1),n.originalPartLocator=this.previousLocator,n.flags=this.flags,t=this.adapter,i=this.bindings,n.adapterBindings=t&&t.bindings,n.bindings=t?i.filter((function(n){return n.source.scope===si.DetailsContainer})):i,n},d.prototype.cloneAs=function(n,t){var u=this,i,r=this.widget?this.widget.options:null,o=[this.awaitComposed(),this.getInputPropertyBindings().awaitAllBound],s=this.adapter;return s&&o.push(s.inputPropertyBindings.awaitAllBound),Q.all(o).then((function(){var c=u.getNonDetailsContainerPropertyBindings(),s={},h,o;return c.forEach((function(n){var t=ri(n.targetModel,n.targetProperty).value;dt.setModelValue(s,n.sourceProperty,f.toJS(t))})),h=f.toJS(u.overridesModel),i=n(s,h),i.widgetState(e.extend(!0,{},u.widgetState())),r&&r.size&&(i.initialSize=r.size(),i.initialSize===99&&(i.initialWidth=r.gridWidth(),i.initialHeight=r.gridHeight())),o=u._partSettingsManager,o&&o.saveIdentityPartSettings(i.containerModel,t),i}))},d.prototype.clone=function(){var n=this;return this.cloneAs((function(t,i){return au(n.services,n.locator,null,t,i)}))},d.fromJSON=function(n,t){var i=n.diContainer.get(p.ExtensionManagerOptions);return su(i,t,(function(){var r=new d(n,pi.fromJSON(i,t.locator),t.widgetState,t.id);return r.loadPropertiesFromJson(i,t),r}),(function(i,r){var u=new d(n,i,null,t.id);return u.unrecoverableErrorMessage=r,u}))},d.prototype.getAssetInstanceMetadataAsync=function(){var n=this;return this._registrationDeferred.promise.then((function(){if(!n.isDisabled&&!n.isDisposed())return n.getAssetId().then((function(t){return{id:t,type:n.assetType}})).catch(e.noop)}))},u.defineProperty(d.prototype,"assetType",{get:function(){var n=this.assetInstanceDefinition;return n&&n.assetType},enumerable:!0,configurable:!0}),d.prototype.addWidgetToUI=function(n){var t=this.widget;n.parentElement.addChild(t);t.addChild(this._partContainer)},d.prototype.recompose=function(n){this._compose(n,Q.defer(),!0)},d.prototype._compose=function(n,t,u,f){var o=this,c,h,d,a,p,w,l,b;u===void 0&&(u=!1);var s,k=du(this),g=er(this.locator),y=function(n,t){return hu(n,t,o._menu,o._creationState)};f=f||{};c=function(n){return ir.startTrace({extension:k,source:fu,action:n,name:g,journeyId:o._getTelemetryJourneyId()})};this.calledOnInputsSet.subscribe(this,(function(n){n&&(o._onInputsSetResolvedMarker=c(wi.OnInputsSetResolved))}));this._allOnInputsSet.then((function(){var t=o._readyMarker,n;t&&(y(t,o._perfData),o._readyMarker=null);n=o._onInputsSetResolvedMarker;n&&(o.fullReadyTime=y(n,o._perfData),o._onInputsSetResolvedMarker=null)}));this.await(0).then((function(n){var t=o._revealedMarker;t&&(o._perfData.contentRevealedCalled=n,y(t,o._perfData),o._revealedMarker=null)}));this._registrationDeferred.promise.then((function(){t.resolve()}),(function(){t.reject()}));this._clearLoadingReactor();this._ltm&&this._ltm.dispose();h=this.widget;h&&u?(this._partContainer=h.element.find("."+ru),s=h.options,d=s.commands.splice(0,s.commands.length),d.forEach(i.disposeDisposable),s.actionBarViewModel.update(),this._ltm=h.ltm.createChildLifetime()):(this._partContainer=e(r.createElement("div",{"class":ru})),s=new ft.ViewModel(this.id,this.widgetState()),s.inLockedContext=n.options.locked(),s.size()===undefined&&s.size(this.initialSize),s.size()===99&&(s.gridWidth(Math.max(1,this.initialWidth)),s.gridHeight(Math.max(1,this.initialHeight))),h=this.widget=ft.createTileWidget(e(r.createElement("div")),s,(function(){return o._getActions()})),this.widgetState(h.saveViewSettings()),this._ltm=h.ltm.createChildLifetime(),this.addWidgetToUI({parentElement:n,doNotSaveSettings:!0}));a=h.element;p=this._ltm;n.options.locked()||s.isInBlockingLoadingState(!0);a.data(at.CompositionInstanceDataName,this);p.registerForDispose(a.setEvents([v.default.fxregistermenu,function(n,t){o._menu=t},]));w=function(){if(o._loadedMarker=c(wi.PartLoaded),o._readyMarker=c(wi.PartReady),o._revealedMarker=c(wi.PartRevealed),o.unrecoverableErrorMessage&&o.unrecoverableErrorMessage.length>0)return o._createErrorPart(ui.UnrecoverableError,o.unrecoverableErrorMessage);o._locateDefinitionAndStartCompose(p,s);o._perfData.srcExtension=he(o,k);var t=o.createChildLifetime();n.options.locked.subscribeAndRun(t,(function(n){o._toggleShellCommands(t,!n,s.commands)}))};l=f.delayLoad;cf&&(l=l||function(n){return!ut.isElementFullyInViewport(n,0,!0).fullyVisible});b=f.delayLoadPromise;b&&l&&l(a[0])?(this._loadDelayed=!0,Q(b).finally(w)):w()},d.prototype._locateDefinitionAndStartCompose=function(n,t){var r=this,e=oi(),u,o=yr();return this.services.finder.locateAsync(this.locator).then((function(n){return r._perfData.instanceExtensionLoad=e(),u=oi(),r._processLocatedDefinitionAsync(n)})).then((function(n){return o.then((function(){return n}))})).then((function(e){var l,o,h,s;if(!n.isDisposed())if(r._perfData.referenceExtensionLoad=u(),e){if(r._isRestoredPartLackingBinding(e))if(r.eligibleForBinding)r._bindingsInitialized=!1,r.bindings=[];else if(!e.canUseOldInputVersions){ti.warning("[Definition Change] Bindings for part '"+r+"' have been changed in the definition in an incompatible way.");l={reason:f.observable(i.isDevelopmentMode?c.PartError.titleSettingsDevMode:c.PartError.titleSettings),clickable:!1};r._createErrorPart(ui.OldInputsNotHandled,"Bindings for part have been changed in the definition in an incompatible way. Locator: "+r.locator+".",l);return}if(o=r.adapter,r._restoredFromJson&&r._bindingsInitialized!==!1){var a=o?o.bindings:r.bindings,v=o?o.inputDefinitions:e.inputDefinitions,y=pr(),p=y.inferInitialBindingsForInputDefinitions(r,v),w=p.filter((function(n){return a.every((function(t){return t.targetProperty!==n.targetProperty}))}));[].push.apply(a,w)}else o?o.bindings=r._constructAdaptedBindings():r._setBindings(e),r.assetInstanceDefinition={assetType:e.assetType,assetIdInputProperty:e.assetIdInputProperty},o&&((o.assetType||o.adaptedPart.assetType)&&(r.assetInstanceDefinition.assetType=o.assetType||o.adaptedPart.assetType),o.assetIdInputProperty&&(r.assetInstanceDefinition.assetIdInputProperty=o.assetIdInputProperty)),h=r._partInstanceDefinition,s=h&&h.reference,s&&s.assetType&&(r.assetInstanceDefinition.assetType=s.assetType),r._bindingsInitialized=!0,r.save();if(r.partDefinition=e,r._partDefinitionDeferred.resolve(e),wf(r))r._createErrorPart(ui.CustomPartWithMissingTemplate,c.UiCompositionPart.missingTemplateMessage);else return r._composeCommandsAndPart(t,r._partContainer)}else r._createErrorPart(ui.PartDefinitionNotFound,"Unable to find the definition for the part. Locator: "+r.locator+".")})).catch((function(t){r._partDefinitionDeferred.reject(t);n.isDisposed()||r._createErrorPart(ui.ErrorLocatingPartDefinition,t)}))},d.prototype.getInstanceBindings=function(){var n=this._partInstanceDefinition;return n?n.inline?n.inline.bindings:n.reference.bindings:undefined},d.prototype._setBindings=function(n){var r=this.getInstanceBindings(),t=ce(r,n.bindings),i;ne(this,t)&&(this.bindings=this.bindings.concat(ur(t,this)));this.bindings.length<=0&&this.locator.type===6&&(i=pr(),this.bindings=this.bindings.concat(i.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions)))},d.prototype._constructAdaptedBindings=function(){var n=this.adapter,t;return n.bindings.length<=0&&this.locator.type===6?(t=pr(),t.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions)):ur(n.adaptedPart.bindings,this)},d.prototype._isRestoredPartLackingBinding=function(n){if(this._restoredFromJson){var t=this.adapter,i=t?this._constructAdaptedBindings():ur(n.bindings||[],this),r=t?t.bindings:this.bindings,u=function(n){return!n.optional&&r.firstIndex((function(t){return t.targetProperty===n.targetProperty}))<0};return!!i.some(u)}return!1},d.prototype._getActions=function(){var t=this.services,n=[];return this.getCompositionType()===hi.StartboardPart&&n.push(new ht.UnpinFromStartboard(this,t).createAction(this)),n.push(new ht.OpenContextMenu(this,t,c.ContextMenu.ariaLabel).createAction(this)),n},d.prototype.resetLayout=function(){var n=this.initialSize,r=kt.AllSizes[n>=0?n:kt.getDefaultSize().name],t=r.size,i=this.widget;i.element.trigger(v.default.fxsizechange,[i.options.id,t.width,t.height])},d.prototype.clearIdentitySettings=function(){var n=this._partSettingsManager;n&&n.clearIdentityPartSettings()},d.prototype._processLocatedDefinitionAsync=function(n){var f=this,u=this.services.finder,r=n,t,i;switch(this.locator.type){case 5:case 7:this._partInstanceDefinition=n;break;case 6:t=n;t&&t.reference&&(this._partInstanceDefinition={reference:{partTypeName:t.name,bindings:t.bindings,assetType:t.assetType,initialSize:t.initialSize}})}if(i=this._partInstanceDefinition,i){if(i.reference){var e=i.reference.extension||this.locator.getExtensionLocator().name,o=yi(e),s=o.withPartType(i.reference.partTypeName);return u.locateAsync(o).then((function(n){return f._setExtension(n),u.locateAsync(s)})).then((function(n){return n&&n.reference?f._processAdapterAsync(n,e):n}))}r=i.inline}return this.initialSize===99&&(this.initialWidth=r.initialWidth,this.initialHeight=r.initialHeight),this._setExtension(u.locate(this.locator.getExtensionLocator())),Q(r)},d.prototype._processAdapterAsync=function(n,t){var i=this,u=yi(n.reference.extension||t),o=u.withPartType(n.reference.partTypeName),e=this.services.finder;return e.locateAsync(u).then((function(t){var u=i+" (AdapterPart. Extension: "+i.extension.name+", ViewModel: "+n.viewModel+")",r;return i.adapter={extension:i.extension,viewModel:null,viewModelLocator:n.viewModelLocator,viewModelName:n.viewModel,viewModelId:u,bindings:i._adapterBindings||[],inputDefinitions:n.inputDefinitions,adaptedPart:i._partInstanceDefinition.reference,allInputsSet:f.observable(!1),calledOnInputsSet:f.observable(!1),failedOnInputsSet:f.observable(!1),inputPropertyBindings:new gr(u,{},!1),assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},i._partInstanceDefinition={name:i._partInstanceDefinition.name,reference:n.reference},r=i.adapter.adaptedPart.assetType,r&&(i._partInstanceDefinition.reference.assetType=r),i._setExtension(t),e.locateAsync(o)})).then((function(u){if(u&&u.reference){var f="Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(i,i.adapter.extension.name,n.reference.partTypeName,u.reference.extension||t,u.reference.partTypeName);ti.error(f);Q.reject(r.createError(f))}else return i._setBindings(u),u}))},d.prototype.getTitle=function(){var t=this.getViewModel(),n;return t&&(n=t.container,n)?n.partTitle&&n.partTitle()||"":""},d.prototype._composeCommands=function(n){var t=this,i=st.getCommandGroupForDefinitionItem(this.services.finder,this.extension.name,this.partDefinition),r=[],u={viewModelName:this+"-[ContainerModel]",viewModel:this.containerModel};i&&(i.commands.forEach((function(n){t._canPopulateCommand(n)&&r.push(new st.ExtensionCommandMenuItemImpl(t,t.extension,t,n,t.partDefinition,t.services,u))})),n.splice.apply(n,[0,0].concat(r)))},d.prototype._canPopulateCommand=function(n){var t=this.parent&&this.getPartsContainer();return t?n.details&&t.flags&1?(ti.error("Part '"+this+"' cannot have the open blade command '"+(n.name||n.text)+"', because it is inside the context blade."),!1):!0:!0},d.prototype.disableForAssetDeleted=function(n,t){var u,e,r,f,o;this._disabled=!0;u=this._vm;u&&u.container&&(e=this._getNotFoundMessage(),e(ff.deletedTitle));r=this.widget;r&&r.options&&(f=r.options.commands,o=f.splice(0,f.length,new ht.UnpinFromStartboard(this,this.services)),o.forEach(i.disposeDisposable));this.save();ti.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))},d.prototype._composeCommandsAndPart=function(n,t){try{this._composeCommands(n.commands);this._composePart(t,n);this._attachEventHandlers(t)}catch(i){return e.Deferred().reject(i).promise()}},d.prototype._attachEventHandlers=function(n){var t=this,i=function(n,i){t.widgetState(i);t.save();n.stopPropagation()},r=function(i,r){var u=t.widget.options,f=!!tr.InternalPartSize[r];r=f?r:u.size();vr(t._vm,n,u,r,f)},u=function(n,i){t._handleRightClick(n,i)},f=function(n,i){i.masterPartId=t.id},e=function(n,i){n.stopPropagation();var r=t.locator.getExtensionLocator();t.services.desktop.pinMultipleParts(i.partReferences,r.name)};this.resourceLTM().registerForDispose(this.widget.element.setEvents([et.Widget.viewSettingsChanged,i],[v.default.fxsizechanged,r],[v.default.fxrightclick,u],[v.default.fxensurebladevisible,f],[l.fxpinmultipleparts,e]))},d.prototype._toggleShellCommands=function(n,t,i){wt.composeShellCommands(n,this,i,this._showShellCommands=t,this.services)},d.prototype._getPartContext=function(){var n=ei(this)||{},t=this.getPartsContainer(),i=!!n,r=t&&t.getCompositionType()===hi.Startboard;return{id:er(this.locator),instanceId:this.instanceId,bladeId:er(n.locator),bladeInstanceId:n.instanceId,onBlade:i,onStartBoard:r,bladeCustomized:!1,loadDelayed:!!this._loadDelayed}},d.prototype._updateRebindSequenceNumber=function(){this.instanceId="Part_"+i.sessionId+"_"+this._sequence+"_"+this._rebindCount++},d.prototype._getPartViewModelAsync=function(n,t,u,e,s,h,c){var l=this,v,p=yt.needContainerSelectable(this.partDefinition.details),w=oi(),y=ai.provideContext((function(){var o,y;l._creationState=ai.getState();var i=l.parent&&l.getPartsContainer(),w=i?i.getCompositionType():hi.Unknown,a=i?w===hi.Startboard?1:2:0,r=i&&i.bladeDefinition,e=129;return r&&l.partDefinition.shareVmWithParentBlade&&(e|=64,r.templateBlade&&!r.templateBlade.isV2&&(e=453),r.menuBlade&&!r.menuBlade.isV2&&(e=454)),o=i&&i.flags&1?1:0,o|=cu(l)?2:0,(v=vf(l,i,l._journey||l.services.desktop.getActiveJourney()))&&(o|=4),y=yf(c,{partLocation:a,blade:ei(l),journeyWidget:l.services.desktop.portalWidget.getPanorama().getJourneyWidget(),inMenuBlade:!!v}),l.extension.getPartViewModel(n,e,{initialState:f.toJS(l.partState),createSelectable:p,partSize:t,contentSize:y,partLocation:a,collapsed:u,onInputsSetParameters:s,onViewModelAcquired:h&&function(n){n&&!n.chrome&&n.content()&&h(n)},locator:l.locator,flags:o})}),br.Part,this._getPartContext());return y.then(this._earlyVmDeferred.resolve,this._earlyVmDeferred.reject),y.then((function(n){var e,u,s,t;return n&&n.chrome?(u=i.cloneAndRebindFunctions(n),u.content=f.observable(o.markAsV2(n.chrome)),e=n.content.fxAwaitAndRun(l).then((function(){return h&&h(n),n})),l._setupLoadingReactor(c,n.container.operations)):e=Q.resolve(u=n),l.partDefinition.shareVmWithParentBlade&&(s=ei(l),s.setViewModelForTemplateOrMenuBlade(u),s.setInputsSetPromise(l._allOnInputsSet)),t=n&&r.shellInterface(n.container),t&&(t.closeBlade(af(l)),t.menu(v),t.openDialog((function(t,i){return l.services.diContainer.getAsync(ni.DialogManager).then((function(r){n.internal.dialog(t);var u=cu(l)?function(){return Q(ei(l).widget)}:function(){return l.services.diContainer.getAsync(ot.AsyncPortalFormTarget)},f=i?function(){return l.services.diContainer.getAsync(ot.AsyncPortalFormTarget)}:u;return f().then((function(n){var u=l.widget.element[0];return typeof i=="string"?u=l.widget.element.find(i)[0]:typeof i=="object"&&(u=a.unwrapFxElement(i)),r.showShellDialog(t,n,u,l.locator,!1).then((function(n){t.onClosed&&t.onClosed({button:n})})),!0}))}))})),t.setFocus((function(n){return l._contentInitializing.fxAwaitAndRun(l,(function(n){return n===!1})).then((function(){return l._part.setFocus(n)}))}))),e})).then((function(n){var r=l.services.finder,t=r.locate(l.locator),u=oi(),i=n&&n.content();return s&&ii.notifyOnInputsSetCalled(e,s,n&&n.onInputsSetPromise&&Q(n.onInputsSetPromise)),t&&t.reference&&(t.reference.extenderViewModelLocator||t.reference.extenderViewModel)?(l._extenderVMExtn=r.locate(l.locator.getExtensionLocator(),l.extension.name),l._extenderVMExtn.getViewModel(t.reference.extenderViewModelLocator||t.reference.extenderViewModel,9).then((function(r){var u=t.reference.extenderViewModelLocator?t.reference.extenderViewModelLocator.name:t.reference.extenderViewModel;return r&&r.content()?i&&f.isObservable(i.extenderViewModel)?(l._extenderVM=r,i.extenderViewModel(r.content())):ti.error("Part '"+l+"' defines extender view model '"+u+"' but the referenced part is not marked as extensible."):ti.error("Extender view model '"+u+"' for part '"+l+"' must be an object."),n})).finally((function(){l._perfData.extenderViewModelLoad=u()}))):n})).finally((function(){l._perfData.partViewModelLoad=w()}))},d.prototype._getAdapterViewModelAsync=function(){var n=this;if(!this.adapter)return Q(null);yu(this);var i=fr(this._getAdapterAllInputsSetWatcherConfig()),r=ii.loadOnInputsSetParameters(i),t=this.adapter;return r.then((function(r){n._earlyAdapterOnInputsSet=!!r;n._perfData.earlyOnInputsSetAdapter=n._earlyAdapterOnInputsSet;var u=oi();return t.extension.getViewModel(t.viewModelLocator||t.viewModelName,10,{onInputsSetParameters:r}).then((function(n){return t.viewModel=n,r&&ii.notifyOnInputsSetCalled(i,r,n&&n.onInputsSetPromise),i})).finally((function(){n._perfData.adapterViewModelLoad=u()}))}))},d.prototype._bindAssetNameFromAdapter=function(){var r=this,t=this.adapter,n,i;t&&(n=ri(t.viewModel,"content.assetName"),n.exists)&&(f.isObservable(n.value)?(i=n.value,f.computed(this,(function(){var t=i(),n=r._vm;!ki(t)&&n&&n.container&&dt.setModelValue(n,"container.assetName",t)}))):ti.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(t.viewModelId)))},d.prototype._composePart=function(n,t){var r=this,a,h;if(!this.isDisposed()){var y=this.locator,u=this.partDefinition,k=u.partKind,e=tt.getPartFactory(this.extension.name,u,this.extension.definition.htmlTemplates),f,s,p;if(e){u.resizeMode!==1?t.supportedSizes(e.supportedSizes):t.supportedSizes([]);this._inputBindings=null;this.getInputPropertyBindings();var w=this._getAdapterViewModelAsync(),l=this.services.finder.locate(y),d=l&&l.reference&&l.reference.extenderViewModel,b=this.bindings||[],g=b.some((function(n){return n.source&&n.source.scope===si.DetailsContainer})),nt=this.adapter&&b.some((function(n){return n.source&&n.source.modelType===li}));d||g||!this.extension.canUseInputsSetParameters(y)?s=Q(null):(a=function(){return r.isDisposed()?Q(null):(r._registerInputPropertyBindings(),f=fr(r._getAllInputsSetWatcherConfig()),ii.loadOnInputsSetParameters(f))},s=nt?w.then(a):a());s=re(s);this._vmPromise=s.then((function(n){var i,u,o;return r.isDisposed()?(r._releaseResources(),Q.reject(new ci)):(r._earlyOnInputsSet=!!n,r._perfData.earlyOnInputsSetPart=r._earlyOnInputsSet,i=r.partDefinition,u=i.partKind===fi.ResourceSummary?r._getSummaryPartViewModelState():null,h=t?t.size():r.initialSize,o=r._getPartViewModelAsync(i.viewModelLocator||i.viewModel,h,u,f,n,f&&function(n){return r._setupInvocationProperties(e.viewStateProperties,n)},t),Q.all([o,w]))})).catch((function(n){if(r.isDisposed()||i.Errors.isInstanceOfErrorType(n,i.Errors.CanceledError))return Q.reject(new ci);r._createErrorPart(ui.ErrorAcquiringViewModel,n)})).spread((function(i,s){var l=oi();if(r.setViewModel(i),r.isDisposed())return r._releaseResources(),Q.reject(new ci);if(i){if(!r.isDisabled){r._bindAssetNameFromAdapter();r.resourceLTM().registerForDispose(r.widget.element.setEvents([v.default.fxportalcontrolloadfailed,function(n,t){r._createErrorPart(ui.ErrorLoadingControl,t)},]));u.partKind===fi.ResourceSummary&&r._autoOpenSettingsFromSummary();var a=t?t.size():r.initialSize,y=a!==h,p=u.partKind===fi.Provisioning;vr(r._vm,n,t,a,y);o.isV2(i.content())||r._setupLoadingReactor(t,i.container.operations);t.userResizable(r.getCompositionType()===hi.StartboardPart&&u.resizeMode===2);y?r.extension.processMessages().finally((function(){r.isDisposed()||r._setupPartWidget(n,e,f,s,h,p,l)})):r._setupPartWidget(n,e,f,s,h,p,l)}}else r._createErrorPart(ui.ViewModelMissing,c.UiCompositionPart.viewModelRequired)}))}else p="Incorrect part type '{0}'.".format(k),this._createErrorPart(ui.IncorrectPartType,p)}},d.prototype._setupPartWidget=function(n,t,u,e,o,s,h){var c=this,l=this.widget,a=this.getViewModel(),y;this._perfData.prepareViewModel=h();y=oi();b.setSelectableContext(this,a,n);i.tryImmediateResolve(this._createPartWidget(t,a,s),(function(){var o,s,i;if(c.isDisposed())return Q.reject(new ci);if(o=c.partDefinition,o.shareVmWithParentBlade||f.reactor(c,(function(){var n=c._getNotFoundMessage()();c._part.notFoundMessage(n)})),vr(a,n,l.options,l.options.size(),!1),c.register(t.viewStateProperties,u,e),te(c),c._ensureAssetAffinity(),c._perfData.finalizePartCompose=y(),o.resizeMode===1){if(s=c.extension&&c.extension.name,s!=="AppInsightsExtension"&&s!=="SamplesExtension")return;i=r.shellInterface(c._vm.container);i.autoSize.subscribe(c,(function(n){if(n){i.autoSize(!1);var r=c.widget,t=r.element,u=t.find(".fxs-part-content"),f=u.find("> div");if(f.length!==1)return;var e=f[0],o=u[0],s=t.outerWidth()+Math.floor(e.clientWidth-o.clientWidth),h=t.outerHeight()+Math.floor(e.clientHeight-o.clientHeight);t.trigger(v.default.fxsizechange,[r.options.id,s,h])}}));i.resize.subscribe(c,(function(n){if(n&&n.width&&n.height){var t=kt.getGridPixelSize(n.width,n.height);c.widget.element.trigger(v.default.fxsizechange,[l.options.id,t.width,t.height])}}))}}),(function(n){c._createErrorPart(ui.ErrorCreatingWidget,n)}))},d.prototype.register=function(t,i,r){var u=this,e=this.parent&&this.getPartsContainer(),o,s,f;this._removeOutputArgumentValuesFromContainerModel();(this.bindings||[]).forEach((function(n){var t=n.source.modelType;u._hasRebindableInputs||n.source.scope!==si.CurrentContainer||t!==1&&t!==li&&t!==di||(u._hasRebindableInputs=!0)}));this._listenForPartMutation();this.adapter&&!r&&yu(this);i||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm));this._partSettingsManager.configureInstanceProperties(this._viewStateProperties);this._partSettingsManager.initialize();bi(this,"./UI.Composition.SelectableRegistration",(function(n){n.listenForRegistrationChanges(u,u._vm,u)}),n);se(this,(function(n){n.autoRegisterSelectables(u,u._vm,u)}));o=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(e);s=oi();this.save();i||(i=fr(this._getAllInputsSetWatcherConfig()));i.bindableTarget.viewModel=this._vm;this._setContainerInputsChanging=function(n,t){if(n)ii.turnOnInputsSetSuppressionOn(i);else return t?ii.turnOnInputsSetSuppressionOff(i,t):ii.turnOnInputsSetSuppressionOff(i)};ii.setupAllInputsSetWatcherFromExtendedConfig(i);this.adapter&&(r||(r=fr(this._getAdapterAllInputsSetWatcherConfig())),r.bindableTarget.viewModel=this.adapter.viewModel,ii.setupAllInputsSetWatcherFromExtendedConfig(r));yr().then((function(n){n.listenForConfigurationChanges(u,r,i)}));f=function(){u._finishCompose(e,o,s)};this.partDefinition.shareVmWithParentBlade?setTimeout(f):this.extension.processMessages().finally(f)},d.prototype._finishCompose=function(n,t,i){var r=this,u,e,f;this.isDisabled||this.isDisposed()||(n&&n.notifyPartComposed(this),this._registrationDeferred.resolve(),u=[t.awaitAllBound],this.adapter&&u.push(this.adapter.inputPropertyBindings.awaitAllBound),e=i(),f=this._allInputPropertyBindingsBound,Q.all(u).then((function(){var n=r._perfData;f.resolve();n.allInputBindingsBoundPreprocess=e;n.allInputBindingsBound=i();r._loadedMarker&&(r.adapter&&(n=__assign({},n,{innerPart:{extension:r.extension.name,name:r.partDefinition.name}})),r.compositionTime=hu(r._loadedMarker,n,r._menu,r._creationState),r._loadedMarker=null)})).catch((function(){f.reject()})),this.save())},d.prototype._registerInputPropertyBindings=function(){var n=this,i=[],r=[],u=[],t;this._journey=this.services.desktop.getActiveJourney();(this.bindings||[]).forEach((function(n){n.source.scope===si.DetailsContainer?u.push(n):r.push(n);!n.isIdentityInput||i.push(n.targetProperty)}));this._partSettingsManager.configure(this._getPartSettingsManagerConfig(i,this._viewStateProperties));t=this.getInputPropertyBindings();rr(this,t,u);rr(this,t,r,(function(t){return n.adapter?n.adapter?n.bindAdaptedInput(t):void 0:n.bindAgainstOverridesOrContainerModel(t)}));this._setEditScope();this._setupJourneyEditScopeReactor()},d.prototype.bindAdaptedInput=function(n){var t=n.source,i=t&&t.modelType;switch(i){case li:return{sourceModel:this.adapter.viewModel,sourceModelName:this+"-[Adapter]"};case di:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this+"-[AdapterInputs]"}}},d.prototype.getNonDetailsContainerPropertyBindings=function(n){n===void 0&&(n=!0);var t=this.adapter,i=n&&t?t.inputPropertyBindings:this.getInputPropertyBindings();return i.properties.filter((function(n){var t=n.compositionBindingDefinition,i=t&&t.source&&t.source.scope;return i!==si.DetailsContainer}))},d.prototype.bindAgainstOverridesOrContainerModel=function(n){var t,r,i,u;if(n.source.id!==this.id){if(dt.isDynamicBindingWithNonLocalSource(n))return null;if(t=n.source.property,r=this.overridesModel,ri(r,t).exists)return{overridesConstantBindings:!0,sourceModelName:this+"-[OverridesModel]",sourceModel:r};if(i=this.containerModel,i&&ri(i,t).exists)return{sourceModelName:this+"-[ContainerModel]",sourceModel:i};if(dt.isOverridesOrContainerModelSourceReference(n.source))return u={},dt.setModelValue(u,t,undefined),{sourceModelName:this+"-[Inferred]",sourceModel:u}}},d.prototype._setupInvocationProperties=function(n,t){var i=this,r=this.partDefinition,u;(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)||(this._setViewStateProperties(r.viewStateProperties,n),u=ue(),this.setBladeOpener(u.create(this._getBladeOpenerConfig())),df(this,this.partDefinition,this._restoredFromJson)&&r.details&&r.details.length&&(r.details.forEach((function(n){gf(i,n)&&i._registerInvocationProperty(n)})),this.resourceLTM().registerForDispose(this.widget.element.setEvents([v.default.fxopeninnewtab,function(n,t){var r=t.selectable,u=yt.getAssociatedDetailDefinition(r||t.selectableSet,i.getViewModel(),i.partDefinition),f,e;u&&(f=r?r.selectedValue():wt.createSelection(t.selectableSet,t.item),e=Q(f).then((function(n){var t=i._bladeOpener.createBladeModelForSelectedItem(u,n),r=t&&t.locator;return r?w.getBladeDeepLink(r.getExtensionLocator(),r.name,iu.location.href,t.model):null})),i.services.diContainer.get(lt.WindowManager).openWindow(e))}]))))},d.prototype.selectOnReady=function(n,t){var i=this;return Q.all([this.awaitComposed(),this._allInputPropertyBindingsBound]).then((function(){return i._part.selectOnReady(n||function(){return!0},t)}))},d.prototype.getSelectableAsync=function(n){return this.getViewModelAsync().then((function(t){var r=typeof n=="string"?n:yt.getSelectablePath(n),i=ri(t,r);if(i.exists)return f.unwrap(i.value)}))},d.prototype._getBladeOpenerConfig=function(){var n=this;return{services:this.services,masterModelId:nr(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:function(t){return lu(n,t)},onBladeOpened:i.noop,addOutputBindings:function(t,i){bf(n,t,i)},removeOutputBindings:function(t){kf(n,t)},configureBladeDescriptor:function(t){t.masterPartId=n.id;t.bindings&&t.bindings.forEach((function(i){i.source&&i.source.id===n.id&&(t.model[i.targetProperty]=f.toJS(ri(n._vm,i.source.property).value))}))},initialViewModelState:f.toJS(this.partState)}},d.prototype.loadState=function(n){var i=this;this.partDefinition&&n&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach((function(t){var r=ri(n,t);r.exists&&!t.startsWith("internal.")&&dt.setModelValue(i._vm,t,r.value)}))},d.prototype._setupLoadingReactor=function(n,t){var r=this,u,i,e;this.partDefinition.partKind!==fi.Provisioning&&(this._frameBlockingUi(ku(this.partDefinition)),this._loadingReactorLifetime=this.createChildLifetime(),f.reactor(this._loadingReactorLifetime,(function(){var i=t.inProgress();n.hasOngoingOperation(i&&!n.locked());r.triggeringLockedBladeSpinner(i&&n.locked())})),u=f.computed(this._loadingReactorLifetime,(function(){return t.blockingUi()||r._frameBlockingUi()||r._contentInitializing()})),this.partDefinition.shareVmWithParentBlade&&(i=ei(this),e=at.getBladeType(i.bladeDefinition),e!==2&&(f.reactor(this._loadingReactorLifetime,(function(){i.shieldType&&i.shieldType(t.shieldType())})),i.uiBlockers.push(u))),u.subscribe(this._loadingReactorLifetime,(function(i){var f=t.shieldType()===1||n.locked(),u;n.isInBlockingLoadingState(i&&!f);i||(u=n.hasOngoingOperation(),r._contentRevealed.resolve(u))})),u()||(this._contentRevealed.resolve(t.inProgress()),n.isInBlockingLoadingState(!1)))},d.prototype._removeOutputArgumentValuesFromContainerModel=function(){var n=this.partDefinition,t=this.containerModel;t&&n&&n.details&&n.details.forEach((function(n){var i=n.outputArguments;i&&i.forEach((function(n){var i=n.valuesFrom;i&&i.forEach((function(n){var i=n.property;ri(t,i).exists&&dt.setModelValue(t,i,undefined)}))}))}))},d.prototype._getPartSettingsManagerConfig=function(n,t){return{services:this.services,part:this,instanceProperties:t,partViewModelId:nr(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:n}},d.prototype._listenForPartMutation=function(){var n=this,r=this.partDefinition,t,u=this._vm.container,i;u.mutate&&!r.shareVmWithParentBlade&&(i=this.createChildLifetime(),u.mutate.subscribe(i,(function(u){var o=n.locator.getExtensionLocator(),f;if(u.partName)t=u.extensionName?yi(u.extensionName).withPartType(u.partName):o.withPartType(u.partName);else{if(f=r.assetTypeDefinition,!f){ti.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(n.locator.toString()));return}t=yi(o.name).withPartType(f.partName)}var e=n.getPartsContainer(),s=e&&e.locator&&e.locator.type===1,h={newPartContainerModel:u.containerModel,preventNewPartActivation:u.preventActivation||s,invoker:"mutation"};n.services.desktop.replacePart(n,t,h).fail((function(i){var r="Unable to replace provisioning part '"+n.locator.toString()+"' with the part for the created asset defined by the locator '"+t.toString()+"'\r\n"+i+".";ti.error(r)})).finally((function(){n._disposeEditScope();i.dispose()}))})))},d.prototype._updateForHasPermissions=function(n){var i=this;return this._vmPromise.then((function(){var r=i._vm,u,f;r===t.EmptyViewModel||i.isDisposed()?ti.warning("Part '{0}' has not retrieved view model when checking permissions.".format(i.locator.toString())):(u=r.container,f=i.widget,n?u.unauthorizedMessage(null):(f&&f.options.isInBlockingLoadingState(!1),u.unauthorized(),r.updatePartForUnauthorized()))}))},d.prototype._getAllInputsSetWatcherConfig=function(){var t=this,f=this.widget,o={bindableTarget:{viewModelName:nr(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:function(n,i){i.finally((function(){t._onInputsSet.resolve();t._contentRevealed.resolve(!1);t._lastRebindOnInputsSetProperties&&(e.isEmptyObject(t._lastRebindOnInputsSetProperties)||at.deepSubset(n,t._lastRebindOnInputsSetProperties))&&f&&f.options.isInBlockingLoadingState(!1)}))},beforeViewModelPropertyUpdate:function(r){if(t.partDefinition.permissions){var u=oi(),f=t.locator.toString();return gt.checkPermissions(t.partDefinition.permissions,rf.All,r,t.partDefinition.assetType,t.extension.name,t.services,f).then((function(r){return t._updateForHasPermissions(r).catch((function(r){t.isDisposed()||i.Errors.isInstanceOfErrorType(r,i.Errors.CanceledError)||h.logToExtension(n,t.widget.element,2,"Part permission check failed. Error: "+i.getLogFriendlyMessage(r))})),r})).finally((function(){t._perfData.checkPermissions=u()}))}return Q(!0)},getInputsMetadata:function(){return Q(yr()).then((function(n){var i=n.getConfigurableInputsMetadata(t);return u.keys(i).forEach((function(n){var t=i[n];(t&&t.bindingSources||[]).forEach((function(n){delete n.sourceReference}))})),i}))},getDashboardFilters:function(){var n=t.parent&&t.getPartsContainer();return n&&n.getFilters?n.getFilters():{}},getPartFilters:function(){return t.filters||{}}};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(o.getStateAsync=function(){return Q(t._partSettingsManager.getPartSettingsAsync()).then((function(n){return t._part&&t._part.partSettingFailed(!1),n}),(function(n){return t._part&&t._part.partSettingFailed(!0),r.QReject("Failed to retrieve part settings for part '"+t+"'.",{innerErrors:n})}))}),o},d.prototype._getAdapterAllInputsSetWatcherConfig=function(){var n=this.adapter;return{bindableTarget:{viewModelName:n.viewModelId},propertyBindings:n.inputPropertyBindings,allInputsSet:n.allInputsSet,calledOnInputsSet:n.calledOnInputsSet,failedOnInputsSet:n.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0}},d.prototype.notifyDetailBladesRehydrated=function(n){!this.isComposed||this.isDisabled||this.isDisposed()||this._bladeOpener.notifyDetailBladesOpened(n)},d.prototype.notifyDetailBladeClosed=function(n){var t=this;i.tryImmediateResolve(this.awaitComposed(),(function(){var r=n.masterCommandName,u=t._vm.container,i;t.isDisabled||t.isDisposed()||!ki(r)||t._bladeOpener.notifyDetailBladeClosed(n);i=u&&u.selectable;i&&!ki(r)&&i.isCommandSelected(!1)}))},d.prototype.beforeActivateCommandMenuItems=function(n){n.isControlContextMenu||this._contextMenuViewModels&&(this._contextMenuViewModels.dispose(),this._contextMenuViewModels=null)},d.prototype._handleRightClick=function(t,r){var u=this,e=r&&r.listData&&r.listData.selectableSet,o,s;this.isDisabled||this.isDisposed()||(e instanceof k.SelectableSet2&&e.commandGroupProvider?(o=f.utils.peekObservable(r.viewModel.data),o&&e.commandGroupProvider(o).then((function(n){var f=i.clone(r,!1,!1);f.viewModel=o;f.commandGroupOwner=n[0].owner;f.commandGroup=n[0].id;u._determineExtensionAndTriggerContextMenu(t,f)}))):(s=k.isSelectableSet2(e)?undefined:e,r.supplyCommands||s&&s._msPortalFxSupplyCommands?bi(this,"./UI.Composition.ContextMenuV2",(function(n){var i={partComposition:u,services:u.services},f=n.OpenContextMenuPipeline.createPipeline(u,i,u);f.startTask({dataItem:r.viewModel,extension:u.extension,contextMenuArgs:r,evt:t})}),n):this._determineExtensionAndTriggerContextMenu(t,r)))},d.prototype._determineExtensionAndTriggerContextMenu=function(t,i){var r=this,f=this.services,u=this.extension,o=function(n){var t=f.finder.locateAsync(yi(n.commandGroupOwner));return t.fail((function(){ti.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(n.commandGroupOwner,n.commandGroup,u.name))})),t},e=function(n,u){r._contextMenuViewModels=n.fireContextMenuEvent(r,f,r,u,t,i,r._showShellCommands,r._bladeOpener)};bi(this,"./UI.Composition.ContextMenuContainer.DemandLoad",(function(n){i.commandGroupOwner&&i.commandGroupOwner!==u.name?o(i).then((function(t){e(n,t)})):e(n,u)}),n)},d.prototype.isSelected=function(){var t=f.unwrap(this._vm.container).selectable,n=f.unwrap(t);return n&&f.unwrap(n.isSelected)},d.prototype.await=function(n){switch(n){case 0:return this._allContentRevealed;case 1:return this._partDefinitionDeferred.promise;case 2:return this._earlyVmDeferred.promise;case 3:return this._allOnInputsSet}return y.prototype.await.call(this,n)},d.prototype.awaitComposed=function(){return this._registrationDeferred.promise},d.prototype.awaitCommandBar=function(){var n=this;return this.await(1).then((function(){var t=ei(n),i=!!(t&&t.bladeDefinition&&t.bladeDefinition.azBlade);return i?n.await(0):n.awaitComposed()}))},d.prototype._createErrorPart=function(n,t,r){var e,s,u;if(this.isDisposed())return Q.reject(new ci);var o=this.locator,a=tt.getPartFactory(wr.getWindowId(o.getExtensionLocator()),{partKind:fi.Error}),h=this.extension,c=kr.composePartViewModel((function(){return r=r||{},r.title=f.observable(o&&o.name),r.subtitle=f.observable(h&&h.name),r})),l=i.getLogFriendlyMessage(t);return this._traceErrorTelemetry(n,l),ti.error("Error composing part '"+this+"'. Details: "+l,1),e=this._savedContainerState,s=c.container,e&&(s.partTitle(e.partTitle),s.assetName(e.assetName)),this._registrationDeferred.reject(t),u=ei(this),u&&u.bladeDefinition&&at.bladeImplementedWithVirtualPart(u.bladeDefinition)&&u.widget.options.loaded(!0),this._createPartWidget(a,c,!0,!0)},d.prototype._createPartWidget=function(n,t,r){var u=this,e,o;return this.isDisposed()?Q.reject(new ci):(e=ei(this),o={size:this.widget.options.size,locator:this.locator,getDebugId:function(){return nr(u)},traceErrorTelemetry:function(n){u._traceErrorTelemetry(ui.TransitionedToErrorState,n)},noFxContentPadding:this.partDefinition&&(this.partDefinition.noFxContentPadding||this.partDefinition.isV2),isVirtualPartForTemplateBlade:!!(e&&e.bladeDefinition&&at.getBladeType(e.bladeDefinition)===1)},r&&this.widget.options.isInBlockingLoadingState(!1),i.tryImmediateResolve(n.createPart(this._partContainer[0],t,o,this.services),(function(n){var i,r,t,e;if(u.isDisposed())return Q.reject(new ci);u._part=n;ku(u.partDefinition)&&n.awaitContentRevealed?(i=n,i.awaitContentRevealed().then((function(){u._frameRevealed.resolve(!0);u._frameBlockingUi(!1)})),i.awaitInitializationComplete().then((function(){u._frameRevealed.resolve(!1);u._frameInitialized.resolve();u._frameBlockingUi(!1)}))):(u._frameRevealed.resolve(!1),u._frameInitialized.resolve());r=u.partDefinition;n.setupContent({extensionWindowId:u.extension&&wr.getWindowId(u.extension),styleSheets:r&&r.styleSheets}).finally((function(){u._contentInitializing(!1)}));f.computed(u,(function(){var n=u.parent,t=n&&n.widget,i=t&&t.options.locked();u.widget&&u.widget.options.locked(i);u._part&&u._part.lockedUiContext(i)}));t=u.widget;e=t&&t.ltm&&t.element;e&&u.resourceLTM().registerForDispose(e.setEvents([v.default.fxerrorpartclicked,function(){u.services.desktop.replacePart(u,u.locator,{newPartContainerModel:u.containerModel,newPartOverridesModel:u.overridesModel,doNotSaveSettings:!0,preventNewPartActivation:!0})},]))})))},d.prototype.loadPropertiesFromJson=function(n,t,i,u){i===void 0&&(i=!1);var e=ii.bindingsFromJSON,f=t.partState;this.assetInstanceDefinition=t.assetInstanceDefinition;this.bindings=u?ur(u,this):e(n,t.bindings)||[];this.initialSize=t.initialSize;this._bindingsInitialized=t.bindingsInitialized;this._restoredFromJson=!0;this.loadFromJson(t);this._savedContainerState=t.savedContainerState;this.containerModel=vt.createContainerModel(t.containerModel);this.overridesModel=vt.createContainerModel(t.overridesModel)||{};this.partState=r.isSerializedObject(f)?r.fromSerializableObject(f):f;i&&wu(this.partState);t.originalPartLocator&&(this.previousLocator=pi.fromJSON(n,t.originalPartLocator));this.flags=t.flags||0;this._adapterBindings=e(n,t.adapterBindings)},d.prototype.calculateInitialSize=function(){var n,h,a,v,i={},c=this.services.finder,f=this.locator,e=f.type,o,t,r,y,p,l,u,s;e===5||e===7?c.tryLocate(f,i)&&(o=i.value,o&&(t=o.inline,r=o.reference,h=t?t.initialSize:r.initialSize,a=t?t.initialWidth:r.initialWidth,v=t?t.initialHeight:r.initialHeight,t?n=t:(y=yi(r.extension||f.getExtensionLocator().name),p=y.withPartType(r.partTypeName),i={},c.tryLocate(p,i)&&(n=i.value)))):e===6?(i={},c.tryLocate(f,i)&&(n=i.value)):ti.error("Unable to create Part composition. Invalid locator type: '{0}'".format(e));this._bindingsInitialized=!1;l=tt.getPartSizeOrDefault(n);u=l;tr.InternalPartSize[h]?u=h:n&&tr.InternalPartSize[n.initialSize]?u=n.initialSize:n&&(s=tt.getPartFactory(this.extension&&this.extension.name,n,{}),u=s&&s.defaultSize!==undefined?s.defaultSize:l);this.initialSize=u;this.initialSize===99&&(this.initialWidth=a||n&&n.initialWidth,this.initialHeight=v||n&&n.initialHeight)},d.prototype.getDiagnosticsData=function(){return e.extend(y.prototype.getDiagnosticsData.call(this),{bindings:ii.mapBindingsToFriendlyObjects(this.bindings)})},d.prototype._getSummaryPartViewModelState=function(){var n=v.default.fxsummarycollapsed,t=e.Event(n);return this.widget.trigger(n,t),t.result},d.prototype._autoOpenSettingsFromSummary=function(){var t=this,n;hf==="true"&&(this._restoredFromJson||(n=this.getPartsContainer(),Q.all([n.getPermissionPromise(),this.awaitComposed()]).then((function(){var u=ri(t._vm,"content.hasSettings"),i,r,e;u.exists&&f.unwrap(u.value)&&(i=ri(t._vm,"content.settingsSelectable"),i.exists&&(r=f.unwrap(i.value),e=n.detailContainers,r&&(e||[]).length<=0&&n.canAutoOpenSettings()&&(t.widget.element.trigger(v.default.fxautosettings,{masterBladeId:n.instanceId,masterPartId:t.instanceId}),r.isSelected(!0))))}))))},d.prototype._getEditScopeIdFromSettings=function(){var n=this._journey,t=n&&n.ambientSettings.getItem(this.journeyPath),i=t&&t.value,r=i&&i.editScope;return r&&r.editScopeId},d.prototype._setupJourneyEditScopeReactor=function(){var n=this.partDefinition,t=this._journey;n&&n.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})},d.prototype._setEditScope=function(){var f=this.partDefinition,t,n,r,e,u;if(f&&f.editScopeType){if(t=this._getEditScopeIdFromSettings(),n=this.editScopeId,t)n(t);else{n(i.getUniqueId());this.services.diContainer.get(rt.EditScopeManager).onEditScopeCreated(n())}r=this.getInputPropertyBindings();e=r.properties.some((function(n){return n.targetProperty===vi}));e||(u={},u[vi]=n,r.mapProperty(vi,vi).bind(this+"-[EditScopeId]",u,!0))}},d.prototype._getCommands=function(){if(!this.isComposed||!this.widget)throw new Error("Part '"+this+"' needs to be composed before retrieving its commands.");var n=this.widget;return n.options.commands},d.prototype._setupPromises=function(){this._onInputsSet=Q.defer();this._contentRevealed=Q.defer();this._allOnInputsSet=Q.all([this._onInputsSet.promise,this._frameInitialized.promise]);this._allContentRevealed=Q.all([this._contentRevealed.promise,this._frameRevealed.promise]).spread((function(n){return n}))},d.prototype._setupBladeRebindingHandlers=function(n){var t=this;if(n&&n.onRebind){var i=function(n){var i,r,u,f,e;if(t._setContainerInputsChanging(!0),t._updateRebindSequenceNumber(),ai.provideContext((function(){t._creationState=ai.getState()}),br.Part,t._getPartContext()),i=t.editScopeId()&&t.services.diContainer.get(rt.EditScopeManager).getStateObservable(t.editScopeId()),r=t.widget,t._onInputsSet.reject(new tu("Part binding canceled due to rebinding for part '"+t+"'")),t._contentRevealed.reject(new tu("Part reveal canceled due to rebinding for part '"+t+"'")),t._setupPromises(),t._hasRebindableInputs&&(u=(t.parent.parent||t.parent).widget,!r||u&&u.options.locked()||r.options.isInBlockingLoadingState(!0),t._lastRebindOnInputsSetProperties=sr(n,t.bindings,1,""+t),t._setupAdaptedInputsReboundReactor()),i&&i()===0)t.services.diContainer.get(rt.EditScopeManager).onEditScopeDisposed(t.editScopeId());t.editScopeId(undefined);t._ensureAdapterAtomicityForBindings();t.bindings.forEach((function(n){if(n.source.scope===si.DetailsContainer){var i=ri(t._vm,n.targetProperty);i.exists&&dt.setModelValue(t._vm,n.targetProperty,undefined)}}));t._vm.container.unauthorizedMessage(null);t.partDefinition.shareVmWithParentBlade?(f=ei(t),f.setInputsSetPromise(t._onInputsSet.promise)):(e=t._getNotFoundMessage(),e(null))},r=function(){t.isComposed&&(t._setEditScope(),t.partDefinition.partKind===fi.ResourceSummary&&t._autoOpenSettingsFromSummary())},u=function(){t._setContainerInputsChanging(!1)};n.onRebind(i,r,u);this.registerForDispose((function(){n.offRebind(i,r,u)}))}},d.prototype._ensureAssetAffinity=function(){var u=this,n=this.parent&&this.getPartsContainer(),t=this.assetType,i=n&&n.assetType,r=this._part.inContainerOfSameAsset;if(!n||!i||!t||i!==t||!f.isObservable(n.assetId))return r(!1);f.computed(this,(function(){var t=n.assetId(),i=u.assetId(),f=t&&i&&it.compareAssetId(t,i);r(f)}))},d.prototype._ensureAdapterAtomicityForBindings=function(){var t=this.adapter,n;t&&(n=[],this.bindings.forEach((function(t){var i=t.source;i.modelType===li&&n.push(i.property)})),n.forEach((function(n){dt.setModelValue(t.viewModel,n,undefined)})))},d.prototype._setupAdaptedInputsReboundReactor=function(){var n=this,t=this.adapter;t&&!t.allOutputsReboundComputed&&(t.allOutputsReboundComputed=f.computed(this,(function(){var r=n.bindings.filter((function(n){var t=n.source.modelType;return t===li||t===di})).every((function(t){var i=n.bindAdaptedInput(t).sourceModel,r=ri(i,t.source.property).value;return f.unwrap(r)!==undefined}));if(r){var i=""+n,u=sr(t.viewModel,n.bindings,li,i),o=sr(t.inputPropertyBindings.targetModel,n.bindings,di,i);n._lastRebindOnInputsSetProperties=e.extend(u,o)}})))},d.prototype._disposeEditScope=function(){var t=this.editScopeId(),n;if(t){this.services.diContainer.get(rt.EditScopeManager).onEditScopeDisposed(t);n=this._journey;n&&n.ambientSettings.removeItem(this.journeyPath)}},d.prototype._setViewStateProperties=function(n,t){var f=this,e=n||[],i=t||[],r,u;i=i.filter((function(n){var t=n.split(".");return t.length>1?(t.pop(),typeof ri(f._vm,t.join(".")).value=="object"):!0}));this._viewStateProperties=e.concatUnique(i);r=this._vm;u=r&&r.container;u&&u.selectable&&(this._viewStateProperties=this._viewStateProperties.concatUnique(of))},d.prototype._registerInvocationProperty=function(n){var i=this,r=this._bladeOpener,t,u=yt.detailsIsPartContainer(n);u&&(t=f.pureComputed((function(){return!i._vm.container.isSelectable()})));r.registerInvocationProperty(n,t)},d.prototype._getNotFoundMessage=function(){var n=this._vm.container;return n.notFoundMessage},d.prototype._traceErrorTelemetry=function(n,t){ir.trace({extension:du(this),source:fu,action:wi.PartErrored,actionModifier:ui[n],name:er(this.locator),data:{details:t},journeyId:this._getTelemetryJourneyId()})},d.prototype._getTelemetryJourneyId=function(){var n=this._journey||this.services.desktop.getActiveJourney();return n&&n.id},d})(vt.Instance);t.Instance=lr;t.prepareContainerModel=or;t.getSerializableContainerModel=ar;t.create=au;t.setBladeOpenerModule=fe;t.setDynamicPartBinderModule=ee;t.inferredReferenceType=-999;t.createOverridesOrContainerModelSourceReference=oe}));
define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","f","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f,e,o){"use strict";function d(n,t){var i=n.parent&&n.getPartsContainer(),f=function(n){if(i&&i.getCompatibleSourceReferences){var t=i.getCompatibleSourceReferences(n);return t&&t[0]}},u,r;return t=t||[],u=n.overridesModel,r=[],t.forEach((function(n){var i=n.name,t;t=o.getModelValue(u,i).exists?null:f(n);r.push(s(n,t))})),r}function a(n){if(n.adapter){var i=v(n),t={},r=y(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===l&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return v(n)}function g(n,t,i){function e(e,s){var y,b,l,v;t&&f.CompositionBinder.turnOnInputsSetSuppressionOn(t);f.CompositionBinder.turnOnInputsSetSuppressionOn(i);try{var k=e.inputs,p=e.settings,d=e.inputsMetadata,w=n.getSettingsModel(),c=n.partDefinition&&n.partDefinition.partState,g=c?(c.inputIdentityProperties||[]).concat((c.sharedProperties||[]).map((function(n){return n.property}))):[],it=r.keys(p);g.forEach((function(n){var r=u.unwrap(o.getModelValue(w,n).value),t=n.startsWith("content.")?n.slice(8):n,i=u.toJS(o.getModelValue(p,t).value);h(i,r)||(o.setModelValue(w,n,i),y=!0);it.remove(t)}));l=a(n);r.keys(l).forEach((function(t){var i=l[t],r=d[t],u=k[t];tt(n,t,i,r.activeBindingSourceName,u)&&(b=!0)}));b&&(n.widgetState.valueHasMutated(),nt(n,n.hasUserInteractedRecently()),n.save())}finally{return v=(y?2:1)|(s?0:4),Q.all([t&&f.CompositionBinder.turnOnInputsSetSuppressionOff(t,v,!0)||Q(),f.CompositionBinder.turnOnInputsSetSuppressionOff(i,v,!0),])}}n.getViewModel().internal.updateConfigFn(e)}function nt(n,t){var i=n.widget;i&&i.element.trigger(e.fxpartinputchanged,{part:n,isUserInteraction:t})}function s(n,t){var r=n,i=n,f=i.targetProperty||r.name,o=!!n.optional,u;return t||(u=i.source&&i.source.property||r.name,t=e.createOverridesOrContainerModelSourceReference(u)),{targetProperty:f,optional:o,source:t,isDynamicBinding:!0}}function v(n){var t=n.parent&&n.getPartsContainer(),i=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,f=function(n){var u,r;return i&&t&&t.getCompatibleSourceReferences&&(r=i.first((function(t){return t.name===n})),r&&(u=t.getCompatibleSourceReferences(r))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},r=n.overridesModel,e=function(n){if(!n||o.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return r&&t&&o.getModelValue(r,t).exists},u={},s=y(n);return s.forEach((function(n){var r=n.targetProperty,o=f(r),t=n.compositionBindingDefinition,i=t&&t.source,s=!e(t)&&i&&(o||[]).first((function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));u[r]={bindingSources:o,activeBindingSourceName:s&&s.name}})),u}function y(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter((function(n){var t=n.targetProperty;return!b.isBladeCallerInput(t)&&t!==p.EditScopeId}))}function tt(n,t,i,r,e){var y=r&&i.bindingSources.first((function(n){return n.name===r})),p,a,b,d,rt,ut,w,it;if(r&&!y){c.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(r,t));return}if(p=n.getInputPropertyBindings(),a=p.properties.first((function(n){return n.targetProperty===t})),y?(rt=i.activeBindingSourceName,y.name!==rt&&(b=!0)):(ut=u.unwrap(o.getModelValue(a.targetModel,a.targetProperty).value),h(u.toJS(e),ut)||(d=!0)),!(b||d))return!1;if(n.adapter){var ft=n.bindings.first((function(n){return n.targetProperty===t})),g=ft&&ft.source,et=g&&g.modelType===l&&g.property;if(et)w=et;else return c.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else w=t;var nt=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),tt=nt.properties.first((function(n){return n.targetProperty===w})),ot=tt.compositionBindingDefinition,st=n.overridesModel,v;if(b){var ht=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,ct=ht.first((function(n){return n.name===w})),lt=y.sourceReference;v=s(ct,lt)}return d&&(o.setModelValue(st,tt.sourceProperty,u.toJS(e)),v=s(ot)),v&&(nt.removeProperty(tt),it=n.adapter?n.adapter.bindings:n.bindings,k(it,ot),f.CompositionBinder.setupPropertyBindings(n,nt,[v],(function(t){return n.bindAgainstOverridesOrContainerModel(t)})),it.push(v),n.adapter&&(p.removeProperty(a),f.CompositionBinder.setupPropertyBindings(n,p,a&&[a.compositionBindingDefinition],(function(t){return n.bindAdaptedInput(t)})))),!0}r.defineProperty(t,"__esModule",{value:!0});var p=i.Base.Constants.BladeParameterNames,w=i.Base.Diagnostics,b=i.ViewModels.Internal,k=i.remove,h=i.deepEquals,c=w.createLog(n),l=9;t.inferInitialBindingsForInputDefinitions=d;t.getConfigurableInputsMetadata=a;t.listenForConfigurationChanges=g}));
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","o","ko","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function e(n,t,u){var e=t.internal,f=r.observableArray([]);f.map(n,(function(n,t){r.ignoreDependencies((function(){o(n,t,e,u)}))}));r.computed(n,e.registeredSelectables,(function(n){n===void 0&&(n={});f.splice.apply(f,[0,f.peek().length].concat(i.keys(n)))})).extend({deferred:!0})}function o(n,i,e,o){var l=o.getBladeOpener(),h={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+i}]}]},c=r.unwrap(e.registeredSelectableOptions),s;c&&(s=c[i],s&&(s.parameterCollector&&u.addCallerBindings(f+"."+i+".parameterCollector.bladeCaller",h,0),h.openInContextPane=s.openInContextPane,h.persistentContextPane=s.persistentContextPane));l.registerInvocationProperty(h,null,n)}var t="internal.registeredSelectables",f="internal.registeredSelectableOptions";n.listenForRegistrationChanges=e})(f||(f={})),f}));
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f","o"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u={pending:"pending"},f=(function(){function n(n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n})(),e=(function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,t){var r=this,i=new f(n&&n.toString(),t),e=this.resolvedCompositions.firstIndex((function(n){return t(n)}));if(e>=0)i.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(i),n)n.onDispose((function(){if(i.deferred.state()===u.pending){i.deferred.reject();var n=r._awaitableCompositions.indexOf(i);n>=0&&r._awaitableCompositions.splice(n,1)}}));return i.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},r.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!0,configurable:!0}),n})();t.CompositionAwaiter=e}));
define("MsPortalImpl/UI/Dashboard/FiltersSerialization",["require","exports","f","o","Fx/Composition/DashboardFilters"],(function(n,t,i,r,u){"use strict";function o(n){return c[n]||l}function b(n){var t=n&&r.keys(n);return!t||t.length===0?undefined:t.reduce((function(t,i){var r=o(i);return t[i]={model:r.toJSON(r.normalizeModel(n[i]))},t}),{})}function k(n){var t=n&&r.keys(n);return!t||t.length===0?undefined:t.reduce((function(t,i){var r=o(i);return t[i]=r.denormalizeModel(r.fromJSON(n[i].model)),t}),{})}function d(n){var t={format:n.format?"local":"utc",granularity:s[n.granularity]};return n.relative?t.relative=""+n.relative.duration+h[n.relative.timeUnit]:t.absolute=n.absolute,t}function g(n){function f(n){var u,t,r;return n=n&&n.trim(),n&&n.length>1?(u=n.slice(-1),t=h.firstIndex((function(n){return n===u})),t!==-1&&(r=parseInt(n.slice(0,n.length-1)),i.isNumeric(r)))?{duration:r,timeUnit:t}:undefined:void 0}function e(n){var t=s.firstIndex((function(t){return t===n}));return t!==-1?t:0}var r={format:n.format==="local"?1:0,granularity:e(n.granularity)},u=n.relative,t;return u?r.relative=f(u):(t=n.absolute,t&&(r.absolute={fromDate:new Date(t.fromDate),toDate:new Date(t.toDate)})),r}function f(n){return{operator:n.operator===1?"notEquals":"equals",values:n.values}}function e(n){return{operator:n.operator==="notEquals"?1:0,values:n.values}}var s,h,c,l;r.defineProperty(t,"__esModule",{value:!0});var a=u.TimeRangeFilter,v=u.LocationFilter,y=u.ResourceGroupFilter,p=u.ResourceTypeFilter,w=u.SubscriptionFilter;t.getFilterProcessors=o;t.serializeFilters=b;t.parseFilters=k;s=(function(){var n=[];return n[0]="auto",n[1]="1m",n[2]="5m",n[3]="15m",n[4]="30m",n[5]="1h",n[6]="6h",n[7]="12h",n[8]="1d",n[9]="7d",n[10]="1mo",n})();h=(function(){var n=[];return n[0]="m",n[1]="h",n[2]="d",n[3]="w",n})();c=(function(){var n=[{filterId:a.filterId,normalizeModel:function(n){return n},denormalizeModel:function(n){return n},toJSON:d,fromJSON:g},{filterId:w.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.subscriptionIds}},denormalizeModel:function(n){return{operator:n.operator,subscriptionIds:n.values}},toJSON:f,fromJSON:e},{filterId:v.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.locations}},denormalizeModel:function(n){return{operator:n.operator,locations:n.values}},toJSON:f,fromJSON:e},{filterId:y.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.resourceGroupIds}},denormalizeModel:function(n){return{operator:n.operator,resourceGroupIds:n.values}},toJSON:f,fromJSON:e},{filterId:p.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.resourceTypes}},denormalizeModel:function(n){return{operator:n.operator,resourceTypes:n.values}},toJSON:f,fromJSON:e},];return n.reduce((function(n,t){return n[t.filterId]=t,n}),{})})();l={filterId:null,normalizeModel:function(n){return n},denormalizeModel:function(n){return n},toJSON:f,fromJSON:e}}));
define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","f","o","a","ko","Fx/Composition/DashboardFilters","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.EditScopeManagement","Fx/Composition/Selectable"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function d(n){return n.chrome&&n.chrome._msPortalFxV2ShellApi()}function ht(n,t,i,r){r=r||{};var u=new rt(n,t,null,r.id,r.isHiddenDashboardPart,r.duringPortalStartup);return u.calculateInitialSize(),u.modelContainsSensitiveData=r.modelContainsSensitiveData,u.containerModel=y.prepareContainerModel(i||{}),u.filters=r.filters,u.overridesModel=y.prepareContainerModel(r.overridesModel||{}),u.openedByContext=i&&i.openedByContext,u.validateBindings(i)||(it.error("Unable to create instance of startboard part '{0}', check log for errors.".format(t.toString())),u.locator.name="##INVALID##"),r.doNotSaveSettings||u.save(),u}r.defineProperty(t,"__esModule",{value:!0});var g=h.Locator,ut=i.Base,ft=ut.Diagnostics,nt=i.Parts.PartKind,et=l.CompositionType,ot=a.CompositionBinder,tt=window.fx.getTimestamp;t.startboardPartName="StartboardPart";t.fxpartfilterschanged="fxpartfilterschanged";var it=ft.createLog(n),st={isClickable:function(){return!0},isSelected:f.observable(!1),value:f.observable({}),onClick:function(){}},rt=(function(n){function h(t,i,r,u,e,o,s){var h=n.call(this,t,i,r,u,null,"StartboardPart")||this;return h.dontSetupWidget=!1,h.partFilterState=f.observable(0),h._lastUserInteraction=0,h.containerModel={},h._store=4,h.openedByContext=s,(e||o)&&(h._dontLoadFilterUpdatingModule=!0),h.awaitComposed().then((function(){h._updatePartFilterState(!h._dontLoadFilterUpdatingModule);h._dontLoadFilterUpdatingModule=!1})),h.await(2).then((function(n){d(n)&&n.content.subscribeAndRun(h,(function(){var t=d(n).updateFilters;t&&t((function(n){return h.updateFilters(n)}))}))})),h}return __extends(h,n),h.fromJSON=function(n,t,i,r){var u=n.diContainer.get(s.ExtensionManagerOptions);return y.createCompositionFromJSON(u,t,(function(){var f=new h(n,g.fromJSON(u,t.locator),t.widgetState,t.id);return f.loadPropertiesFromJson(u,t,!0,i),f._storedEditScopeId=t.editScopeId,f.dontSetupWidget=t.dontSetupWidget,f.defaultMenuItemId=t.defaultMenuItemId,f.containerModel=f.containerModel||{},f.deepLink=t.deepLink,f._dontLoadFilterUpdatingModule=!!r,f.filters=w.parseFilters(t.filters),f}),(function(i,r){var u=new h(n,i,null,t.id);return u.unrecoverableErrorMessage=r,u}))},h.prototype.getCompositionType=function(){return et.StartboardPart},h.prototype.register=function(t,r,u){var f=this,o;n.prototype.register.call(this,t,r,u);var s,h=this.deepLink,e=this._part,c=this.services;h&&(s=i.extend2(e.getSelectable()||st,{onClick:function(){c.router.route(h)}}));e.configure({onStartboard:!0,selectable:s});o=this.editScopeId();o&&this.partDefinition.partKind===nt.Provisioning&&c.diContainer.get(b.EditScopeManager).getStateObservable(o).subscribe(this,(function(n){var t=n===1||n===2;t&&(f.dontSetupWidget=!1,f.addWidgetToUI({parentElement:f.getPartsContainer().widget}))}));e.openPartSettingsBlade=function(n,t){t&&t.stopPropagation();f.openPartSettingsBlade()};this.partFilterState.subscribe(this,(function(n){e.partFilterState(n)}))},h.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.editScopeId=this.editScopeId(),t.dontSetupWidget=this.dontSetupWidget,t.defaultMenuItemId=this.defaultMenuItemId,t.deepLink=this.deepLink,t.filters=w.serializeFilters(this.filters),t},h.prototype.validateBindings=function(n){var r=this,t,i;return this.bindings&&this.bindings.length>0?(t=this.bindings.filter((function(n){return n.source.id!==r.id})),i=t.map((function(n){return n.source.property})),ot.modelHasProperties(""+this,i,n)):!0},h.prototype.matchesLocatorAndModel=function(n,t,r,u,f){return!this.locator.equals(t)&&!this._matchesPartReferenceLocator(n,t)?!1:this.defaultMenuItemId!==u||!i.deepEquals(this.filters||{},f||{})?!1:l.deepSubset(this.containerModel,r||{})},h.prototype.addWidgetToUI=function(t){var r=this,u,f,e,h,l,s;this.dontSetupWidget||(u=this.widget,i.isFeatureEnabled("dashboardfilters")?this.getDashboardFiltering().then((function(n){n.supportsFiltering&&u.options.commands.push(new p.CustomizeTileData(r,r.services));v.composeShellCommands(r,r,u.options.commands,!0,r.services)})):v.composeShellCommands(this,this,u.options.commands,!0,this.services),n.prototype.addWidgetToUI.call(this,t),t.doNotSaveSettings||this.save(),f=u.element,e=this._ltm,f&&e&&(h=this._isFramePart=(this.partDefinition&&this.partDefinition.partKind)===nt.Frame,h||(l=function(n,t,i){return n.addEventListener(t,i,!0),{dispose:function(){n&&(n.removeEventListener(t,i,!0),n=null)}}},s=function(){r._lastUserInteraction=tt()},f&&e&&e.registerForDispose([$(this.services.desktop).setEvents([c.DesktopManagerEvents.bladeClosed,function(n,t){t.masterPartId===r.id&&s()}])].concat([o.default.click,o.default.mousedown,o.default.keydown].map((function(n){return l(f[0],n,s)})))))))},h.prototype.hasUserInteractedRecently=function(){if(this._isFramePart||this._lastUserInteraction+2e3>tt())return!0;var n=this.services.desktop.getActiveJourney(),t=n&&n.children&&n.children[0];return(t&&t.masterPartId)===this.id},h.prototype.save=function(){},h.prototype._forceSave=function(t){n.prototype.save.call(this,t)},h.prototype._getEditScopeIdFromSettings=function(){return this._storedEditScopeId},h.prototype._setupJourneyEditScopeReactor=function(){},h.prototype.getDashboardFiltering=function(){var n=this;return this.await(1).then((function(t){return{supportsFiltering:t.supportsFiltering,staticFilters:t.filters||[],partApi:n.await(2).then((function(n){return d(n)}))}}))},h.prototype.overridesFilter=function(n){return r.keys(this.filters||{}).includes(n)},h.prototype.notifyFiltersChanged=function(n){var t=this;return this.awaitComposed().then((function(){t._setContainerInputsChanging(!0);var i=2|(n?4:0),r=t._setContainerInputsChanging(!1,i),u=t._updatePartFilterState(!t._dontLoadFilterUpdatingModule);return Q.all([r,u])}))},h.prototype._disposeEditScope=function(){var n=this.editScopeId();if(n)this.services.diContainer.get(b.EditScopeManager).onEditScopeDisposed(n)},h.prototype._getBladeOpenerConfig=function(){var t=this,i=n.prototype._getBladeOpenerConfig.call(this),r=function(){var n=t.getPartsContainer().detailContainers;return n&&n.length>0&&n[0]};return i.onBladesOpening=function(){t.isDisposed()&&t.dontSetupWidget&&it.error("Cannot open new blades for part '"+t+"', it has already been disposed and removed from the starboard. If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.")},i.getCloseOwnedDetailBladesHandler=function(n){var u,f=n&&n.source&&n.source.property,i=r();return i&&i.masterPartId===t.id&&i.masterInvocationProperty===f&&!i.masterCommandName&&(u=function(){var n=t.services.desktop,i=n.getActiveJourney();return i?n.tryDiscardJourney(i.id):n.tryDeactivateJourney()}),u},i.getCloseOtherDetailBladesHandler=function(n){var u,f=n&&n.source&&n.source.property,i=r();return i&&(i.masterPartId!==t.id||i.masterInvocationProperty!==f)&&(u=function(){var n=t.services.desktop,i=n.getActiveJourney();return i.isStartedWithContextBlade()?n.tryDiscardJourney(i.id):n.tryDeactivateJourney()}),u},i},h.prototype._updatePartFilterState=function(n){var t=this,i=this.parent&&this.getPartsContainer();return i&&i.getDashboardFiltersForPart(this.id,n).then((function(n){var o=t.filters||{},u,f;n=n||{};var s=0,h=r.keys(o),i=r.keys(n);if(h.length>0||i.length>0)if(h.length===0)s=i.length===1&&i.includes(e.TimeRangeFilter.filterId)?1:2;else{u=[];for(f in o)n[f]&&!t._deepEquals(o[f],n[f])&&u.push(f);s=u.length===0?i.length>1||!i.includes(e.TimeRangeFilter.filterId)?2:1:u.includes(e.TimeRangeFilter.filterId)&&u.length===1?3:4}t.partFilterState(s)}))},h.prototype._matchesPartReferenceLocator=function(n,t){var u=!1,f={},r,i,e,o;return this.locator.type===7&&n.tryLocate(this.locator,f)&&(r=f.value,i=r&&r.reference,i&&(e=i.extension?g.forExtension(i.extension):this.locator.getExtensionLocator(),o=e.withPartType(i.partTypeName),u=t.equals(o))),u},h.prototype.updateFilters=function(n){var r=this.parent&&this.getPartsContainer(),t,i;return r?(u.isArray(n)?t=n.reduce((function(n,t){return n[t.filterId]=t.filterModel,n}),{}):n.dashboard||n.part?(t=n.dashboard,i=n.part):t=n,i&&this._updatePartFilters(i),t)?r.updateFilters(this,t):(this.notifyFiltersChanged(!0),Q()):Q.reject(new Error("Only Parts located on Dashboards can call 'updateFilters'"))},h.prototype._updatePartFilters=function(n){for(var i,e,u=this.filters||{},o=r.keys(n),f=0;f<o.length;f++)i=o[f],e=n[i],e?u[i]=e:delete u[i];this.filters=u;this.widget.element.trigger(t.fxpartfilterschanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()})},h.prototype._getTelemetryJourneyId=function(){return undefined},h.prototype.openPartSettingsBlade=function(){var n=this;this.getViewModel().container.openContextPane(new k.PdlBladeReference("PartSettingsBlade","HubsExtension",{onClosed:function(t,i){if(i){var u={};r.keys(i.filters).forEach((function(n){u[n]=w.getFilterProcessors(n).denormalizeModel(i.filters[n])}));n._updatePartFilters(u);n.notifyFiltersChanged(!1)}},parameters:{partId:this.id}}))},h.prototype._deepEquals=function(n,t){var o=this,u,s,e;if(n=f.unwrap(n),t=f.unwrap(t),n===t)return!0;if(!n||!t||(u=i.getTypeOf(n),u!==i.getTypeOf(t)))return!1;switch(u){case"array":return s=n,n.length!==t.length?!1:s.every((function(n){for(var r=!1,i=0;i<t.length;){if(o._deepEquals(t[i],n)){r=!0;break}i++}return r}));case"date":return n.getTime()===t.getTime();case"object":return e=r.keys(n),e.length===i.keysLength(t)&&e.every((function(i){return o._deepEquals(n[i],t[i])}));default:return!1}},h})(y.Instance);t.Instance=rt;t.create=ht}));
define("MsPortalImpl/UI/UI.DashboardFiltersManager",["require","exports","f","i","o","ko","Fx/Composition/DashboardFilters","Fx/ResourceManagement","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Languages","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";function k(n,t){var r,i,u;if(!t)return!1;r=!1;switch(n){case 0:i=t;r=i.absolute&&!!i.absolute.fromDate&&!!i.absolute.toDate||i.relative&&typeof i.relative.duration=="number"&&typeof i.relative.timeUnit=="number";break;case 1:case 2:case 3:case 5:case 4:u=t;r=typeof u.operator=="number"}return r}function g(n){return i.isNullOrUndefined(d[n])?1:d[n]}function yt(n,t){return{kind:g(n),model:l.getFilterProcessors(n).fromJSON(t.model),displayCache:t.displayCache,filteredPartIds:t.filteredPartIds}}function et(n){var r=n&&n.selectedDisplayLanguage||"",u=n&&n.selectableDisplayLanguages||[],t=i.find(u,(function(n){return n.locale&&n.locale.localeCompareIgnoreCase(r)===0}));return t&&t.specificCulture||"en-us"}function ot(n){var i=n.filterKind;return t.intrinsicFilterDescriptors[i]?t.intrinsicFilterDescriptors[i].filterId:n.filterId}function st(n){return n&&n.operator||0}function ct(n,t){var i=ft(n,t);return i&&o.ArmId.stringify(i,4)}function ft(t,i,r){var f=o.ArmId.parse(t),u;if(f.kind!==4){r||(u=new Error("Invalid resource group id '"+JSON.stringify(t)+"'"),i?v.logToExtension(n,i.widget.element,2,u):vt.error(u));return}return f}var d,ht,p,nt,tt,it,rt,ut,w;u.defineProperty(t,"__esModule",{value:!0});var b=i.Base,lt=b.Diagnostics,at=b.Diagnostics.Telemetry,y=s.Filtering,vt=lt.createLog(n);t.intrinsicFilterDescriptors=(function(){var n=[{kind:0,filterId:e.TimeRangeFilter.filterId,displayText:y.Intrinsics.timeRange},{kind:2,filterId:e.SubscriptionFilter.filterId,displayText:y.Intrinsics.subscription},{kind:3,filterId:e.LocationFilter.filterId,displayText:y.Intrinsics.location},{kind:5,filterId:e.ResourceGroupFilter.filterId,displayText:y.Intrinsics.resourceGroup},{kind:4,filterId:e.ResourceTypeFilter.filterId,displayText:y.Intrinsics.resourceType},];return n.reduce((function(n,t){return n[t.kind]=t,n}),[])})();t.isCompleteFilterModel=k;d=(w={},w[e.TimeRangeFilter.filterId]=0,w[e.SubscriptionFilter.filterId]=2,w[e.LocationFilter.filterId]=3,w[e.ResourceGroupFilter.filterId]=5,w[e.ResourceTypeFilter.filterId]=4,w);t.getFilterKindFromId=g;t.getCultureSpecificLanguage=et;t.getStaticFilterId=ot;t.getOperator=st;ht=(function(){function n(n){var t=this,e,u,o,s,c;this._filtersLocale=f.observable();this._appliedFilters=f.observableArray();this._currentSessionLocale=et(h.currentLocaleContext);this._equalityFilterRuntimes=[];this._parent=n;this._filtersLifetime=n.createChildLifetime();e={getAllSubscriptionsInternal:function(){return Q(r.Azure.getAllSubscriptionsInternal())},getSelectedSubscriptions:a.getSelectedSubscriptions,selectedSubsUpdateTriggered:a.selectedSubsUpdateTriggered};this._equalityFilterRuntimes[1]=new nt;this._equalityFilterRuntimes[2]=new tt(e);this._equalityFilterRuntimes[3]=new it;this._equalityFilterRuntimes[5]=new rt(e);this._equalityFilterRuntimes[4]=new ut;u=f.observableArray([]);o=u.mapInto(n,(function(n,i){var r=f.observable(!1);return b.Promises.cancelOnDispose(t._filtersLifetime,i.getDashboardFiltering()).then((function(n){r(n.supportsFiltering)})),r}));n.subscribeChildren((function(n){u(n.map((function(n){return n})))}));this.filtersWidgetViewModel={showDashboardFilteringUi:f.pureComputed((function(){return!!t._appliedFilters().length||o().some((function(n){return!!n()}))})),appliedFilters:this._appliedFilters,createDashboardFilterViewmodel:function(){return t._createDashboardFilterViewModel({})},getFilterUpdatingApi:function(){return t._getFilterUpdatingApi().then((function(n){return n.filtersWidgetViewModel}))}};u.subscribeArrayBulkChanges(this._parent,(function(n,i){i&&i.length&&i.forEach((function(n){var i=t._appliedFilters.peek();i.forEach((function(t){return t.filteredPartIds.remove(n.id)}))}))}));s=f.pureComputed(u).extend({throttle:100});c=f.pureComputed(this._appliedFilters).extend({throttle:100});f.reactor(this._parent,[s,c],(function(n,r){var u=t._isFilterUpdatingModuleLoadingOrLoaded()?t._getFilterUpdatingApi().then((function(n){return n.getAllFilterDescriptors(!0).then((function(n){return n.map((function(n){return n.filterId}))}))})):(function(){var r=[];return Q.all(n.map((function(n){return t._getPartStaticFilters(n).then((function(n){i.pushUnique(r,n)}))}))).then((function(){return r}))})();return u.then((function(n){t._ensureTimeRangeFilter(n);r.forEach((function(t){var i=t.filteredPartIds&&t.filteredPartIds.length>0||n.includes(t.id());t.isApplicable(i)}))}))}))}return n.prototype.updateFilters=function(n,t){return this._getFilterUpdatingApi().then((function(i){return i.updateFilters(n,t)}))},n.prototype.getFilters=function(){var n=this,t=this._appliedFilters.peek();return t.reduce((function(t,i){var r=i.id(),u=i.model(),f=i.kind(),e=typeof r=="string"&&k(f,u);return e&&(t[r]=n.denormalizeFilterModel(f,u)),t}),{})},n.prototype.loadDashboard=function(n){var t=this,f;this.resetFilters();this._filtersLocale(n&&n.filterLocale||this._currentSessionLocale);var i=n&&n.filters||{},r=u.keys(i),e=r.map((function(n){var r=yt(n,i[n]),f=r.kind,u;if(k(f,r.model))return u=t._createDashboardFilterViewModel({id:n,model:r.model,kind:f,filterIdDisplayText:r.displayCache.name,filterValueDisplayText:r.displayCache.value,filteredPartIds:r.filteredPartIds}),t._activateFilter(u),u})).filter((function(n){return!!n}));(f=this._appliedFilters).push.apply(f,e);at.trace({source:c.Source.DashboardFilters,action:c.Action.DashboardFiltersLoaded,data:{filterIds:r.toString()}})},n.prototype.setFilters=function(n){var t=this,i;this._filtersLifetime||(this._filtersLifetime=this._parent.createChildLifetime());i=u.keys(n).map((function(i){var r=n[i];return t._createDashboardFilterViewModel({id:i,model:t.normalizeFilterModel(r.filterKind,r.filterModel),kind:r.filterKind})}));this._appliedFilters(i)},n.prototype.toJSON=function(){return this._appliedFilters().length?this._getFilterUpdatingApi().then((function(n){return n.toJSON()})):Q({})},n.prototype.getDashboardFiltersForPart=function(n,t){var r=this,u;return t||this._isFilterUpdatingModuleLoadingOrLoaded()?this._getFilterUpdatingApi().then((function(t){return t.getDashboardFiltersForPart(n)})):(u=i.find(this._parent.children,(function(t){return t.id===n})),this._getPartStaticFilters(u).then((function(t){var i=r._appliedFilters.peek().filter((function(i){var r=i.filteredPartIds.includes(n);return r||t.includes(i.id())}));return i.reduce((function(n,t){return n[t.id()]=r.denormalizeFilterModel(t.kind(),t.model()),n}),{})})))},n.prototype.getFilterValues=function(n,t,i){return this._getFilterUpdatingApi().then((function(r){return r.getFilterValues(n,t,i)}))},n.prototype.getFilterIdText=function(n,t){return this._getFilterUpdatingApi().then((function(i){return i.getFilterIdText(n,t)}))},n.prototype.getFilterValueDisplayText=function(n,t,i){return this._getFilterUpdatingApi().then((function(r){return r.getFilterValueDisplayText(n,t,i)}))},n.prototype.getFiltersSupportedByPart=function(n){return this._getFilterUpdatingApi().then((function(t){return t.getFiltersSupportedByPart(n)}))},n.prototype.getFilterWarning=function(n,t){return this._equalityFilterRuntimes[g(n)].getFilterWarning(t)},n.prototype._createDashboardFilterViewModel=function(n){var t=n.model,i=this._filtersLifetime.createChildLifetime();return{id:f.observable(n.id),kind:f.observable(n.kind),kindLifetime:i,model:f.observable(t),isApplicable:f.observable(!0),filterIdDisplayText:n.filterIdDisplayText,operator:st(t),filterValueDisplayText:n.filterValueDisplayText,warningMessage:f.observable(""),filteredPartIds:n.filteredPartIds||[]}},n.prototype._ensureTimeRangeFilter=function(n){var t=this._appliedFilters.peek(),i=t.filter((function(n){return!!n&&n.kind()===0})).first(),r=n.includes(e.TimeRangeFilter.filterId);!i&&r&&b.Promises.cancelOnDispose(this._filtersLifetime,this._getFilterUpdatingApi()).then((function(n){return n.addTimeRangeFilter()}))},n.prototype.resetFilters=function(){this._filtersLifetime&&this._filtersLifetime.dispose();this._filtersLifetime=this._parent.createChildLifetime();this._appliedFilters([])},n.prototype.dispose=function(){this._filtersLifetime&&this._filtersLifetime.dispose()},n.prototype.denormalizeFilterModel=function(n,t){return n===0?t:this._equalityFilterRuntimes[n].denormalizeFilterModel(t)},n.prototype.normalizeFilterModel=function(n,t){return n===0?t:this._equalityFilterRuntimes[n].normalizeFilterModel(t)},n.prototype._activateFilter=function(n){var i=n.kind,r=n.kindLifetime,t=i();t!==0&&this._equalityFilterRuntimes[t].activateFilter(r,n)},n.prototype._normalizeEqualityFilterValue=function(n,t){return this._equalityFilterRuntimes[n].normalizeFilterValue(t)},n.prototype._getFilterUpdatingApi=function(){var n=this;return this._filterUpdatingModulePromise||(this._filterUpdatingModulePromise=i.require("MsPortalImpl/UI/UI.DashboardFiltersManager.Updating").then((function(t){return n._parent.widget&&n._parent.widget.element.attr("data-filterupdatingloaded",!0),new t.DashboardFiltersUpdatingImpl(n._parent,{appliedFilters:n._appliedFilters,getDashboardLifetime:function(){return n._filtersLifetime},activateFilter:function(t){return n._activateFilter(t)},createDashboardFilterViewModel:function(t){return n._createDashboardFilterViewModel(t)},ensureTimeRangeFilter:function(t){return n._ensureTimeRangeFilter(t)},normalizeEqualityFilterValue:function(t,i){return n._normalizeEqualityFilterValue(t,i)}})}))),this._filterUpdatingModulePromise},n.prototype._isFilterUpdatingModuleLoadingOrLoaded=function(){return!!this._filterUpdatingModulePromise},n.prototype._getPartStaticFilters=function(n){return b.Promises.cancelOnDispose(this._filtersLifetime,n.getDashboardFiltering()).then((function(n){return(n.staticFilters||[]).map(ot)}))},n})();t.DashboardFiltersManager=ht;p=(function(){function n(){}return n.prototype.activateFilter=function(){},n.prototype.getFilterWarning=function(){return Q("")},n})();t.EqualityFilterRuntimeBase=p;nt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return n},t.prototype.denormalizeFilterModel=function(n){return n},t.prototype.normalizeFilterValue=function(n){return n},t})(p);t.EqualityFilterRuntime=nt;tt=(function(n){function t(t){var i=n.call(this)||this,r;return i._subscriptions=t,r=l.getFilterProcessors(e.SubscriptionFilter.filterId),i._normalizeFilterModel=r.normalizeModel,i._denormalizeFilterModel=r.denormalizeModel,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.activateFilter=function(n,t){var i=this;f.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){return i.getFilterWarning(t.model()).then((function(n){t.warningMessage(n)}))}))},t.prototype.normalizeFilterValue=function(n){return n.toLowerCase()},t.prototype.getFilterWarning=function(n){return Q(this._subscriptions.getSelectedSubscriptions().then((function(t){var i=!n.values.some((function(n){return!t.some((function(t){return t.subscriptionId.toLowerCase()===n.toLowerCase()}))}));return i?"":y.Subscription.subscriptionFilterUsingExcludedSubscriptions})))},t})(p);t.SubscriptionFilterRuntime=tt;it=(function(n){function t(){var t=n.call(this)||this,i=l.getFilterProcessors(e.LocationFilter.filterId);return t._normalizeFilterModel=i.normalizeModel,t._denormalizeFilterModel=i.denormalizeModel,t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.normalizeFilterValue=function(n){return n},t})(p);t.LocationFilterRuntime=it;rt=(function(n){function t(t){var i=n.call(this)||this,r;return i._subscriptions=t,r=l.getFilterProcessors(e.ResourceGroupFilter.filterId),i._normalizeFilterModel=r.normalizeModel,i._denormalizeFilterModel=r.denormalizeModel,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.activateFilter=function(n,t){var i=this;f.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){i.getFilterWarning(t.model()).then((function(n){t.warningMessage(n)}))}))},t.prototype.getFilterWarning=function(n){return Q(this._subscriptions.getSelectedSubscriptions().then((function(t){var i=!n.values.some((function(n){var i=ft(n),r=i.subscription;return!t.some((function(n){return n.subscriptionId.toLowerCase()===r.toLowerCase()}))}));return i?"":y.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions})))},t.prototype.normalizeFilterValue=function(n,t){return ct(n,t)||n},t})(p);t.ResourceGroupFilterRuntime=rt;ut=(function(n){function t(){var t=n.call(this)||this,i=l.getFilterProcessors(e.ResourceTypeFilter.filterId);return t._normalizeFilterModel=i.normalizeModel,t._denormalizeFilterModel=i.denormalizeModel,t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.normalizeFilterValue=function(n){var r=n.resourceType,t=n.resourceKind,i={resourceType:r.toLowerCase()};return t&&(i.resourceKind=t.toLowerCase()),i},t})(p);t.ResourceTypeFilterRuntime=ut;t.normalizeResourceGroupId=ct;t.parseResourceGroupId=ft}));
define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/UI.DashboardFiltersManager","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt){"use strict";function et(n){return n!==s.desktopSettingsKey&&n!==s.startBoardSettingsKey&&!i.startsWith(n,p.partIdentityStatePrefix)}function at(n){var t=new it(n);return t.save(),t}function vt(n,t,i){var f=r.keys(t).filter(et).map((function(i){return b.Instance.fromJSON(n,t[i])})),u=new it(n,f,i.widgetState);return u.logChildren(),u.loadFromJson(i),u}function yt(n,t){var i=[],r=new d.EnterOrganizeMode(n,t,!0);return r.text(o.Dashboard.edit),i.push(new d.ResetStartBoardCommand(n,t),r,new d.ExitOrganizeMode(n,t)),i}var it;r.defineProperty(t,"__esModule",{value:!0});var ot=i.Base,rt=ot.Diagnostics,st=rt.Telemetry,ht=i.Parts,ct=l.CompositionType,lt=w.ReferenceScope,ut=rt.createLog(n),ft=l.getIdMatchFunc;t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=et;it=(function(n){function o(t,r,f){var e=n.call(this,"Startboard",t,null,r,f,s.startBoardSettingsKey)||this;return e._partAwaiter=new v.CompositionAwaiter(!0),e._containerAwaiter=new v.CompositionAwaiter,e.masterContainer=null,e.detailContainers=[],e.notFound=u.observable(!1),e._store=4,i.isFeatureEnabled("dashboardfilters")&&e.registerForDispose(e.dashboardFiltersManager=new k.DashboardFiltersManager(e)),e}return __extends(o,n),o.prototype.getCompositionType=function(){return ct.Startboard},o.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},o.prototype.removeGetDashboard=function(){this._getDashboard=null},o.prototype.getDashboard=function(){var n=this._getDashboard;return n?n():null},o.prototype.onDetailContainersChanged=function(){},o.prototype.getDeepLink=function(){return Q("")},o.fromJSON=function(n,t,i){var r=n.diContainer.get(e.ExtensionManagerOptions);return y.createCompositionFromJSON(r,i,(function(){return vt(n,t,i)}),(function(t,i){var r=new o(n);return r.unrecoverableErrorMessage=i,r}))},o.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),r=this._getDashboard?this._getDashboard():null,f;return r&&(t.dashboardId=r.id,t.dashboardTitle=r.title,f=r.model,t.dashboardModel=f?{model:u.toJS(f.model),metadata:i.clone(f.metadata,!0)}:undefined),delete t.children,t},r.defineProperty(o.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),o.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},o.prototype.getViewModel=function(n){var r,t;if(n=i.isNullOrUndefined(n)?8:n,n===8){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");r=t.model}return r||{}},o.prototype.getViewModelAsync=function(n){return Q(this.getViewModel(n))},o.prototype.getCompatibleSourceReferences=function(n){var u=this._getDashboard&&this._getDashboard().model,t=u&&u.metadata,i,f;return t&&(i=n.type,i)?(f=r.keys(t).filter((function(n){var r=t[n];return r===i})),f.map((function(n){return{property:n,modelType:8,scope:lt.CurrentContainer,cardinality:w.ReferenceCardinality.OneToOne}}))):null},o.prototype.logChildren=function(){this.children.forEach((function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?ht.InternalPartSize[t.NormalState.size]:"";st.trace({extension:n.locator.getExtensionLocator().name,source:h.Source.StartBoardPart,action:h.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})}))},o.prototype.getFilters=function(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()},o.prototype.updateFilters=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(n,t)||Q()},o.prototype.getDashboardFiltersForPart=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getDashboardFiltersForPart(n,t)||Q({})},o.prototype.getFilterIdsForPart=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFiltersSupportedByPart(n)},o.prototype.setFilters=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(n)},o.prototype.getPartInstance=function(n){return i.find(this.children,(function(t){return t.id===n}))},o.prototype._compose=function(n,r){var s=this,f=new g.ViewModel(this.id,this.widgetState(),this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel,this.services.diContainer),o=this.services,e=this.createChildLifetime();u.utils.arrayPushAll(f.commands,yt(e,this.services));var p=f.addPartsCommand=i.find(f.commands,(function(n){return n.commandName===d.CommandNames.EnterOrganizeMode})),w=f.newCommand=new d.NewDashboard(e,o),b=f.cloneCommand=new d.CloneDashboard(e,o),k=f.filterCommand=new d.FilterDashboard(e,o,this),it=f.fullscreenCommand=new d.FullscreenDashboard(e,o),rt=f.deleteCommand=new d.DeleteDashboard(e,o),et=f.shareCommand=new d.ShareDashboard(e,o),ot=f.browseCommand=new d.OpenBrowseDashboardsPane(e,o),st=f.uploadCommand=new d.UploadDashboard(e,o),ht=f.downloadCommand=new d.DownloadDashboard(e,o),a=this._getDashboard?this._getDashboard().title:null;a&&f.title(a);var v=this.widget=new g.Widget(n.getStartBoardArea(),f),h=v.element,y=function(n,t){n.bind(new c.CompositionInstanceCommandContext(h.findByClassName(t)[0],null,s))};y(p,g.widgetClass+"-title");[[w,"new"],[b,"clone"],[k,"filter"],[it,"fullscreen"],[rt,"delete"],[et,"share"],[ot,"browse"],[st,"upload"],[ht,"download"],].forEach((function(n){var t=n[0],i=n[1];y(t,g.headerButtonClass+"-"+i)}));h.data(l.CompositionInstanceDataName,this);v.ltm.registerForDispose([e,h.setEvents([nt.Widget.viewSettingsChanged,function(n,i){n.stopPropagation();s.widgetState(i);h.trigger(t.fxstartboardsettingchanged)},],[tt.default.fxunpin,function(n,t){var r=s.children.first(ft(t.tileId)),f;if(r){var e=s.widget,u=e.getDomOrderedChildren(),i=u.indexOf(t.tileId);i=i===0?1:i-1;i=i>=u.length?-1:i;f=i!==-1?s.children.first(ft(u[i])):null;ut.warning("Part '{0}' is about to be removed due to user unpin operation.".format(r));s.services.desktop.removeTile(r.id);setTimeout((function(){f?f.widget.setFocus():e.setFocus()}),50)}},]),]);r.resolve()},o.prototype.matchesLocatorAndModel=function(){return!1},o.prototype.resetLayout=function(){this.services.desktop.resetStartBoard()},o.prototype.dispose=function(){ut.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.call(this,!0)},r.defineProperty(o.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),o.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},o.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},o.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},o.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},o.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},o.prototype.onInvocationStarted=function(){},o.prototype.getDiagnosticsData=function(){return f.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map((function(n){return n+""}))})},o})(a.Instance);t.Instance=it;t.create=at}));
define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",["require","exports","f","o","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/Dashboard/Common/DashboardHelperContainer","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o,s){"use strict";function y(n){var i=r.keys(n);if(i.length>=100)throw new Error("There are no more dashboard stores available.");for(var f=i.map((function(t){return n[t].storeName})),u=0,t=b(u);f.indexOf(t)>-1;)t=b(++u);return t}function k(n,t){for(var u=t||w,o=r.keys(n).map((function(t){return n[t].title.toLowerCase()})),s=function(n){return o.indexOf(n.toLowerCase())>=0},f=function(n){return n<=1?u:u+" ("+n+")"},e=1,i=f(e);s(i);)i=f(++e);return i}function d(n,t,i,r){var u=r.settings[s.startBoardSettingsKey];u.dashboardId=i;n.setSetting(c(t),i,r);n.setSetting(h,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function g(n,t){return n[t]&&n[t].storeName}function nt(n){return!!c(n)}function tt(n){return n.queryStore(h).then((function(n){return n||{}}))}var l;r.defineProperty(t,"__esModule",{value:!0});var it=i.Base,rt=it.Diagnostics,a=f.Dashboard,ut=rt.createLog(n),v="recentDashboards",p=10,h=11,w=a.defaultTitle,b=e.getDashboardStoreName,c=e.getDashboardStoreId,ft=i.forEachKey;t.buildNextStoreName=y;t.createDashboardTitle=k;l=(function(){function n(n,t){this._settingsManager=n;this._dashboardHelper=t}return n.prototype.getTypeName=function(){return 2},n.prototype.createDashboard=function(n){var r=this,t=n.extras&&n.extras.id||this._dashboardHelper.newId(),i={id:t,title:n.title,settings:n.settings};return this._getDashboards().then((function(n){return d(r._settingsManager,y(n),t,i),i}))},n.prototype.readDashboard=function(n,t){var r=this;return this._getDashboards().then((function(u){var f=g(u,n);if(f)return r._settingsManager.querySetting(c(f),n);if(t)throw new i.Errors.Error("Attempted to read dashboard '"+n+"', but the dashboard store '"+f+"' was undefined.");}))},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n,!1).then((function(u){if(u){var f={};return i.shallowCopyFromObject(f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then((function(t){var i=g(t,n)||y(t);return d(r._settingsManager,i,n,f),f}))}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})}))},n.prototype.deleteDashboard=function(n){var t=this._settingsManager;return tt(t).then((function(i){var f=i[n],u,e,o;u=f?f.storeName:r.keys(i).filter(nt).first((function(t){return(i[t]||{}).id===n}));u&&t.deleteSettings({store:c(u),keys:[n]});e=u&&i[u]&&i[u].id===n;o=e?[u,n]:[n];t.deleteSettings({store:h,keys:o});t.flushSettings()}))},n.prototype.readDashboards=function(){return this._getDashboards().then((function(n){return r.keys(n).map((function(t){return n[t]}))}))},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return a.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then((function(n){return r.keys(n).length<100}))},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:a.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(h,v).then((function(n){var t=(n||[]).slice(0,p).filter((function(n){return!!n.id}));return i.unique(t,(function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()}))}))},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.id.toLowerCase()}));return u===0?r:(u>0&&r.splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,p),t._settingsManager.setSetting(h,v,r),r)}))},n.prototype.removeFromRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.toLowerCase()}));return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(h,v,r)),r}))},n.prototype.createDefaultDashboard=function(n){var i=this,t;return t=n?Q(n):this._getDashboards().then((function(n){return k(n)})).catch((function(n){return ut.error(n,0,"Failed to generate a dashboard title with index."),w})),t.then((function(n){var t=i._dashboardHelper.newId();return{id:t,title:n}}))},n.prototype._getDashboards=function(){var n=this;return tt(this._settingsManager).then((function(t){return ft(t,(function(t,i,r){if(i){var u;n._dashboardHelper.isOfType(t)?(u=i,r[u.id]=u):nt(t)&&(u=i,r[u.id]||(r[u.id]=u))}}),{})}))},n})();l=__decorate([u.Class(),__metadata("design:paramtypes",[e.SettingsManager,o.PrivateHelper])],l);t.PrivateDashboardRepository=l}));
define("MsPortalImpl/UI/Dashboard/Common/DashboardRepositoryContainer",["require","exports","i","o","FxInternal/Di","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository","MsPortalImpl/UI/Dashboard/Common/DashboardHelperContainer","MsPortalImpl/AsyncLoader"],(function(n,t,i,r,u,f,e,o){"use strict";r.defineProperty(t,"__esModule",{value:!0});var s=(function(){function n(n,t,i){var r={},u=[],e=function(){return i.getAsync(o.get("MsPortalImpl/UI/Dashboard/ArmDashboardRepository","ArmDashboardRepository"))},s=function(){return i.getAsync(o.get("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository","RecommendedDashboardRepository"))},h=function(){return Q(n)},f;r[1]=e;r[2]=h;r[3]=s;u.push(h);u.push(e);u.push(s);t.isEnabled("addsessiondashboardrepository")&&(f=function(){return i.getAsync(o.get("MsPortalImpl/UI/Dashboard/SessionDashboardRepository","SessionDashboardRepository"))},r[4]=f,u.push(f));this._dashboardRepositoryMap=r;this.dashboardRepositoryArray=u}return n.prototype.getRepository=function(n){var t=n&&this._dashboardRepositoryMap[n];return t&&t()||Q(null)},n})();s=__decorate([u.Class(),__metadata("design:paramtypes",[f.PrivateDashboardRepository,i.Features,u.Container])],s);t.DashboardContainer=s}));
define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function ft(n,t,i){var v=i[d],p=v.widgetState,w=p.NormalState.layoutSettings.positions,u=w.first((function(n){return n.id===t})),l,e;if(!u)return k.warning("Cannot compress part '"+t+"', because it does not have position in startboard."),null;var r=i[t],o=f.toJS(rt(r.containerModel)),b=f.toJS(rt(r.overridesModel)),h=(r.adapterBindings||r.bindings||[]).map((function(n){var t=n.source,e=t&&t.property,s=n.targetProperty,r=t&&t.modelType,u,i,h,l;if(a.isDynamicBindingWithNonLocalSource(n)){if(r!==8)return k.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(s,c.referenceTypeMap[r]||r)),null;u={name:s,binding:e}}else i=void 0,h=a.getModelValue(b,e),h.exists?i=f.unwrap(h.value):r===5?i=t.constantValue:(l=a.getModelValue(o,e),l.exists&&(i=f.unwrap(l.value))),u={name:s,value:i};return!n.optional||(u.isOptional=!0),u}));if(h.firstIndex((function(n){return!n}))>=0)return null;l=o[c.PartContainerModelIdProperty];e={};e[c.PartContainerModelIdProperty]=l;var nt=s.Locator.fromJSON(n,r.locator),tt=y.buildIdentitySettingKey(nt,e),it=i[tt]||undefined,ut=ot(r.locator),ft=ht(r.partState),et=lt(r.assetInstanceDefinition);return{position:{x:u.position.col,y:u.position.row,colSpan:g(u.colSpan),rowSpan:g(u.rowSpan)},metadata:{inputs:h,type:ut,settings:it,isAdapter:r.adapterBindings?!0:undefined,viewState:ft,asset:et,defaultMenuItemId:r.defaultMenuItemId,filters:r.filters}}}function et(n,t,i,u,e){var h=t.metadata,d=st(h.type),rt=ct(h.viewState),ut=at(h.asset),g=p.getDefaultSize().name,ft={NormalState:{size:g}},v={},nt;v[c.PartContainerModelIdProperty]=f.observable(i);var b=s.Locator.fromJSON(n,d),et=l.createIdentifier(c.CompositionType.StartboardPart,b,u),ot=b.name.startsWith(o.PinPrefix),w={locator:d,partState:rt,assetInstanceDefinition:ut,initialSize:g,widgetState:ft,id:et,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:h.defaultMenuItemId,childSettings:{},children:[],containerModel:undefined,overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined,filters:h.filters},k=[];return h.inputs.forEach((function(n){var t=n.name,i,r=n.binding,u,f;r?i={property:r,modelType:8,cardinality:tt.OneToOne,scope:it.CurrentContainer}:(u=n.value,i={property:t,constantValue:u,modelType:5,cardinality:tt.OneToOne,scope:it.CurrentContainer},ot&&t.startsWith(o.collisionPrefix)&&(f=t.split(".")[1],a.setModelValue(v,f,u)));k.push({source:i,targetProperty:t,optional:!!n.isOptional,isDynamicBinding:r?!0:undefined})})),w.containerModel=r.toSerializableObject(v),h.isAdapter?w.adapterBindings=k:w.bindings=k,h.settings&&(nt=y.buildIdentitySettingKey(b,v),e(nt,h.settings)),w}function ot(n){var i=encodeURIComponent,r=[],t=n,u,f;do u=i(s.LocatorTypeMap[t.type]),f=[u,i(t.name)],r.unshift(f.join("/")),t=t.parent;while(t);return r.join("/")}function st(n){var r=decodeURIComponent,u=[],i=[],t;return n.split("/").forEach((function(n,t){i.push(n);t%2==1&&(u.push(i),i=[])})),u.forEach((function(n){var e=r(n.pop()),i=n.pop(),f=i.match(/\[(.*?)\]/),u;f&&(i=i.substring(0,i.lastIndexOf(f[0])));i=r(i);u={name:e,type:s.LocatorTypeMap[i]};t&&(u.parent=t);t=u})),t}function ht(n){n=r.isSerializedObject(n)?r.fromSerializableObject(n):n;var f=u.keys(n).filter((function(n){return n!=="container"&&n!=="internal"})),t={};return i.shallowCopyFromObject(t,n,f),ut(t)?undefined:t}function ct(n){return r.toSerializableObject(n||{})}function lt(n){return ut(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function at(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function vt(n){if(!n)return undefined;var t=n.model,r=n.metadata,i={};return u.keys(t).forEach((function(n){i[n]={value:t[n],type:r[n]}})),i}function yt(n){if(!n)return undefined;var t={},i={};return u.keys(n).forEach((function(r){var u=n[r];t[r]=u.value;i[r]=u.type})),{model:t,metadata:i}}u.defineProperty(t,"__esModule",{value:!0});var tt=a.ReferenceCardinality,it=a.ReferenceScope,rt=l.createContainerModel,ut=i.isEmpty,k=i.Base.Diagnostics.createLog(n),d=w.startBoardSettingsKey,g=function(n){return Math.min(Math.max(n,1),25)},nt=(function(){function n(n){this.compress=function(t){var i=t.settings,r=t.title,f=u.keys(i).filter((function(n){return v.isStartboardPartKey(n)})).map((function(t){return ft(n,t,i)})).filter((function(n){return!!n}));return{title:r,model:vt(i[d].dashboardModel),parts:f}};this.uncompress=function(t,r,u,f){var e={},o=[];r.parts.forEach((function(t,r){var l=u?u(r):i.getUniqueId(),a=f?f(r):undefined,h=et(n,t,l,a,(function(n,t){e[n]=t})),s,c;e[h.id]=h;s=t.position;c={id:h.id,colSpan:g(s.colSpan),rowSpan:g(s.rowSpan),position:{col:s.x,row:s.y}};o.push(c)}));try{var s=b.validateGrid(o),c=s.success,h=s.result;c||k.warning("Part '"+h.misplacedPart+"' is misplaced and overlaps with '"+h.overlappedParts.join(", ")+"'.")}catch(l){k.error(l,1)}var a={NormalState:{layoutSettings:{positions:o}}},v=yt(r.model),y={id:d,childSettings:{},locator:null,errorMessage:undefined,widgetState:a,dashboardId:t,dashboardTitle:r.title,dashboardModel:v};return e[d]=y,{id:t,title:r.title,settings:e}}}return n})();nt=__decorate([e.Class(),__metadata("design:paramtypes",[h.ExtensionManagerOptions])],nt);t.DashboardCompressor=nt}));
define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Telemetry","MsPortalImpl/Extension/ExtensionManagerOptions","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Dashboard/Common/DashboardHelperContainer","MsPortalImpl/UI/Dashboard/Common/DashboardRepositoryContainer","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct){"use strict";function si(n){var r=n||{},u=r.model,f=r.metadata;return{model:i.extend2(t.defaultDashboardModelJson.model,u),metadata:i.extend2(t.defaultDashboardModelJson.metadata,f)}}function vt(n,t,i){return new dt(n,t||new Error,i)}function pi(n){var t=n.services,i=t.diContainer,r=new ii(t);return new ri(i,i.get(ct.PrivateDashboardRepository),t.desktop.portalWidget.getTopBarWidget(),n.lifetime,r,i.get(ht.DashboardCompressor))}function hi(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function gt(n,t){return hi(n)===hi(t)}function ni(n){return wt.start({source:c.Source.Dashboard,action:n,actionModifier:wt.ActionModifier.Start})}function ci(n,t,i,r){var u=i.id;return Q.allSettled(r.children.map((function(n){return Q(n.awaitComposed()).then((function(){return n.await(3)})).then((function(){return n}),(function(){return n}))}))).then((function(i){wt.completeTrace(n,{success:!0,dashboardId:u,parts:i.map((function(n){var t=n.value;return{name:t.locator.toFriendlyString(),deepLink:t.deepLink,visible:b.isElementFullyInViewport(t.widget.element[0]).fullyVisible}})),interactionSource:t})}))}function li(n){var t=n&&n.widgetState||{};return t.NormalState&&t.NormalState.layoutSettings||{}}function wi(n,t){var r={},e=t[w.startBoardSettingsKey],o=li(e),s=[];return u.keys(t).filter(ut.isStartboardPartKey).forEach((function(u){var e=t[u],a=v.Locator.fromJSON(n,e.locator),y=nt.createContainerModel(e.containerModel),tt=rt.buildIdentitySettingKey(a,y),b=f.toJS(y),p,h,w,k,d,c,l;b[g.PartContainerModelIdProperty]=i.getUniqueId();p=ti(b);e.containerModel=it.getSerializableContainerModel(p,!1);h=nt.createIdentifier(g.CompositionType.StartboardPart,a);e.id=h;r[h]=e;w=t[tt];w&&(k=rt.buildIdentitySettingKey(a,p),r[k]=w);e.flags&2&&(d=v.Locator.fromJSON(n,e.originalPartLocator),c=rt.buildIdentitySettingKey(d,y),t[c]&&(r[c]=t[c]));l=(o.positions||[]).first((function(n){return n.id===u}));l&&(l.id=h,s.push(l))})),o.positions=s,r[w.startBoardSettingsKey]=e,JSON.parse(JSON.stringify(r))}function bi(n){var r=n&&n.relative,f=n&&n.absolute,t="",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case 3:i===1&&(t=kt.pastWeek);break;case 1:i===1?t=kt.pastHour:i===24&&(t=kt.past24Hours)}}else f&&(t=kt.custom);return t}function ki(n){var t=n&&n.model&&n.model.model;return t&&t.timeRange}function pt(n,t,i){t&&h.updateDashboardUri(n,t.id,i)}function lt(n,t){n._startboard.widget.options.loading(t)}var dt,ii,ri;u.defineProperty(t,"__esModule",{value:!0});var ui=i.Base,ai=i.Composition.Configuration,wt=ui.Diagnostics.Telemetry,vi=window,bt=vi.fx,at=ui.Diagnostics.createLog(n),yi=10,yt=s.Dashboard,kt=s.Filter.Option,ti=tt.CompositionBinder.createObservableModel,fi="create",ei="clone",oi="unpublish";t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:1}}},metadata:{timeRange:ai.TimeRangeValueType}};t.backfillDashboardModel=si;dt=(function(n){function t(t,i,r){return n.call(this,{code:t,data:r||{},message:i.message,stack:i.stack,innerErrors:i})||this}return __extends(t,n),t})(i.Errors.Error);dt.TypeName="MsPortalImpl.UI.DashBoardError";t.create=pi;t.isSameDashboard=gt;t.startTrace=ni;ii=(function(){function n(n){this._diContainer=n.diContainer;this._redirectMap=this._diContainer.get(a.RedirectMap);this._desktopManager=n.desktop;this._settingsManager=n.diContainer.get(p.SettingsManager);this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var s=this,f={},r=n.toJSON(),t=n.children.filter((function(n){return!n.dontSetupWidget&&!n.isDisposed()})),o=n.widget.getDomOrderedChildren(),u;return t.length!==o.length&&at.error("There should be the same number of composed parts to save ("+t.length+") as the number of positioned elements in the layout ("+o.length+"). The settings will be incorrect."),u=[],o.forEach((function(n){var r=i.remove(t,(function(t){return t.id===n}));if(r.length!==1){at.error("There should be a composed part with ID '"+n+"' yet none was found. The saved content will be incorrect. The settings will be incorrect.");return}u.push(s.getPartSettings(r[0]))})),t.length>0&&t.forEach((function(n){at.error("Part '"+n.id+"' should have a position defined in the layout, yet none was found. The settings will be incorrect.");u.push(s.getPartSettings(n))})),Q.allSettled(u).then((function(t){return t.forEach((function(n){e.extend(f,n.value)})),n.dashboardFiltersManager&&n.dashboardFiltersManager.toJSON().catch((function(){return at.error("Failed to get part filters information."),r.dashboardModel.model}))})).then((function(n){return n&&(r.dashboardModel.model.filterLocale=n.filterLocale,r.dashboardModel.model.filters=n.filters),f[w.startBoardSettingsKey]=r,JSON.parse(JSON.stringify(f))}))},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then((function(){var o;if(n.isDisposed())return{};var s={},r=n.toJSON(),u=n.containerModel;return u[g.PartContainerModelIdProperty]||(o=f.toJS(nt.createContainerModel(r.containerModel)),o[g.PartContainerModelIdProperty]=i.getUniqueId(),u=ti(o),r.containerModel=it.getSerializableContainerModel(u,!1)),s[r.id]=r,t.getPartIdentitySettings(n,u).then((function(n){return e.extend(s,n)}))})).catch((function(t){return at.error(t,8,"part: '"+n.id+"'."),{}}))},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=rt.buildIdentitySettingKey(n.locator,t),Q(n.getPartSettingsManager().getStartboardPartIdentitySettings()).then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return at.error(t,9,"Failed to get part '"+n.id+"' identify settings for key '"+i+"'."),{}})))},n.prototype.clearStartboard=function(n,t){var i=this._desktopManager;n.dashboardFiltersManager&&n.dashboardFiltersManager.resetFilters();n.children.filter((function(n){return!n.dontSetupWidget})).forEach((function(n){return i.removeTile(n.id,{force:!0,skipSave:t})}))},n.prototype.renderStartboard=function(n,t,r,f){var s=this,a=r.delayRendering,e=u.keys(t),y={},p=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},b=e.filter((function(n){return i.startsWith(n,rt.partIdentityStatePrefix)})),o,h;return this._settingsManager.setSettings({store:13,settings:p(t,b)}),o=t[w.startBoardSettingsKey],n.widget.options.applyViewSettings(o.widgetState),e=e.filter((function(n){return ut.isStartboardPartKey(n)})),h=[],e.forEach((function(i){var u=t[i],r,f,e;try{r=v.Locator.fromJSON(s._diContainer.get(l.ExtensionManagerOptions),u.locator)}catch(o){at.error("Error deserializing locator for part setting.\r\nError:'"+o+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")}r&&(f=r.getExtensionLocator(),(r.type===6||r.type===5&&r.parent&&r.parent.type===2&&r.parent.parent&&r.parent.parent.type===1)&&(e=n.services.extensionManager.on("assetTypes").then((function(){var h=r.type===6?v.Locator.forPartTypeRedirect(s._redirectMap,f.name,r.name):v.Locator.forPartInstanceRedirect(s._redirectMap,f.name,r.name,r.parent.parent.name,r.parent.name),e={},t,o;n.services.finder.tryLocate(h,e)&&(t=e.value,y[i]=t.bindings,f=t.toExtension?v.Locator.forExtension(t.toExtension):f,o=f.withPartType(e.value.toPart),u.originalPartLocator=u.locator,u.flags||(u.flags=0),u.flags|=2,u.locator=o.toJSON(),wt.trace({source:c.Source.Dashboard,action:c.Action.Redirect,name:r.toFriendlyString(),data:{to:o.toFriendlyString()}}))})).catch((function(n){at.error("Error locating or applying part redirect.\r\nError: '"+n+"'\r\nKey: '"+i+"'\r\nStack: "+(n&&n.stack))})),h.push(e)))})),n.dashboardFiltersManager&&n.dashboardFiltersManager.loadDashboard(o&&o.dashboardModel&&o.dashboardModel.model),Q.all(h).then((function(){var i=[];e.forEach((function(u){var o=t[u],e=ft.Instance.fromJSON(n.services,o,y[u],f),s=e.locator.getExtensionLocator(),h=n.services.extensionManager.getExtension(s.name);(h||!r.isDefault)&&i.push(e)}));i.length&&(n.addChildren(i),a||i.forEach((function(t){t.compose(n.widget)})));a||(n.discardWidgetStateOfUnusedChildren(),n.save())}))},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;this._diContainer.get(et.DesktopManagerMode).value(1);n&&t.portalWidget.options.sideBarViewModel.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded()},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,r){r===void 0&&(r=i.Hubs.Notifications.NotificationStatus.Error);this._notificationManager.addClientNotification({title:n,description:t,status:r,timestamp:new Date})},n})();t.DashboardHelperImpl=ii;ri=(function(){function n(n,t,i,r,u,e){var s=this;this._diContainer=n;this.currentDashboardId=f.observable("");this._notifyDashboardChanged=o.throttle((function(){if(!s._startboard.notFound()){var n=s._dashboardHelperContainer.helperMap.get(2).isOfType(s._curDashboard.id);n?s.saveCurrentDashboard():s._topbarWidget.options.dashboardChanged(!0)}}));this._privateRepo=t;this._dashboardRepositoryContainer=n.get(st.DashboardContainer);this._dashboardHelperContainer=n.get(ot.DashboardHelperContainer);this._armDashboardHelper=n.get(ot.ArmHelper);this._topbarWidget=i;this._lifetime=r;this._helper=u;this._compressor=e;this._isStartboardChanging=!1;this._isMigrated=!1;this._isStartboardShared=f.observable(!1);r.registerForDispose(this._notifyDashboardChanged)}return n.prototype.resetLayout=function(n){var t=this._helper,i=ot.normalizedDashboard(bt.environment.defaultDashboard||{}),r=this._compressor.uncompress(yt.defaultTitle,i);return t.clearStartboard(n),t.renderStartboard(n,r.settings,{delayRendering:!1,isDefault:!0,isCurrentDashboardShared:this.isCurrentDashboardShared()})},n.prototype.isCurrentDashboardShared=function(){var n=this._curDashboard&&this._dashboardHelperContainer.FindOwningRepoKey(this._curDashboard.id);return n===1},n.prototype.isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,i=this._dashboardHelperContainer.FindOwningRepoKey(n.id),t=this._dashboardHelperContainer.helperMap.get(i);return t&&t.getDashboardProperties(n)},n.prototype.initialize=function(n,t,i,r,u){var f=this,e;return this._startboard=n,this._registerEventHandlers(this._lifetime),e=Q(),t?(this._isMigrated=!0,e=this._initDashboard(t,u)):e=this._migrateStartboard().then((function(){return u.dashboardMigration=bt.getTimestamp(),i?f.switchDashboard({id:i,title:i},"DeepLinkAfterMigration"):Q()})).then((function(){u.dashboardInitialized=bt.getTimestamp();(h.isDashboardRoute()||h.isDashboardUri(f._diContainer)&&!t)&&pt(f._diContainer,f._curDashboard,!0)})).catch((function(n){f._handleError(n,"initializeDashboard")})),e.finally((function(){ci(r,"PortalLoad",f._curDashboard,f._startboard).then((function(){u.dashboardRevealed=bt.getTimestamp()}))}))},n.prototype.readDashboardsForType=function(n,t){return t===void 0&&(t=[]),this._dashboardRepositoryContainer.getRepository(n).then((function(n){return n.readDashboards(t)}))},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw vt(6,null,{action:fi});})).then((function(){return lt(n,!0),n._addToRecent(n._curDashboard)})).then((function(){return n._privateRepo.createDefaultDashboard()})).then((function(t){return n._setCurDashboard(t,!0),pt(n._diContainer,t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)})).then((function(){n._helper.enterOrganizeMode(!0)})).catch((function(t){n._handleError(t,"startNewDashboard")})).finally((function(){lt(n,!1)}))},n.prototype.importDashboard=function(n){var t=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(!n)throw vt(6,null,{action:ei});t._isStartboardChanging=!0;lt(t,!0)})).then((function(){return Q.all([t._addToRecent(t._curDashboard),t._privateRepo._getDashboards(),])})).then((function(r){var f=r[1],e=i.getUniqueId(),u=t._compressor.uncompress("private/"+e,n);return t._privateRepo.createDashboard({settings:u.settings,title:ct.createDashboardTitle(f,u.title)})})).then((function(n){return pt(t._diContainer,n),t._loadDashboard(n,!1,!0)})).catch((function(n){t._handleError(n,"importDashboard")})).finally((function(){t._isStartboardChanging=!1;lt(t,!1)}))},n.prototype.getArmDashboardJson=function(){var n=this;return this._collectDashboardSettings(!0,!0).then((function(t){var i=n._compressor.compress({id:"",title:t[w.startBoardSettingsKey].dashboardTitle,settings:t}),r={};return i.parts.forEach((function(n,t){r[t]=n})),{properties:{lenses:{"0":{order:0,parts:r}}},id:t[w.startBoardSettingsKey].dashboardId,name:"",type:"Microsoft.Portal/dashboards",location:"",tags:{"hidden-title":i.title},apiVersion:"2015-08-01-preview"}})).then((function(t){var i=(n._armDashboardHelper.getArmDashboardId(t.id)||"").toLowerCase();return n._dashboardRepositoryContainer.getRepository(1).then((function(n){return n.readArmDashboards().then((function(n){return n.filter((function(n){return(n.id||"").toLowerCase()===i})).first()}))})).then((function(i){var r=n._isStartboardShared();return t.location=r&&i?i.location:"INSERT LOCATION",t.name=r&&i?i.name:t.tags["hidden-title"],t}))}))},n.prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch((function(t){n._handleError(t,"saveCurrentDashboard")}))},n.prototype.cloneCurrentDashboard=function(n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw vt(6,null,{action:"import"});})).then((function(){return t._isStartboardChanging=!0,lt(t,!0),t._collectDashboardSettings(n,!0)})).then((function(n){return t._addToRecent(t._curDashboard).then((function(){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)}))})).then((function(n){return pt(t._diContainer,n),t._loadDashboard(n,!1,!0)})).then((function(){t._helper.enterOrganizeMode()})).catch((function(n){t._handleError(n,"cloneCurrentDashboard")})).finally((function(){t._isStartboardChanging=!1;lt(t,!1)}))},n.prototype.deleteCurrentDashboard=function(n){var t=this,i="deleteCurrentDashboard";return this._isStartboardChanging=!0,lt(this,!0),this._readNextDashboards(1).then((function(n){if(n.length<=0)throw vt(2);return n[0]})).then((function(r){return t._deleteDashboard(t._curDashboard,n).catch((function(n){return t._handleError(n,i)})).then((function(){return r}))})).then((function(n){return pt(t._diContainer,n,!0),t._loadDashboard(n)})).catch((function(n){t._handleError(n,i)})).finally((function(){t._isStartboardChanging=!1;lt(t,!1)}))},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,lt(this,!0),this._loadDashboard(this._curDashboard).catch((function(t){n._handleError(t,"restoreCurrentDashboard")})).finally((function(){n._isStartboardChanging=!1;lt(n,!1)}))},n.prototype.switchDashboard=function(n,t){var i=this,r=gt(this._curDashboard,n),u;return(pt(this._diContainer,n,r),r)?Q():(u=ni("DashboardRevealed"),lt(this,!0),Q(this._switchDashboard(n,!1)).finally((function(){lt(i,!1);ci(u,t,i._curDashboard,i._startboard)})))},n.prototype.populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(yi,(function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)}))},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return lt(this,!0),this.shareCurrentDashboardToArm(n,t,i).then((function(n){return pt(r._diContainer,n,!0),r._switchDashboard(n,!0)})).then((function(){return r._deleteDashboard(u,2)})).finally((function(){lt(r,!1)}))},n.prototype.unshareCurrentDashboard=function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then((function(t){if(t)return Q();var r=vt(6,null,{action:oi});n._handleError(r,i);throw r;})).then((function(){return lt(n,!0),n._shareCurrentDashboard(2,t.title)})).then((function(t){return pt(n._diContainer,t,!0),n._switchDashboard(t)})).then((function(){return n._deleteDashboard(t,3)})).finally((function(){lt(n,!1)}))},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=ni(c.Action.DashboardPublishNew);return this._shareCurrentDashboard(1,n,{subscriptionId:t,resourceGroupName:i}).then((function(n){return wt.completeTrace(u,{success:!0,dashboardId:n.id}),n})).catch((function(f){wt.completeTrace(u,{success:!1});var e=vt(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");throw e;}))},n.prototype.shareCurrentDashboardToSession=function(n){var t=this;return this._shareCurrentDashboard(4,n).catch((function(i){var r=vt(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;}))},n.prototype._registerEventHandlers=function(n){var t=this,e=this._startboard,l=this._topbarWidget.element,h=this._topbarWidget.options,o=e.widget,a=o.element;e.setGetDashboard((function(){return i.clone(t._curDashboard)}));f.reactor(n,(function(){var n,i,r;t.currentDashboardId();n=ki(t._curDashboard);i=bi(n&&n());i&&(r=yt.filterButtonTextFormat.format(i),o.options.filterButtonText(r))}));var v=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},p=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},s=function(n,i){var r,u,f;n.stopPropagation();r=i.part;r.getCompositionType()===g.CompositionType.StartboardPart&&(u=r.getViewModel(),u&&!u.container.operations.inProgress.peek()&&(f=t._dashboardHelperContainer.helperMap.get(2).isOfType(t._curDashboard.id),f?t._notifyDashboardChanged():h.dashboardVisible()&&(i.isUserInteraction||t._diContainer.get(et.DesktopManagerMode).value()===1?t._notifyDashboardChanged():wt.trace({source:c.Source.StartBoardPart,action:c.Action.PartUpdated,name:r.locator.toFriendlyString(),data:{isPartLoading:r.await(0).isPending()}}))))},w=function(n){n.stopPropagation();var i=o.options;i.title().length===0&&(t._diContainer.get(et.DesktopManagerMode).value(1),i.title(yt.untitled));t._notifyDashboardChanged()},b=function(n,i){if(n.stopPropagation(),h.dashboardChanged(!1),!e.notFound())switch(i.action){case 1:t.saveCurrentDashboard();break;case 2:t.cloneCurrentDashboard(!1);break;case 3:t.restoreCurrentDashboard()}},nt=function(n){n.stopPropagation();t._migrateStartboard()},u=o.options;u.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};u.updateDashboardUri=pt;u.switchDashboard=function(n){return t.switchDashboard(n,"RecentList")};u.title.subscribe(n,(function(n){t._curDashboard.title=n}));e.notFound.subscribe(n,(function(n){u.notFound(n)}));u.isShared(this.isCurrentDashboardShared());this._isStartboardShared.subscribe(n,u.isShared,(function(n){u.isShared(n)}));y.selectedSubsUpdateTriggered.subscribe(n,(function(){var n=r.Azure.getAllSubscriptionsInternal(),t=y.getSelectedSubscriptions();Q.all([n,t]).spread((function(n,t){var r=n.length,i=t.length,f="";f=i<r?i>1?yt.browseForOneMoreSubs.format(i):yt.browseForOneSub.format(i):r>0?yt.browseForAllSubs:yt.browseForNoSubs;u.subscriptionsInfo(f)}))})).callback(null);n.registerForDispose([function(){e.removeGetDashboard()},a.setEvents([ut.fxstartboardsettingchanged,v],[g.fxreplacedpartcomposing,p],[it.fxpartsettingchanged,s],[it.fxpartinputchanged,s],[ft.fxpartfilterschanged,s],[k.fxstartboardtitlechanged,w],[k.fxmigratestartboard,nt]),l.setEvents([d.fxfinishdashboardedit,b])])},n.prototype._setCurDashboard=function(n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:s.NavBar.home};n&&(u=n.settings,f=u&&u[w.startBoardSettingsKey],r=f&&f.dashboardModel);r=si(r);e={model:ti(r.model),metadata:r.metadata};this._curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.notFound(i);this._isStartboardShared(this.isCurrentDashboardShared())},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then((function(){return i._loadDashboard(n,!1,t)})).catch((function(n){i._handleError(n,"switchDashboard")})).finally((function(){i._isStartboardChanging=!1}))},n.prototype._findOwningRepo=function(n){return this._dashboardRepositoryContainer.getRepository(this._dashboardHelperContainer.FindOwningRepoKey(n))},n.prototype._readDashboard=function(n){var i=this,t=n.id;return this._findOwningRepo(t).then((function(n){if(!n)throw new Error("Unable to find dashboard repository for dashboard '"+t+"'.");return n.readDashboard(t,!0)})).then((function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+t+"'. But the result is "+n+".");return n})).catch((function(r){throw vt(1,r,{dashboardId:t,dashboardTitle:n.title,initDashboardIdFromStore:i.initDashboardIdFromStore});}))},n.prototype._collectDashboardSettings=function(n,t){var r=this,u=n?this._readDashboard(this._curDashboard):Q(null);return Q(u).catch(i.noop).then((function(n){return n?n.settings:r._helper.collectDashboardSettings(r._startboard)})).then((function(n){return t?wi(r._diContainer.get(l.ExtensionManagerOptions),n):n}))},n.prototype._saveDashboard=function(n){var u=this,t=n.id,r=n.title,f=i.getCurrentCallStack(!0);return this._collectDashboardSettings().then((function(n){return u._findOwningRepo(t).then((function(i){var e=n&&n.Startboard,u=li(e),o=u.positions&&u.positions.length;return o||at.warning("Saving empty dashboard.",0,f),i.updateDashboard(t,{settings:n,title:r})}))})).catch((function(t){throw vt(5,t,{dashboardId:n.id,dashboardTitle:r});}))},n.prototype._deleteDashboard=function(n,t){var u=this,i=n.id,f=ni(c.Action.DashboardDelete),r=!0;return this._removeFromRecent(i).then((function(){return u._findOwningRepo(i).then((function(n){return n.deleteDashboard(i)}))})).catch((function(t){r=!1;throw vt(4,t,{dashboardId:i,dashboardTitle:n.title});})).finally((function(){wt.completeTrace(f,{success:r,dashboardId:i,reason:t})}))},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=i.noop);var u=function(t,i){return t=i?r._armDashboardHelper.filterDashboards(t,i):t,t.filter((function(n){return!gt(n,r._curDashboard)})).slice(0,n)},f=y.getSelectedSubscriptions().catch((function(){return[]})),e=this._privateRepo.getRecentDashboards().catch((function(){return[]}));return Q.all([f,e]).spread((function(f,e){var h=f.map((function(n){return n.subscriptionId})),c=u(e,h),o;t(c);var s=Q(c),l=r._dashboardRepositoryContainer.dashboardRepositoryArray,a=function(r){var f=l[r];s=s.then((function(r){return r.length>=n?Q(r):f().then((function(n){return n.readDashboards().catch((function(t){return at.error(t,10,"Failed to read dashboards from '"+n.getTypeName()+"' repository."),[]})).then((function(n){var e=i.union(r,n,gt),f=u(e,h);return t(f),f}))}))}))};for(o=0;o<l.length;o++)a(o);return s}))},n.prototype._isWritable=function(n){return this._findOwningRepo(n).then((function(t){return t.isDashboardWritable(n)})).catch((function(){return!0}))},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(n).catch(e.noop)},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch(e.noop)},n.prototype._loadDashboard=function(n,t,i,r,u){var f=this,e=n.id,s=i?Q(n):this._readDashboard(n),o=this._helper;return r=r||{},Q.all([this._removeFromRecent(e).then((function(){r.dashboardRemoveFromRecent=bt.getTimestamp()})),this._isWritable(e).then((function(n){return r.dashboardIsWritable=bt.getTimestamp(),n})),Q(s).then((function(n){return r.dashboardRead=bt.getTimestamp(),n})),]).spread((function(n,i,r){return o.clearStartboard(f._startboard),f._setCurDashboard(r,i),o.renderStartboard(f._startboard,r.settings,{delayRendering:t,isCurrentDashboardShared:f.isCurrentDashboardShared()},u)})).catch((function(t){f._setCurDashboard(n,!0,!0);f._startboard.notFound()||f._startboard.save();throw t;}))},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=s.NavBar.home;return this._helper.getStartboardReadyPromise().then((function(){return n._privateRepo.createDefaultDashboard(i)})).then((function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then((function(){return t}))})).then((function(i){t.headerMode(1);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0})).catch((function(n){throw vt(3,n);}))},n.prototype._initDashboard=function(n,t){var i=this,r=this._startboard.widget.options;return r.headerMode(1),this._loadDashboard(n,!0,!1,t,!0).then((function(){i._startboard.logChildren()}))},n.prototype._shareCurrentDashboard=function(n,t,i){var r=this;return this._collectDashboardSettings(!0,!0).then((function(u){return r._dashboardRepositoryContainer.getRepository(n).then((function(n){return n.createDashboard({title:t,settings:u,extras:i})}))}))},n.prototype._handleError=function(n,t){var e=this,o=this._startboard.widget.options,r=this._helper,u=yt.Notification.errorTitle,i=yt.Error,f=function(n,i){at.error(n,n.code,t+": "+i)},s=function(n){var r=n.data,i=r.dashboardId,u=r.dashboardTitle;at.warning(n,n.code,t+": Failed to find dashboard '"+i);var f=e._dashboardHelperContainer.FindOwningRepoKey(i),s=e._dashboardHelperContainer.helperMap.get(f),h={id:i,title:u},c=s.getNotFoundMessage(h);o.notFoundMessage(c)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");o.headerMode(2)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+t.dashboardId+"'.");r.popNotification(u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,t="";switch(f){case fi:t=i.cannotCreate;break;case ei:t=i.cannotClone;break;case oi:t=i.cannotUnpublish}r.popNotification(u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){at.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof dt)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n})();t.DashboardManagerImpl=ri}));
define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","o","ko","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function a(n,t){s.isTraceEnabled&&y.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),f.toJSON(t.getInputsOnlyViewModel())))}function p(n,t){return new c(n,t.get(o.RightContextPane))}var c;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base.Diagnostics,v=window,y=l.createLog(n);t.showConfirmDialog=function(n){return v.confirm(n)};c=(function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(h.default.fxautosettings,(function(n,t){i._autoOpenedBy=t}))}return u.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var u,f,o;return(a("Adding blade to desktop.",n),u=n.parent.blades,f=n.services.desktop.getActiveJourney(),l.Telemetry.trace({action:"JourneyLength",source:e.Source.Desktop,data:{count:u.length,blades:u.map((function(n){var t=n.locator;return{bladeName:t.name,extension:r.Extension.getWindowId(t.getExtensionLocator())}}))},journeyId:f&&f.id}),n.flags&1)?this._contextPane.tryOpen(n).then(i.noop):(this._autoOpenedBy&&(o=n.masterContainer,o&&o.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panoramaWidget.getJourneyWidget(),t),Q())},n.prototype.removeBlade=function(n){a("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){var t=this._panoramaWidget.getJourneyWidget();t&&t.removeChildren(n);var i=this._contextPane,r=i.getContent(),u=r&&r.locator;u&&u.type===1&&i.close(!0)},n.prototype.showConfirmDialog=function(n){return!!t.showConfirmDialog(n)},n.prototype.getContextPane=function(){return this._contextPane},n})();t.DesktopManagerViewImpl=c;t.create=p}));
define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Dashboard/DashboardManager","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){"use strict";function ii(n,t,i,r,u){return ht.startTrace({source:n,action:t,name:i,assetType:r,journeyId:u})}function ri(){return at("MsPortalImpl/UI/UI.Desktop.Actions")}function gi(n,t){return new fi(rt.create(n,t.diContainer),t)}function nr(n,t){var r={},u=si[si.StartboardPart],f=i.forEachKey(n,(function(n,t,i){var f=g.isStartboardPartKey(n),e=ti(n,u+"-"+bt)||ti(n,u+"-"+kt);!f||e?r[n]=t:i.push(n)}),[]);return f.length&&t.deleteSettings({store:ni,keys:f}),r}function tr(n){var t=n[y.startBoardSettingsKey]||{},i=t.dashboardId;return!i?null:{id:i,title:t.dashboardTitle||l.NavBar.home}}function pi(n,t){if(!t)return n;if(n){var i=t.toLowerCase(),r=(n.id||"").toLowerCase()===i;return r?n:{id:i,title:i}}return null}function ui(n,t,i){n.removeChild(t,!1,!i&&!t.dontSetupWidget)}function wi(n){return n&&n.locator&&n.locator.toFriendlyString()}function ir(t){var u=r.ViewModels.Part.composePartViewModel,f=ut.registerWithState,e=n.normalize("./UI.BladeLauncher"),i;f("Shell$BladeLauncherViewModel",e,(function(n,t){return u((function(i){return new n.BladeLauncher(i,t)}),{initialState:t,createSelectable:!0,logArea:e})}));i=n.normalize("./UI.AssetBladeLauncher");f("Shell$AssetBladeLauncherViewModel",i,(function(n,r){return u((function(i){return new n.AssetBladeLauncher(i,r,t)}),{initialState:r,createSelectable:!0,logArea:i})}))}function rr(n,t,i,r){var u,f="Unable to replace part '"+(n&&n.toString())+"', ";return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1}var fi;u.defineProperty(t,"__esModule",{value:!0});var bi=c.Locator,ki=r.Extension,ei=i.Base,wt=ei.Constants.ExtensionNames.Hubs,oi=ei.Diagnostics,ht=oi.Telemetry,di=i.Parts,si=b.CompositionType,hi=it.DesktopManagerEvents,ct=i.Helpers.Deferred,ci=i.deepEquals,li=i.getUniqueId,lt=i.tryImmediateResolve,bt="AssetBladeLauncher",kt="BladeLauncher",ai=window,at=i.require,ot=oi.createLog(n),vt=w.Source.Desktop,yt=w.Action,pt=l.Desktop,st={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},dt=y.desktopSettingsKey,gt=8,ni=4,ti=i.startsWith,vi=bi.forExtension,yi="./Compositions/UI.Composition.Blade";t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};t.createDesktopManager=gi;t.resolveInitialDashboard=pi;fi=(function(){function y(n,t){this._startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._lifetime=new r.TriggerableLifetimeManager;this._dashboardMgrDeferred=Q.defer();this.activeJourney=f.observable(null);this.commandsEnabled=f.observable(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._mode=t.diContainer.get(it.DesktopManagerMode).value;this._initDeferred=ct();this._sharedSettings=t.diContainer.get(v.SettingsManager);this._portalServices=t;ir(this._services.assetTypeService)}return y.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},y.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},u.defineProperty(y.prototype,"isJourneyLoading",{get:function(){return this._loadingJourneyGuid!==null},enumerable:!0,configurable:!0}),y.prototype.initialize=function(n,r,u){var f=this;this._setupOrganizeModeComponents(t.organizeModeModules);this._extensionsMetadata=n;this._services.diContainer.get(a.AssetManager).onAssetDeleted((function(n,t,i,r){ri().then((function(u){return u.handleAssetDeleted(f,n,t,i,r)}))}));var h=tt.startTrace("DashboardRevealed"),o=s.getDashboardIdFromUri(),e=this._dashboardMgr=tt.create({services:this._services,lifetime:this._lifetime});return r.then((function(n){u.startboardSettingsLoaded=ai.fx.getTimestamp();var t,r=n&&n[ni]||{},s=tr(r);return(u.dayZero=!r[dt])?(f._startBoard=g.create(f._createCompositionServices()),f._view.composeStartBoard(f._startBoard),i.isFeatureEnabled("noday0parts")?f._startboardPartsLoadedDeferred.resolve():f._populateStartBoardFromManifests().then((function(){f._startboardPartsLoadedDeferred.resolve()})),f._initDeferred.resolve()):(t=pi(s,o),f.load(n&&n[gt]||{},r,t&&t.id)),e.initDashboardIdFromStore=s?s.id:"",e.initialize(f._startBoard,t,o,h,u).finally((function(){u.dashboardManagerInitialized=ai.fx.getTimestamp();f._dashboardMgrDeferred.resolve(e);f._initDeferred.resolve()}))})),Q(this._initDeferred.promise())},y.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(6):this._services.diContainer.getAsync(et.DialogManager).then((function(n){return n.showModalDialog({title:l.Startboard.resetConfirmationTitle,description:l.Startboard.resetConfirmationText,buttons:4})})),i.then((function(n){var r,i;if(n===6){for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,{force:!0});return t._populateStartBoardFromManifests()}}))},y.prototype._populateStartBoardFromManifests=function(){var n=this;return this._dashboardMgr.resetLayout(this._startBoard).then((function(){n.save();var t=n._services.extensionManager,i=t.getExtensions().map((function(i){var u=n._extensionsMetadata[i.name],r=u.startBoardParts;if(u.isTestExtension||r&&r.length)return t.getManifestByName(i.name).then((function(t){n._addStartBoardPartsFromManifest(t,r);n.save()}))})).filter((function(n){return!!n}));return Q.allSettled(i)}))},y.prototype._getExtensionEmailAddress=function(n){var t=this._extensionsMetadata[n];return t&&t.feedbackEmail},y.prototype.getCurrentBladeInfo=function(){var t=this._getBreadCrumb(),r=this._getExtensionEmailAddress(wt),n=t[t.length-1],i=n&&n.extensionName||"",u=i?this._getExtensionEmailAddress(i):r;return{extensionName:i,feedbackTo:u,feedbackCC:r,breadcrumb:t.map((function(n){return n.title})).join(" > "),bladeName:n&&n.name||""}},y.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,name:"Extension/"+n.locator.getExtensionLocator().name+"/Blade/"+n.locator.name}})):[]},y.prototype.createJourney=function(t,i,r){var u=this,o=this._startBoard.children.first((function(n){return n.id===t})),e;return o?(e=ct(),r||(r=li(),this._loadingJourneyGuid=r,this._createNewJourneyPromise=e.promise()),e.promise().finally((function(){u._loadingJourneyGuid===r&&(u._loadingJourneyGuid=null,u._createNewJourneyPromise=null)})),lt(Q(o.awaitComposed()),(function(){if(u.tryDeactivateJourney(r)){var t=u._createCompositionServices();lt(at("./Compositions/UI.Composition.Journey",n),(function(r){var f=r.create(t,o),s=ii(vt,yt.JourneyOpened,wi(o),undefined,f.id);return u.setActiveJourney(f),lt(at(yi,n),(function(n){var r=n.create(t,i,u._startBoard),f=u._activeJourney;f.addChild(r);u._view.composeJourney(f);u._startBoard.detailContainers=[r];u._view.addBlade(r,{assetType:i.originAssetType,focus:!0}).catch((function(n){ot.error(n)}));u._triggerJourneyChange();e.resolve(f);ht.completeTrace(s);Q.nextTick((function(){u.save()}))}))})).catch((function(n){e.reject(n)}))}else e.reject("tryDeactivateJourney returned false")})),e.promise()):(ot.error(st.noTileInDesktop.format(t)),ot.verbose(f.toJSON(this.getDiagnosticsData(),null,2)),ct().reject())},y.prototype.createJourneyForBlade=function(n,t){return this._createJourneyWithHiddenPart(wt,kt,n,t,kt,n.defaultMenuItemId)},y.prototype.createJourneyForAsset=function(n,t,i){return this._createJourneyWithHiddenPart(wt,bt,{extensionName:n.extension,assetType:n.assetType,assetId:i},t,bt,n.defaultMenuItemId,n.assetType)},y.prototype._createJourneyWithHiddenPart=function(n,t,r,u,f,e,o){var h=this;if(this._loadingJourneyGuid!==u)return Q();var l=ii(vt,yt.JourneyOpened,f,o),a=vi(n).withPartType(t),s=this.addPartToStartBoard({originPartLocator:a,model:r,defaultMenuItemId:e,dontSetupWidget:!0,isHiddenDashboardPart:!0}),c;return c=s.isComposed&&s.isSelected()&&this._activeJourney&&this._activeJourney.originTile===s?Q():s.selectOnReady((function(){return h._loadingJourneyGuid!==u?!1:!s.isSelected()&&h.tryDeactivateJourney(u)}),{timeoutInMilliseconds:9e4}).then((function(n){n&&ht.completeTrace(l)})),i.tryImmediateFinally(c,(function(){h._loadingJourneyGuid===u&&(h._loadingJourneyGuid=null)}))},y.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,(function(n,i){return i===0&&n.locator.equals(t.locator)}))},y.prototype.openMultipleBlades=function(n,t){var u=this,i=ct(),r;return t&&t.length!==0?(r=t.map((function(t){return u._openBlade(n,t,(function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&b.deepSubset(n.getViewModel(),t.model)}))})),e.when.apply(e,r).done((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i.resolve(t)})).fail((function(){i.reject()}))):i.resolve([]),i.promise()},y.prototype.confirmBladesCanClose=function(n){var t=this,f=(n||[]).first((function(n){return!t.canCloseBlade(n)})),r,u;return f?(r=[],n.forEach((function(n){r.push(t._findFirstItem(t.activeJourney().children,n,st.noBladeInJourney.format(n)))})),u=[],i.pushUnique(u,i.mapMany(r,(function(n){return t._getAlertMessageRecursive(n)}))),this._view.showConfirmDialog(u.join("\n")||pt.confirmEditScopeDiscard)):!0},y.prototype.forceCloseBlade=function(n,t,i){var u,r,f,e;if(!this._activeJourney)throw new Error(st.noActiveJourney);u=this._findFirstItemIndex(this._activeJourney.children,n,st.noBladeInJourney.format(n));r=this._activeJourney.children[u];this._startBoard.detailContainers.length===1&&this._startBoard.detailContainers[0].id===r.id?this.forceDiscardJourney(this._activeJourney.id,t):(r.masterContainer&&(f=r.masterContainer.detailContainers,e=f.indexOf(r),e>=0&&(f.splice(e,1),i&&i.openBlade||r.masterContainer.onDetailContainersChanged())),this._closeBladeRecursive(r,u,t));this._triggerJourneyChange()},y.prototype.getContextPane=function(){return this._view.getContextPane()},y.prototype.tryCloseBlade=function(n,t){if(this._activeJourney&&i.findIndex(this._activeJourney.children,(function(t){return t.id===n}))>=0){var r=this.confirmBladesCanClose([n]);return r&&this.forceCloseBlade(n,t),r}return!0},y.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id,1);return i},y.prototype.discardEditsOfPart=function(n,t){var r=n.getPartsContainer();return this._discardEditsOfContainer(r,t.force,(function(u){var s=u.path,e=r.journeyPath,h=ci(s,n.journeyPath),c=!1,f,o;if(!h&&s.length>e.length){f=void 0;try{f=i.parseSortedString(u.path[e.length])}catch(l){ot.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".format(r.toString(),JSON.stringify(e),l.message))}c=f&&f.master&&f.master.part===n.id}return o=u.value,o&&o.editScope&&(t.includeSelf&&h||t.includeDescendants&&c)}))},y.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=ci(u,f),o=!e&&(r.type===1||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},y.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],r={confirmationRequired:!1,successful:!1},e=this._activeJourney,f;if(!e)throw new Error(st.noActiveJourney);return f=e.ambientSettings,(n instanceof g.Instance||n.isInitialized)&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);o._services.diContainer.get(p.EditScopeManager).onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},y.prototype.canCloseBlade=function(n){var t=this._activeJourney,r,i;return t?(r=this._findFirstItem(t.children,n,st.noBladeInJourney.format(n)),i=function(n){var u=!!(n.bladeDefinition&&n.bladeDefinition.actionBar),r;return!f.unwrap(n.editScopeId)&&n.shouldAlertOnClose(u)?!0:n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&t.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving}))?!0:(r=n.detailContainers,!r||r.length===0)?!1:(r||[]).some((function(n){return i(n)}))},!i(r)):!0},y.prototype.addPartToStartBoard=function(n,t){var r,u;if(t===void 0&&(t=!1),!n){ot.error("options should be specified for adding a part to the startboard.");return}if(!n.originPartLocator){ot.error("options.originPartLocator should be specified for adding a part to the startboard.");return}var f=this._createCompositionServices(),e=n.model,i=nt.create(f,n.originPartLocator,e,{modelContainsSensitiveData:n.modelContainsSensitiveData,filters:n.filters,isHiddenDashboardPart:n.isHiddenDashboardPart,duringPortalStartup:t});return i.dontSetupWidget=!!n.dontSetupWidget,r=n.defaultMenuItemId,r&&(i.defaultMenuItemId=r),di.InternalPartSize[n.initialSize]&&(i.initialSize=n.initialSize,n.initialSize===99&&(i.initialHeight=n.initialHeight,i.initialWidth=n.initialWidth)),u=i.id,this._isStartBoardPartLoaded(u)||(this._isStartBoardPartLoaded(u,!0),this._startBoard.addChild(i,undefined,!i.dontSetupWidget),this._view.addPartToStartBoard(i),i.dontSetupWidget||this.save()),i},y.prototype.pinMultipleParts=function(n,t,i){var r=this,u=this._createCompositionServices();return ri().then((function(f){return f.pinMultipleParts(r,u.finder,n,t,i)}))},y.prototype.removeTile=function(n,t){var e=this._startBoard,i=e.children.first((function(t){return t.id===n})),r,u;if(i){r=void 0;u=this._activeJourney;u&&u.originTile===i&&(r=u.id);var f=i.editScopeId()&&this._services.diContainer.get(p.EditScopeManager).getStateObservable(i.editScopeId()),s=!f||f()===0||f()===2,h=!r||this._canDiscardJourney(r),o=t&&t.force||s&&h;(o||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),ui(e,i,t&&t.skipSave),o||i.dontSetupWidget||ot.warning("Part '{0}' is removed from the start board.".format(i)),t&&t.skipSave||this.save())}},y.prototype.replacePart=function(n,t,i){var o=this,f=n&&n.id,u,s=this._createCompositionServices(),h=!0,c,l,e;return i=i||{},rr(n,t,i.newPartContainerModel,(function(n){l=n}))?(n instanceof nt.Instance?(u=nt.create(s,t,i.newPartContainerModel,{id:f,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel,filters:n.filters}),e=n,u.dontSetupWidget=e.dontSetupWidget,h=!e.dontSetupWidget):u=d.create(s,t,f,i.newPartContainerModel,i.newPartOverridesModel),u.previousLocator=n.previousLocator||n.locator,u.flags|=4,c=n.getPartsContainer(),n.dispose(!0),n.parent.replaceChild(n,u),u instanceof nt.Instance&&this._activeJourney&&this._activeJourney.originTile===n?this.tryDiscardJourney(this._activeJourney.id):c.getPartsContainer().detailContainers.slice(0).reverse().forEach((function(n){n.masterPartId===f&&o.tryCloseBlade(n.id,1)})),u.widgetState(n.widgetState()),h?(u.widget=n.widget,u.recompose(n.parent.widget)):u.compose(n.parent.widget),u.widget.element.trigger(b.fxreplacedpartcomposing,{part:u}),u.awaitComposed().then((function(){return!i.preventNewPartActivation&&u.partDefinition.details&&u.partDefinition.details.length>0?u.selectOnReady((function(){return!o._activeJourney}),{timeoutInMilliseconds:15e3}).then((function(){return u})):u}))):Q.reject(r.createError(l))},u.defineProperty(y.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),y.prototype.getDashboardManager=function(){return this._dashboardMgrDeferred.promise},y.prototype.getSettingCollections=function(){var i={},r={},n=this._activeJourney,t=[];return i[dt]=JSON.parse(JSON.stringify(this)),t.push({store:ni,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:gt,settings:r})),t},y.prototype.dispose=function(){this._lifetime.dispose()},y.prototype.save=function(){var n=this;this._initDeferred.promise().finally((function(){n.getSettingCollections().forEach((function(t){n._services.diContainer.get(v.SettingsManager).setSettings(t)}))}))},y.prototype.load=function(n,t,i){var r=this,e=this._createCompositionServices(),u=t[dt],f=!1,o,s;u&&u.startBoardId&&t[u.startBoardId]?(o=t[u.startBoardId],f=!!i,f&&(t=nr(t,this._sharedSettings)),this._startBoard=g.Instance.fromJSON(e,t,o)):(ot.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),this._startBoard=g.create(e));this._removeOrphanedStartboardParts();this._view.composeStartBoard(this._startBoard);f||this._initDeferred.resolve();s=this._view.portalWidget.element;s.one(ft.default.fxshowstartboard,(function(){var n=r._startBoard.children.slice();n.forEach((function(n){r._displayPartOnStartBoardIfAvailable(n)}));r._startBoard.discardWidgetStateOfUnusedChildren();r._startboardPartsLoadedDeferred.resolve()}))},y.prototype._removeOrphanedStartboardParts=function(){var n=this.startBoard;n.children.slice(0).forEach((function(t){t.dontSetupWidget&&ui(n,t)}))},u.defineProperty(y.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),y.prototype.getActiveJourney=function(){return this._activeJourney},y.prototype.setActiveJourney=function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&o.isFullscreen()&&o.exitFullscreen()},y.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=li(),this._loadingJourneyGuid},y.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,r,i,u;if(t){if(!this.confirmBladesCanClose(t.children.map((function(n){return n.id}))))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i].id);u=ii(vt,yt.JourneyDeactivated,wi(t.originTile),undefined,t.id);t.save();this._closeActiveJourney(!0);ht.completeTrace(u)}else this._startBoard&&(this._startBoard.detailContainers=[]);return this._loadingJourneyGuid=n||null,!0},y.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},y.prototype._triggerJourneyChange=function(){e(this).trigger(hi.journeyChange)},y.prototype._canDiscardJourney=function(n){var t=this._activeJourney&&this._activeJourney.id===n&&this._activeJourney,i=t&&t.ambientSettings.getObservable().peek().some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!t||!i},y.prototype.forceDiscardJourney=function(n,t){var i=!1;this._deleteJourneySettings(n);this._activeJourney&&this._activeJourney.id===n&&(this._closeActiveJourney(!1,t),i=!0);i&&this._triggerJourneyChange()},y.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:gt,keys:[n]})},y.prototype.toJSON=function(){return{startBoardId:this._startBoard?this._startBoard.id:null}},y.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts;t||(t=i.map((function(n){return n.name})));i&&i.length&&t.forEach((function(t){var u=i.first((function(n){return n.name===t})),f;u&&(f=vi(n.name).withStartboardPartInstance(u.name),r.addPartToStartBoard({originPartLocator:f,initialSize:u.initialSize},!0))}))},y.prototype._createCompositionServices=function(n){return n?i.extend2(this._services,{finder:n,desktop:this,sharedSettings:this._sharedSettings}):this._thisCompositionServices||(this._thisCompositionServices=i.extend2(this._services,{finder:new c.DefinitionFinderImpl(this._services.extensionManager),desktop:this,sharedSettings:this._sharedSettings}))},y.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,st.noBladeInJourney.format(n));else throw new Error(st.noActiveJourney);return t},y.prototype._openBlade=function(t,i,r){var s=this,e=this._findPartContainer(t),a=e instanceof g.Instance,o=ct(),u,h,v=this._createCompositionServices(),c,l;return e?((e.detailContainers||[]).forEach((function(n,t){n.locator.equals(i.locator)&&n.masterPartId===i.masterPartId&&n.masterInvocationProperty===i.masterInvocationProperty&&r(n,t)&&(u=n,o.resolve(u))})),u?(l=u.containerWidget,l&&l.setFocus(),it.isTraceEnabled&&ot.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(u.toString(),f.toJSON(u.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(f.toJSON(i)))):(c=function(){a&&e.detailContainers.length===0?s.createJourney(i.masterPartId,i).finally((function(n){n&&n.children&&n.children.length>0?o.resolve(n.children[0]):o.reject()})):lt(at(yi,n),(function(n){return lt(Q(),(function(){u=n.create(v,i,e);e.detailContainers.unshift(u);e.onDetailContainersChanged();h=a?0:1+s._findFirstItemIndex(s._activeJourney.children,e.id,st.noBladeInJourney.format(e.id));s._activeJourney.addChild(u,h);s._view.addBlade(u,{assetType:i.originAssetType,index:h,focus:!0}).catch((function(n){ot.error(n)}));s._triggerJourneyChange();o.resolve(u)}))})).catch((function(n){o.reject(n)}))},this._createNewJourneyPromise?this._createNewJourneyPromise.always((function(){c()})):c())):o.reject(),o.promise()},y.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,r);r||(n.parent.save(),e(this).trigger(hi.bladeClosed,{id:n.id,reason:i,masterPartId:n.masterPartId}))},y.prototype._getAlertMessageRecursive=function(n){var t=function(n){var t=n.detailContainers,r;return t&&t.length!==0?(r=i.mapMany(t,(function(n){return n.getAlertOnCloseMessages()})),i.union(n.getAlertOnCloseMessages(),r)):n.getAlertOnCloseMessages()};return t(n)},y.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},y.prototype._disposeBladesRecursive=function(n,t,i){var u=this,r=n.parent.children.indexOf(n,t);i?n.dispose(!0):n.parent.removeChildAt(r,undefined);n.detailContainers.forEach((function(n){u._disposeBladesRecursive(n,r,i)}))},y.prototype._closeActiveJourney=function(n,t){var u=this,r=this._activeJourney,i;this.setActiveJourney(null);this._startBoard.detailContainers=[];r&&(r.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})),i=r.originTile,i&&i.dontSetupWidget&&!n&&this.removeTile(i.id,{skipSave:i.dontSetupWidget}),r.dispose(n));this._view.removeAllBlades((function(n){ot.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}))},y.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},y.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex((function(n){return n.id===t}));if(r===-1){ot.verbose(f.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},y.prototype.pinPartComposition=function(n){this._startBoard.addChild(n);this._view.addPartToStartBoard(n);ht.trace({source:vt,action:yt.DashboardPinPart,name:n.locator.toFriendlyString(),data:n.id});this.save()},y.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[n]},y.prototype._displayPartOnStartBoardIfAvailable=function(n){var r=this,i,e;if(!this._isStartBoardPartLoaded(n.id)){this._isStartBoardPartLoaded(n.id,!0);var t=n.locator,u=t.getExtensionLocator(),f=function(t,i){if(ot.warning(t.format(n)),i){var u=r._startBoard;ui(u,n);u.removeChildWidget(n.id)}},o=function(t,i){var u=!1;return t===0?(i||r._view.addPartToStartBoard(n),u=!0):t===1&&(f("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),u=!0),u},s=function(i,u){(i.startBoardParts||[]).some((function(n){return n.name===t.name}))?u||r._view.addPartToStartBoard(n):f("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")};this._extensionsMetadata[u.name]?o(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),i=t.name,e=t.type,e===7?this._services.extensionManager.getManifestByName(u.name).then((function(n){s(n,!0)})):this._services.extensionManager.getExtensionByName(u.name,{trigger:ki.getModule(i,e)}).then((function(n){var u=h.PinPrefix,f,r;if(ti(i,u))return f=i.substr(u.length),n.getBladeDefinition(f);for(r=t;r;r=r.parent)if(r.type===1)return n.getBladeDefinition(r.name);if(t.type===6)return n.getPartDefinition(t.name)})).then((function(){o(n.definitionExists(!0),!0)}))):f("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},y.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},y.prototype.getAssetDiagnosticsData=function(){var n=this._activeJourney;return n?ri().then((function(t){return t.dumpCompositionAssets(n)})):Q.resolve("No journey")},y.prototype._setupOrganizeModeComponents=function(n){var t=this,r=this._lifetime,u=r.createChildLifetime();this._mode.subscribe(u,(function(f){f===1&&i.require(n.dragDrop).then((function(n){n.create(r,t,t.portalWidget.element);u.dispose()}))}))},y})();t.DesktopManagerImpl=fi}));
define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","o","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function vt(n){var i=n.target,t=u(i);if(!c||c.htmlTarget===i){if(c={htmlTarget:i,elementObject:t,width:t.outerWidth(!1),height:t.outerHeight(!1)},d.top=-n.offsetY,d.left=-n.offsetX,l=ft(t.closest(v),s.Widget),!l){n.preventDefault();ut(n);return}t.css("opacity",.75);nt=a=rt({left:n.pageX,top:n.pageY});e.register(st,!0)}}function tt(n){if(c){p.off(v);var t=c.elementObject,i=t.attr("dragdrop.revert")==="true",r={left:n.pageX,top:n.pageY};e.unregister(st);i&&t.attr("dragdrop.revert","false");it();i&&pt();t.css("opacity",1);a=i?nt:rt(r);l.moveChild(c.elementObject,Math.max(a.col,0),Math.max(a.row,0),!0);ct()}}function ht(){c.elementObject.attr("dragdrop.revert","true").trigger(h.default.mouseup)}function yt(n,t){if(l){var i=rt(t);i.col===a.col&&i.row===a.row||(a=i)}it();w=y.setTimeout((function(){w=null;l&&l.moveChild(c.elementObject,Math.max(a.col,0),Math.max(a.row,0),!1)}),50)}function it(){w&&(y.clearTimeout(w),w=null)}function pt(){l&&(it(),l.refreshLayout())}function rt(n){var t=l.element,i=t.offset(),r={left:n.left+d.left,top:n.top+d.top},u=r.left-i.left+t.scrollLeft(),f=r.top-i.top+t.scrollTop(),e=Math.floor((u+.33*b.GridSpacingWidth)/b.GridSpacingWidth),o=Math.floor((f+.33*b.GridSpacingHeight)/b.GridSpacingHeight);return{col:e,row:o}}function ct(){l=null;nt=null;a=null;c=null}function lt(){var t=u.querySelectorAll(v),n=[];return t.each((function(t,i){var r=ft(u(i),s.Widget),f=r.options;f.allowReorder&&!f.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))})),n}function ut(n){ht();tt(n)}var at;r.defineProperty(t,"__esModule",{value:!0});var b=i.Widgets.AzureGrid,y=window,p=u(y.document.body),ft=o.Widget.getWidget,et="ui-draggable",k="draggable",ot=et+" fxs-drag-disableTouchAction",g=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",v=".fxs-flowlayout",st={dismissFn:ht,logName:"flowlayoutdragdrop"},c,l,nt,a,w,d={left:0,top:0};at=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();ct();n._singleton=null},r.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){if(n.attr(k)!=="true"){n.attr(k,"true");var t=n.filter(g).addClass(ot);t.on(h.default.dragstart,(function(n){var t,i;if(c&&ut(n),f.isFullscreen()||n.target!==n.currentTarget){n.preventDefault();return}t={left:n.pageX,top:n.pageY};p.on(h.default.dragover+v,(function(n){n.preventDefault();var i={left:n.pageX,top:n.pageY};(i.left!==t.left||i.top!==t.top)&&yt(n,t=i)}));p.on(h.default.drop+v,(function(n){n.preventDefault();tt(n)}));p.on(h.default.dragend+v,(function(n){tt(n)}));p.on(h.default.dragleave+v,(function(n){0<n.clientX&&n.clientX<y.innerWidth&&0<n.clientY&&n.clientY<y.innerHeight||ut(n)}));i=n.originalEvent.dataTransfer;i.setData("text","fxs-draganddrop");i.effectAllowed="move";vt(n)}))}},n.prototype.enableDragDropTargets=function(){var n=this;lt().forEach((function(t){t.on(h.default.mouseenter,g,(function(t){var i=u(t.currentTarget);i.attr(k)!=="true"&&n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){lt().forEach((function(n){return n.off(h.default.mouseenter,g)}));u.querySelectorAll("."+et).removeClass(ot).off(h.default.dragstart).removeAttr(k)},n})();t.FlowLayoutDragDrop=at}));
define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-tile:hover .fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile.fxs-tilesize-custom .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}")}));
define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","i","o","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/Resources.Images","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function ft(n,t,r){var c=n.desktop,h=n.diContainer.get(l.DesktopManagerMode).value,u=new b(t,n,r),s=function(n){var t=f(n.target).closest(tt);return v.Widget.getWidget(t,y.Widget)},a=t.element,o=t.getPanorama().getStartBoardArea();a.on(p.default.fxexitorganizemode,(function(){n.diContainer.get(l.DesktopManagerMode).value(0);var t=c.startBoard.widget.element.findByClassName("fxs-startboard-button-edit");t.length&&t.focus()}));o.on(p.default.fxenterorganizemode,(function(n,t){n.stopPropagation();var r=s(n);t=f.extend({},t);i.isNullOrUndefined(t.trigger)&&(t.trigger=r?0:1);u.startPartManagment(t);r&&(r.options.selected(!0),u.updateTileSelection(r),r.showTileManagementContextMenu())}));o.on(p.default.click,nt,(function(n){var i=s(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),u.updateTileSelection(i))}));o.on(p.default.click,it,(function(n){if(h()===1){var i=s(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),u.updateTileSelection(i))}}));o.on(p.default.dragstart,ut,(function(n){if(e.isFullscreen()){n.preventDefault();return}h()!==1&&h(1);var t=s(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),u.updateTileSelection(t))}));o.on(p.default.fxpartcreated,(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);u.updateTileSelection(i)}));return u}var b;u.defineProperty(t,"__esModule",{value:!0});var g=window,k=v.Widget.widgetRemoveEvent,nt="."+y.overlayClassName,tt="."+y.widgetClassName,it="."+y.actionBarContainerClassName,d="fxs-desktop-normal",rt="fxs-partgallery-container",ut=".ui-draggable";g.fx.injectCss({id:"flowlayoutGridShadowUri"},".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+w.getFlowLayout().gridShadow+");")+"}");t.organizeModeClassName="fxs-desktop-organize";t.createDesktopModeManager=ft;b=(function(){function n(n,t,i){var r=this;this._wasContextPaneCollapsed=!1;this._dismissHandle={dismissFn:function(){r._mode(0)},logName:"desktopmodemanager"};this._mode=t.diContainer.get(l.DesktopManagerMode).value;this._portalWidget=n;this._services=t;this._lifetime=i;this._userSettingsManager=t.diContainer.get(h.SettingsManager);this._contextPane=t.diContainer.get(c.LeftContextPane);this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(i)}return u.defineProperty(n.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!0,configurable:!0}),n.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(k,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},n.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._mode(1),r=this._contextPane,r.tryOpen(this).then((function(){return Q.spread([t._partGalleryWidget,i.require("MsPortalImpl/UI/UI.PartGalleryManager")],(function(i,u){t._partGalleryManager||(t._partGalleryManager=u.create(t._lifetime.createChildLifetime(),t._services.diContainer,i));i.setFocus();n.expandTileGallery&&r.collapsed(!1)}))})))},n.prototype.onAddingContent=function(n){var t=this;return i.require("MsPortalImpl/Widgets/Widgets.PartGallery").then((function(i){t._partGalleryWidget||(t._partGalleryWidget=i.create(f(r.createElement("div",{"class":rt})),new i.ViewModel(t._lifetime)),n.addChild(t._partGalleryWidget.element))}))},n.prototype.onRemovingContent=function(){this._partMgmtStarted=!1},n.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,n;return(r.addClass(t.organizeModeClassName),r.removeClass(d),n=i.getTopBarWidget(),n&&n.options.isInOrganizeMode(!0),o.register(this._dismissHandle),s.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._wasContextPaneCollapsed=this._contextPane.collapsed(),!this._partMgmtStarted)?this.startPartManagment({}):Q()},n.prototype._exitOrganizeMode=function(){var r=this._portalWidget,u=r.element,n,i;s.FlowLayoutDragDrop.Instance.disableDragDropTargets();u.removeClass(t.organizeModeClassName);u.addClass(d);n=r.getTopBarWidget();n&&n.options.isInOrganizeMode(!1);i=this._contextPane;i.close(!0);i.collapsed(this._wasContextPaneCollapsed);this._deselectCurrentTile();this._userSettingsManager.flushSettings();o.unregister(this._dismissHandle)},n.prototype._handleModeChange=function(n){var t=this;this._mode.subscribe(n,(function(n){switch(n){case 1:t._services.diContainer.getAsync(a.DialogManager).then((function(n){n.dismissOpenDialog()}));var i=t._services.desktop.getActiveJourney();i&&t._services.desktop.forceDiscardJourney(i.id);t._enterOrganizeMode();e.isFullscreen()&&e.exitFullscreen();break;case 0:default:t._exitOrganizeMode()}}))},n.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(k,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},n})();t.DesktopModeManagerImpl=b}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","i","o","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";function b(t,u,b,k){var g=r.Rpc.client,it=u.extensionManager,rt=u.diContainer.get(e.AssetTypeService),tt;i.isFeatureEnabled("whatsnew")&&b.whatsNewEnabledKey()&&v.WhatsNew.showWhatsNewModal.register(g,[y],(function(n){i.require("MsPortalImpl/Widgets/Widgets.WhatsNew").then((function(t){var i=n.items.map((function(n){var t=!n.published?"":new Date(n.published).toLocaleString();return n.description+="\r\n"+t,n}));new t.Widget($(r.createElement("div")),new a.ViewModel,i,k.element)}))}));v.PortalData.getPreloadData.register(g,[y],(function(n){return Q(p.early&&p.early.preload).then((function(t){return t&&t[n]}))}));v.UpdateContact.showUpdateContactModal.register(g,[y],(function(n){i.require("MsPortalImpl/Widgets/Widgets.UpdateContact").then((function(t){new t.Widget($(r.createElement("div")),new t.ViewModel,n.profile,n.irisNotificationDetails,k.element)}))}));var ut=k.getToastVM(),d={diContainer:u.diContainer,rpcClient:g,storageService:u.storageService,extensionManager:it,assetTypeService:rt,desktop:null,modeManager:null,getService:null,router:null,notificationManager:null},nt=d.desktop=h.createDesktopManager(k,d);return d.diContainer.get(o.PortalCommandManager).startListeningForEvents(),tt=d.getService=i.memoizeQ((function(t){switch(t){case"FeedbackPane":return w("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(u.diContainer.get(s.RightContextPane),ut,function(){return nt.getCurrentBladeInfo()})}}))}throw new Error("Invalid service type '{0}' specified.".format(t));})),d.notificationManager=l.createNotificationManager(d),d.router=f.createRouter(d),d.modeManager=c.createDesktopModeManager(d,k,t),t.registerForDispose([nt,d.router,tt,]),d}u.defineProperty(t,"__esModule",{value:!0});var y=r.Extension.getHubsWindowId(),w=i.require,p=window.fx;t.initialize=b}));
define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","f","i","o","Fx/Composition/DashboardFilters","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Services/Services.Settings","MsPortalImpl/UI/UI.DashboardFiltersManager","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.GeneralSettings"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function v(n,t,r){var u={store:i.isNullOrUndefined(r)?6:r,keys:t};return n.querySettings(u).then((function(n){return i.convertArrayToMap(t,i.identity,(function(t){return n[t]}))}))}function y(n,t,i,r){var u={store:r||6,settings:t};n.setSettings(u,i)}function p(n){var w=n.diContainer.get(s.SettingsManager),t=n.rpcClient,p=[r.Extension.getHubsWindowId()],b=n.diContainer.get(l.GeneralSettings);e.readHubsUserSettings.register(t,p,(function(n){return v(w,n.settingsKeys,n.settingStore)}));e.writeHubsUserSettings.register(t,p,(function(n){return y(w,n.settings,n.priority),undefined}));o.BrowserStorageSettings.readBrowserStorageSettingsEndpoint.register(t,p,(function(n){if(n.storageType!==0)return Q.reject("Access outside of local storage is denied.");var t={},i=!1;return n.storageKeys.forEach((function(n){a[n]||(i=!0);t[n]=MsPortalImpl.localStorage.getItem(a[n])})),i?Q.reject("Certain keys in the list are not allowed to be accessed."):Q(t)}));o.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint.register(t,p,(function(n){if(n.storageType!==0)return Q.reject("Access outside of local storage is denied.");var t=!1;return(i.forEachKey(n.storageSettings,(function(n){a[n]||(t=!0)})),t)?Q.reject("Certain keys in the list are not allowed to be accessed."):(i.forEachKey(n.storageSettings,(function(n,t){i.getTypeOf(t)==="string"&&MsPortalImpl.localStorage.setItem(a[n],t)})),Q(null))}));o.PartFilterEndpoints.getFilters.register(t,p,(function(t){var r=n.desktop.startBoard,e=r.dashboardFiltersManager,o=r.getFilterIdsForPart(t).then((function(n){var i=[];return n.forEach((function(n){i.push(r.dashboardFiltersManager.getFilterIdText(t,n).then((function(t){return{id:n,displayString:t}})))})),Q.all(i)})),s=r.getDashboardFiltersForPart(t,!0);return Q.all([o,s]).then((function(n){var c={},o=n[1],s=[],l;return u.keys(o).forEach((function(r){var u=e.normalizeFilterModel(h.getFilterKindFromId(r),o[r]),l;r!==f.TimeRangeFilter.filterId&&(l=e.getFilterValueDisplayText(r,o[r],t).then((function(n){return{displayString:n,value:u.values}})),s.push(l.then((function(t){var f=i.find(n[0],(function(n){return n.id===r})).displayString;c[r]={filterIdDisplayText:f,operator:u.operator,valueString:t.displayString,values:t.value}}))))})),l=i.forEachKey(i.clone(r.getPartInstance(t).filters,!0)||{},(function(n,r,u){var f=e.getFilterValueDisplayText(n,r,t).then((function(t){u[n]=i.extend(e.normalizeFilterModel(h.getFilterKindFromId(n),r),{valueString:t})}));s.push(f)}),{}),Q.all(s).then((function(){return{dashboardFilterDisplays:c,dashboardTimeRangeFilter:o[f.TimeRangeFilter.filterId],partFilters:l||{},allPossibleFilters:n[0]}}))}))}));o.PartFilterEndpoints.getFilterValues.register(t,p,(function(t){return n.desktop.startBoard.dashboardFiltersManager.getFilterValues(t.filterId,t.filterText,t.partId)}));o.PartFilterEndpoints.getFilterValueDisplayText.register(t,p,(function(t){var i=n.desktop.startBoard.dashboardFiltersManager.denormalizeFilterModel(h.getFilterKindFromId(t.filterId),t);return n.desktop.startBoard.dashboardFiltersManager.getFilterValueDisplayText(t.filterId,i,t.partId)}));o.PartFilterEndpoints.getFilterWarning.register(t,p,(function(t){return n.desktop.startBoard.dashboardFiltersManager.getFilterWarning(t.filterId,t.filterModel)}));o.DashboardEndpoints.getDashboardDeepLink.register(t,p,(function(t){return c.rpcGetDashboardDeepLink(n.diContainer,t)}));e.writeBrowsePreviewOptInFlagEndpoint.register(t,p,(function(n){b.optIntoNewBrowse(n)}))}u.defineProperty(t,"__esModule",{value:!0});var a=[];a[1]="hideBrowseInfo";t.registerRpcCallbacks=p}));
define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var t=i.Hubs.Notifications.NotificationStatus,e=u.NotificationMenu,o=[t.Information,t.Warning,t.Error,t.Success],s=[t.Information],h=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.hasNotifications=r.pureComputed((function(){return t.notifications&&(t.notifications()||[]).length})),t.lastPaneOpenedTime=r.observable(Date.now()),t.isPaneOpen=r.observable(!1),t.dismissDropdownTitle=e.all,t.dismissOptions=[{name:e.informational,dismissableStates:s,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(s)}))},{name:e.completed,dismissableStates:o,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(o)}))},],t}return __extends(t,n),t.prototype._checkNotificationsState=function(n){return this.hasNotifications()&&this.notifications().some((function(t){return n.indexOf(t.status)>-1}))},t})(f.ViewModel);n.ViewModel=h})(e||(e={})),e}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","i","o","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/UI/Hubs/UI.BrowseManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";function l(n){var t={diContainer:n,browseManager:n.get(s.BrowseManager),assetTypeService:n.get(o.AssetTypeService),extensionManager:n.get(f.ExtensionManager)},l=h+"All.Part",i,r;e.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",l,(function(n,i){return c.composePartViewModel((function(r){return new n.ServicesListPartViewModel(r,i,t)}),{initialState:i,logArea:l})}));e.registerWithState("Browse$BrowseServiceBladeViewModel",h+"Service.Blade",(function(n,i){return u.composeViewModel((function(r){return new n.BrowseServiceBladeViewModel(r,i,t)}))}));i=h+"Service.Part";e.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",i,(function(n,r){return c.composePartViewModel((function(i){return new n.ServiceItemsListPartViewModel(i,r,t)}),{logArea:i})}));r=h+"Service.PinnedPart";e.registerWithState("Browse$BrowseServiceTileViewModel",r,(function(n,i){return c.composePartViewModel((function(r){return new n.BrowseServiceTileViewModel(r,i,t)}),{logArea:r})}))}r.defineProperty(t,"__esModule",{value:!0});var c=i.ViewModels.Part,h="./MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";t.registerViewModels=l}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i){"use strict";var r;return (function(n){function t(){i.register("Gallery$CsmCommand","./MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",(function(n){return new n.CsmCommand}))}n.registerViewModels=t})(r||(r={})),r}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","i","o","FxInternal/Composition/ViewModelComposer","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r,u,f){"use strict";function y(n){var t=f.registerWithState,r,i,h,v;t(c+"ViewModel",e+(o+"Blade"),(function(n,t){return u.composeViewModel((function(i){return new n.SettingsBladeViewModel(i,t)}))}));r=e+(o+"SettingsPart");t(c+"$SettingsPartViewModel",r,(function(t,i){return s((function(r){return new t.SettingsPartViewModel(r,i,n)}),{logArea:r})}));t(l+"ViewModel",e+(o+"LanguageSelectionBlade"),(function(n,t){return u.composeViewModel((function(i){return new n.LanguageSelectionBladeViewModel(i,t)}))}));i=e+(o+"LanguageGrid");t(l+"$LanguageGridViewModel",i,(function(n,t){return s((function(i){return new n.LanguageGridViewModel(i,t)}),{logArea:i})}));t(a+"ViewModel",e+(o+"LocaleSelectionBlade"),(function(n,t){return u.composeViewModel((function(i){return new n.LocaleSelectionBladeViewModel(i,t)}))}));h=e+(o+"LocaleGrid");t(a+"$LocaleGridViewModel",h,(function(n,t){return s((function(i){return new n.LocaleGridViewModel(i,t)}),{logArea:i})}));v=e+(o+"DiagnosticsPart");t("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",v,(function(t,r){return s((function(i){return new t.DiagnosticsPartViewModel(i,r,n)}),{logArea:i})}))}r.defineProperty(t,"__esModule",{value:!0});var v=i.ViewModels,s=v.Part.composePartViewModel,e="./MsPortalImpl/UI/Hubs/ViewModels/",h="Settings$",c=h+"SettingsBlade",l=h+"LanguageSelectionBlade",a=h+"LocaleSelectionBlade",o="UI.Settings.";t.registerViewModels=y}));
define("MsPortalImpl/UI/UI.AdvisorNotificationHelper",["require","exports","f","i","o","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Languages","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o){"use strict";function v(n){var u=i.isFeatureEnabled("testadvisor"),v,y;return t.percentageOfUsersShownAdvisorNotification>0||u?(v=Date.now()-h,y=i.Base.Resources.getVersionlessContentUri("Content/static/MsPortalImpl/AdvisorNotifications/AdvisorDashboard_"+e.getCultureSpecificLanguage().split("-").join("")+".png"),u||!l&&!a)?n.querySetting(15,"AdvisorNotification").then((function(e){if(u||(e||0)<v&&Math.random()<t.percentageOfUsersShownAdvisorNotification){r.Hubs.Notifications.InternalClientNotification.internalPublish({notificationId:"AdvisorModal",timestamp:new Date,title:s.title,description:"<h1>"+i.encodeHtml(s.description)+"<a href='"+i.encodeAttribute(c.fx.environment.links.learnAdvisor)+'\' target="_blank"><span>'+i.encodeHtml(f.Blade.helpText)+'<\/span><\/a><img style="padding-top: 20px; display: block; margin-left: auto; margin-right: auto;" src= "'+i.encodeAttribute(y)+'"><\/h1>',status:i.Hubs.Notifications.NotificationStatus.Information,descriptionAsHtml:!0,toastDuration:4,inlineForm:{buttons:[{label:s.buttonText,id:"LaunchAdvisorBladeButton",deepLink:{uri:"#blade/Microsoft_Azure_Expert/AdvisorBlade"}}]}});var l=Date.now();return n.setSetting(15,"AdvisorNotification",l),i.Base.Diagnostics.Telemetry.trace({source:o.Source.ToastTray,action:o.Action.AdvisorNotificationShown,data:{advisorNotificationOccurence:h,percentageOfUsersShownAdvisorNotification:t.percentageOfUsersShownAdvisorNotification,testAdvisorFlag:u,timeElapsedInMs:v,advisorLastShown:e,advisorShownTime:l}}),!0}return!1})):Q(!1):Q(!1)}u.defineProperty(t,"__esModule",{value:!0});var c=window,s=f.AdvisorNotification,l=i.isFeatureEnabled("ci"),a=i.isFeatureEnabled("nativeperf"),h=(parseInt(i.getFeatureValue("advisornotificationdays"))||30)*864e5;t.percentageOfUsersShownAdvisorNotification=parseFloat(i.getFeatureValue("advisornotificationpercent"))/100;t.showAdvisorNotification=v}));
define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","f","o","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u){"use strict";function e(n,r,e,c,l,a,v){return f||!h&&s&&!t.npsShownInSession?i.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(f){o.Diagnostics.Telemetry.trace({source:u.Source.ToastTray,action:u.Action.NPSShown,data:i.extend({productId:l},a)});f.showSurvey(n,r,e,c,l,v);t.npsShownInSession=!0})):Q(null)}function a(n,t,i,r){var u=r(),o=Date.now()-l,s=u<o&&Math.random()<c;return f||s?e(n,t,i,null,null,{surveyLastCompleted:u},(function(){r(Date.now())})):Q(null)}r.defineProperty(t,"__esModule",{value:!0});var o=i.Base,f=i.isFeatureEnabled("testnps"),s=i.isFeatureEnabled("nps"),h=i.isFeatureEnabled("ci"),c=(parseFloat(i.getFeatureValue("npspercent"))||1)/100,l=(parseInt(i.getFeatureValue("npsintervaldays"))||90)*864e5;t.npsShownInSession=!1;t.showNps=e;t.showPortalNps=a}));
define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","f","o","ko"],(function(n,t,i,r,u){"use strict";function l(n,t,r){return t.addCallbacks({onIdle:function(t,i){var f=u.unwrap(n);f&&t.getTime()-i.getTime()>=f*6e4&&(o.warning("Signing out at {0} after idle timeout of {1} minutes".format(t,f)),r())},onBusy:i.noop})}function p(n,t,r,u,o,s,a){if(c?l(c,u,o):r.subscribeAndRun(n,(function(n){n&&!f?f=l(r,u,o):!n&&f&&u.removeCallbacks(f)})),i.isFeatureEnabled("sessionvalidity")){var p=function(){return Q.delay(v).then((function(){e().then((function(n){n&&i.require("MsPortalImpl/UI/UI.SessionHandlerDeferred",null,!0).then((function(n){n.validateSessionLifetime(t.bootstrapState,s,a,"SessionValidityPoll").then((function(n){n?(h(),p()):y()}))}))}))}))};p()}h()}r.defineProperty(t,"__esModule",{value:!0});var a=window,o=i.Base.Diagnostics.createLog(n),v=parseInt(i.getFeatureValue("sessionpollinterval"))||36e5,s="LastValidSessionTs",h=function(){MsPortalImpl.localStorage.setItem(s,Date.now().toString())},y=function(){MsPortalImpl.localStorage.removeItem(s)},c=parseInt(i.getFeatureValue("idletimeoutmins")),f,e=i.memoizeQ((function(){var n=a.fx.environment.links.graphPoliciesEndpoint;return n?Q(i.Base.Net2.ajax({uri:n,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return(n.value||[]).some((function(n){return(n.type||"").toLowerCase()==="tokenlifetimepolicy"&&(n.definition||[]).some((function(n){return(n||"").toLowerCase().includes("maxagesession")}))}))})).catch((function(n){var t=(n.jqXHR||{}).status;return t===401||t===403?!0:t===0?(e.clear(),!1):(e.clear(),o.error("Error calling graph for policy details",n),!0)})):Q(!0)}));t.initialize=p}));
define("_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxt-copy{display:-webkit-flex;display:flex;margin-top:5px}.fxt-copy-control{padding-left:10px}")}));
define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/Services/Services.SecurityTokens","_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function p(n,t,i,r,u){et.ClientNotification.publish({title:n,description:t,status:r||b.Information,descriptionAsHtml:u,correlationIds:[i]})}var w;u.defineProperty(t,"__esModule",{value:!0});var pt=r.Extension,it=i.Base,rt=it.Constants,ut=it.Diagnostics,ft=ut.Telemetry,et=i.Hubs.Notifications,b=et.NotificationStatus,k=o.Action,ot=o.Source,v=window,st=v.document,d=ut.createLog(n),lt=r.ensureAbsoluteUri(v.fx.internalEnv.errorPageUri),g=rt.Shell,ht=e.Shell,nt=ht.Notifications,a=ht.Dialogs,tt=nt.SessionEnding,y=nt.TokenFailure,ct=nt.VersionChanged,at={sessionId:i.sessionId},vt=[12e5,6e5,],yt='<div class="fxt-copy"><a href="#" data-bind="text: copyText, click: copyClick"><\/a><\/div>';w=(function(){function n(n,t,i,r,u){var f=this;this._authStateManager=n;this._dialogManager=t;this._rootElements=i;this._windowManager=r;this.isShellInitialized=Q.defer();this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;u.sessionEndedHandler=function(n,t){return f.onLastTokenRefresh(n,t)};u.tokenFailedHandler=function(n,t,i){f.onStatus({code:2,message:i,data:{resourceName:t}},n)}}return n.prototype.onLastTokenRefresh=function(n,t){var i=Date.now();if(t<=i)this.onStatus({code:2},n);vt.forEach((function(n){var r=t-n;v.setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?tt.messageFmt.format(t):tt.message;p(tt.title,i,"lastTokenRefresh")}),r-i)}))},n.prototype.onStatus=function(n,t){var c=this,u=Q.resolve(null),f,i,o,s;if(!n||this._pageBlockingPrompt)return u;var e=t===g||t===rt.ExtensionNames.Hubs,r=n.data||{},l=r.uri||"",h=n.message||"";switch(n.code){case 0:break;case 1:e?u=this._showDialog(t,k.ShellVersionChanged,a.newVersionMessageTitle,a.newVersionMessageDescription,a.newVersionDefaultButtonText,null,3e4,2,5,r):(ft.trace({source:ot.Shell,action:k.ExtensionVersionChanged,data:t}),d.warning("Extension reporting incompatible server version. {0}:{1}".format(t,r.version)),p(ct.title,ct.messageFmt.format(t),"VersionChanged-{0}".format(t)));break;case 2:f=r.resourceName;e&&!f?(this._authStateManager.clear(),this._windowManager.redirect({uri:lt+"/UE_SessionExpired"+window.location.hash})):(i=y.description.format(t),f&&(i+="\n"+y.resourceName.format(f)),h&&(i+="\n"+y.errorDetails.format(h)),p(y.title,i,"AuthTokenError-{0}".format(t),b.Information));break;case 7:u=this._showDialog(g,"SessionExpired",a.sessionExpired,a.sessionExpiredMessage,a.refresh,null,0,1,2,r);break;case 4:if(d.verbose("Received a status code zero from extension {0} for URL '{1}'.".format(t,l)),!e)break;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)break;this._unknownNetworkErrorCount++;u=this._showDialog(g,k.UnknownNetworkError,a.connectionErrorMessageTitle,a.connectionErrorMessageDescription,null,a.connectionErrorCancelButtonText,0,2,0,r).then((function(n){c._unknownNetworkErrorCanceled=n===1}));break;case 6:i=a.tooManyRequestsDescription;o=r.retryAfter;o&&(i=i+" "+a.tooManyRequestsRetry.format(o));p(a.tooManyRequestsTitle,i,"TooManyRequests-{0}".format(t),b.Warning,!0);break;default:s="Received unknown extension event '{0}' for extension '{1}'.".format(n.code,t);u=Q.reject(s);d.error(s)}return u},n.prototype._showDialog=function(n,t,u,f,e,o,s,h,l,y){var p=this,k,d=c.hasFlag(l,2),w,g,b,nt;return this._pageBlockingPrompt=c.hasFlag(l,1),t&&ft.trace({source:ot.Shell,action:t,data:n}),d&&this._authStateManager.clear(),w=function(n){p._windowManager.redirect({skipFlushBuffers:d,delayPromise:n&&s?Q.delay(s):null})},g=c.hasFlag(l,4)&&Q.isPending(this.isShellInitialized.promise),g?(k=Q.defer().promise,w(!1)):(b=Q.defer(),this._isDialogVisible=!0,nt=f+" "+yt,k=this._dialogManager.showModalDialog({title:u,description:nt,templateViewModel:{copyText:a.copyText,copyClick:function(){var f=JSON.stringify(i.extend2(at,y||{}),null,2),n=r.createElement("pre"),t,u;n.textContent=f;st.body.appendChild(n);t=v.getSelection();t.removeAllRanges();u=st.createRange();u.selectNodeContents(n);t.addRange(u);v.document.execCommand("copy");n.remove()}},defaultButtonText:e,cancelButtonText:o,buttons:h,uiShield:{hidePromise:b.promise}}).then((function(n){return p._pageBlockingPrompt?(p._rootElements.showSplash(!0),b.resolve(),w(!0)):n===4?w(!1):b.resolve(),n})).finally((function(){p._isDialogVisible=!1}))),k},n})();w=__decorate([f.Class(),__metadata("design:paramtypes",[c.AuthStateManager,s.DialogManager,h.RootElements,h.WindowManager,l.SecurityTokensManager])],w);t.StatusHandler=w}));
define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","i","o","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o){"use strict";function rt(n,t){l=n.desktop;k=t&&t.increment||w;d=t&&t.tooSmall||b;s&&s.dispose();s=new r.TriggerableLifetimeManager;l.activeJourney.subscribe(s,(function(n){n?v():a(y)}));l.getDashboardManager().then((function(n){n.currentDashboardId.subscribe(s,(function(n){v();p=n;a(y)}));p=n.currentDashboardId()}));var i,u,f;h.addEventListener(o.default.blur,u=function(){v()});h.addEventListener(o.default.focus,f=function(){a(y)});h.addEventListener(o.default.mousemove,i=function(){h.removeEventListener(o.default.mousemove,i);a()});s.registerForDispose((function(){h.removeEventListener(o.default.blur,u);h.removeEventListener(o.default.focus,f);h.removeEventListener(o.default.mousemove,i)}))}function ut(){s&&s.dispose();v()}function a(n){c||l.activeJourney()||(n&&(nt=0,++g),tt=Date.now(),c=setTimeout((function(){it();c=null;a()}),k))}function v(){c!==null&&(clearTimeout(c),it());c=null}function it(){var n=Date.now()-tt;n>=d&&i.Base.Diagnostics.Telemetry.trace({source:e.Source.Shell,action:e.Action.DashboardViewTime,data:{target:"Dashboard",trackId:p,timespan:n,sequenceId:g,sequence:++nt,tileCount:l.startBoard.children.filter((function(n){return!n.dontSetupWidget})).length,fullscreen:!!f.isFullscreen()}})}u.defineProperty(t,"__esModule",{value:!0});var h=window,y=!0,w=3e5,b=1e4,l,p="",k=w,d=b,g=0,nt=0,c=null,tt,s;t.start=rt;t.stop=ut}));
define("MsPortalImpl/UI/UI.Initialize",["require","exports","f","i","o","ko","$","MsPortalImpl/AsyncLoader","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Themes","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Controls/ControlBindings.Async","Fx/Diagnostics","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/ExtensionMetadataSource","Fx","Fx/Feedback","Fx/Telemetry","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Base/Languages","MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Util","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.AdvisorNotificationHelper","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/UI/UI.AuthStateManager","MsPortalImpl/UI/UI.ViewTimeTelemetry","Fx/UriBuilder","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/Services/Services.ExtensionTokensManager","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di,gi,nr,tr){"use strict";function vu(n,t){t&&t.startsWith("#")&&n.route(t)}function fr(n,t,i){tt.trace({source:n,action:t,data:i})}function yf(n){var f,e;if(n&&ar&&ar.getEntriesByType&&ar.timing){var u=er(),i=function(n,t,i){yu(n,{duration:t,endTime:Math.round(i+ar.timing.navigationStart)})},o=ar.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=o.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=o.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),f=t-r,e=u-f-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",s,h),i("StartupResourceDownload",f,t),i("StartupScriptExecution",e,u),e}}function yu(n,t){t=t||{};var r=t.duration||er(),i=t.data||{};return i.cdn="CdnIndex"+kr.index,i.bundling="Bundling"+kr.bundling,sr.trace({timestamp:t.endTime,source:cr,action:n,actionModifier:sr.ActionModifier.Complete,duration:r,data:i}),r}function pf(n,t){var i=n.getValue(lu,cu,au);return t!==i&&n.setValue(lu,cu,t,au),i}function wf(){gi.registerPrefix(b.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",(function(n,t,i,r){return n.createViewModel(t,i,r)}))}function bf(n,t,u,f,o,s){var h=new li.ViewModel,a=i.memoizeQ((function(){return ir("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((function(n){var i=new n.Widget(e(r.createElement("div")),h,t,o);return s.registerForDispose(i),i}))})),c=i.memoizeQ((function(){return ir("MsPortalImpl/UI/Hubs/UI.NotificationHelper")})),l;t.notificationManager.notifications.subscribeArrayChanges(s,(function(n){c().then((function(t){return t.showToastAndUpdateCount(n,h,u)}))}),(function(n){c().then((function(t){return t.removeToastAndUpdateCount(n,h,u)}))}));n.options.topBarViewModel.notificationButtonClick=function(){a().then((function(n){n.toggleNotificationsContextPane().then((function(){u.removeAllToasts();c().then((function(n){return n.updateUnreadCountOnButton(0)}))}))}))};l={events:tr.default.fxtoastclick,handler:function(n,t){f.handleNotificationClick(t,!0)}};u.eventHandlers.push(l)}function kf(n,t,u,f){var o=i.memoizeQ((function(){return ir("MsPortalImpl/Widgets/Widgets.SettingsPane").then((function(n){var i=new n.Widget(e(r.createElement("div")),new n.ViewModel,t,f);return u.registerForDispose(i),i}))}));n.element.on(tr.default.fxsettingsbuttonclick,(function(){o().then((function(n){fr(lr.TopBar,ur.SettingsPaneOpen);n.toggleSettingsContextPane()}))}))}function df(n,t){n.feedbackButtonClick=function(){t.getService("FeedbackPane").then((function(n){var t=n.widget;fr(vr,ur.FeedbackSmileyClicked,{isPaneOpen:t.isVisible()});t.toggle()}))}}function gf(n,t,u,f,o,s){var h=i.memoizeQ((function(){return ir("MsPortalImpl/Widgets/Widgets.DirectoryPane").then((function(n){var i=new n.Widget(e(r.createElement("div")),new n.ViewModel,{portalServices:t,userInfoPromise:u,tenantsPromise:f,redirectWithCdn:s});return o.registerForDispose(i),i}))}));n.options.topBarViewModel.directoryButtonClick=function(){h().then((function(n){n.toggleDirectoryContextPane()}))}}function ne(n,t,i){n.initOptions((function(){return ir("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((function(r){r.initSearchWidgetOptions(i,n,t)}))}))}function te(n,t,i,r,u,f,e,o){var h=n.getToastVM(),s=n.getTopBarWidget(),c=s.options;kf(s,t,r,e);df(c,t);ne(s.searchWidget,t,r);bf(n,t,h,u,o.getCurrentUser().emailAddress,r);gf(n,t,o.getUserInfo(),o.getTenants(),r,f)}function ie(){return i.convertArrayToMap(["EntryPoint","SignInIndex"],(function(n){return"PageTelemetry_"+n}),(function(n,t,i){var r=MsPortalImpl.sessionStorage.getItem(i);if(r)return MsPortalImpl.sessionStorage.removeItem(i),JSON.parse(r)}))}var pu;u.defineProperty(t,"__esModule",{value:!0});var or=r,wu=or.Data,bu=or.Extension,ku=or.TriggerableLifetimeManager,yr=i.Base,du=yr.Constants,gu=du.Shell,fu=yr.Diagnostics,sr=fu.Telemetry,nf=r.NetDiagnostics,tf=yr.Resources,eu=r.Rpc,rf=i.Hubs.Notifications,ou=rf.NotificationStatus,uf=or.Hubs.Notifications,ff=i.Services,su=yr.Net2,ur=ii.Action,lr=ii.Source,pr=MsPortalImpl.Performance,hr=window,ar=hr.performance,dr=hr.fx,er=dr.getTimestamp,gr=sr.trace,ef=eu.client,cr=lr.Shell,rr=dr.environment,of=rr.chrome,nu=rr.links,vr=lr.TopBar,ir=g.require,sf=i.ensureSuffix,wr=sf(tf.getAppRelativeUri("/"),"/"),hf=hr.console,br=hr.location,tu=p.createLog(n),hu=wr+"SignOut",cf=wr+"signin/index",lf=r.ensureAbsoluteUri(dr.internalEnv.errorPageUri),af=g.isDevelopmentMode,cu="loadedPageVersion",lu=pt.ComponentName.Telemetry,au=0,kr=rr.cdn,iu="FirstVisitedTimestamp",ru,uu,vf=function(){tu.warning.apply(tu,arguments)};su.setAjaxLogFunc(vf);t.routeIfHash=vu;pu=(function(){function t(n){this._lifetime=new ku;this._dependencies=n}return t.prototype.initialize=function(){var p=this,b=this._lifetime,tt=this._dependencies,t=tt.diContainer,ii=t.get(vi.RootElements),g=t.get(r.Features),li=g.isEnabled("ci"),pt=tt.storageService,gi=new di(br.href);return y.initialize(t),Q.spread([tt.diContainer.getAsync(bi.AuthStateManager),tt.diContainer.getAsync(bt.SecurityTokensManager),tt.diContainer.getAsync(dt.SettingsManager),],(function(y,bt,vi){var bf=y.bootstrapState,dr=y.getCurrentUser(),lu=function(n,t,r){var u=new di(n+br.search+i.ensurePrefix(r,"#")),f=kr.forceIndex,e=u.query;y.clear(!0);f&&e.setParameter(kr.indexParameter,f);i.forEachKey(t,(function(n,t){return e.setParameter(n,t)}));p._redirect({uri:u.toString()})},cu,vf;if(!bf){lu(wr,null,br.hash);return}rr.enableAnimations||e.enableAnimations(!1);cu=t.get(wt.PortalIdleStateService);sr.initialize(cr);kt.init(vi);var kf=dt.queryStores(vi,[8,4]),du=rr.pageVersion,tf=pf(pt,du),yr={defaultRoute:!1,splashScreen:pr.splashScreenLoadTime,initializeStart:er(),cdnFailedIndex:tt.cdnFailedIndex,loadedSameVersion:du===tf,previousVersion:tf||"",performanceTelemetry:r.NetDiagnostics.getPerformanceTelemetry()};ft.shutdown();ft.initialize(ii.portal);var df=ft.read(it.Shell.Reader.portalLoading,1,"portal"),au=t.get(wi.StatusHandler),ar,rf=Q.spread([t.getAsync(k.ExtensionManagerOptions),t.getAsync(k.ExtensionManager),t.getAsync(vt.GeneralSettings),t.getAsync(yt.FavoritesSettings),t.getAsync(yt.UserDirectorySettings),t.getAsync(c.ThemeManager),],(function(f,c,k,ft,lt){function oe(n){v.getAvatarImage(dr.emailAddress,dr.avatarUri,dr.defaultAvatarUri,pt,n).then((function(n){vt.avatarImage(n)}))}var ki,kr,dt,yf,yt,su,wt,wu,pf,di,kt,du,sr,pi,fe,gu,nf,tf,vt,ee,rf,ni,ff,se,he;tt.extensionManager=c;var wi=f.extensionsAsMap,vf=bt.getTokenFunc,ce=gi.query.getParameter("l")!==undefined;et.initialize(b,pt,k.rawLocale,rr.localeFromQuery,ce)&&p._redirect({uri:null,skipFlushBuffers:!0});i.isObject(rr)&&hf.log("Version: "+rr.version+"\nSession: "+i.sessionId);yr.initializeGeneralSettings=er();ki=et.currentLocaleContext;kr=ki.selectedDisplayLanguage;fr(cr,ur.PortalInitializeLanguage,{language:kr,formatCulture:ki.selectedFormatCulture||kr});dt=dr.tenantId;yf=y.getTenants();rt.initialize();b.registerForDispose((function(){rt.dispose()}));yt=t.get(nr.Widget);ar=ei.initialize(b,tt,k,yt);su=yt.getTopBarWidget();wt=ar.desktop;ot.initialize(ar.assetTypeService,b);wu=Q(bi.getSubscriptions());pf=wu.then((function(n){pu(n)}));p._notificationManager=ar.notificationManager;c.lastExtensionError.subscribeAndRun(b,(function(n){n&&p._notificationManager.addClientNotification({title:it.Shell.extensionError,description:it.Shell.loadingError.format(n.name),status:ou.Error,timestamp:new Date})}));bu.extensionStatusEndPoint.register(ef,null,(function(n,t){n&&sf(n,t.srcWindowId)}));di=yt.options;kt=di.topBarViewModel;g.isEnabled("azureconsole")&&(kt.getConsoleViewModel=function(){return Q.spread([t.getAsync(d.ShellBootEnvironmentState),ir("MsPortalImpl/Widgets/Widgets.Console"),],(function(n,t){return new t.ViewModel({src:rr.consoleUri,region:n.value.region,getAuthToken:vf,features:g})}))});kt.exitDevMode=function(){ii.showSplash(!0);MsPortalImpl.Extension.unregisterAll().then((function(){p._redirect({uri:wr})}))};var or=function(){ir("../Base/Base.ClientRawFileDownload",n).then((function(n){n.downloadFile({provideText:function(){return ne().then((function(n){return JSON.stringify(n,null,2)}))}},"PortalDiagnostics.json","charset=utf-8;application/json")}))},bf=i.memoizeQ((function(){return ir("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(b,ar)}))})),df=function(){bf().then((function(n){return n.toggleStickys(ru)}))},le=of.hideShortcuts?null:ut.setup(yt,ar,or,df),ae=yt.element,gf=function(){return o.get("MsPortalImpl/Widgets/Widgets.WelcomeSequence","Widget").then((function(n){var i=n.create(t,yt,vi);return b.registerForDispose(i),i}))},ve=i.memoizeQ((function(){return ir("MsPortalImpl/Widgets/Widgets.HelpPane").then((function(n){var t=new n.Widget(e(r.createElement("div")),new n.ViewModel,ar,or,le,gf);return b.registerForDispose(t),t}))}));kt.helpButtonClick=function(){ve().then((function(n){return n.toggle(lr.TopBar)}))};var ne=function(){return Q.all([ir("MsPortalImpl/Base/Base.DiagnosticsPopup"),pf,ee]).spread((function(n){return n.getDiagnosticsData(ar,pu,ku,bt)}))},re=dt==="72f988bf-86f1-41af-91ab-2d7cd011db47",ue=i.getFeatureValue("showbugreportlink");kt.canReportBug(ue==="force"||ue==="true"&&re&&!li);kt.reportBug=function(){ir("./UI.Portal.Actions",n).then((function(n){n.reportBug(ar,ne,gi)}))};du=ar.diContainer.get(si.FavoritesManager);sr=di.sideBarViewModel;sr.attachFavoritesManager(du);pi=ar.router;fe=i.getIdGenerator("SideBarOpeningBlade");sr.launchBlade=function(n,t){var f=pi.route(n,t),u=yt.getPanorama(),i=u&&u.getJourneyWidget(),r;i&&(r=fe(),i.loadingHint(r,!0),f.finally((function(){i.loadingHint(r,!1);i.trigger(tr.default.fxbladerepos,null,{noScroll:!0,noExitPeekMode:!0})})))};du.initializeFavorites(ft);c.initialize({useCachedManifests:!0});bi.initializeRpc(y,wi);ct.initializeRpc();ti.registerEndpoints(eu.client,ar.desktop);gu=Q.fcall((function(){var n=function(n){var t=u.keys(wi).some((function(n){var t=wi[n];return t.isTestExtension||t.isTestStamp}));return kt.inDevMode(t||n||g.isEnabled("canmodifyextensions")),wt.initialize(wi,kf,yr)};return g.isEnabled("canaddgallerypackages")?t.getAsync(o.get("MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource","GalleryPackageState")).then((function(t){return yr.galleryPackagesSideload=er(),n(t.hasUntrustedGalleryPackages)})):n(!1)})).then((function(){return vi.querySetting(14,iu).then((function(n){var i=!n,t;return i&&(n=Date.now(),vi.setSetting(14,iu,n)),fr(cr,ur.FirstVisited,(t={},t[iu]=n,t)),i}))})).then((function(n){g.isEnabled("landnewusertohome")&&n&&k.landingPage(3);yr.defaultLandingView=h.isLandingPageDashboard(t)?"Dashboard":"Home";yr.desktopAndExtensionManagerInitialize=er();var i=g.isEnabled("nodirectory");return pi.initialRoute((function(){return yr.defaultRoute=!0,pi.goToLandingPage("UiInitialize",!0,i)}),{skipFocus:i})})).then((function(){su.initReactiveLayout();yr.setupInitialRoute=er();ii.showSplash(!1);pr.pageLoaded();yr.locationHash=gi.fragment.split("?")[0];yr.hiddenTime=pr.getHiddenTime();var n={data:e.extend(yr,ie())};c.getHubsExtension().then((function(){ru=yu("TotalTimeToPortalReady",n)}));p._idleHandle=cu.addCallbacks({onIdle:function(){var n=hr.navigator;n&&n.onLine!==!1&&(oe(!0),i.getFeatureValue("prefetch")!=="false"&&ir("MsPortalImpl/Services/Services.PortalPrefetch",null,!0).then((function(n){n.start(b,cu,pt,ru)})),rr.useCachedManifests&&c.refreshManifests().catch((function(){})),ir("MsPortalImpl/Services/Services.BrowserTelemetry",null,!0));cu.removeCallbacks(p._idleHandle)},onBusy:i.noop})})).catch((function(n){uu=uu||"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3);p._redirect({uri:lf+uu})}));nf=i.isFeatureEnabled("tokenfetch");lt.signInToLastVisitedDirectory()&&lt.userDefaultDirectory()!==dt?(lt.userDefaultDirectory(dt),nf&&y.persistentRefreshToken(dt)):nf&&lt.userDefaultDirectory()===dt&&y.persistentRefreshToken(dt);gu.then((function(){var n,i,u,f;p._notificationManager.listenForClientNotifications();vi.querySetting(7,"WelcomeSequence").then((function(n){n||li||!g.isEnabled("guidedtour")?g.isEnabled("nodirectory")?di.topBarViewModel.directoryButtonClick():ri.showAdvisorNotification(vi).then((function(n){n||ai.showPortalNps(k,vi,tf,k.npsTimeMs)})):gf().then((function(){fr(cr,ur.PortalInitializeWelcome)}))}));at.init(vi);!g.isEnabled("internalonly")||g.isEnabled("canmodifyextensions")||re||(n=r.trustedParentOrigin,i=n.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),n!==i&&(u=it.Portal,p._notificationManager.addClientNotification({status:ou.Information,title:u.preview,description:u.unsupportedEnvironment.format(n),uri:i,timestamp:new Date,uriAction:uf.ClientNotificationUriAction.OpenInCurrentTab})));l.isSafari&&l.webKitVersion<602&&(f=it.Portal,t.getAsync(w.DialogManager).then((function(n){return n.showModalDialog({title:f.unsupportedBrowser,description:f.unsupportedBrowserDesc.format(nu.unsupportedBrowser),buttons:1,showErrorIcon:!0})})))}));ht.setupAssetTypeServiceRpc(ar);ar.diContainer.get(st.AssetManager).onAssetDeleted((function(n,t,i){ar.diContainer.getAsync(o.get("MsPortalImpl/UI/Hubs/UI.ResourceMapManager","ResourceMapManager")).then((function(r){r.processAssetDeletion(n,t,i)}))}));return o.registerRpc(ar.diContainer),gt.create(ar),fu.ErrorReporter.initialize((function(){tu.debug(wt.getDiagnosticsData())})),s.initialize(wt,ar),tf=yt.getToastVM(),te(yt,ar,or,b,p._notificationManager,lu,vf,y),nt.Internal.showNpsEndpoint.register(ar.rpcClient,null,(function(n,t){ai.showNps(k,vi,tf,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)})),nt.Internal.canShowNpsEndpoint.register(ar.rpcClient,null,(function(){return!ai.npsShownInSession})),vt=su.avatarMenuVM,vt.userIdentity(dr),vt.hideTenant(g.isEnabled("hideavatartenant")),y.getUserInfo().then((function(n){vt.userInfo(n)})),ee=yf.then((function(n){var t=n.tenants;ku(t);vt.listOfTenants(t)})),vt.showDiagnostics=or,vt.showDebugTools=df,vt.signedOut=function(){gr({source:lr.TopBar,action:ur.AvatarMenuSignOut});y.clear();p._redirect({uri:hu})},vt.openAccountPortal=function(){var n=nu.accountPortal;fr(vr,ur.AvatarMenuOpenBilling);vu(pi,n.startsWith("#")?n:n+"subscriptions")},vt.switchDirectory=kt.directoryButtonClick,oe(),sr.saveCollapseState=function(n){k.sideBarCollapsedKey(n)},vt.submitAnIdea=function(){fr(vr,ur.AvatarMenuOpenFeedback);hr.open(nu.submitAnIdea,"_blank")},vt.showMyAccessBlade=function(){fr(vr,ur.AvatarMenuOpenAccessDetails);wt.createJourneyForBlade({extension:"HubsExtension",detailBlade:"MyAccessBlade",detailBladeInputs:{resourceId:""},openInContextPane:!0,defaultMenuItemId:undefined},wt.generateLoadingJourneyGuid())},wu.then((function(n){var t=(ki.selectedFormatCulture||"").toLowerCase().split("-").slice(-1)[0];vt.contactInfoEnabled(n.subscriptions.length&&i.isFeatureEnabled("contactinfo")&&!["at","ru","de","gr"].includes(t))})),vt.showContactInfoBlade=function(){fr(vr,ur.AvatarMenuOpenContactInfo);wt.createJourneyForBlade({extension:"HubsExtension",detailBlade:"ContactInfoBlade",detailBladeInputs:{resourceId:""},openInContextPane:!0,defaultMenuItemId:undefined},wt.generateLoadingJourneyGuid())},vt.switchAccount=function(n){MsPortalImpl.localStorage.removeItem("LastValidSessionTs");lu(cf,n?{loginHint:n}:{selectAccount:"true"},a.getHashQueryStringSegment(br.href))},!li&&(af||rr.clientOptimizations&&rr.clientOptimizations!=="true"||g.isEnabled("canmodifyextensions"))&&bf().then((function(n){return n.startErrorDetection(b)})),rf="data-click-telemetry",ni=ae[0],ni.addEventListener(tr.default.mousedown,he=function(n){ff=n.target},!0),ni.addEventListener(tr.default.mouseup,se=function(n){var i=ff,r,t;if(ff=null,n.target===i&&(r=e(i),t=r.closest("["+rf+"]",ni),t.length)){var o=t.attr(rf)+"",u=t.closest(".fxs-tile",ni).data(fi.CompositionInstanceDataName),f=u&&u.locator,s=f&&f.toFriendlyString()||cr;gr({source:s,action:ur.CustomClick,name:o})}},!0),b.registerForDispose((function(){ni.removeEventListener(tr.default.mousedown,he,!0);ni.removeEventListener(tr.default.mouseup,se,!0)})),ar.diContainer.get(oi.BrowseManager).initialize(),ui.registerViewModels(ar.diContainer),hi.registerViewModels(),yi.registerViewModels({portalServices:ar,securityTokensManager:bt,subscriptions:pu,tenants:ku}),ci.registerRpcCallbacks(ar),wf(),au.isShellInitialized.resolve(),gu})),sf=function(n,t){au.onStatus(n,t)},pu=f.observable(),ku=f.observableArray();return wu.registerTelemetrySubmissionHandler(),nf.registerTelemetrySubmissionHandler(),or.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),su.status.subscribe(b,(function(n){sf(n,gu)})),t.getAsync(ni.SharingTelemetryProcessor).then((function(n){sr.addProcessor(n)})),g.isEnabled("consoletelemetry")&&(vf=ff.getConsoleTelemetryEventProcessor(),sr.addProcessor(vf)),MsPortalEarly.initializedTelemetry(gr),yf(pr.splashScreenLoadTime),rf.then((function(){ki.start(ar)})).then((function(){df();ft.read(it.Shell.Reader.portalReady,1,"portal");pi.initialize(p._lifetime,y,ar.diContainer.get(vt.GeneralSettings).idleTimeoutMins,cu,(function(){return p._redirect({uri:hu})}),dr.tenantDomain,au)})),b.registerForDispose(ki.stop),lt.registerFileUploadEndpoints(),at.uploadSettingsManager=vi,rf}))},t.prototype.dispose=function(){or.resetGlobalState();this._lifetime.dispose()},t.prototype._redirect=function(n){this._dependencies.diContainer.get(vi.WindowManager).redirect(n)},t})();t.Portal=pu}));
define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c23{fill:#cae3f3}.msportalfx-svg-c24{fill:#59aed3}.msportalfx-svg-c25{fill:#4c3b12}.msportalfx-svg-c26{fill:#be9555}.msportalfx-svg-c27{fill:#4f4d52}.msportalfx-svg-c28{fill:#ef6f59}.msportalfx-svg-c29{fill:#f7cb64}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-blade-header-icon .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-blade-header-icon .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g *{fill:inherit!important}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.ext-fxc-menu-icon>.msportalfx-svg-badge{left:-2px;bottom:-2px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-loading-square{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-square:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes ProgressFlagAnimation{0%{transform:scale(1);opacity:.3}36.1%,50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}@keyframes ProgressFlagAnimation{0%{transform:scale(1);opacity:.3}36.1%,50%{transform:scale(1.06);opacity:1}86.1%{transform:scale(1);opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-flip-vertical>svg,svg.msportalfx-svg-flip-vertical{transform:scaley(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"a{color:#015cda}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar-avatarmenu .fxs-dropmenu-button,.fxs-topbar-button{fill:#fff}.fxs-topbar-avatarmenu .fxs-dropmenu-button:active,.fxs-topbar-avatarmenu .fxs-dropmenu-button:hover,.fxs-topbar-button:active,.fxs-topbar-button:hover{background-color:#605e5c}.fxs-topbar-home{color:#fff}.fxs-notificationspane-button-unreadcount{color:#1c1c1c;background-color:#fff}.fxs-topbar-active .fxs-topbar-button,.fxs-topbar-active.fxs-topbar-button{background-color:#fff;fill:#1c1c1c}.fxs-topbar-active .fxs-notificationspane-button-unreadcount{color:#fff;background-color:#1c1c1c}.fxs-topbar-debug-button{color:#1c1c1c!important;background-color:#ff8c00!important}.fxs-topbar-debug-button:hover{background-color:#fff0d1!important}.fxs-search-wrapper{background-color:#e1dfdd}.fxs-search-icon-mini{fill:#3b3a39}.fxs-search-box .azc-input{color:#3b3a39}.fxs-search-box .azc-input::placeholder{color:#3b3a39}.fxs-search-box .azc-input::-ms-input-placeholder{color:#3b3a39}.fxs-search-box .azc-input::-webkit-input-placeholder{color:#3b3a39}.fxs-search-box .azc-input:-ms-input-placeholder{color:#3b3a39}.fxs-search-box .azc-input::-moz-placeholder{color:#3b3a39}.fxs-topbar-devmode{background-color:#ff8c00}.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button{color:#1c1c1c}.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button,.fxs-topbar-devmode .fxs-topbar-button{fill:#1c1c1c}.fxs-topbar-devmode .fxs-topbar-avatarmenu .fxs-dropmenu-button:hover,.fxs-topbar-devmode .fxs-topbar-button:hover{background-color:#fff0d1}.fxs-search-showmenu .fxs-search-wrapper{background-color:#fff}.fxs-search-showmenu .fxs-search-box .azc-input{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::-ms-input-placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::-webkit-input-placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input:-ms-input-placeholder{color:#252423}.fxs-search-showmenu .fxs-search-box .azc-input::-moz-placeholder{color:#252423}.fxs-search-showmenu .fxs-search-icon-mini{fill:#135995}.fxs-sidebar .fxs-sidebar-icon,.fxs-sidebar .fxs-sidebar-icon .msportalfx-svg-c05,.fxs-sidebar .fxs-sidebar-icon .msportalfx-svg-c07,.fxs-sidebar-collapse-button{fill:#fff}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{background-color:#8a2da5}.fxs-sidebar-browse-active{background-color:rgba(128,128,128,.25)}.fxs-sidebar-collapse-button:hover,.fxs-sidebar-item-link:hover{background-color:rgba(128,128,128,.15)}.fxs-sidebar-bar{background-color:#323130;color:#fff}.fxs-sidebar-divider{border-bottom-color:#605e5c}.fxs-sidebar-shadow{width:6px;background:linear-gradient(270deg,rgba(0,0,0,.24) 0,rgba(0,0,0,0) 100%)}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#000;stroke-width:1px}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:rgba(125,125,125,.2)}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a;fill:#fff}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 4px 8px 0 rgba(0,0,0,.14)}.fxs-text-white{color:#fff}.fxs-fill-white{fill:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}.azc-disabled,.azc-disabled:focus,.azc-disabled:hover,input.azc-disabled{cursor:default;outline:0}.azc-balloon-content a{color:#55b3ff}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-fill-info,.msportalfx-fill-info{fill:#015cda!important}.fxs-fill-complete,.fxs-fill-success,.msportalfx-fill-success{fill:#5db300!important}.fxs-fill-dirty,.fxs-fill-upsell,.msportalfx-fill-dirty{fill:#8a2da5!important}.fxs-fill-warning,.msportalfx-fill-warning{fill:#ff8c00!important}.fxs-fill-error,.msportalfx-fill-error{fill:#e00b1c!important}.fxs-br-info,.msportalfx-br-info{border-color:#015cda!important}.fxs-br-success,.msportalfx-br-success{border-color:#5db300!important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5!important}.fxs-br-warning,.msportalfx-br-warning{border-color:#ff8c00!important}.fxs-br-error,.msportalfx-br-error{border-color:#e00b1c!important}.fxs-bg-info,.msportalfx-bg-info{background-color:#015cda!important}.fxs-bg-success,.msportalfx-bg-success{background-color:#5db300!important}.fxs-bg-dirty,.fxs-bg-upsell,.msportalfx-bg-dirty{background-color:#8a2da5!important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#ff8c00!important}.fxs-bg-error,.msportalfx-bg-error{background-color:#e00b1c!important}")}));
define("MsPortalImpl/Init",["require","exports","f","o","MsPortalImpl/Base/Base.Router","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function g(n){var t={fx:p.version};(n?Q():f.container.getAsync(e.ExtensionManager).then((function(n){n.initializedExtensions.forEach((function(n){t[n.name]=n.extension.getVersion()}))}))).then((function(){rt.custom("Session",1,k++,d,t)}))}var b,k,d,nt;r.defineProperty(t,"__esModule",{value:!0});var a=i.Base,tt=a.Diagnostics,it=a.UriBuilder,l=h.ComponentName,v=window,y=v.fx,p=y.environment,rt=tt.createLog(n),ut=p.cdn,c=f.container.get(h.StorageService),w=new it(u.originalHref);c.clearValue(l.Redirect,"ReloadCount",1);w.query=new a.QueryStringBuilder(y.bootParameters.userQuery);u.history_replaceState(null,v.document.title,w.toString());ut.enabled||(b=c.clearValue(l.Cdn,"FailedIndex",1));c.clearValue(l.Redirect,"IdpRedirectCount",1);k=0;d=c.clearValue(l.Redirect,"Referrers",1)||"";g(!0);v.setInterval(g,36e5);nt=new s.Portal({diContainer:f.container,storageService:c,extensionManager:null,cdnFailedIndex:b});nt.initialize()}))