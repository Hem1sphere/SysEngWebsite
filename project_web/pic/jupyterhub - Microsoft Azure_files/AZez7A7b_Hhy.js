define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Helpers",["require","exports","f","o","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers","MsPortalImpl/UI/UI.DesktopManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";function w(n){var t={master:{part:n.masterPartId,property:n.masterInvocationProperty,command:n.masterCommandName}};return i.toSortedString(t)}function l(n,t){var i=n.services.desktop.getActiveJourney();return t.every((function(n){var t;if(!n.isInitialized)return!0;if(t=!!n.bladeDefinition.actionBar,n.shouldAlertOnClose(t))if(t){var u=n.getViewModel(2),r=u&&u.content(),f=r&&r.output&&r.output(),e=f&&f.status;if(e!==3)return!1}else return!1;return i.ambientSettings.getItemsInPath(n.journeyPath).every((function(n){return n&&n.value&&n.value.type===1?!n.value.editScope||n.value.editScope.disposeOnSelectionChange:!1}))}))}function b(n,t,r,u,f,o){var p=n.services.desktop,w=n.referenceComposition.getPartsContainer().detailContainers||[],tt=function(t){return n.isBladeOpenedByMaster(t)&&t.masterInvocationProperty===r.source.property},s,c,a=!0,it=!1,h=o&&o.getContent(),b,k,d,y,v;if(h&&h.id&&w.some((function(n){return n.id===h.id}))&&(h=null),s=w.filter((function(n){var r=!1,t=n.bladeDefinition,o=f.length===1?!!(f[0].flags&2):!1,s=!!(n.flags&2);return n.isDisposed()||o!==s||(r=i.isFeatureEnabled("disablerebind")||!tt(n)||t&&(t.attributes&1||t.name==="CreateBlade"&&n.extension.name==="WebsitesExtension")?!0:!f.some((function(t){var f=n.locator.equals(t.locator),i,r;return f&&(r=nt(t.model,u),i=e.deepSubset(n.getBindableContainer().getViewModel(),r),c=c||n),i}))),r})),b=l(n,s),f.length===1&&s.length===w.length&&c&&g(c,f[0])&&(s.remove(c),k=p.discardEditsOfBlade(c,{includeSelf:!1,includeDescendants:!0,force:b}),s=s.concat(c.detailContainers),a=k.successful,it=a&&k.confirmationRequired),a&&!it&&(d=s.map((function(n){return n.id})),h&&h.id&&d.push(h.id),a=b||p.confirmBladesCanClose(d)),a){for(y=s.length-1;y>=0;y--)v=s[y],tt(v)&&(n.removeOutputBindings(v),t.detailBladesTracker.untrack(v)),p.forceCloseBlade(v.id,1,{openBlade:!0});h&&o.close(!0)}return a}function k(n,t,i){var u={},r=new o.PropertyTransformerArgs(n,t,null,u,null);return r.propertyChanges.push(o.ObservableChangeArgs.forObject(i.targetProperty,t)),i.opensDynamicBlades&&p(r),i.targetProperty||y(r),r.propertyChanges.forEach((function(n){var t=n.propertyName;t&&(u[t]=n.propertyValue)})),u}function d(n,t,i,r){var l=n.diContainer.get(f.RedirectMap),e=t,s=t.getExtensionLocator(),a=u.Locator.forBladeRedirect(l,s.name,t.name),h={},o;return n.finder.tryLocate(a,h)?(o=h.value,o.type===3?e=u.Locator.forExtension(c.ExtensionNames.Hubs).withBlade(c.BladeNames.Hubs.ResourceMenuBlade):o.type===2&&(e=u.Locator.forExtension(o.toExtension||s.name).withBlade(o.toBlade))):e=n.assetTypeService.getMappedBladeLocator(t),e&&r.matchesLocatorAndModel(e,i)&&(e=t),e}function g(n,t){var i=[],r=n.widget;r&&(i=r.options.commandBar.menuItems(),n.children.forEach((function(n){n.children.forEach((function(n){var t=n.widget;t&&(i=i.concat(t.options.commands))}))})));var u=t.masterDetailsDefinition,f=u&&!!u.parameterCollector,e=n.bladeDefinition&&n.bladeDefinition.attributes&1,o=!n.isDisabled&&n.bladeDefinition&&!n.bladeDefinition.waitForInputsSet&&!e&&!f&&i.every((function(n){return n.canRebind}));return o||e||f||v.warning("Unable to rebind Blade '"+n.id+"', it was either disabled, cleared, or one of its commands was executing. Will close and reopen blade instead."),o}function nt(n,t){var u=n,r;return n&&t&&t.length&&(r={},t.forEach((function(n){r[n.targetProperty]=!0})),u=i.forEachKey(n,(function(n,t,i){r[n]||(i[n]=t)}),{})),u}r.defineProperty(t,"__esModule",{value:!0});var h=i.Base,a=h.Diagnostics,tt=i.Extension,c=h.Constants,v=a.createLog(n),y=s.PropertyTransformers.getModelToPropertyMapper(),p=s.PropertyTransformers.getDynamicSelectionMapper();t.getBladeOpenerJourneyPathSegment=w;t.shouldSkipPromptForBladesWithEdits=l;t.tryCloseOtherDetailBlades=b;t.mapMasterModelToBladeModel=k;t.getMappedBladeLocator=d}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-breadcrumb-wrapper{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:100%}.fxs-breadcrumb-crumb,.fxs-breadcrumb-divider{display:-webkit-flex;height:100%;padding:0 3px}.fxs-breadcrumb-wrapper>.fxs-breadcrumb-crumb{cursor:text}.fxs-breadcrumb-wrapper>.fxs-breadcrumb-crumb-active{cursor:pointer}.fxs-breadcrumb-wrapper>.fxs-breadcrumb-crumb-active:hover{text-decoration:underline}.fxs-breadcrumb-crumb{font-size:13px;-webkit-flex:0 0 auto;flex:0 0 auto;display:flex;-webkit-align-items:center;align-items:center;box-sizing:border-box}.fxs-breadcrumb-divider{-webkit-flex:0 0 auto;flex:0 0 auto;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;text-align:center}.fxs-breadcrumb-divider svg{-webkit-transform:rotate(90deg);transform:rotate(90deg);height:10px;width:10px;margin-top:1px}.fxs-breadcrumb-overflow-btn{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200;font-size:24px;box-sizing:border-box;height:27px;padding-bottom:10px}.fxs-breadcrumb-dropmenu{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-breadcrumb-dropmenu .fxs-dropmenu-content{width:220px}.fxs-breadcrumb-overflow .fxs-breadcrumb-crumb{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;line-height:32px;padding:0 10px!important}.fxs-breadcrumb-container{display:-webkit-flex;display:flex;padding-left:22px;height:100%}')}));
define("_generated/Templates/WidgetsBreadCrumb",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-breadcrumb-container"> <nav class="fxs-breadcrumb-wrapper" data-bind="attr: { \'aria-label\': navLabel }"> <div class="fxs-breadcrumb-dropmenu"><\/div> <!-- ko foreach: breadCrumbsVisibleUI --> <!-- ko if: $index() || $parent.firstDividerVisible() --> <div class="fxs-breadcrumb-divider fxs-portal-svg-secondary" data-bind="image: $data.caretUp, css: { \'fxs-display-none\': !$data.visible() }"><\/div> <!-- /ko --> <a class="fxs-breadcrumb-crumb fxs-portal-text" data-bind="css: { \'fxs-portal-hover fxs-breadcrumb-crumb-active\': $data.visible() && $index() < $parent.lastVisibleIdx(), \'fxs-display-none\': !$data.visible()  }, attr: { \'data-blade-id\': $data.bladeId, href: $data.href }, text: $data.bladeTitle" tabindex="-1"><\/a> <!-- /ko --> <\/nav> <\/div>'}}));
define("_generated/Templates/WidgetsBreadCrumbOverFlow",["require","exports"],(function(){"use strict";return function(){return'<ul class="fxs-breadcrumb-overflow"> <!-- ko foreach: breadCrumbsOverFlow --> <li class="fxs-portal-hover" data-bind="css: { \'fxs-display-none\': !$data.visible() }"> <a class="fxs-breadcrumb-crumb" data-bind="css: { \' fxs-breadcrumb-crumb-active\': $data.visible() }, attr: { \'data-blade-id\': $data.bladeId, title: $data.bladeTitle, href: $data.href }, text: $data.bladeTitle" tabindex="-1"><\/a> <\/li> <!-- /ko --> <\/ul>'}}));
define("MsPortalImpl/Widgets/Widgets.BreadCrumb",["require","exports","f","o","a","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsBreadCrumb","_generated/Templates/WidgetsBreadCrumbOverFlow","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Base/Base.EventTypes","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function g(n,t,i,r){var u;f.computed(n,t,(function(t){var c=r?t.reverse():t,l=c.length,o,s,h,a,v,e;if(u&&u.dispose(),u=n.createChildLifetime(),o=i(),s=l-o.length,s>0){for(h=[],e=0,a=Math.max(s,5);e<a;e++)h.push({bladeId:f.observable(),bladeTitle:f.observable(),visible:f.observable(!0),caretUp:ft,href:f.observable()});i.push.apply(i,h)}for(v=function(n){var t=o[n],i;n<l?(i=c[n],i.bladeId.subscribeAndRun(u,(function(n){t.bladeId(n)})),i.bladeTitle.subscribeAndRun(u,(function(n){t.bladeTitle(n)})),i.href.subscribeAndRun(u,(function(n){t.href(n)})),t.visible(!0)):t.visible(!1)},e=0;e<o.length;e++)v(e)}))}function d(n,t,i){var u=i().first(),r;u&&(r=t.width(),r&&n.width()>=r&&(u.visible(!1),d(n,t,i)))}var nt;r.defineProperty(t,"__esModule",{value:!0});var tt=i.Base,it="<div class='fxs-breadcrumb-overflow-btn fxs-portal-hover' role='presentation'>...<\/div>",b={deferred:!0},k="rootpagelink",rt="> .fxs-breadcrumb-crumb-active, .fxs-dropmenu-button:not(.fxs-display-none)",ut=".fxs-breadcrumb-crumb-active",ft=i.Base.Images.CaretUp({isLogo:!0});nt=(function(n){function t(t,r){var c=n.call(this,t,r)||this,ft=c.element,gt=c.options,u=c.ltm,ni=[{bladeId:k,bladeTitle:""}],nt=f.observableArray([]),ot,ct,kt,dt;f.computed(u,[gt.breadCrumbs],(function(n){nt.valueWillMutate();var t=nt(),i=ni.concat(n);i.forEach((function(n,i){var u=t[i]||(t[i]={bladeId:f.observable(),bladeTitle:f.observable(),visible:f.observable(!0),href:f.observable()}),o;u.bladeId(n.bladeId);u.bladeTitle(n.bladeTitle);u.href("#");n.bladeId===k&&(o=r.getRootPageType()===2,u.bladeTitle(o?e.AzureHome.home:e.NavBar.home),u.href("#"+(o?"home":"dashboard")))}));t.splice(i.length);nt.valueHasMutated()})).extend(b);ot=nt.filter(u,(function(n){return!n.visible()}));ot.extend(b);var st=c.breadCrumbsVisible=nt.filter(u,(function(n){return n.visible()})),vt=f.observableArray([]),yt=f.observableArray([]),pt=f.observable(),wt=f.observable();g(u,st,vt,!1);g(u,ot,yt,!0);ft.html(l());c._bindDescendants({breadCrumbsVisibleUI:vt,navLabel:e.Breadcrumb.navlabel,lastVisibleIdx:pt,firstDividerVisible:wt});var lt=ft.findByClassName("fxs-breadcrumb-container"),ht=ft.findByClassName("fxs-breadcrumb-wrapper"),at=ft.findByClassName("fxs-breadcrumb-dropmenu"),et,bt=f.computed(u,ot,(function(){return ot().length>0}));return bt.extend(b),bt.subscribeAndRun(u,(function(n){n&&(et||(et=new v.ViewModel(it,a(),ut,!0),et.setItemFocusWhenOpen=!0,et.buttonTooltip(e.Breadcrumb.navhistory),et.alignMenu=0,u.registerForDispose(new v.Widget(at,et)),f.applyBindings({breadCrumbsOverFlow:yt},at[0])));o.toggle(at,n);wt(n)})),f.computed(u,(function(){var t=nt(),n=i.last(t);n&&n.bladeTitle();ct||(ct=h.throttleByAnimationFrame((function(){var n=nt();n.forEach((function(n){n.visible(!0)}));d(ht,lt,st);kt||(kt=!0,p.track(u,ft,(function(){if(c.options.breadCrumbs().length){var n=lt.width();ht.width()>=n?d(ht,lt,st):ct()}})))})));ct()})).extend(b),dt=new w.KeyboardNavigation(u,{element:ht,tabTriggers:12,itemSelector:rt}),u.registerForDispose([ft.setEvents([y.default.click+" "+y.default.keydown,".fxs-breadcrumb-crumb",function(n){var u;if(n.type===y.default.click||n.which===13||n.which===32){var i=$(n.currentTarget),e=f.dataFor(i[0]),r=e&&f.unwrap(e.bladeId),t=r===k;i.hasClass("fxs-breadcrumb-crumb-active")&&r&&(u=t?undefined:{bladeId:r},tt.Diagnostics.Telemetry.trace({source:s.Source.Desktop,action:t?s.Action.BreadCrumbHomeClicked:s.Action.BreadCrumbClicked,data:u}),t||i.trigger(y.default.fxbreadcrumbclick,u));t||(n.preventDefault(),n.stopPropagation())}},]),]),f.computed(u,st,(function(n){pt(n.length-1);dt.correctState()})).extend(b),c}return __extends(t,n),t})(c.Widget);t.Widget=nt}));
define("MsPortalImpl/Widgets/Widgets.BreadCrumbViewModel",["require","exports","o","ko","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u){"use strict";i.defineProperty(t,"__esModule",{value:!0});var f=(function(n){function t(t){var i=n.call(this)||this;return i.getRootPageType=t,i.breadCrumbs=r.observableArray(),i}return __extends(t,n),t})(u.ViewModel);t.ViewModel=f}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Journey.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-journey{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.fxs-journey-layout{-webkit-flex:1 1 auto;flex:1 1 auto;overflow-x:auto;overflow-y:hidden;z-index:0}.fxs-journey-layout>.fxs-blade{display:none}.fxs-journey-layout>.fxs-blade.fxs-blade-display-in-journey,.fxs-portal-peekmode .fxs-journey-layout>.fxs-blade{display:-webkit-flex;display:flex}.fxs-portal-peekmode .fxs-blade-maximized.fxs-blade{-webkit-flex-shrink:0;flex-shrink:0}.fxs-journey-breadcrumb{display:none;height:28px;z-index:1;border-bottom-width:1px;border-bottom-style:solid;box-sizing:border-box}.fxs-show-journey .fxs-journey-breadcrumb{display:block}.fxs-journey-placeholder:last-child{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-journey-dockleft{transform:rotate(-90deg)}.fxs-journey-dockright{transform:rotate(90deg);margin-left:10px}")}));
define("MsPortalImpl/Widgets/Widgets.Journey",["require","exports","f","i","o","a","ko","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Blade","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.StackLayout","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Widgets/Widgets.BreadCrumb","Viva.Controls/Util/Viva.Resize","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Widgets/Widgets.BreadCrumbViewModel","_generated/Less/MsPortalImpl/Widgets/Widgets.Journey.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function dt(n,t){var i=n.length,r=n[i-1],u=n[i-2];i>0&&(r.visibleInJourney?nt(n,t)&&(u.visibleInJourney=!0):vt(n,t,!0))}function gt(n,t){var r=n.length,i,u;if(n[r-1].subjourney)for(i=r-2;i>=0&&n[i].visibleInJourney;--i)n[i].visibleInJourney=!1;else u=g(n,t),u.freespace<0&&yt(n,r-(nt(n,t)?3:2))}function vt(n,t,i){i===void 0&&(i=!1);var r=g(n,t,i);yt(n,r.unfitIdx)}function yt(n,t){for(var i=t+1;i<n.length&&!n[i].visibleInJourney;)n[i++].visibleInJourney=!0;while(t>=0&&n[t].visibleInJourney)n[t--].visibleInJourney=!1}function g(n,t,i){var f;i===void 0&&(i=!1);for(var e=t,u=n.length,r=u-1;r>=0&&(i||n[r].visibleInJourney)&&t>=0&&(r===u-1||!n[r+1].subjourney);)f=n[r],f.maximized?t=-1:t-=f.idealWidth,(t>=0||r===u-1)&&--r;return r===u-2&&nt(n,e)&&--r,{freespace:t,unfitIdx:r}}function nt(n,t){var r=n.length,i=n[r-1],u=n[r-2];return r>1&&u.actStyle&&!i.appblade&&!i.subjourney&&t>=i.idealWidth+u.idealWidth&&(!i.widget.options.fullWidthExtensionOptOut||!i.widget.element.hasClass(bt))}function ni(n,t,i){var r=n.length;return n.map((function(n,u){var f=n.blade,e=f.options,o=f.getContentWidget().options.bladeStyle()===12,s=!o&&!n.pending&&e.useActivationStyle&&(u!==r-1||t&&f.element.hasClass(ot)),h=o||n.pending||e.displayState()===2&&!s;return{widget:f,idealWidth:f.idealWidth(s),actStyle:s,maximized:h,subjourney:e.asSubJourney,visibleInJourney:i||f.element.hasClass(st)||!f.element[0].style.width,appblade:o}}))}function ti(n,t){n.forEach((function(i,r){var u=n[r-1];!i.appblade&&u&&u.actStyle&&!i.subjourney&&(i.actStyleCanFit=u.displayWidth+i.idealWidth<=t);i.displayWidth=i.maximized?i.actStyleCanFit?t-u.displayWidth:Math.max(i.idealWidth,t):i.idealWidth}))}function pt(n,t){var u=i.isFeatureEnabled("reservehozscroll"),e=n.widget.element,r={},f;u&&ht?r.width=n.displayWidth+"px":(f=n.maximized?"100%":n.idealWidth+"px",n.maximized&&t&&t.actStyle&&(n.actStyleCanFit||!u)&&!n.subjourney&&!n.appblade&&(f="calc(100% - "+t.idealWidth+"px)"),r.width=f,u&&(r["min-width"]=n.maximized?n.idealWidth+"px":""));e.css(r).toggleClass(ot,n.actStyle).toggleClass("fxs-blade-maximized",n.maximized).toggleClass("fxs-blade-appblade",n.appblade)}var lt,at;u.defineProperty(t,"__esModule",{value:!0});var k=window,tt="fxs-journey",it="fxs-journey-layout",rt="fxs-journey-breadcrumb",ut=".fxs-blade",wt="<div class='"+rt+" fxs-portal-bg-txt-br'><\/div><div class='"+it+"'><\/div>",d="fxs-blade-firstblade",ft="fxs-blade-lastblade",et="fxs-journey-placeholder",bt="fxs-menublade",ot="fxs-blade-has-activation",st="fxs-blade-display-in-journey",kt="fxs-blade-shows-pending",ht=p.isIe&&!p.isEdge,ct=2e3;t.scrollLogDebounce=1e3;t.EventNames={addingChild:"addingChild",removingChild:"removingChild"};lt=(function(n){function t(t,i){var r=n.call(this,t)||this,u;return r.getRootPageType=i,u=new c.ViewModel("fxs-journey-stacklayout-instanceid"),u.orientation(h.Orientation.Horizontal),r.stackLayoutOptions=u,r}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.stackLayoutOptions.getViewSettings()}}},t})(l.ViewModel);t.ViewModel=lt;at=(function(n){function u(t,u){var p=n.call(this,t,u)||this,nt,ut,lt,at,ot;return p._childElementCount=e.observable(),p._rePosArgs=[],p._lastBladeCalcInfo=[],p._scheduleFocusOnLastChild=w.throttleByAnimationFrame((function(n){if(p.ltm&&!p.ltm.isDisposed()&&n&&p._childElementCount()>0){var t=p.options.stackLayoutOptions.childElements(),i=t[t.length-1],r=o.Widget.getWidget(i,s.Widget);r.setFocus()}})),p._loadingBladeIdList=[],t.addClass(tt).html(wt),nt=t.findByClassName(it),p._layout=new c.Widget(nt,u.stackLayoutOptions),p._childElementCount(0),ut=new b.ViewModel(u.getRootPageType),lt=w.throttleByAnimationFrame((function(){if(p.ltm&&!p.ltm.isDisposed()){var n=p.getBlades();ut.breadCrumbs(f.prototype.concat.apply([],n.map((function(n){return n.getBreadCrumbs()}))))}})),p.ltm.registerForDispose([p._layout,new v.Widget(t.findByClassName(rt),ut),function(){p._cleanElement(tt)},p.element.setEvents([a.default.fxbladerepos,function(n,t){p._rePosArgs.push(t);p._rePositionBlades()},],[h.Widget.layoutUpdatedEventName,function(n){t.trigger(l.Widget.viewSettingsChanged,p.saveViewSettings());n.stopPropagation()},],[a.default.fxbreadcrumbclick,function(n,t){for(var u,f=t.bladeId,r=p.getBlades(),i=0;i<r.length;++i)if(u=r[i],u.options.id===f){i<r.length-1&&r[i+1].close(!1);u.goToFirstDetailContent();break}else if(u.goToDetailContent(f)){i<r.length-1&&r[i+1].close(!1);break}},],[a.default.fxbreadcrumbupdate,lt,]),]),at=t.parent(".fxs-panorama"),ot=i.isFeatureEnabled("reservehozscroll"),p._rePositionBlades=w.throttleByAnimationFrame((function(){var h,f,v,u,y;if(p.ltm&&!p.ltm.isDisposed()){var t=at.width(),b=nt.scrollLeft(),tt=p._rePosArgs.length&&p._rePosArgs.every((function(n){return n&&n.noExitPeekMode})),it=p._rePosArgs.length&&p._rePosArgs.every((function(n){return n&&n.noScroll}));p._rePosArgs=[];var n=p._getBladeCalculatedInfo(),i=n.length,s=p._lastBladeCalcInfo.length;if(p._lastBladeCalcInfo=n,i&&n[i-1].actStyle&&k.setTimeout((function(){p._rePosArgs.push({noExitPeekMode:!0,noScroll:!0});p._rePositionBlades()}),ct),tt&&p._peekMode)n.forEach((function(n){return pt(n)}));else if(ot||(s>i?dt(n,t):s===i?vt(n,t):gt(n,t)),h=!1,f=-1,n.forEach((function(t,i){var r=t.widget,u=r.element;pt(t,n[i-1]);u.toggleClass(d,t.visibleInJourney&&!h).removeClass(ft);t.widget.options.collapseVisible(t.actStyle);t.actStyle||t.widget.options.collapsed(!1);t.visibleInJourney&&(h=!0,f=i);t.widget.element.toggleClass(st,t.visibleInJourney)})),f>=0&&n[f].widget.element.addClass(ft),i&&p.trigger(a.default.fxshowjourney),p.trigger(a.default.fxpeekmode,null,{enter:!1}),ot){var c=0,e=0,o=0;if(i){var rt=g(n,t),w=rt.unfitIdx+1,l=n[w];o=n.reduce((function(n,t){return n+t.displayWidth}),0);e=l.idealWidth<t&&!l.subjourney?o-t:n.reduce((function(n,t,i){return n+(i<w?t.displayWidth:0)}),0);l.subjourney&&(v=o-e,v<t&&(c=t-v))}u=nt.findByClassName(et);c>0?(u.length||(u=$(r.createElement("div",{"class":et})),nt.append(u)),u.css("width",c+"px")):u.remove();i===s&&it||Math.max(0,e)!==b&&nt.scrollLeft(e);ht&&(y=t<o?nt[0].clientHeight+"px":"",n.forEach((function(n){return n.widget.element.css("height",y)})),u.css("height",y))}}})),y.track(p.ltm,p.element,(function(){p._rePosArgs.push({noExitPeekMode:!0,noScroll:!0});p._rePositionBlades()})),p}return __extends(u,n),u.prototype.hasChildren=function(){return this._childElementCount()>0},u.prototype.addChild=function(n){this.insertChild(n,undefined)},u.prototype.insertChild=function(n,i){var r=n.element?n.element:n,u=l.Widget.getId(r);this.trigger(t.EventNames.addingChild,null,u);this._scheduleFocusOnLastChild(!1);i>=0?this._layout.insertChild(n,i):this._layout.addChild(n);this._childElementCount(this._childElementCount()+1);this.trigger(a.default.fxbladerepos);this.trigger(a.default.fxbreadcrumbupdate)},u.prototype.getBladeDisplayWidth=function(n){var t=i.find(this._getBladeCalculatedInfo(),(function(t){return t.widget.options.id===n}));return t&&t.displayWidth||0},u.prototype._getBladeCalculatedInfo=function(){var n=i.isFeatureEnabled("reservehozscroll"),r=this.element.parent(".fxs-panorama").width(),u=this.getBlades(),f=u.map((function(n){var i=n.isMenuBladeLoadingDetailBlade(),t=n.bladeDefinitionLoaded&&!i;return{blade:n,pending:!t&&n.element.hasClass(kt),loaded:t}})).filter((function(n){return n.loaded||n.pending})),e=k.fx.getTimestamp(),o=this._loadingBladeIdList.some((function(n){return n.ts+ct>e})),t=ni(f,o,n);return n&&ti(t,r),t},u.prototype.removeChild=function(n){var i=this._layout.removeChild(n);return i&&(this.trigger(t.EventNames.removingChild,null,n),this._childElementCount(this._childElementCount.peek()-1),this._scheduleFocusOnLastChild(!0),this.trigger(a.default.fxbladerepos),this.trigger(a.default.fxbreadcrumbupdate)),i},u.prototype.removeChildren=function(n){var r=this,t=this.options,i=t&&t.stackLayoutOptions&&t.stackLayoutOptions.childElements();i&&i.slice(0).forEach((function(t){var i=l.Widget.getId(t);n&&n(i);r.removeChild(i)}))},u.prototype.saveViewSettings=function(){return this.options.getViewSettings()},u.prototype.setFocus=function(){if(this._childElementCount()>0){var t=this.options.stackLayoutOptions.childElements(),i=t[0],n=o.Widget.getWidget(i,s.Widget);n&&n.setFocus()}},u.prototype.getBlades=function(){var n=[];return this._childElementCount()>0&&(n=this.options.stackLayoutOptions.childElements().map((function(n){return o.Widget.getWidget(n,s.Widget)}))),n},u.prototype.close=function(){var n=this.getBlades()[0];n&&n.close(!1)},u.prototype.getFocusedBlade=function(){var n=$(document.activeElement).closest(ut)[0],t=null;return n&&(t=this.getBlades().first((function(t){return t.element[0]===n}))),t},u.prototype.peekMode=function(n){this._peekMode=n;n?this.element.find(ut).removeClass(d).first().addClass(d):(this._rePosArgs.push({noExitPeekMode:!1,noScroll:!0}),this._rePositionBlades())},u.prototype.loadingHint=function(n,t){var r=this._loadingBladeIdList.firstIndex((function(t){return t.id===n})),i=this._loadingBladeIdList[r],u=k.fx.getTimestamp();t?i?i.ts=u:this._loadingBladeIdList.push({id:n,ts:u}):i&&this._loadingBladeIdList.splice(r,1)},u})(l.Widget);t.Widget=at}));
define("MsPortalImpl/UI/Compositions/UI.Composition.DelayedBladeManager",["require","exports","f","i","o","a","ko","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Widgets/Widgets.Journey","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function l(n,t){n&&n.enableTrace&&y.verbose(t+" Debug Id: '"+n.debugId+"'.")}var a;u.defineProperty(t,"__esModule",{value:!0});var v=i.Base,y=v.Diagnostics.createLog(n),p=i.getUniqueIdGenerator("DBS");a=(function(){function t(n,t,i){var r,u,f,e;this._journeyEventAttached=!1;this._loadingVisible=!1;this._config=i;this._portalWidget=i.services.desktop.portalWidget;i&&i.enableTrace===undefined&&(i.enableTrace=o.isTraceEnabled);this._loadingHintId=p();t&&(r=void 0,u=void 0,t.delayedBladeSelection?(f=t,r=f.delayedBladeSelection,u=function(n){f.selectedValue(n);f.isSelected(!0)}):t._msPortalFxDelayedBladeSelection&&(e=t,r=e._msPortalFxDelayedBladeSelection,u=function(n){e.selectedItems.splice(0,0,n);e.activateAllSelectedItems()}),r&&this._processDelayedBladeSelection(n,r,u,i.extension))}return t.prototype._loadingHintSignal=function(n){this._loadingVisible!==n&&(this._loadingVisible=n,this._portalWidget.trigger(c.default.fxloadingontopbar,null,{id:this._loadingHintId,cancel:!n}))},t.prototype._processDelayedBladeSelection=function(n,t,i,r){var u=this;t.subscribeAndRun(n,(function(t){t&&(u._journeyEventAttached||(u._journeyEventAttached=!0,n.registerForDispose([u._portalWidget.element.setEvents([h.EventNames.addingChild,function(){return u._abort()},]),function(){u._loadingHintSignal(!1)},])),u._processDelayedBladeSelectionChange(t,i,r))}))},t.prototype._abort=function(){this._currentBladeSelectionPromise=null;this._loadingHintSignal(!1)},t.prototype._processDelayedBladeSelectionChange=function(t,u,o){var c=this,h=this._config,b=h.services.desktop,a=h.getSelectableContainerComposition(),y=a&&(a.detailContainers||[]).filter((function(n){return!(n.flags&1)})),p=f.isArray(y)&&y.map((function(n){return n.id})),w,v;if(p.length>0)if(b.confirmBladesCanClose(p))w=y[0].widget,w&&w.options.loaded(!1),l(h,"Closing all detail blades except the first one."),p.forEach((function(n,t){t&&b.forceCloseBlade(n)}));else{l(h,"Closing of detail blade(s) was cancelled by user, aborting delayed blade selection operation.");this._abort();return}else this._currentBladeSelectionPromise||this._loadingHintSignal(!0);v=this._currentBladeSelectionPromise=Q(t.selectedValuePromise);i.tryImmediateResolve(v,(function(n){v===c._currentBladeSelectionPromise?(c._loadingHintSignal(!1),l(h,"Activate master selectable. Value: {0}.".format(e.toJSON(n))),u(n)):l(h,"Another delayed operation is underway, selected value will be ignored. Value: {0}.".format(e.toJSON(n)))}),(function(t){v===c._currentBladeSelectionPromise&&c._loadingHintSignal(!1);var i=a&&a.toString()||"N/A",u=r.createError("Promise provided to Selectable.delayedBladeSelection/SelectableSet.setCreateDelayedBladeSelection has been rejected. PartId:"+i,{innerErrors:t});s.logToExtension(n,o,2,u)}))},t})();t.DelayedBladeManager=a}));
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableSetBinder",["require","exports","f","i","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){function a(n,i,r){return n.selectableItems().first((function(n){return t(i,n.data,r)}))}function s(n,i,r){return n().first((function(n){return t(i,r,n)}))}function t(n,t,r){return u.getOwnPropertyNames(n).reduce((function(u,f){var o,s;return u?(o=e.getModelValue(r,f,!0),o.exists)?(s=e.getModelValue(t,n[f],!0),i.deepEquals(o.value,s.value,!0)):!1:u}),!0)}function w(n,t,i,r,u,f){var e=t.itemsWithChildEdits;v(n,e,i,(function(n,t){return n.editScopeId===t.editScopeId&&u(n.item,t.item)}),(function(n){return{editScopeId:n.editScopeId,item:r(n.item)}}),(function(){}),(function(n){f(n.item)}));v(n,i,e,(function(n,t){return t.editScopeId===n.editScopeId&&u(t.item,n.item)}),(function(n){var i=t.selectableItems().first((function(t){return u(t.data,n.item)}));return i?{editScopeId:n.editScopeId,item:i.data}:undefined}),(function(n){f(n.item)}),(function(){}))}function v(n,t,i,r,u,e,o){var s=[];f.reactor(n,(function(){var n=f.utils.compareArrays(s,t());n.forEach((function(n){switch(n.status){case"added":case"retained":if(!i().some((function(t){return r(n.value,t)}))){var t=u(n.value);t&&i.push(t)}break;case"deleted":i.remove((function(t){return r(n.value,t)?(o(t),!0):!1}));e(n.value)}}));s=t.slice(0)}))}var y=r.TriggerableLifetimeManager,h=o.CompositionBinder,p=" - [SelectableSetElement]",c=(function(n){function t(t,i,r,u,f){var e=n.call(this)||this;return e._bindings=[],e._selectablePath=t,e._modelId=i,e._modelIdPostFix=r,e._inputs=u,e._referenceComposition=f,e.registerForDispose((function(){e._bindings.forEach((function(n){n.unbind()}));e._bindings=[]})),e}return __extends(t,n),u.defineProperty(t.prototype,"selectablePath",{get:function(){return this._selectablePath},enumerable:!0,configurable:!0}),t.prototype.createTargetForSelectedItem=function(n){var t=this._bindElement(n,this._inputs,this._referenceComposition);return this._deleteBindings(t),t},t.prototype._bindElement=function(n,t,i,r){var l=[],o=[];t.forEach((function(n){n.valuesFrom[0].referenceType===6?l.push(n):o.push(n)}));var u=r?r:{},a=this._modelId+this._modelIdPostFix,s=new e.PropertyBindings(a,u),c;return this._bindings.push(s),o.length>0&&(c=h.mapInputBindingDefinitions(o,i),c.forEach((function(n){e.setModelValue(u,n.targetProperty,f.observable())})),h.setupPropertyBindings(i,s,c)),l.forEach((function(t){e.getModelValue(u,t.property).exists||e.setModelValue(u,t.property,f.observable());s.mapProperty(t.valuesFrom[0].property,t.property).bind(a,n,!0)})),u},t.prototype._deleteBindings=function(n){var t=this._findBindings(n);t&&(t.unbind(),this._bindings.remove(t))},t.prototype._findBindings=function(n){return this._bindings.first((function(t){return t.targetModel===n}))},t})(y),l;n.SelectableSetBinderBase=c;l=(function(n){function i(i,r,u,f,e,o){var h=n.call(this,i,r,p,e,o)||this,v=!1,y=!1,l=e.reduce((function(n,t){var i=t.valuesFrom;return i&&i.length&&i[0].referenceType===6&&(n[t.property]=i[0].property),n}),{}),c=f.activatedItems,b;return c().forEach((function(n){var t=a(u,l,n);t&&(t.isActivated(!0),t.isSelected(!0),h._bindElement(t.data,e,o,n))})),u.activatedItems().forEach((function(n){var t=s(c,l,n);t||c.push(h._bindElement(n,e,o))})),c().length>h._bindings.length&&(b=h.createChildLifetime(),u.selectableItems.subscribeArrayAdds(b,(function(n){var t=s(c,l,n.data);t===null||h._findBindings(t)||(n.isSelected(!0),n.isActivated(!0),h._bindElement(n.data,e,o,t),h._bindings.length>=c().length&&b.dispose())}))),u.activatedItems.subscribeArrayChanges(h,(function(n){if(!y){var t=s(c,l,n);try{v=!0;t||c.splice(0,0,h._bindElement(n,e,o))}finally{v=!1}}}),(function(n){if(!y)try{v=!0;c.remove((function(i){return t(l,n,i)?(h._deleteBindings(i),!0):!1}))}finally{v=!0}})),c.subscribeArrayChanges(h,(function(n){var t=a(u,l,n);if(t){if(!v)try{y=!0;t.isSelected(!0);t.isActivated(!0)}finally{y=!1}h._findBindings(n)||h._bindElement(t.data,e,o,n)}}),(function(n){if(!v)try{y=!0;u.activatedItems.remove((function(i){return t(l,i,n)?(h._deleteBindings(n),!0):!1}))}finally{y=!1}})),w(h,u,f.itemsWithChildEdits,(function(n){return h._bindElement(n,e,o)}),(function(n,i){return t(l,n,i)}),(function(n){h._deleteBindings(n)})),h}return __extends(i,n),i})(c);n.SelectableSetBinder=l})(s||(s={})),s}));
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableSet2Binder",["require","exports","f","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSetBinder"],(function(n,t,i,r,u,f){"use strict";r.defineProperty(t,"__esModule",{value:!0});var e=i.ViewModels.Internal.Selection2.compareIds,o=" - [SelectableSetElement]",s=(function(n){function t(t,i,r,f,s,h){var c=n.call(this,t,i,o,s,h)||this,l=f.activatedItems,a;return r.activatedItems.subscribeArrayAdds(c,(function(n){var t=l.peek().first((function(t){return e(t._id,n.id)}));t?c._findBindings(t)||c._bindElement(n.data,s,h,t):(t=c._bindElement(n.data,s,h),t._id=u.utils.peekObservable(n.id),l.unshift(t))})),r.activatedIds.subscribeArrayDeletes(c,(function(n){var t=l.peek().firstIndex((function(t){return e(t._id,n)}));t>=0&&l.splice(t,1)[0]})),l.subscribeArrayChanges(c,(function(n){r.activateId(n._id)}),(function(n){c._deleteBindings(n);r.deactivateId(n._id)})),a=f.activatedItems.peek().map((function(n){return n._id})),r.activateIds(a),c}return __extends(t,n),t})(f.SelectableSetBinderBase);t.SelectableSetBinder=s}));
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener",["require","exports","f","o","a","ko","$","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Pipeline","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Helpers","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.DelayedBladeManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSet2Binder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSetBinder"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";var g;return (function(t){function at(n){return!!(n.value&&n.value.flags&16)}function vi(){return v.DefaultConfiguration}function vt(n,t,i,r,u){return p.CompositionBinder.mapInputBindingDefinitions(n,t,(function(n){n.source.scope=i;n.opensMultipleBlades=u!==undefined?u:r&&r.isMultiple;n.opensDynamicBlades=r&&!r.blade}))}function yi(n,t,i,r){var e,f,o,u=n.referenceComposition;return e=vt(i.additionalInputArguments,u,b.ReferenceScope.MasterContainer),f=vt(r.invocationInputArguments,u,b.ReferenceScope.MasterContainer,i,r.isMultiple)[0],o=p.CompositionBinder.mapInputBindingDefinitions(i.outputArguments,u,(function(n){n.source.scope=b.ReferenceScope.DetailsContainer})),new w.DelayedBladeManager(t,yt(n,f),{services:n.services,debugId:n.masterModelId,extension:n.referenceExtension.name,getSelectableContainerComposition:function(){return u&&u.getPartsContainer()}}),{additionalInputs:e,invocationInput:f,invocationOutputs:o,detailsDefinition:i}}function ti(n,t){var i=n.referenceExtension;return t.blade&&t.bladeExtension?et(t.bladeExtension).withBlade(t.blade):t.blade&&i?et(i.name).withBlade(t.blade):null}function ii(n,t){var i=n.lastIndexOf("."),r=i>0?n.substring(0,i):"";return b.getModelValue(t,r).value}function yt(n,t){return ii(t.source.property,n.masterModel)}function pt(){return 0}function rt(n,t,i){var r=ai(i?b.getModelValue(t,i).value:t);return n(r)}function pi(n,t){return rt(ft.isSelectable2,n,t)}function wi(n,t){return rt(h.getOrCreate,n,t)}function bi(n,t){return!!rt(ft.tryGetSelectableViewModelContract,n,t)}function ki(n,t){return rt(ft.tryGetSelectableViewModelContract,n,t)}function ri(n,t){return rt(c.isSelectableSet2,n,t)}function di(n,t){return rt(c.getSelectableSet2,n,t)}function ui(n,t,i,r,u){var c;if(u){var o=p.CompositionBinder.mapInputBindingDefinitions(i.selectableBindings,t.referenceComposition),l=nr(r,t.initialViewModelState),s=l?l:{},h=new b.PropertyBindings(t.masterModelId+"-[Selection]",s),a=b.getModelValue(t.masterModel,r).value,f=tr(t,a,r);c=function(){f&&f.setInternalSelectedValue(!0)};o.length>0&&(t.configureBindings&&t.configureBindings(o),n.registerForDispose((function(){h.unbind()})),o.forEach((function(n){var t=b.getModelValue(s,n.targetProperty).value;b.setModelValue(s,n.targetProperty,ut(t))})),p.CompositionBinder.setupPropertyBindings(t.referenceComposition,h,o),c=function(){f&&(f.lock(),f.setInternalSelectedValue(h.targetModel),o.forEach((function(t){s[t.targetProperty].subscribe(n,(function(){a.isSelected()&&f.setInternalSelectedValue(h.targetModel)}))})))})}return{invocationInputArguments:[{valuesFrom:[{property:r+".value",referenceType:pt(t.referenceComposition)}]}],updateSelectedValue:c||e,isMultiple:!1,viewStatePropertyRemovals:[],success:!0}}function gi(n,t,i,r,u){var f,s,g=t.masterModel,h,v=fi(r.selectablePath,t.initialViewModelState),y=r.selectablePath+".activatedItems",p,w=dt,c="",l="",k=[],a=!0,o;return f=b.getModelValue(t.masterModel,r.selectablePath).value,f&&f.activatedItems&&(p=f.activatedItems),h=it(g,t.initialViewModelState),o=r.selectablePath,u?(l=w+"._sets."+h._sets().length.toString(),c=l+".activatedItems",h._sets.push(v),k.push(y,o+".selectedItems",o+".itemsWithChildEdits"),f&&p?(s=new d.SelectableSetBinder(o,t.masterModelId,f,v,r.selectableBindings,t.referenceComposition),i.push(s),n.registerForDispose((function(){s.dispose();i.remove(s)}))):(nt(t,"The view model for '"+t.masterModelId+"' is missing the required property '"+y+"' needed to open the child blade(s) '"+r.blade+"'"),a=!1)):(h._sets().some((function(n,t){return n.path()===o?(l=w+"._sets."+t.toString(),c=l+".activatedItems",!0):!1})),c===""&&(tt.error("Failed to find a selectable set reflection for view model '"+t.masterModelId+"'. Selectable set path is '"+o+"'"),a=!1)),{invocationInputArguments:[{valuesFrom:[{property:c,referenceType:pt(t.referenceComposition)}]}],updateSelectedValue:e,isMultiple:!0,viewStatePropertyRemovals:k,success:a}}function fi(n,t){var i=t&&t.internal?t.internal.selectable:null,f,e,o;return i&&i._sets&&(f=r.keys(i._sets).filter((function(n){return!!i._sets[n].path&&!!i._sets[n].activatedItems})).map((function(n){return i._sets[n]})).first((function(t){return t.path===n}))),f&&(u.isArray(f.activatedItems)&&(e=f.activatedItems.slice(0),e.forEach((function(n,t){e[t]=p.CompositionBinder.createObservableModel(n)}))),u.isArray(f.itemsWithChildEdits)&&(o=f.itemsWithChildEdits.slice(0),o.forEach((function(n,t){o[t].item=p.CompositionBinder.createObservableModel(n.item)})))),{path:ut(n),activatedItems:g(e),itemsWithChildEdits:g(o)}}function nr(n,t){var u=t&&t.internal?t.internal.selectable:null,f;return u&&u._selectables&&(f=r.keys(u._selectables).filter((function(n){return!!u._selectables[n].path&&!!u._selectables[n].selectedValue})).map((function(n){return u._selectables[n]})).first((function(t){return t.path===n}))),f?i.clone(f.selectedValue,!0):undefined}function it(n){var t=n.internal.selectable();return t||(t={_sets:g(),_selectables:g(),_dynamicSelections:g(),_selectable2Invocations:{},_contextMenu2Selectables:ut({}),_wizardShim:g([]),commandBar2Selectables:ut({}),callbacks:g()},n.internal.selectable(t)),t}function tr(n,t,i){var r=t;return t?(r.lock&&r.setInternalSelectedValue&&r.isLocked||(nt(n,"This property '"+i+"' must be of type MsPortalFx.ViewModels.Selectable, view model = '"+n.masterModelId+"'"),r={lock:e,setInternalSelectedValue:function(n){t.selectedValue(n)},isLocked:e}),r):undefined}function ir(n,t,r,u,f){var l=function(t,i,r,u){t.forEach((function(t,f){var o=ct(n,t,r),e=i.first((function(n){return bt(o,n.invocationModel)}));u(t,f,e&&e.editScopeId)}))},o,s;if(u.length===0)o=t.itemsWithChildEdits,s=o().length,s>0&&o.splice(0,s);else{var h=i.mapMany(u,(function(n){var e,t,u,f;if(n.path.length-r.length>2)return[];e=n.path[r.length];try{t=i.parseSortedString(e)}catch(o){tt.error("Failed to parse journey path segment. Path: '"+JSON.stringify(n.path)+"'. Error: '"+o.message+"'.")}return u=t&&t.model,f=n&&n.value&&n.value.editScope&&n.value.editScope.editScopeId,u&&f?[{invocationModel:u,editScopeId:f}]:[]})),e=t.itemsWithChildEdits().slice(),c=!1;l(t.activatedItems(),h,f,(function(n,t,i){if(i){var r=e.some((function(t){return bt(t.item,n)}));r||(c=!0,e.push({item:n,editScopeId:i}))}}));e.length>h.length&&l(e.map((function(n){return n.item})),h,f,(function(n,t,i){i||(c=!0,e.splice(t,1))}));c&&t.itemsWithChildEdits(e.slice())}}function ei(n,t,i,r){var u=t.getBlades().filter((function(t){return!t.isDisposed()&&t.masterInvocationProperty===i.source.property&&n.isBladeOpenedByMaster(t)})),s=r||y.shouldSkipPromptForBladesWithEdits(n,u),o=s||n.services.desktop.confirmBladesCanClose(u.map((function(n){return n.id}))),f,e;if(o)for(f=u.length-1;f>=0;f--)e=u[f],n.removeOutputBindings(e),t.untrack(e),n.services.desktop.forceCloseBlade(e.id);return o}function rr(){var n=[],t={},i=kt.Callbacks();return{bladeOpenedCallbacks:i,getBlades:function(){return n.slice(0)},track:function(t){(t||[]).forEach((function(t){t&&!n.some((function(n){return n===t}))&&(n.push(t),i.fire(t))}))},wasClosedByMaster:function(n){return t.hasOwnProperty(n&&n.id)},isTracked:function(t){return n.some((function(n){return n===t}))},untrack:function(i){i&&(n.remove(i),t[i.id]=!0)},closed:function(i){i&&(n.remove(i),delete t[i.id])},dispose:function(){n=[];t={};i.empty()}}}function ur(n,t,i,r){return ui(n,t,i,"container.selectable",r)}function fr(n,t,i){it(n.masterModel,n.initialViewModelState);var r=ki(n.masterModel,i);return r._msPortalFxSelectable2?oi(n,t,i+"._msPortalFxSelectable2"):(i=i+"._msPortalFxSelectable",t[0].valuesFrom[0].property=i+".value",{success:!0,isMultiple:!1,invocationInputArguments:t,viewStatePropertyRemovals:[],updateSelectedValue:e})}function oi(n,t,i){var u=n.masterModel,f=it(u,n.initialViewModelState),r=wi(u,i),o=i.replace(/\./g,"_");return f._selectable2Invocations[o]=r.value,f.callbacks.push(r.callbacks),t[0].valuesFrom[0].property="internal.selectable._selectable2Invocations."+o,{success:!0,isMultiple:!1,invocationInputArguments:t,viewStatePropertyRemovals:[],updateSelectedValue:e,selectable2:r}}function er(n,t,i,r,u){var o=di(t.masterModel,r),h,f,s;return o&&o.dynamicSelectionProvider&&(h=it(t.masterModel,t.initialViewModelState),u[0].valuesFrom[0].property="internal.selectable._dynamicSelections."+h._dynamicSelections().length,f=g(),h._dynamicSelections.push(f),f.subscribeArrayBulkChanges(n,(function(n,t){t.length&&o.deactivateIds(t.map((function(n){return n._id})))})),s=new ht.CancelationToken,o.activatedItems.subscribe(n,(function(n){var i=f.peek(),r=n.filter((function(n){return!i.some((function(t){return st.compareIds(n.id,t._id)}))})),t=i.filter((function(t){return n.some((function(n){return st.compareIds(n.id,t._id)}))})),u;s.cancel();r.length?(u=r.map((function(n){var t=ni(n.id);return Q(o.dynamicSelectionProvider(t,ni(n.data))).then((function(n){return kt.extend({_id:t},n)}))})),s=new ht.CancelationToken,ht.makeCancelable(Q.all(u),s).then((function(n){n.reverse().forEach((function(n){var i=t.firstIndex((function(t){return st.compareIds(t._id,n._id)}));i>=0?t.splice(i,1,n):t.unshift(n)}));f(t)}))):t.length<i.length&&f(t)}))),{success:!0,isMultiple:!0,invocationInputArguments:u,viewStatePropertyRemovals:[],updateSelectedValue:e}}function or(n,t,i,r,u){var l,f,d=t.masterModel,a,o,y=fi(i.selectablePath,t.initialViewModelState),p="activatedItems",w=dt,s="",h="",v=!0;return l=b.getModelValue(t.masterModel,i.selectablePath).value,l&&(a=c.getSelectableSet2(l)),o=it(d,t.initialViewModelState),r?(h=w+"._sets."+o._sets().length.toString(),s=h+".activatedItems",o._sets.push(y),a?(f=new k.SelectableSetBinder(p,t.masterModelId,a,y,i.selectableBindings,t.referenceComposition),u.push(f),n.registerForDispose((function(){f.dispose();u.remove(f)}))):(nt(t,"The view model for '"+t.masterModelId+"' is missing the required property '"+p+"' needed to open the child blade(s) '"+i.blade+"'"),v=!1)):(o._sets().some((function(n,t){return n.path()===i.selectablePath?(h=w+"._sets."+t.toString(),s=h+".activatedItems",!0):!1})),s===""&&(tt.error("Failed to find a selectable set reflection for view model '"+t.masterModelId+"'. Selectable set path is '"+i.selectablePath+"'"),v=!1)),{invocationInputArguments:[{valuesFrom:[{property:s,referenceType:pt(t.referenceComposition)}]}],updateSelectedValue:e,isMultiple:!0,viewStatePropertyRemovals:[],success:v}}function sr(n,t,i,r){var u=yt(n,i);if(u&&u.isSelected&&u.isCommandSelected){var f=u.isSelected,o=u.isCommandSelected,e=t.getBlades().filter((function(t){return t.masterInvocationProperty===i.source.property&&n.isBladeOpenedByMaster(t)}));o()&&e.length===0&&o(!1);f()&&e.length===0?(f(!1),r()):!f()&&e.length>0?(r(),f(!0)):r()}}function si(n,t,i,r,u){var f=t,e=t,o=n.referenceComposition.getPartsContainer().journeyPath.concat([r]),s=i.ambientSettings.getItemsUnderPath(o);f&&f.selectedValue?f.hasChildEdits(s.length>0):e&&e.itemsWithChildEdits&&ir(n.masterModelId,e,o,s,u)}function hr(n,t,i,r){var f=t.services.desktop.getActiveJourney(),u,e=t.referenceComposition.getPartsContainer()===t.services.desktop.startBoard,o=null,s=function(r){if(r&&r.originTile){if(e&&r.originTile.id!==t.referenceComposition.id)return;if(u=n.createChildLifetime(),cr(t,u,r,i),e)r.onDispose((function(){u&&(u.dispose(),u=null)}))}else return};s(f);e&&(o=function(){u||(f=t.services.desktop.getActiveJourney(),s(f))},r.bladeOpenedCallbacks.add(o),n.registerForDispose((function(){r.bladeOpenedCallbacks.remove(o)})))}function cr(n,t,i,r){var f,u,e;if(!i)throw new Error("Journey is required.");f=yt(n,r);u={locator:null,masterInvocationProperty:r.source.property};n.configureBindings&&u.bindings&&u.bindings.length&&n.configureBindings(u.bindings);n.configureBladeDescriptor(u);e=y.getBladeOpenerJourneyPathSegment(u);si(n,f,i,e,r);i.ambientSettings.getObservable().subscribe(t,(function(){si(n,f,i,e,r)}))}function lr(n,t,i){var r=b.getModelValue(n.masterModel,i.source.property).value,f=lt(r),e;u.isArray(f)?i.opensMultipleBlades?(e=f.firstIndex((function(r){var s=t.getBindableContainer().getViewModel(),f=ct(n.masterModelId,r,i),u=a.deepSubset(s,f),e,o;return u&&i.opensDynamicBlades&&(e=v.mapDynamicSelectionToBladeLocator(n.services,r,et(n.referenceExtension.name),n.masterModelId),o=y.getMappedBladeLocator(n.services,e,f,t.masterContainer),u=t.locator.equals(o)),u})),e>=0&&r.splice(e,1)):r.splice(0,f.length):b.setModelValue(n.masterModel,i.source.property,undefined)}function ar(n,t,i){var r=n.referenceComposition.getPartsContainer();r&&r.detailContainers&&i.track(r.detailContainers.filter((function(i){return n.isBladeOpenedByMaster(i)&&i.masterInvocationProperty===t.source.property})))}function vr(n,t){var u=!n.length,r;i.remove(n,(function(n){return n.id===t.id}),1);n.push(t);r=function(t){t.pipeline.startTask(t.taskArgs).finally((function(){n.shift();n.length&&r(n[0])}))};u&&r(n[0])}function yr(n,t){var i=ii(n,t);return i&&i.controlType===107&&i}function pr(n,t,i){return t.parameterCollector&&n?!!yr(n,i):!1}function wr(n,t,r,u){var c=i.find(r.additionalInputArguments,(function(n){return n.property==="internal_bladeCallId"})).valuesFrom[0].property,e=f.unwrap(b.getModelValue(u,t).value),s=f.unwrap(b.getModelValue(u,c).value),o=f.observable(e),h,l;return f.reactor(n,(function(){var i=f.unwrap(b.getModelValue(u,t).value),n;i!==e&&(e=i);n=f.unwrap(b.getModelValue(u,c).value);n&&e!==o.peek()&&(!s||n>s)?(s=n,o(e)):n||i||o(i)})),o.subscribe(n,(function(n){n||b.setModelValue(u,t,n)})),h=it(u,undefined),l=h._wizardShim().length,h._wizardShim.push(o),"internal.selectable._wizardShim."+l}function hi(n,t,r,u,f,o){var s,h,l,a=function(n){return n.map((function(n){return i.clone(n,!0,!1)}))},c;if(r.invocationInputArguments&&r.invocationInputArguments.length>0){if(h=r.invocationInputArguments,l=r.isMultiple,h=a(r.invocationInputArguments),!r.blade&&r.invocationInputArguments[0].valuesFrom&&r.invocationInputArguments[0].valuesFrom.length>0){if(s=r.invocationInputArguments[0].valuesFrom[0].property,c=n.masterModel,s=s==="container.selectable"?"container":s,bi(c,s))return fr(n,h,s);if(pi(c,s))return oi(n,h,s);if(ri(c,s))return er(t,n,r,s,h);v.isSelectableSet(c,s)?(l=!0,h[0].valuesFrom[0].property=s+".activatedItems"):v.isSelectable(c,s)?(l=!1,h[0].valuesFrom[0].property=s+".value"):pr(s,r,c)&&(h[0].valuesFrom[0].property=wr(t,s,r,c))}return{success:!0,isMultiple:l,invocationInputArguments:h,viewStatePropertyRemovals:[],updateSelectedValue:e}}return br(n,t,r,u,f,o)}function br(n,t,i,r,u,f){var o={success:!0,isMultiple:!1,invocationInputArguments:null,viewStatePropertyRemovals:[],updateSelectedValue:e};if(i.selectablePath)if(ri(n.masterModel,i.selectablePath)){if(!i.selectableBindings||!i.selectableBindings.some((function(n){return n.valuesFrom&&n.valuesFrom.length>0?n.valuesFrom[0].referenceType===6:!1})))return o.success=!1,nt(n,"The view model '"+n.masterModelId+"' has a selectable source '"+i.selectablePath+"' that is a selectable set.  There must be at least one <BladeInput> which has SelectedItem as the Source for a selectable set to identify which row is opening the blade."),o;o=or(t,n,i,r,f)}else if(v.isSelectableSet(n.masterModel,i.selectablePath)){if(!i.selectableBindings||!i.selectableBindings.some((function(n){return n.valuesFrom&&n.valuesFrom.length>0?n.valuesFrom[0].referenceType===6:!1})))return o.success=!1,nt(n,"The view model '"+n.masterModelId+"' has a selectable source '"+i.selectablePath+"' that is a selectable set.  There must be at least one <BladeInput> which has SelectedItem as the Source for a selectable set to indentify which row is opening the blade."),o;o=gi(t,n,u,i,r)}else v.isSelectable(n.masterModel,i.selectablePath)?o=ui(t,n,i,i.selectablePath,r):(o.success=!1,nt(n,"The view model for '"+n.masterModelId+"' with property '"+i.selectablePath+"' must of type MsPortalFx.ViewModels.Selectable or MsPortalFx.ViewModels.SelectableSet to open the child blade(s) '"+i.blade+"'"));else o=ur(t,n,i,r);return o}function nt(t,i,r){o.logToExtension(n,t.referenceExtension.name,2,i,r)}var ft=FxImpl,wt=ft.TriggerableLifetimeManager,ci=i.Base.Diagnostics,li=i.ViewModels,st=li.Internal.Selection2,ht=i.Base.Promises,ct=y.mapMasterModelToBladeModel,bt=i.deepEquals,kt=jQuery,tt=ci.createLog(n),e=i.noop,dt="internal.selectable",gt="./UI.Composition.BladeOpener",ut=f.observable,g=f.observableArray,ai=f.unwrap,ni=f.utils.peekObservable,lt=f.toJS,et=l.Locator.forExtension,ot=s.createDescriptor();ot.registerAsyncFactory("./UI.Composition.BladeInvocationHandler",(function(n,t,i,r,u){return t.factory(n,i,r,u)}),(function(n,t,i){return!at(i)}),n);ot.registerAsyncFactory(gt+".Selectable2",(function(n,t,i,r){return t.selectable2InvocationHandler(i,r)}),(function(n,t,i){return t.selectable2?!at(i):!1}),n);ot.registerAsyncFactory(gt+".PendingBladeHint",(function(n,t,i,r){return t.getHandler(i,r)}),(function(n,t,i){return at(i)}),n);t.create=function(n){var f=[],e=[],o=[],h=[],t=i.extend2(vi(),n),r=rr(),s=new b.PropertyBindings(t.masterModelId+"-[Invocation]",{}),u;return r.bladeOpenedCallbacks.add(t.onBladeOpened),u=new wt,u.registerForDispose([function(){s.unbind()},r,]),u.getInitialState=function(){return t.initialViewModelState},u.registerInvocationProperty=function(n,i,c){var y=u.createChildLifetime(),it=null,rt=t.referenceComposition.getPartsContainer(),ft=ti(t,n),p=hi(t,y,n,!0,e,o),l,a={container:rt,detailsBladeLocator:ft,disableInvocation:i,isThrottled:ut(!1),detailBladesTracker:r,resettingMasterArrayValue:!1,registrationInfo:undefined,prevValue:undefined,previousInvocationPromise:undefined},k=function(){return lt(b.getModelValue(t.masterModel,l.source.property).value)},g,w,d;if(a.selectable2=p.selectable2,g=ot.createPipeline(y,t,a),p.success)return a.registrationInfo=yi(t,y,n,p),l=a.registrationInfo.invocationInput,a.prevValue=k(),f.push(l),ar(t,l,r),sr(t,r,l,(function(){p.updateSelectedValue()})),hr(y,t,l,r),i&&i.subscribe(y,(function(n){n?(v.traceInvocationChange(tt,"Disabled listening for invocation property change.",t,l,k()),ei(t,r,l,!0)):(a.prevValue=k(),a.prevValue!==undefined&&nt(t,"Selectability was enabled for the part (container.isSelectable(true)) and the part is already in a selected state.  Current selection state will be ignored and blade will not be opened. Part Id: "+t.masterModelId,a.prevValue))})),w=l.source.property,d=s,b.setModelValue(d.targetModel,w,lt(a.prevValue)),it=d.addProperty(w).bind(t.masterModelId,t.masterModel,!!a.selectable2,(function(n){var i=k(),r={value:i,invocationInput:l,propertyChanges:n};v.traceInvocationChange(tt,"Detected invocation property change.",t,l,i);a.selectable2?vr(h,{id:w,pipeline:g,taskArgs:r}):g.startTask(r)}),(function(n){nt(t,"Failed to subscribe to changes for the selectable "+w+". Error: "+n)})),y.registerForDispose((function(){t.services.desktop.activeJourney()&&ei(t,r,l,!0);d.removeProperty(it);f.remove(l)})),c&&c.registerForDispose(y),{viewStatePropertyRemovals:p.viewStatePropertyRemovals}},u.notifyDetailBladesOpened=function(n){r.track(n)},u.notifyDetailBladeClosed=function(n){if(r.isTracked(n)){var u=r.wasClosedByMaster(n),i=f.first((function(t){return t.source.property===n.masterInvocationProperty}));t.removeOutputBindings(n);r.closed(n);i?u||lr(t,n,i):tt.error("Unable to react to detail blade '"+(n&&n.toString())+"' closing. No invocation argument on this part that opened the blade. Invocations: '"+JSON.stringify(f)+"'")}},u.modifyViewStateProperties=function(n,t){return n.filter((function(n){return!t.viewStatePropertyRemovals.first((function(t){return n===t}))}))},u.createBladeModelForSelectedItem=function(n,i){var f=n.invocationInputArguments,c=new wt,l=hi(t,c,n,!1,e,o),a=vt(l.invocationInputArguments,t.referenceComposition,b.ReferenceScope.MasterContainer,n)[0],r={},h,s=ti(t,n),y=function(){var n=t.referenceComposition;return n.containerModel||n.getBindableContainer().getViewModel()};return l.updateSelectedValue(),s||n.blade||(s=v.mapDynamicSelectionToBladeLocator(t.services,i,et(t.referenceExtension.name),t.masterModelId)),f&&f.length&&f[0].property?r[a.targetProperty]=i:(h=i,!f&&n.selectablePath&&e.some((function(t){return t.selectablePath===n.selectablePath?(h=t.createTargetForSelectedItem(i),!0):!1})),r=ct(t.referenceComposition.locator.toString(),h,a)),(n.additionalInputArguments||[]).forEach((function(n){if(n.valuesFrom&&n.valuesFrom.length){var f=n.property,i=n.valuesFrom[0];i.referenceType!==0||i.part&&i.part!==t.referenceComposition.locator.name?i.referenceType===1?r[f]=y()[i.property]:(r[f]=undefined,tt.warning("Part Selection: Blade "+s+" Property "+f+" has an input that's from part "+i.part+" instead of its list part "+u+" or the blade.")):r[f]=b.getModelValue(t.masterModel,i.property).value}})),c.dispose(),{model:r,locator:s}},u};t.createOrGetInternalSelectionState=it})(g||(g={})),g}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar",["require","exports","f","i","o","a","ko","$","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.Selectable2","Fx/Composition/Selectable","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.AssetTypes","FxInternal/Di"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function kt(n,t,r){var u=new i.Map;dt(n,u,t,r)}function dt(n,t,i,r){e.computed(n,(function(){var n=vt(i);e.ignoreDependencies((function(){var i=[];t.forEach((function(t,r){n.has(r)||i.push(t)}));i.forEach((function(n){t.delete(n.selectable)}));n.forEach((function(n,i){t.has(i)||(gt(n,r),t.set(i,n))}))}))})).extend({throttle:100})}function gt(n,t){var i=t.getBladeOpener(),r={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:n.path}]}]},u=rt(n.selectable);i.registerInvocationProperty(r,undefined,u)}function ni(n,t,r,u){var f=n.filter((function(n){return n.type===10}));if(f.length===0)return!0;if(!ti(f,r.locator))return!1;var h=r.getBladeOpener(),c=bt(t,h.getInitialState()),o=c[u],s={};return f.forEach((function(n){var u=n.selectable,r=rt(u);s[r.id]=u;r.registerForDispose({dispose:function(){var n=i.clone(o(),!1);delete n[r.id];o(n)}});e.reactor(r,(function(){r.isSelected()&&t.internal.activeOpenBladeCommand(n)}))})),o(s),!0}function ti(n,t){function f(i){var u=n.filter((function(n){return!n[i]}));return u.length&&ft.error(r.format(u.length,i,t)),!!u.length}var r,u,i;return(n=n||[],r="Found {0} OpenBladeCommmand2 items with a null or undefined '{1}' property. Source: '{2}'",["id","selectable"].some(f))?!1:(u=n.map((function(n){return n.id})),i=ci(u),i.length)?(ft.error("Found multiple OpenBladeCommand2 items have the same id. Ids must be unique. Duplicate Id(s): '{0}', Source: '{1}'".format(JSON.stringify(i),t)),!1):!0}function ht(n,t,u){var e,s;if(!t)return undefined;var h=r.shellInterface(t.container),l=h.selectables(),f=l[n],a=!f;return a&&(e=o.extend(!1,l),f=e[n]=new c.Selectable2({supplyBladeReference:i.noop}),h.selectables(e)),s=rt(f),a&&u&&u(s),s}function ii(n){var t=i.Base.ProxiedObservables.data(n,k);return t||(t=k+ct++,i.Base.ProxiedObservables.data(n,k,t)),t}function ri(n,t,r){var f=ut(t,r),u=i.Base.ProxiedObservables.data(f,et),o;u||(u=f?i.Base.ProxiedObservables.data(f,et,{}):{});o=ii(t);u[o]||(u[o]=e.observable(),n.registerForDispose((function(){return delete u[o]})));var h=u[o],c=function(n){var t=n;e.reactor(f.container,(function(){var i=t.activationState(),r,f;i&&(r=i.previous&&i.previous.item,f=i.current&&i.current.item,r&&u[r]&&u[r](undefined),f&&u[f]&&u[f](n.value()))}))},s=ht(k,f,c);return{activated:h,invokeClick:function(n,t){s&&s.invokeClickCallback(2,f,n,t,a.getOrCreateFxElement(r[0],f.internal.elements),o)},openBlade:s?s.openBlade:function(){}}}function lt(n,t,i){var r=ut(n,t),f,e,u;if(r&&(f=si(r,n,!0),f))return e=f.replace(/\./g,"_"),u=ht(e,r),u.onClick=function(){u.invokeClickCallback(1,r,n,i)},u}function ui(n,t,i){var r=lt(n,t,o.noop),u=r,f=ut(n,t);return u.onClick=function(t){r.invokeClickCallback(3,f,n,i,undefined,t.item,t.metadata)},u}function fi(n,t){t?(n.closest(".fxs-part-content").find("."+g).removeClass(nt),n.addClass(nt)):n.removeClass(nt)}function oi(t,u,f){var a=new r.TriggerableLifetimeManager,ht=u.$data,w=o(t),tt=t.tagName==="A",it=ri(a,ht,w),b=u,rt,ct=function(n,i){var r=!!n,u;t.setAttribute("aria-disabled",""+r);w.toggleClass("azc-text-disabled",r);u=r?-1:i?i:0;t.setAttribute("tabindex",""+u)},lt=function(n,t){rt?rt.then((function(i){var r=i||n;ct(r,t)})):ct(n,t)},et=function(){return t.getAttribute(d)},vt=tt&&!!et(),at=function(){t.setAttribute(d,ot)},ut=Q(),nt,c,l,h,k,g=ut,ft,st;e.utils.domNodeDisposal.addDisposeCallback(t,(function(){a.dispose()}));ft=i.isFeatureEnabled("fxclicklinks");ft&&e.reactor(a,(function(){var r,u,o,v,a,it,ft,et;try{if((c||l||h)&&at(),nt=c=l=h=rt=k=null,g=ut,r=e.unwrap(f()),!r)return;if(typeof r=="function")nt=r;else{if(!tt)return;o=void 0;r.hasOwnProperty("bladeReference")?(c=r,v=e.unwrap(c.bladeReference),g=Q(v)):r.hasOwnProperty("resourceId")?(l=r,u=l.resourceId,g=u?li(u)||ut:ut):r.hasOwnProperty("uri")&&(h=r,a=e.unwrap(h.uri),it=s.sanitizeUri(a),k=it?a:"");o=g.then((function(n){if(n){var t=c?p.getBladeDeepLink({name:n.extensionName},n.bladeName,""):l?"#resource"+u:"";if(t)return t}}));ft=!!(c||l);et=!k&&!!h;rt=g.then((function(n){return!n&&ft||et}));lt(b.$disabled&&b.$disabled(),b.$tabIndex&&b.$tabIndex());k?t.setAttribute(d,k):o.then((function(n){n&&t.setAttribute(d,n)}))}}catch(ot){y.logToExtension(n,w,2,"fxclick failed to read value: "+i.getLogFriendlyMessage(ot))}}));tt&&!et()&&at();e.reactor(a,[b.$disabled,b.$tabIndex],lt);st=function(i){var u=!1,s,a,p,w;if(v.default.keydown===i.type)if(13===i.which)u=!0,i.preventDefault();else return!0;else if(ft&&!nt&&(i.ctrlKey||i.shiftKey))return!0;tt&&(s=et(),(h||s&&s.startsWith(ot))&&i.preventDefault());a=function(n){it.invokeClick(ht,n)};try{ft?nt?a(nt):c||l?g.then((function(n){if(n){it.openBlade(n);var t=(c||l).onLinkOpened;t&&t(u)}})):h&&(p=k,p&&(w=window.open(p,e.unwrap(h.target),e.unwrap(h.windowFeatures)||undefined),h.onLinkOpened&&h.onLinkOpened(u))):a(e.unwrap(f()))}catch(b){y.logToExtension(n,t,2,r.createError("fxclick binding Error",{innerErrors:b,data:{databind:o(t).attr("data-bind")}}))}i.stopPropagation()};a.registerForDispose(w.setEvents([v.default.click,st,],[v.default.keydown,st,]));it.activated.subscribeAndRun(a,(function(n){var t=!!n;fi(w,t);t&&w.trigger(o.Event(v.default.fxselectableactivated,{activated:it.activated}))}))}function at(n,t,i){try{var r=e.unwrap(n[t]);return(!i&&f.isArray(r)||typeof r!="object")&&(r=undefined),r}catch(u){return undefined}}function tt(n,t){return n?n+"."+t:t}function vt(n){for(var e=new i.Map,s={path:undefined,value:n,unprocessedChildProperties:it(n)},r=[s],u,f,t,o;r.length;)u=r[r.length-1],u.unprocessedChildProperties.length?(f=u.unprocessedChildProperties.shift(),t=at(u.value,f),t&&(yt.isSelectable2(t)?e.set(t,{path:tt(u.path,f),selectable:t}):r.length<st&&(o={path:tt(u.path,f),value:t,unprocessedChildProperties:it(t)},r.push(o)))):r.pop();return e}function si(n,t,i){for(var s=undefined,c={path:undefined,value:n,unprocessedChildProperties:it(n)},r=[c],u,o,e,f,h;r.length;)if(u=r[r.length-1],o=u.unprocessedChildProperties,o.length){if(e=o.shift(),f=at(u.value,e,i),f)if(f===t){s=tt(u.path,e);break}else r.length<st&&(h={path:tt(u.path,e),value:f,unprocessedChildProperties:it(f)},r.push(h))}else r.pop();return s}function it(n){return u.keys(n).filter((function(n){return!hi(n)}))}function hi(n){return n.charCodeAt(0)===95&&!(n.charCodeAt(1)===109&&n.charCodeAt(2)===115&&n.charCodeAt(3)===80&&n.charCodeAt(4)===111&&n.charCodeAt(5)===114&&n.charCodeAt(6)===116&&n.charCodeAt(7)===97&&n.charCodeAt(8)===108&&n.charCodeAt(9)===70&&n.charCodeAt(10)===120)}function ci(n){var t={},i=[];return(n||[]).forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function li(n){var t=b.container.get(w.AssetTypeService).mapResourceIdToDynamicSelectionAndIcon(n,{reason:"openBlade"});return t&&t.then((function(n){return i.Assets.mapDynamicBladeSelectionToBladeReference(n.selection)}))}var g,nt,ct,ei;u.defineProperty(t,"__esModule",{value:!0});var yt=r,pt=i.Base.Diagnostics,wt=i.ViewModels,ai=wt.Toolbars,bt=l.createOrGetInternalSelectionState,rt=h.getOrCreate,ut=h.findExtensionViewModel,ft=pt.createLog(n),k="fxclick",et=k+"idmap",ot="#",d="href",st=15;t.autoRegisterSelectables=kt;t.registerOpenBladeCommands=ni;g="msportalfx-activated";nt=g+" ext-"+g;ct=0;t.getSelectableWithClickHandler=lt;t.getListSelectableWithClickHandler=ui;ei=i.noop;t.attachFxClickHandler=oi;t.discoverSelectables=vt}))