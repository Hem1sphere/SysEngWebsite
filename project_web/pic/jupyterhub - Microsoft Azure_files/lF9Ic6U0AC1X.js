define("_generated/Less/MsPortalImpl/Controls/Forms/GroupDropDown.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxc-dropdown-option-label,.fxc-group-dropdown-arrow{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}.fxc-dd-caret,.fxc-dropdown-popup svg{pointer-events:none}.fxc-dropdown-check,.fxc-dropdown-open.azc-input,.fxc-dropdown-popup{border-width:1px;border-style:solid}.fxc-group-dropdown{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box;position:relative;font-size:12px;height:auto;line-height:inherit}.fxc-group-dropdown .azc-formElementContainer{position:relative}.fxc-left-label .fxc-dd-text-wrapper{min-height:23px;position:relative}.fxc-left-label .fxc-dropdown-open.azc-input{position:absolute}.fxc-dropdown-open.azc-input{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:inherit;display:block;padding:2px 20px 3px 8px;width:calc(100% - 30px);min-height:16px}.fxc-dropdown-open.azc-input input{display:none}.fxc-dropdown-option{position:relative;cursor:pointer}.fxc-dd-noresults,.fxc-dropdown-option,.fxc-dropdown-option-label{padding:4px 4px 4px 8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxc-dd-noresults{font-style:italic;text-align:center;opacity:.7}.fxc-dropdown-option-label{padding-bottom:0}.fxc-dropdown-option-disabled{opacity:.35}.fxc-dropdown-option-disabled,.fxc-dropdown-option-disabled .fxc-dropdown-option{cursor:default}.fxc-group-dropdown .azc-formControl .fxc-dropdown-select{opacity:1;outline:0;padding-left:0}.fxc-group-dropdown .azc-textBox-wrapper input{padding-top:3px;padding-right:20px}.fxc-dropdown-multifilter{padding:8px}.fxc-dropdown-multifilter input{border-top-width:0;border-left-width:0;border-right-width:0}.fxc-dropdown-popup{box-shadow:0 4px 8px 0 rgba(0,0,0,.14);width:calc(100% - 2px);position:fixed;max-height:750px;z-index:150;overflow:auto;overscroll-behavior-y:contain;-ms-scroll-chaining:none}.fxc-dropdown-hidden{visibility:hidden;left:-10000px;top:-10000px}.fxc-dropdown-open{cursor:pointer}.fxc-dropdown-placeholder{font-style:italic;opacity:.8}.fxc-dropdown-group .fxc-dropdown-option,.fxc-dropdown-group .fxc-dropdown-option-label{padding-left:15px}.fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-option,.fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-option-label{padding-left:30px}.fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-option,.fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-option-label{padding-left:45px}.fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-option,.fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-group .fxc-dropdown-option-label{padding-left:60px}.fxc-dropdown-filter:not(.fxc-dropdown-multiselect) div.azc-input{display:none!important}.fxc-group-dropdown-arrow{position:absolute;height:calc(100% - 2px);width:27px;right:1px;top:1px;cursor:pointer}.fxc-dd-caret{height:13px;width:13px;position:absolute;top:calc(50% - 6px);right:7px}.fxc-dropdown-check{height:11px;width:11px;min-width:11px;padding:2px;top:calc(50% - 8px);position:absolute}.fxc-dropdown-check .fxc-dd-svg{display:none}.fxc-group-dropdown .fxc-dropdown-keynav{outline:#00bcf2 dashed 1px;outline-offset:-1px}.fxc-dd-svg{height:11px;width:11px;margin-top:-2px}.fxc-dropdown-multiselect .fxs-portal-selected .fxc-dd-svg{display:block}.fxc-dropdown-multiselect .fxc-dropdown-option>span{display:inline-block;padding-left:23px}.fxc-dropdown-selectall-all .fxc-dropdown-selectall .fxc-dropdown-check .fxc-dd-svg{display:block}.fxc-dropdown-selectall{position:relative}.fxc-dropdown-selectall span.azc-bg-muted-80-10{display:none}.fxc-dropdown-selectall-partial .fxc-dropdown-selectall .azc-bg-muted-80-10{width:9px;height:9px;position:absolute;top:8px;left:12px;display:block;padding:0}.fxc-dropdown-selectall-partial .fxc-dropdown-selectall .fxc-dd-svg,.fxc-group-dropdown .azc-dockedballoon-validation{display:none}.fxc-group-dropdown .azc-validatableControl-invalid .fxc-dd-text-wrapper .fxc-TextField{width:calc(100% - 13px + 1px)}.fxc-group-dropdown .azc-validatableControl-invalid .fxc-dd-text-wrapper .azc-input.azc-formControl{border-color:#e81123}.fxc-group-dropdown .azc-validatableControl-invalid>.azc-dockedballoon-validation{display:block;width:13px;position:absolute;right:0;top:0;height:100%!important}.fxc-group-dropdown .azc-validatableControl-invalid .azc-dockedballoon-anchor{top:calc(50% - 12px);left:calc(50% - 2px);position:absolute}.fxc-group-dropdown .azc-validatableControl-invalid .fxc-group-dropdown-arrow{right:13px}.fxc-group-dropdown.azc-validationBelowCtrl .azc-validatableControl-invalid .fxc-TextField{width:100%}.fxc-group-dropdown.azc-validationBelowCtrl .azc-validatableControl-invalid .fxc-group-dropdown-arrow{right:1px}.fxc-dropdown-filter .azc-formElementSubLabelContainer.azc-validatableControl-invalid .azc-dockedballoon-validation{margin-right:-13px}')}));
define("MsPortalImpl/Controls/Forms/GroupDropDown",["require","exports","f","i","a","ko","$","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl.Controls/Fields/Base/LabelAndBalloonWidget","Viva.Controls/Util/Viva.TemplateEngine","MsPortalImpl.Controls/Fields/TextField","MsPortalImpl/Controls/Helpers/Validators","MsPortalImpl.Controls/Controls/Base/ViewModelBase","MsPortalImpl/Base/Base.BrowserDetection","_generated/Less/MsPortalImpl/Controls/Forms/GroupDropDown.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";var d;return (function(t){function si(n){return n&&n.length>0&&!n.hasClass(d)}function hi(n){n.parentsUntil("."+g).each((function(){e(this).find("> ."+ct).removeClass(d)}))}function pt(n){var t=[];return(f.unwrap(n)||[]).forEach((function(n){if(n.hasOwnProperty("value")&&!f.unwrap(n.disabled)){var i=f.unwrap(n.value);t.includes(i)||t.push(f.unwrap(n.value))}else n.hasOwnProperty("children")&&pt(n.children).forEach((function(n){t.push(n)}))})),t}function ci(n,t){var i="";return t.some((function(t){return t.hasOwnProperty("value")&&yt(f.unwrap(t.value),n)?i=f.unwrap(t.selectedItemOverride?t.selectedItemOverride:t.text)||"":t.hasOwnProperty("children")&&(i=ci(n,f.unwrap(t.children))),!!i.length})),i}function li(n){return i.merge.apply([],n)}function ai(n){var t=f.unwrap(n.children);return t?li(t.map(ai)):n}function ni(n){return u.isArray(n)?n:[n]}var vi=i.ViewModels.Forms.TextBox.ViewModel,rr=i.ViewModels.Controls,ft=i.isNullOrUndefined,ii=i.Base,et=ii.Images,bt=window,ot="azc-formElementContainer",yi=bt.document.implementation.createHTMLDocument(""),st="fxc-dropdown-option-disabled",nt="fxc-dropdown-option",tt="fxc-dropdown-keynav",ct="fxc-dropdown-option-label",rt="fxc-dropdown-open",ri="fxc-group-dropdown",g="fxc-dropdown-popup",lt="fxc-dropdown-hidden",d="fxs-display-none",kt="fxc-control-border",ui="fxs-br-primary",at="fxs-portal-selected",vt="msportalfx-tooltip-overflow",ut="azc-input",pi="fxc-dropdown-multiselect",fi="fxc-dropdown-check",it="fxc-dropdown-selectall",wi="fxc-dropdown-selectall-partial",bi="fxc-dropdown-selectall-all",ei="fxc-dropdown-filter",dt="fxc-dropdown-multifilter",ki=r.createElementStringLiteral(Root,null,r.createElementStringLiteral(KoIf,{condition:"$data.children || !$data.hasOwnProperty('value')"},r.createElementStringLiteral("div",{"class":"fxc-dropdown-header","data-bind":{css:(ti={},ti[st]="$data.disabled",ti)}},r.createElementStringLiteral(KoIf,{condition:"$data.text"},r.createElementStringLiteral("div",{"class":[ct,vt],"data-bind":{untrustedContent:"text"}})),r.createElementStringLiteral("div",{role:"tree","class":"fxc-dropdown-group","data-bind":{attr:{"aria-label":"ko.unwrap($data.ariaLabel) || $data.text"}}},r.createElementStringLiteral(KoForEach,{items:"$data.children"},r.createElementStringLiteral(KoTemplate,{templateKey:"innerTemplate"}))))),r.createElementStringLiteral(KoIf,{condition:"!$data.children && $data.hasOwnProperty('value')"},r.createElementStringLiteral("div",{role:"treeitem","class":[nt,vt],"data-bind":{attr:{"aria-selected":"(ko.unwrap($data.disabled) ? null : $data._selected().toString())",id:"$ctl._assignId()","aria-disabled":"$data.disabled","aria-label":"ko.unwrap($data.ariaLabel) || $data.text"},css:(ht={},ht[st]="$data.disabled",ht["fxs-portal-hover"]="!$data.disabled",ht[at]="$data._selected",ht)}},r.createElementStringLiteral(KoIf,{condition:"$ctl._multiselect"},r.createElementStringLiteral("div",{"class":[fi,kt]},r.createElementStringLiteral("span",{"class":["fxc-dd-svg","fxs-portal-svg"],"data-bind":{image:"MsPortalFx.Base.Images.Check()"}}))),r.createElementStringLiteral("span",{"class":"fxs-portal-svg","data-bind":{untrustedContent:"text"}})))),di=r.createElementStringLiteral("div",{"class":ot},r.createElementStringLiteral("label",{"aria-live":"polite","aria-atomic":"true","class":"fxs-hide-accessible-label","data-bind":{text:"$ctl._ariaLive"}}),r.createElementStringLiteral("div",{"class":"fxc-dd-text-wrapper",role:"combobox","aria-haspopup":"tree","aria-label":"combobox",tabindex:"-1","data-bind":{attr:{id:"$ctl._comboboxId","aria-expanded":"$data.data.isPopUpOpen().toString()","aria-owns":"$ctl._optionContainerId","aria-labelledby":"$ctl._labelId()"}}},r.createElementStringLiteral(KoIfNot,{condition:"$ctl._filter() && !$ctl._multiselect()"},r.createElementStringLiteral("div",{"class":["azc-formControl",ut,rt,vt,"azc-validation-border"],role:"textbox","aria-autocomplete":"list","aria-readonly":"true","aria-multiline":"false","data-canfocus":"true","data-bind":{untrustedHtml:{html:'($data.data.loading() ? "'+i.encodeAttribute(h.dropDownLoading)+'" : $ctl._displayString)',data:"$data.func ? $data.func._currentItem : $data.data"},css:(wt={},wt["azc-disabled"]="$disabled()",wt["fxs-br-dirty"]="data.dirty()",wt),attr:{id:"$ctl._textboxId",tabindex:"$tabIndex","aria-disabled":"$disabled()","aria-controls":"$ctl._optionContainerId","aria-labelledby":"$ctl._labelAndComboboxIds()"}}}))),r.createElementStringLiteral("span",{"class":["fxc-group-dropdown-arrow",rt]},r.createElementStringLiteral("span",{"class":["fxc-dd-caret","fxs-portal-svg"],"data-bind":{image:"$ctl._icon",css:{"msportalfx-svg-flip-vertical":"$data.data.isPopUpOpen() && $ctl._icon() !== MsPortalFx.Base.Images.Loading.Spinner()"}}})),r.createElementStringLiteral("div",{role:"tree",tabindex:"-1","aria-hidden":"true","aria-label":h.DropDown.optionContainer,"data-canfocus":"true","class":[lt,g,kt,"azc-bg-default"],"data-bind":{attr:{id:"$ctl._optionContainerId","aria-multiselectable":"$ctl._multiselect()"}}},r.createElementStringLiteral(KoIf,{condition:"$ctl._multiselect() && $ctl._filter()"},r.createElementStringLiteral("div",{"class":dt})),r.createElementStringLiteral(KoIf,{condition:"$ctl._multiselect() && $ctl._multiselectSelectAll() && data.items && data.items() && data.items().length"},r.createElementStringLiteral("div",{role:"treeitem","class":[nt,vt,it],"data-bind":{attr:{"aria-label":'"'+h.dropDownSelectAll+'"',id:"$ctl._assignId()","aria-selected":"$ctl._allSelected().toString()","aria-disabled":"$data.disabled"}}},r.createElementStringLiteral("span",{"class":"azc-bg-muted-80-10"}),r.createElementStringLiteral("div",{"class":[fi,kt]},r.createElementStringLiteral("span",{"class":["fxc-dd-svg","fxs-portal-svg"],"data-bind":{image:"MsPortalFx.Base.Images.Check()"}})),r.createElementStringLiteral("span",{"data-bind":{text:'"'+h.dropDownSelectAll+'"'}}))),r.createElementStringLiteral(KoIf,{condition:"$ctl._popupOnce"},r.createElementStringLiteral(KoForEach,{items:"$ctl._mapItems"},r.createElementStringLiteral(KoTemplate,{templateKey:"innerTemplate"}))),r.createElementStringLiteral(KoIf,{condition:"$ctl._showStatusMessage()"},r.createElementStringLiteral("div",{role:"treeitem","class":["fxc-dd-noresults"]},r.createElementStringLiteral("span",{"data-bind":{untrustedContent:"$ctl._statusMessage"}}))))),gt=35,gi=200,oi=750,nr=200,yt=i.deepEquals,tr=ii.Diagnostics.createLog(n),ir=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this,e;return u._displayString=f.observable(""),u._isTouch=k.isTouch,u._filterReadOnly=f.observable(!1),u._icon=f.observable(et.CaretDown()),u._pendingTimer=null,u._filter=f.observable(!1),u._filtering=!1,u._doNotFilter=!1,u._showStatusMessage=f.observable(!1),u._statusMessage=f.observable({htmlTemplate:h.Search.noResults}),u._multiselect=f.observable(!1),u._multiselectSelectAll=f.observable(!1),u._allSelected=f.observable(!1),u._labelId=f.observable(""),u._comboboxId=f.observable(""),u._labelAndComboboxIds=f.observable(""),u._optionContainerId=f.observable(""),u._textboxId=f.observable(""),u._filterTextboxId=f.observable(""),u._descendantIndex=0,u._ariaLive=f.observable(""),u._popupOnce=f.observable(!1),u._selectedValue=f.observable(),u._staleVMItems=f.observable(),u._popupGuard=!1,e=u.ltm,u._flattenItemsMap=f.computed(e,u.vm.items,(function(n){return n?li(n.map(ai)):[]})),u._flattenItemsMap.subscribeAndRun(u.ltm,(function(n){n.forEach((function(n){n._selected||(n._selected=f.observable(!1))}))})),u._setTemplate(),u._attachEvents(),u._initializeSubscriptions(),u._mapItems=f.computed(e,(function(){return u.vm.isPopUpOpen()?(u._staleVMItems(null),u.vm.items()):(u._setAttribute("aria-activedescendant",null),u._staleVMItems(u.vm.items()),u._staleVMItems())})),u}return __extends(t,n),t.prototype._setTemplate=function(){var r=this,n,t;this.element.addClass(ri+" msportalfx-form-formelement");n=new v.LabelAndBalloonWidgetHelper(this.ltm,this.vm);this._required=f.computed(this.ltm,(function(){var t=0!==r.vm.validations.filter(r.ltm,(function(n){return 1===n.type}))().length;return t||n.required()}));t=e(di);n.appendWidgetToDom(this.element,t);n.insertLabelBefore(t);this._labelId(n.labelId);this._textboxId(n.labelId+"textbox");this._filterTextboxId(n.labelId+"filter");this._comboboxId(n.labelId+"combobox");this._optionContainerId(n.labelId+"aria");this._labelAndComboboxIds(this._labelId()+" "+this._comboboxId());this.templateEngine=new y.StringTemplateEngine;this.templateEngine.setTemplate("innerTemplate",ki);this._bindDescendants({},this.element.findByClassName(ot));this._validator=new w.Validators(this.ltm,this,this.element.findByClassName(ot));n.errMsgId=(n.labelId||i.getUniqueId())+"-err";this._labelElement=this.element.find(".azc-form-labelcontainer > label");this.vm.showValidationMessagesBelowControl?n.insertValidationMessageBelowControlAfter(t,this,this._validator.validationResults):n.insertValidationMessageHidden(t,this,this._validator.validationResults);n.insertSubLabelAfter(t);t.findByClassName(ut).attr("aria-describedby",n.errMsgId);this._validator.validationResults.subscribeAndRun(this.ltm,(function(i){var r=i.filter((function(n){return n.state!==0&&!n.valid})).map((function(n){return n.message})).join(" ").trim();v.toggleAriaErrorMessage(t.findByClassName(ut),n.errMsgId,!!r)}))},t.prototype._initializeSubscriptions=function(){var n=this,t=this.vm,i=this.ltm,r=this.element.find("#"+this._comboboxId()),u=function(i){n._multiselect(i);n.element.toggleClass(pi,i);n._filter()?(n._removeFiltering(),n._setupFiltering()):n._updateSelected(t.value())};f.isObservable(t.multiselect)?t.multiselect.subscribeAndRun(i,(function(t){t?u(t):n._multiselect()&&u(t)})):t.multiselect&&u(!0);f.isObservable(t.selectAll)?t.selectAll.subscribeAndRun(i,(function(t){n._multiselectSelectAll(t);n._setSelectAllClass()})):t.selectAll&&(this._multiselectSelectAll(!0),this._setSelectAllClass());f.isObservable(t.filter)?t.filter.subscribeAndRun(i,(function(t){t?n._setupFiltering():n._filter()&&n._removeFiltering()})):t.filter&&this._setupFiltering();t.value.subscribeAndRun(i,(function(t){n._updateSelected(t)}));t.items.subscribe(i,(function(){n._updateSelected(t.value())}));f.isObservable(t.multiItemDisplayText)&&t.multiItemDisplayText.subscribe(i,(function(){n._setDisplayString()}));this.$disabled.subscribe(i,(function(t){t&&n._closeDropdown()}));this.$disabled.subscribeAndRun(i,(function(t){n.element.toggleClass("msportalfx-form-formelement-disabled",t)}));this.vm.isPopUpOpen.subscribe(i,(function(t){n._popupGuard||(t?n._openDropdown(!0):n._closeDropdown(!0,!0))}));t.ariaLabel&&t.ariaLabel.subscribeAndRun(i,(function(t){var i=r.find("#"+n._textboxId()),u=(t||"").trim();u.length?(r.attr({"aria-labelledby":null,"aria-label":u}),i.attr({"aria-labelledby":null,"aria-label":u})):n.element.find("#"+n._labelId()).length?(r.attr("aria-labelledby",n._labelId()),i.attr("aria-labelledby",n._labelId()+" "+n._comboboxId())):(r.removeAttr("aria-labelledby aria-label"),i.attr("aria-labelledby",n._comboboxId()))}));this._required.subscribeAndRun(i,(function(t){n._setAttribute("aria-required",t)}));t.valid.subscribeAndRun(i,(function(t){n._setAttribute("aria-invalid",!t)}));t.loading.subscribeAndRun(i,(function(t){n.disabled(t);t?(n._closeDropdown(),n._icon(et.Loading.Spinner())):n._icon(et.CaretDown())}));this._validator.validationState.subscribe(this.ltm,(function(t){t===3?n._pendingTimer=bt.setTimeout((function(){n._icon(et.Loading.Spinner())}),nr):(n._pendingTimer&&clearTimeout(n._pendingTimer),n._pendingTimer=null,n._icon(et.CaretDown()))}));this.vm.statusMessage&&this.vm.statusMessage.subscribeAndRun(this.ltm,(function(t){ft(t)?n._statusMessage({htmlTemplate:h.Search.noResults}):n._statusMessage(t)}));this.vm.showStatusMessage&&this.vm.showStatusMessage.subscribeAndRun(this.ltm,(function(t){ft(t)?n._showStatusMessage(!1):n._showStatusMessage(t)}))},t.prototype._attachEvents=function(){var n=this,t,r=function(){n.vm.isPopUpOpen()?n._closeDropdown():n._openDropdown()},u=function(t){var u=n.vm,s,o,h,r,c;if(t.hasClass(it))if(u.selectAllOverride)u.selectAllOverride();else{var l=u._msPortalFxWidgetValue,a=l(),v=pt(u.items());a&&a.length===v.length?l([]):l(v)}else s=t.hasClass(st),t.parentsUntil("."+g).each((function(){if(e(this).hasClass(st)){s=!0;return}})),s||(o=f.unwrap(f.dataFor(t[0]).value),n._multiselect()?(h=u._msPortalFxWidgetValue(),r=[],ft(h)||(r=ni(h)),c=void 0,r&&r.length?i.isUndefined(c=i.find(r,(function(n){return i.deepEquals(n,o)})))?r.push(o):r.remove(c):r=[o],u._msPortalFxWidgetValue(r)):u._msPortalFxWidgetValue(o),n._multiselect()||(n._closeDropdown(!0),n.element.find(".fxc-dd-text-wrapper > ."+ut).focus()));n.element.trigger("fxvaluechanged")},o=function(t){var i=n.element.findByClassName(g).find("."+nt+":not(."+it+"):not(."+d+"):not(."+st+")");(i.length===1||t&&!!i.length)&&u(e(i[0]))};this._labelElement.on("click",(function(t){e(t.target).is("a")||(t.stopPropagation(),r(),n.vm.isPopUpOpen()&&n.element.find("input").focus())}));this.ltm.registerForDispose([this.element.setEvents([s.default.touchstart,function(){n._isTouch||n._filterReadOnly(!0);n._isTouch=!0},],[s.default.click,function(n){n.stopPropagation()},],[s.default.mousedown,function(n){n.stopPropagation();e(n.target).closest(".fxc-group-dropdown-arrow").length>0&&n.preventDefault()},],[s.default.mouseup,function(n){n.stopPropagation();e(n.target).closest("."+rt).length>0&&(n.preventDefault(),r())},],[s.default.keydown,function(i){(i.which===38&&n.vm.isPopUpOpen()||i.which===40||i.which===18)&&(i.preventDefault(),i.stopPropagation());(i.which===13||i.which===32)&&(t=n.element.findByClassName(tt),n._filter()||e(i.target).is("a")||i.preventDefault());i.which===9&&n._filtering&&o()},],[s.default.keyup,function(i){var f=n.element.find("."+tt+":not(."+d+")"),s,h;f.length||(f=e(n.element.findByClassName(at)[0]));switch(i.which){case 13:case 32:t&&t.length&&!t.hasClass(d)?u(t):i.which===13&&n.vm.isPopUpOpen()&&n._filtering?o(!0):e(i.target).hasClass(rt)&&r();break;case 40:s=n.element.find("."+nt+":not(."+d+")").first();n._handleArrowKey(i,!0,s,f);break;case 38:h=n.element.find("."+nt+":not(."+d+")").last();n._handleArrowKey(i,!1,h,f)}}]),this.element.findByClassName(g).setEvents([s.default.mouseup,function(t){t.stopPropagation();n.element.findByClassName(tt).removeClass(tt);var i=e(t.target).closest("."+nt);si(i)&&u(i)}]),e(window).setEvents(["resize."+g,function(){n._closeDropdown()},]),])},t.prototype._setAttribute=function(n,t){var r=this.element.find(this._filter()&&!this._multiselect()?".fxc-TextField input":"."+ut+"."+rt);i.isNull(t)?r.removeAttr(n):r.attr(n,t);this._multiselect()&&this._filter()&&(r=this.element.find(".fxc-TextField input"),i.isNull(t)?r.removeAttr(n):r.attr(n,t))},t.prototype._updateSelected=function(n){this._selectedValue(n);var i=this._multiselect(),r=ni(n),t=null;this._flattenItemsMap().forEach((function(n){var u=r.some((function(t){return n.hasOwnProperty("value")&&yt(t,f.unwrap(n.value))}));n._selected(u);!i&&t===null&&u&&(t=n)}));this.vm.suppressSelectedUpdate()?this._currentItem=t:this._setDisplayString(t);this._multiselectSelectAll()&&this._setSelectAllClass()},t.prototype._setSelectAllClass=function(){var n;if(this._multiselectSelectAll()){var t=this.vm.value(),r=pt(this.vm.items()),i=t&&t.length;this._allSelected(i===r.length);n=this._allSelected();this.element.findByClassName(it).toggleClass(at,n);this.element.toggleClass(bi,n);this.element.toggleClass(wi,!n&&!!i)}},t.prototype._setupFiltering=function(){var t=this,o,y,b;this.element.addClass(ei);this._filter(!0);var n=this.vm,u=this.ltm,k=!f.isObservable(n.filterPlaceholder)&&n.filterPlaceholder===""?n.placeholder:n.filterPlaceholder,r=this._textBoxViewModel=new vi(u,{emptyValueText:i.initObservable(k),valueUpdateTrigger:4,readOnly:this._filterReadOnly}),c=e(document.createElement("div"));this.element.find(this._multiselect()?"."+dt:"#"+this._comboboxId()).prepend(c);this._textBoxWidget=new p.Widget(c,r);n.showSearchIcon&&n.showSearchIcon.subscribeAndRun(this._textBoxWidget.ltm,(function(n){t._textBoxWidget&&t._textBoxWidget._textBoxViewModel.showSearchIcon(n)}));c.find(".azc-text-label").removeAttr("aria-hidden");n.customFilter&&r.value.extend({rateLimit:{timeout:gi,method:"notifyWhenChangesStop"}});var w=function(i){n.isPopUpOpen()&&!t._doNotFilter&&t._filterResults(i)},v=r.value()||"",l=h.dropDownLoading;this._multiselect()||n.loading.subscribeAndRun(u,(function(n){if(n){var t=r.value();l!==t&&(v=t);r.value(l)}else r.value(v)}));r.value.subscribe(u,(function(t){if(l!==t&&(v=t,n.loading())){r.value(l);return}n.filterString()!==t&&(n.filterString(t),w(t))}));n.filterString.subscribe(u,(function(n){r.value()!==n&&(r.value(n),w(n))}));this._multiselect()||(r.valid=n.valid);o=this._textBoxDisabledLifetime;o&&o.dispose();o=this._textBoxDisabledLifetime=u.createChildLifetime();this.$disabled.subscribeAndRun(o,r.disabled);y=c.find("input");b=[27,9,16,40,38,18,112,13];y.on(s.default.mouseup,(function(){t.vm.isPopUpOpen()||t._openDropdown()})).on(s.default.keyup,(function(n){if(t.vm.isPopUpOpen()||~b.indexOf(n.which)||a.getModifierKeys(n)!==0?n.which===32?n.stopPropagation():n.which===13&&t._openDropdown():(t._openDropdown(),t._filterResults(t._textBoxViewModel.value())),112===n.which||27===n.which){var i=e.Event("keydown");i.which=n.which;t.element.trigger(i)}}));y.attr({id:this._multiselect()?this._filterTextboxId():this._textboxId(),role:"textbox","aria-readonly":!1,"aria-controls":this._optionContainerId(),autocomplete:"off","aria-required":this._required(),"aria-invalid":!n.valid(),"aria-label":h.DropDown.filterTextbox,"aria-labelledby":null,"aria-autocomplete":"list"});this._updateSelected(n.value())},t.prototype._filterResults=function(n){var i=this,u=this.element.findByClassName(g),t=0,o=u.find("."+nt+":not(."+it+")"),l=u.findByClassName(ct),s=this.vm,a=this.element.findByClassName(it),c,v;this._filtering=!0;c=function(){var n=i.vm.showStatusMessage;(!n||ft(n()))&&i._showStatusMessage(t===0)};s.customFilter?(v=s.items(),s.customFilter(n).then((function(s){var y,p;a.toggleClass(d,!!n.length);yt(v,i.vm.items())?(l.each((function(){e(this).addClass(d)})),o.each((function(){var i=this,n=e(this),t=s&&s.some((function(n){return yt(n,f.unwrap(f.dataFor(i).value))}));t&&hi(n);n.toggleClass(d,!t)})),y=u.find("."+nt+"."+d+":not(."+it+")"),t=o.length-y.length):(s&&s.length>0&&(p=r.createError("DropDown customFilter",{data:{message:"The dropdown is unable to replace items and filter. Please use one or the other to avoid erroneous behavior."}}),tr.warning(p)),t=u.find("."+nt+":not(."+it+")").length);c(t===0);i._ariaLive(h.DropDown.filterResult.format(t,n))}))):(ft(n)||(a.toggleClass(d,!!n.length),l.each((function(){e(this).toggleClass(d,n.length>0)})),o.each((function(){var i=e(this),r=i.text().toLocaleLowerCase().indexOf(n.toLocaleLowerCase())===-1;r||(t++,hi(i));i.toggleClass(d,r)}))),c(t===0),this._ariaLive(h.DropDown.filterResult.format(t,n)))},t.prototype._removeFiltering=function(){this.element.removeClass(ei);this._filter(!1);this._textBoxDisabledLifetime&&this._textBoxDisabledLifetime.dispose();this._textBoxViewModel=null;this._textBoxWidget.dispose();this._textBoxWidget.element.remove();this._textBoxWidget=null;this.element.find("."+ut+"."+rt).attr({"aria-required":this._required(),"aria-invalid":!this.vm.valid()})},t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(n.prototype.dispose.call(this),this._filter()&&this._removeFiltering(),this._cleanElement(ri,"msportalfx-form-formelement"))},t.prototype._handleArrowKey=function(n,t,i,r){n.preventDefault();var u=this.vm.isPopUpOpen();u?t&&n.altKey?this._closeDropdown():r.length===0?i.length>0?this._moveSelectedFromKeyboard(i):this._findNextValidItem(i,t):this._findNextValidItem(r,t):this._openDropdown()},t.prototype._findNextValidItem=function(n,t){var i=this.element.findByClassName(g).find("."+nt+":not(."+d+")"),u,r;i.length&&(u=i.toArray().indexOf(n[0]),r=void 0,t?i.length>u&&(r=e(i[u+1])):r=u>0?e(i[u-1]):e(i[i.toArray().length-1]),si(r)?this._moveSelectedFromKeyboard(r):this._findNextValidItem(r,t))},t.prototype._moveSelectedFromKeyboard=function(n){if(n&&n.length>0){this.element.findByClassName(tt).removeClass(tt);n.addClass(tt);this._setAttribute("aria-activedescendant",n.attr("id"));var i=n.outerHeight(),r=this.element.findByClassName(g),t=n.position().top,u=r.height(),f=u<t+i;(f||t<0)&&(r[0].scrollTop+=t+(f&&i-u))}},t.prototype._assignId=function(){var n=this._optionContainerId()+this._descendantIndex;return this._descendantIndex++,n},t.prototype._setDisplayString=function(n){var r,u,o,s;if(n===void 0&&(n=null),this._currentItem=n,r=f.unwrap(this.vm.placeholder),u=r,n&&(u=n.selectedItemOverride?n.selectedItemOverride:n.text),this._multiselect()){var c=f.unwrap(this.vm.multiItemDisplayText),a=this.vm.value(),v=ni(a),l=this.vm.items&&this.vm.items()||[],y=pt(l),t=v.filter((function(n){return y.indexOf(n)>-1}));c?this._displayString(c.format(t.length)):t.length===1?this._displayString(ci(t[0],l)):this._displayString(h.dropDownXSelected.format(t.length));this._ariaLive(this._displayString())}else o=f.unwrap(u),this._displayString(o),this._filter()?(this._doNotFilter=!0,n?(s=e(e.parseHTML(o,yi)).text(),this._textBoxWidget.element.find("input").val(s),this._textBoxViewModel.value(s)):this._textBoxViewModel.value(""),this._doNotFilter=!1):r.length>0&&this.element.find("."+rt+".azc-formControl").toggleClass("fxc-dropdown-placeholder",i.isNullOrUndefined(n))},t.prototype._resetPopUpUIForEdge=function(n,t){o.isEdge||o.isIe11?(n.css("opacity",0),bt.setTimeout((function(){n.toggleClass(lt,t).css("opacity",1)}),50),t&&l.jBody.hide().show(0)):t&&n.addClass(lt)},t.prototype._openDropdown=function(n){var l=this,u,rt,y,f,h,k,et;if(n===void 0&&(n=!1),!this.$disabled()&&(!this.vm.isPopUpOpen()||n)){this._popupGuard=!0;this._popupOnce(!0);n||this.vm.isPopUpOpen(!0);this.element.findByClassName(ot).addClass(ui);var t=e(this.element.findByClassName(ot)[0]).width()-2,i=this.element.findByClassName(g).removeClass(lt).css({"max-height":"",width:t}).removeAttr("aria-hidden"),st=e(document).findByClassName("fxs-sidebar-bar").width(),d=this.element.find("#"+this._comboboxId()),r=d.offset(),nt=r.left,a=e(window).width()-r.left-i.outerWidth(),tt="right",it=a,v=nt-st;a>v&&(tt="left",it=nt,v=a);u=0;rt=i.find("[role='treeitem']");rt.each((function(){this.scrollWidth>u&&(u=this.scrollWidth)}));y=t+v-gt;u>t&&(t=u+20,t>y&&(t=y));var p="top",ut=e(window).height(),w=r.top+d.height()-e(window).scrollTop(),ft=w-gt-e(document).findByClassName("fxs-topbar").height()-e(document).findByClassName("fxs-breadcrumb-container").height(),b=ut-r.top-this.element.height()-gt,o=b,s={};i.height()>b&&ft>b&&(p="bottom",o=ft,w=ut-r.top);this._syncFilterPosition("bottom"===p);o>oi&&(o=oi);s[p]=w;s[tt]=it;e.extend(s,{"max-height":o,width:t});i.css(s);f=this.element.findByClassName(at);f.length&&(f.position().top>i.height()&&(this.element.findByClassName(g)[0].scrollTop=f.position().top),this._setAttribute("aria-activedescendant",f.attr("id")));this._filter()&&(this._isTouch?(i.focus(),this._filterReadOnly(!1)):this._multiselect()&&this.element.find("input").focus());h=function(n){return!(l.element.findByClassName("azc-formElementContainer")[0]===n)&&!e.contains(l.element.findByClassName("azc-formElementContainer")[0],n)?2:0};k={dismissFn:function(){l._closeDropdown()},shouldDismissOnFocusOutFn:h,shouldDismissOnMouseDownFn:h,shouldDismissOnMouseWheelFn:h,shouldDismissOnScroll:!this._isTouch,logName:"dropdown"};(!this._dismissHandleLifetime||this._dismissHandleLifetime.isDisposed())&&(c.register(k,!0),et=this._dismissHandleLifetime=this.ltm.createChildLifetime(),et.registerForDispose((function(){c.unregister(k)})));this._resetPopUpUIForEdge(i,!1);this._popupGuard=!1}},t.prototype._closeDropdown=function(n,t){var u=this,r,i;(t===void 0&&(t=!1),this.vm.isPopUpOpen()||t)&&(this._popupGuard=!0,this._filtering=!1,r=f.unwrap(this.vm.showStatusMessage),r||this._showStatusMessage(!1),[ui,tt].forEach((function(n){u.element.find("."+n).removeClass(n)})),this.element.find("."+nt+"."+d).removeClass(d),this.element.find("."+ct+"."+d).removeClass(d),i=this.element.findByClassName(g),i[0].scrollTop=0,i.css({top:"",bottom:"",left:"",right:""}).attr("aria-hidden","true"),this._resetPopUpUIForEdge(i,!0),this._setAttribute("aria-activedescendant",null),t||this.vm.isPopUpOpen(!1),this._filter()&&(this._isTouch&&this._filterReadOnly(!0),this._multiselect()?(this._textBoxWidget.element.find("input").val(""),this._textBoxViewModel.value(""),this.element.find("div."+ut+"[role='textbox']").focus()):n||this._setDisplayString(this._currentItem)),this._dismissHandleLifetime&&this._dismissHandleLifetime.dispose(),this._popupGuard=!1)},t.prototype._syncFilterPosition=function(n){var t,i;this._multiselect()&&(t=this.element.find("."+dt),t[0])&&(i=t.parent(),i.hasClass(g))&&(n?i.append(t):i.prepend(t))},t})(b.Widget),ti,ht,wt;t.Widget=ir})(d||(d={})),d}))